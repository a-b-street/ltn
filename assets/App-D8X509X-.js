import{c as cl,b as dl,H as ju,i as zu,n as Du,s as Uu,a as Gu,d as Wu,e as Hu,U as qu,p as Ju,r as Qu,t as Zu,l as vr,I as gr,f as Ce,g as $e,h as Z,j as _r,k as _,o as Ae,u as us,q as Vu,v as r,w as Y,x as $o,y as Re,z as W,A as fl,B as Ku,C as cr,D as Qe,E as u,F as ve,G as Ne,J as Pn,K as Ur,L as It,M as Pe,N as M,O as rn,P as Q,Q as c,R as Et,S as vl,T as Er,V as Xu,W as gl,X as Yu,Y as ec,Z as tc,_ as bt,$ as rc,a0 as Vn,a1 as nc,a2 as oc,a3 as ua,a4 as h,a5 as ac,a6 as ic,a7 as sc,a8 as lc,a9 as uc,aa as nn,ab as cc,ac as dc,ad as kn,ae as qt,af as U,ag as Jt,ah as Dr,ai as dr,aj as _l,ak as lt,al as we,am as fc,an as co,ao as vc,ap as Hr,aq as io,ar as pl,as as ca,at as Ve,au as wt,av as Zr,aw as Rr,ax as so,ay as be,az as qr,aA as ut,aB as ct,aC as gc,aD as bi,aE as er,aF as vn,aG as Rt,aH as jt,aI as Di,aJ as po,aK as Qo,aL as Zo,aM as hl,aN as Vo,aO as Ko,aP as Xo,aQ as Ue,aR as Yo,aS as ml,aT as ea,aU as Ra,aV as yi,aW as Vr,aX as ta,aY as En,aZ as Ai,a_ as Ui,a$ as Gi,b0 as Wi,b1 as Hi,b2 as qi,b3 as Ji,b4 as Va,b5 as ra,b6 as Qi,b7 as ho,b8 as _n,b9 as ma,ba as Ka,bb as Na,bc as wi,bd as _c,be as Jr,bf as xi,bg as pc,bh as bl,bi as yl,bj as Kt,bk as Al,bl as wl,bm as Zi,bn as $i,bo as xl,bp as cs,bq as lr,br as Vi,bs as zo,bt as ki,bu as ba,bv as Ba,bw as Fa,bx as Ea,by as La,bz as $l,bA as Do,bB as ds,bC as fs,bD as vs,bE as Si,bF as hc,bG as Ei,bH as gs,bI as _s,bJ as mc,bK as ps,bL as kl,bM as bc,bN as yc,bO as Ac,bP as wc,bQ as xc,bR as $c,bS as kc,bT as Sc,bU as Ec}from"./pico.conditional.jade.min-Cku-EFrk.js";function Lc(n){var e;e=document.head.appendChild(cl());try{dl(()=>n(e),ju)}finally{}}function Xa(n,e,t){var o=n,a=qu,s,l,i=null,v=zu()?Du:Uu;function f(){s&&Ju(s),i!==null&&(i.lastChild.remove(),o.before(i),i=null),s=l}dl(()=>{if(v(a,a=e())){var b=o,m=Hu();m&&(i=document.createDocumentFragment(),i.append(b=cl())),l=Gu(()=>t(b)),m?Wu.add_callback(f):f()}})}function Cc(n,e,t,o,a){var s=()=>{o(t[n])};t.addEventListener(e,s),a?Qu(()=>{t[n]=a()}):s(),(t===document.body||t===window||t===document)&&Zu(()=>{t.removeEventListener(e,s)})}const Mc="/ltn/assets/arrow-big-up-DKeSc1KD.png",Pc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAk0lEQVRIS+3U0Q2AIAwEUNjMUXQydRJH0zZB0wjGuwJfSsKfuWfO1hg6n9g5P3wPWKTSXe6EVstUNEjoloIVghAG0OxR7swgLEAjHoBCvACM1AAQUgJ0DL0nm67WwJom7XrBlhVl4arUAHYniuE1ABTuBeBwD0CFs4D92T12fp9v9iPrnJ8LBu0KC0Ch9qEfeK3sAPceHxk8hJ17AAAAAElFTkSuQmCC",Tc="/ltn/assets/favicon-DMAVMD4u.ico",Ic="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAALRQTFRFR3BMemc7uV08rWA9gmc9wlw9+1M8/1c6XGw7rWA8yFs9Tm47d2g8RXA7lmM8N3I6bGo7g2Y8u108wl097lY9vV08pmE9pGE8IHY7/3YajWU8hWc811o+nmI87VU7L3M73Fo+K3Q62Fs+s189kWQ8gGc7iGU8e2g7x1pAC3k6////X6d+H4RKTJ1vjcCjEHg6F3c6HnY6+Pv6NJBbWaR5FX5C4vDoHINIQZZlfbiWmMaszuTYcGgFiwAAACl0Uk5TAMN7grBaDAXjiU7r0O+f9dvJdmUgbZSi/AKouC+zGPg3+yV8wbuzwESr5F6DAAAFwklEQVR42u3ax1rbQACF0STGvRsXMJieMqTICqS//3tlkS8LgpNgSZsZnf8R7hysgp49kyRJkiRJkqQ0mzdn141HvVhctGyTese95clkmIddZZedwXp2ZqR0u1oOLsO/y/qvFm1LJdnpqh+e0nZwjUB6tZZPO/5fBJoGS6zeIAt7NF65IUyq7jDsVza9sFoytVdHYe86PcOlcv6bbShQ341AIq0KnX8IQ78BSbTMQ8E6p9aLv+Y4FG7qWSD6rjrFzz9kKwPG3iaUaew2IPYLwHkpAGHqrXDcTcudf8gXNoz6B+CyJIAwPbZixJ2UPf9w5HVQxM37pQGEtRnjrVv+/EPHu4B4e1kBgO2hHWOt1akAQBgZMtZ6eRUAnhsy1hpVnH+YeBCMtVElAMZzS0baQRXnn+X+H1Df10AeA6LudSUAwsySkfa8GgAvLAmAABAAAkAACADFDuDL+4d9/QRAnQC8/Xj7R5/vAKgPgHePzv/29gcA9QFwf7ujTwDUBsDbXQDeAQAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAAAAAAAAAAAAAAAAAAAAAfne/C8AXAGoD4G7H+X8OANQGQPj+6Pw/3gNQIwDh/YeHfbsLANQJwD4BAICi7HU1AGaWjLSXlZx/dmjJSDuoBEDes2SkjSoBMD61ZKR1KwHQaVsy0g63VQAYGDLWzvpVAFgbstYvAjJPgfG2rABAf27HaLsYlwdwYsZ4Oy5/Ddi6AsTcrPRzwKRlxYhrD8reAnaNGHXXuR8AdwHFO1qYMPLeDMsAuDFg9HWPSlwAruwX/0VgkxU9/2HTfAnUuil4/ufXxkuis2mx8/cEmIyAmwJXgXHDcOlcBTZ73wl2fAmYVI39Pg3YTn0Hllinm8s9/vy7PgNLr8X0ideB/trjf5pvBA5P/n8hyCcjx59u8+6ryflfHwny4WDU9OOfeO2LRXe0Xh/80Xq0bDTPzCNJkiRJkqQk+wnTOFu90krtLAAAAABJRU5ErkJggg==",Sl="/ltn/assets/no_left_turn-Xpmw1_3C.png",Li="/ltn/assets/no_right_turn-CZwHVCpW.png",El="/ltn/assets/no_straight_turn-BWpcWQch.png",Ll="/ltn/assets/no_u_left_to_right_turn-C4sWYlhS.png",Cl="/ltn/assets/no_u_right_to_left_turn-ClrJyulH.png",Rc="/ltn/assets/logo-3MjkCCFo.svg",Ml="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC";function Nc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m5 12 7-7 7 7"}],["path",{d:"M12 19V5"}]];gr(n,Ce({name:"arrow-up"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Bc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M8 12h8"}],["path",{d:"M12 8v8"}]];gr(n,Ce({name:"circle-plus"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Pl(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];gr(n,Ce({name:"copy"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Fc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21"}],["path",{d:"m5.082 11.09 8.828 8.828"}]];gr(n,Ce({name:"eraser"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Tl(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M12 18v-6"}],["path",{d:"m9 15 3 3 3-3"}]];gr(n,Ce({name:"file-down"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Oc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"}]];gr(n,Ce({name:"folder-open"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function jc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}],["path",{d:"M2 12h20"}]];gr(n,Ce({name:"globe"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function zc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];gr(n,Ce({name:"house"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Dc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];gr(n,Ce({name:"layers"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Uc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m14.622 17.897-10.68-2.913"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15"}]];gr(n,Ce({name:"paintbrush"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Ki(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]];gr(n,Ce({name:"pencil"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Il(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M22 14a8 8 0 0 1-8 8"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"}]];gr(n,Ce({name:"pointer"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Gc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21 7v6h-6"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"}]];gr(n,Ce({name:"redo"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Wc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"6",cy:"19",r:"3"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}],["circle",{cx:"18",cy:"5",r:"3"}]];gr(n,Ce({name:"route"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Ya(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];gr(n,Ce({name:"trash-2"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Hc(n,e){const t=vr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M3 7v6h6"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"}]];gr(n,Ce({name:"undo"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Z(l);_r(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}class qc extends Map{#e=new Map;#t=Ae(0);#r=Ae(0);#a=us||-1;constructor(e){if(super(),e){for(var[t,o]of e)super.set(t,o);this.#r.v=super.size}}#n(e){return us===this.#a?Ae(e):Vu(e)}has(e){var t=this.#e,o=t.get(e);if(o===void 0){var a=super.get(e);if(a!==void 0)o=this.#n(0),t.set(e,o);else return r(this.#t),!1}return r(o),!0}forEach(e,t){this.#o(),super.forEach(e,t)}get(e){var t=this.#e,o=t.get(e);if(o===void 0){var a=super.get(e);if(a!==void 0)o=this.#n(0),t.set(e,o);else{r(this.#t);return}}return r(o),super.get(e)}set(e,t){var o=this.#e,a=o.get(e),s=super.get(e),l=super.set(e,t),i=this.#t;if(a===void 0)a=this.#n(0),o.set(e,a),Y(this.#r,super.size),$o(i);else if(s!==t){$o(a);var v=i.reactions===null?null:new Set(i.reactions),f=v===null||!a.reactions?.every(b=>v.has(b));f&&$o(i)}return l}delete(e){var t=this.#e,o=t.get(e),a=super.delete(e);return o!==void 0&&(t.delete(e),Y(this.#r,super.size),Y(o,-1),$o(this.#t)),a}clear(){if(super.size!==0){super.clear();var e=this.#e;Y(this.#r,0);for(var t of e.values())Y(t,-1);$o(this.#t),e.clear()}}#o(){r(this.#t);var e=this.#e;if(this.#r.v!==e.size){for(var t of super.keys())if(!e.has(t)){var o=this.#n(0);e.set(t,o)}}for([,o]of this.#e)r(o)}keys(){return r(this.#t),super.keys()}values(){return this.#o(),super.values()}entries(){return this.#o(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return r(this.#r),super.size}}function na(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>t!=null))}function hs(n){let e;return t=>{if(t)for(let o in t){let a=e?.[o],s=t[o];a!==s&&n(o,s,a)}else if(e)for(let o in e)n(o,void 0,e[o]);e=t}}function Jc(n,...e){let t=[n];for(let o of e)if(o)Array.isArray(o)&&o[0]===n?t.push(...o.slice(1)):t.push(o);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Qc(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function xt(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}function da(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("layer")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"paint",3,void 0),v=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),b=W(e,"applyToClusters",3,void 0),m=W(e,"requireSource",3,!0),C=W(e,"minzoom",3,void 0),B=W(e,"maxzoom",3,void 0),T=W(e,"manageHoverState",3,!1),$=W(e,"hovered",15),P=W(e,"interactive",3,!0),y=W(e,"hoverCursor",3,void 0),w=W(e,"eventsIfTopMost",3,!1),O=W(e,"children",3,void 0),D=W(e,"onclick",3,void 0),N=W(e,"ondblclick",3,void 0),j=W(e,"oncontextmenu",3,void 0),z=W(e,"onmouseenter",3,void 0),d=W(e,"onmousemove",3,void 0),g=W(e,"onmouseleave",3,void 0);const p=fl(),k=u(Ur),x=u(()=>r(k).loaded),{layer:A}=Ku(),F=u(Ur),S=u(()=>r(F).map),I=u(()=>r(F).eventTopMost),E=u(()=>r(F).layerInfo),L=u(()=>r(F).minzoom),R=u(()=>r(F).maxzoom);cr(()=>{A.value&&(r(E).delete(A.value),r(S).removeLayer(A.value))});let G;function J(fe){if(!P()||!A.value||!r(S)||w()&&r(I)(fe)!==A.value)return;let oe=fe.features??[],ye=oe[0]?.properties?.cluster_id,he={event:fe,map:r(S),clusterId:ye,layer:A.value,source:r(re),features:oe};switch(fe.type){case"click":D()?.(he);break;case"dblclick":N()?.(he);break;case"contextmenu":j()?.(he);break}}function H(fe){if(!P()||!A.value||w()&&r(I)(fe)!==A.value)return;y()&&(r(S).getCanvas().style.cursor=y());let oe=fe.features??[];$(oe[0]??void 0);let ye=oe[0]?.properties?.cluster_id,he={event:fe,map:r(S),clusterId:ye,layer:A.value,source:r(re),features:oe};z()?.(he)}function X(fe){if(!P())return;if(w()&&r(I)(fe)!==A.value){$(void 0),T()&&G!==void 0&&(r(S).setFeatureState({source:r(re),sourceLayer:a(),id:G},{hover:!1}),G=void 0);return}y()&&(r(S).getCanvas().style.cursor=y());let oe=fe.features??[],ye=oe[0]?.properties?.cluster_id,he=oe[0]?.id;he!==G&&(T()&&(G!==void 0&&r(S).setFeatureState({source:r(re),id:G,sourceLayer:a()},{hover:!1}),r(S).setFeatureState({source:r(re),id:he,sourceLayer:a()},{hover:!0})),G=he,$(oe[0]??void 0)),d()?.({event:fe,map:r(S),clusterId:ye,layer:A.value,source:r(re),features:oe})}function le(fe){if(!(!P()||!A.value||!r(S))){if(y()&&(r(S).getCanvas().style.cursor=""),$(void 0),T()&&G!==void 0){const oe={source:r(re),id:G,sourceLayer:a()};r(S).setFeatureState(oe,{hover:!1}),G=void 0}g()?.({map:r(S),layer:A.value,source:r(re)})}}let q=Ae(!0);function ee(fe){r(S).off("click",fe,J),r(S).off("dblclick",fe,J),r(S).off("contextmenu",fe,J),r(S).off("mouseenter",fe,H),r(S).off("mousemove",fe,X),r(S).off("mouseleave",fe,le)}cr(()=>{A.value&&ee(A.value)});let ue=u(()=>Qc(b())),K=u(()=>Jc("all",r(ue),f())),V=u(()=>C()??r(L)),te=u(()=>B()??r(R)),re=u(()=>o()||p?.value);Qe(()=>{if(A.value!==t()&&r(x)&&(r(re)||!m())){A.value&&(ee(A.value),r(E).delete(A.value));let fe=s();if(!s()&&l()){let oe=r(S).getStyle().layers,ye=typeof l()=="function"?l():xe=>xe.type===l(),he=oe?.find(ye);he&&(fe=he.id)}A.value=t(),r(S).addLayer(na({id:A.value,type:e.type,source:r(re),"source-layer":a(),filter:r(K),paint:i(),layout:v(),minzoom:r(V),maxzoom:r(te)}),fe),Y(q,!0),r(S).on("click",A.value,J),r(S).on("dblclick",A.value,J),r(S).on("contextmenu",A.value,J),r(S).on("mouseenter",A.value,H),r(S).on("mousemove",A.value,X),r(S).on("mouseleave",A.value,le)}}),Qe(()=>{A.value&&r(E).set(A.value,{interactive:P()})});let ie=u(()=>A.value?hs((fe,oe)=>{r(S).style._loaded?r(S).setPaintProperty(A.value,fe,oe):r(S).once("styledata",()=>r(S).setPaintProperty(A.value,fe,oe))}):void 0),ne=u(()=>A.value?hs((fe,oe)=>{r(S).style._loaded?r(S).setLayoutProperty(A.value,fe,oe):r(S).once("styledata",()=>r(S).setLayoutProperty(A.value,fe,oe))}):void 0);Qe(()=>{r(ie)?.(i())}),Qe(()=>{r(ne)?.(v())}),Qe(()=>{A.value&&r(S).setLayerZoomRange(A.value,r(V),r(te))}),Qe(()=>{A.value&&(r(q)?Y(q,!1):r(S).setFilter(A.value,r(K)))});var ae=$e(),_e=Z(ae);{var se=fe=>{var oe=$e(),ye=Z(oe);Xa(ye,()=>A.value,he=>{var xe=$e(),Se=Z(xe);It(Se,()=>O()??Pe),_(he,xe)}),_(fe,oe)};ve(_e,fe=>{A.value&&fe(se)})}_(n,ae),Ne()}function Ln(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("circle")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),f=W(e,"applyToClusters",3,void 0),b=W(e,"minzoom",3,void 0),m=W(e,"maxzoom",3,void 0),C=W(e,"hoverCursor",3,void 0),B=W(e,"manageHoverState",3,!1),T=W(e,"hovered",15),$=W(e,"eventsIfTopMost",3,!1),P=W(e,"interactive",3,!0),y=W(e,"children",3,void 0),w=W(e,"onclick",3,void 0),O=W(e,"ondblclick",3,void 0),D=W(e,"oncontextmenu",3,void 0),N=W(e,"onmouseenter",3,void 0),j=W(e,"onmousemove",3,void 0),z=W(e,"onmouseleave",3,void 0);da(n,{get id(){return t()},type:"circle",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return v()},get applyToClusters(){return f()},get minzoom(){return b()},get maxzoom(){return m()},get hoverCursor(){return C()},get manageHoverState(){return B()},get eventsIfTopMost(){return $()},get interactive(){return P()},get onclick(){return w()},get ondblclick(){return O()},get oncontextmenu(){return D()},get onmouseenter(){return N()},get onmousemove(){return j()},get onmouseleave(){return z()},get hovered(){return T()},set hovered(d){T(d)},children:(d,g)=>{var p=$e(),k=Z(p);It(k,()=>y()??Pe),_(d,p)},$$slots:{default:!0}}),Ne()}var Zc=M("<div><!></div>");function Ci(n,e){Re(e,!0);let t=W(e,"defaultStyling",3,!0),o=W(e,"position",3,"top-right"),a=W(e,"class",3,void 0);const s=u(Ur),l=u(()=>r(s).map);let i=Ae(void 0),v={onAdd(){return r(i)},onRemove(){r(i)?.parentNode?.removeChild(r(i))}};Qe(()=>{r(i)&&r(l).addControl(v,o())}),cr(()=>{r(l).removeControl(v)});var f=Zc();let b;var m=c(f);It(m,()=>e.children??Pe),rn(f,C=>Y(i,C),()=>r(i)),Q(C=>b=Et(f,1,vl(a()),null,b,C),[()=>({"maplibregl-ctrl":t()})]),_(n,f),Ne()}var Vc=M("<div><!></div>");function ms(n,e){let t=W(e,"class",3,"");var o=Vc(),a=c(o);It(a,()=>e.children??Pe),Q(()=>Et(o,1,`maplibregl-ctrl-group ${t()??""}`)),_(n,o)}function ur(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("fill")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),f=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"hoverCursor",3,void 0),C=W(e,"manageHoverState",3,!1),B=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),$=W(e,"interactive",3,!0),P=W(e,"onclick",3,void 0),y=W(e,"ondblclick",3,void 0),w=W(e,"oncontextmenu",3,void 0),O=W(e,"onmouseenter",3,void 0),D=W(e,"onmousemove",3,void 0),N=W(e,"onmouseleave",3,void 0);da(n,{get id(){return t()},type:"fill",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return v()},get minzoom(){return f()},get maxzoom(){return b()},get hoverCursor(){return m()},get manageHoverState(){return C()},get eventsIfTopMost(){return T()},get interactive(){return $()},get onclick(){return P()},get ondblclick(){return y()},get oncontextmenu(){return w()},get onmouseenter(){return O()},get onmousemove(){return D()},get onmouseleave(){return N()},get hovered(){return B()},set hovered(j){B(j)},children:(j,z)=>{var d=$e(),g=Z(d);It(g,()=>e.children??Pe),_(j,d)},$$slots:{default:!0}}),Ne()}function Kc(n,e){Re(e,!0);const t=u(Ur),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"container",3,void 0),i=Ae(void 0),v=u(()=>typeof l()=="string"?document.querySelector(l())??void 0:l());Qe(()=>{r(i)||(r(v)?Y(i,new Er.FullscreenControl({container:r(v)}),!0):Y(i,new Er.FullscreenControl,!0),r(o).addControl(r(i),s()))}),cr(()=>{r(a)&&r(i)&&r(o).removeControl(r(i))}),Ne()}function Rl(n,e,t,o,a){let s=!1;n.getSource(e)&&(s=!0,n.removeSource(e));const l=()=>{o(e)&&(n.addSource(e,t),a())};if(s){const i=()=>{e&&(n.getSource(e)?setTimeout(i,1):l())};i()}else l()}function Nl(n,e,t){Xu().then(()=>{if(!n.loaded())return;n.getSource(e)===t&&n.removeSource(e)})}function st(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("geojson")),o=W(e,"generateId",3,!1),a=W(e,"promoteId",3,void 0),s=W(e,"filter",3,void 0),l=W(e,"lineMetrics",3,void 0),i=W(e,"cluster",3,void 0),v=W(e,"maxzoom",3,void 0),f=W(e,"attribution",3,void 0),b=W(e,"buffer",3,void 0),m=W(e,"tolerance",3,void 0);const C=u(Ur),B=u(()=>r(C).map),T=u(()=>r(C).loaded),{source:$}=gl();let P=Ae(void 0),y=Ae(!0);Qe(()=>{r(B)&&r(T)&&$.value!==t()&&($.value=t(),Rl(r(B),$.value,na({type:"geojson",data:e.data,filter:s(),lineMetrics:l(),generateId:o(),promoteId:a(),cluster:!!i(),clusterMinPoints:i()?.minPoints,clusterMaxZoom:i()?.maxZoom,clusterRadius:i()?.radius,clusterProperties:i()?.properties,maxzoom:v(),attribution:f(),buffer:b(),tolerance:m()}),N=>r(B)&&N===$.value,()=>{$.value&&(Y(P,r(B).getSource($.value),!0),Y(y,!0))}),r(P))}),Qe(()=>{r(P)&&(r(y)?Y(y,!1):r(P).setData(e.data))}),Qe(()=>{r(B).on("style.load",()=>{Y(P,r(B).getSource(t()),!0)})}),Qe(()=>{r(P)?.setClusterOptions(na({cluster:!!i(),clusterMaxZoom:i()?.maxZoom,clusterRadius:i()?.radius}))}),cr(()=>{$.value&&r(P)&&r(B)&&(Nl(r(B),$.value,r(P)),$.value=void 0,Y(P,void 0))});var w=$e(),O=Z(w);{var D=N=>{var j=$e(),z=Z(j);Xa(z,()=>$.value,d=>{var g=$e(),p=Z(g);It(p,()=>e.children??Pe),_(d,g)}),_(N,j)};ve(O,N=>{$.value&&N(D)})}_(n,w),Ne()}function Xc(n,e){Re(e,!0);const t=u(Ur),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"positionOptions",3,void 0),i=W(e,"fitBoundsOptions",3,void 0),v=W(e,"trackUserLocation",3,!1),f=W(e,"showAccuracyCircle",3,!0),b=W(e,"showUserLocation",3,!0),m=W(e,"control",15);Qe(()=>{r(o)&&!m()&&(m(new Er.GeolocateControl({positionOptions:l(),fitBoundsOptions:i(),trackUserLocation:v(),showAccuracyCircle:f(),showUserLocation:b()})),r(o).addControl(m(),s()))}),cr(()=>{r(a)&&m()&&r(o).removeControl(m())}),Ne()}function Yc(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("heatmap")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),f=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"hoverCursor",3,void 0),C=W(e,"manageHoverState",3,!1),B=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),$=W(e,"interactive",3,!0),P=W(e,"onclick",3,void 0),y=W(e,"ondblclick",3,void 0),w=W(e,"oncontextmenu",3,void 0),O=W(e,"onmouseenter",3,void 0),D=W(e,"onmousemove",3,void 0),N=W(e,"onmouseleave",3,void 0);da(n,{get id(){return t()},type:"heatmap",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return v()},get minzoom(){return f()},get maxzoom(){return b()},get hoverCursor(){return m()},get manageHoverState(){return C()},get eventsIfTopMost(){return T()},get interactive(){return $()},get onclick(){return P()},get ondblclick(){return y()},get oncontextmenu(){return w()},get onmouseenter(){return O()},get onmousemove(){return D()},get onmouseleave(){return N()},get hovered(){return B()},set hovered(j){B(j)},children:(j,z)=>{var d=$e(),g=Z(d);It(g,()=>e.children??Pe),_(j,d)},$$slots:{default:!0}}),Ne()}function ed(n,e){Re(e,!0);let t=W(e,"sourceLayer",3,void 0),o=new Set;const a=u(Ur),s=u(()=>r(a).map),l=fl();Qe(()=>{if(e.data&&r(s)&&l?.value){let i=new Set;for(const v of e.data){const f=v[e.idCol];if(!f)continue;o.delete(f),i.add(f);const b={id:f,source:l.value,sourceLayer:t()},m=r(s).getFeatureState(b);let C=!1;for(const B of Object.keys(v))if(m[B]!==v[B]){C=!0;break}C&&r(s).setFeatureState(b,v)}for(const v of o){const f={id:v,source:l.value,sourceLayer:t()},b=r(s).getFeatureState(f);for(const m of Object.keys(b))r(s).removeFeatureState(f,m)}o=i}}),Ne()}function gt(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("line")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),f=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"hoverCursor",3,void 0),C=W(e,"manageHoverState",3,!1),B=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),$=W(e,"interactive",3,!0),P=W(e,"children",3,void 0),y=W(e,"onclick",3,void 0),w=W(e,"ondblclick",3,void 0),O=W(e,"oncontextmenu",3,void 0),D=W(e,"onmouseenter",3,void 0),N=W(e,"onmousemove",3,void 0),j=W(e,"onmouseleave",3,void 0);da(n,{get id(){return t()},type:"line",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return v()},get minzoom(){return f()},get maxzoom(){return b()},get hoverCursor(){return m()},get manageHoverState(){return C()},get eventsIfTopMost(){return T()},get interactive(){return $()},get onclick(){return y()},get ondblclick(){return w()},get oncontextmenu(){return O()},get onmouseenter(){return D()},get onmousemove(){return N()},get onmouseleave(){return j()},get hovered(){return B()},set hovered(z){B(z)},children:(z,d)=>{var g=$e(),p=Z(g);It(p,()=>P()??Pe),_(z,g)},$$slots:{default:!0}}),Ne()}function fa(n,e){Re(e,!0);let t=W(e,"layer",3,void 0),o=Yu(e,["$$slots","$$events","$$legacy","layer"]);const a=u(Ur),s=u(()=>r(a).map);function l(b){return o["on"+b]}function i(b){l(b.type)?.(b)}const v=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],f=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend","pitch","rotate","wheel","data","styledata","idle"];Qe(()=>{if(r(s))if(t())for(const b of v)l(b)&&r(s).on(b,t(),i);else for(const b of f)l(b)&&r(s).on(b,i)}),cr(()=>{if(r(s))if(t())for(const b of v)l(b)&&r(s).off(b,t(),i);else for(const b of f)l(b)&&r(s).off(b,i)}),Ne()}function td(n){let e=n.getCenter(),t=Math.round(n.getZoom()*100)/100,o=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,o),s=Math.round(e.lat*a)/a,l=Math.round(e.lng*a)/a,i=`${t}/${s}/${l}`,v=n.getBearing(),f=n.getPitch();return(v||f)&&(i+=`/${Math.round(v*10)/10}`),f&&(i+=`/${Math.round(f)}`),`#${i}`}function rd(n){const e=n.replace("#","").split("/").map(parseFloat);return e.some(isNaN)?[]:e}var ko=Xi;function Xi(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?bs(n,e):{}.toString.call(n)=="[object Set]"?bs(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?od(n,e):nd(n,e)}function nd(n,e){return n.toString()===e.toString()}function bs(n,e){var t=n.length;if(t!=e.length)return!1;for(var o=0;o<t;o++)if(!Xi(n[o],e[o]))return!1;return!0}function od(n,e){var t=Object.keys(n),o=t.length;if(o!=Object.keys(e).length)return!1;for(var a=0;a<o;a++){var s=t[a];if(!(e.hasOwnProperty(s)&&Xi(n[s],e[s])))return!1}return!0}function Bl(n,e){Re(e,!0);const t=u(Ur),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"showCompass",3,!0),i=W(e,"showZoom",3,!0),v=W(e,"visualizePitch",3,!1),f=Ae(void 0);Qe(()=>{r(o)&&!r(f)&&(Y(f,new Er.NavigationControl({showCompass:l(),showZoom:i(),visualizePitch:v()}),!0),r(o).addControl(r(f),s()))}),cr(()=>{r(a)&&r(f)&&r(o).removeControl(r(f))}),Ne()}function Fl(n,e){Re(e,!0);const t=u(Ur),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"bottom-left"),l=W(e,"maxWidth",3,void 0),i=W(e,"unit",3,"metric"),v=Ae(void 0);Qe(()=>{r(o)&&!r(v)&&(Y(v,new Er.ScaleControl({maxWidth:l(),unit:i()}),!0),r(o).addControl(r(v),s()))}),cr(()=>{r(a)&&r(v)&&r(o).removeControl(r(v))}),Ne()}var ad=M("<!> <!> <!> <!>",1),id=M("<!> <!>",1),sd=M('<div data-testid="map-container"><!></div>');function ld(n,e){Re(e,!0);let t=W(e,"map",15,void 0),o=W(e,"mapContainer",15,void 0),a=W(e,"class",3,void 0),s=W(e,"diffStyleUpdates",3,!1),l=W(e,"center",15,void 0),i=W(e,"zoom",15,void 0),v=W(e,"pitch",15,0),f=W(e,"bearing",15,0),b=W(e,"bearingSnap",3,7),m=W(e,"bounds",15,void 0),C=W(e,"fitBoundsOptions",19,()=>({})),B=W(e,"hash",3,!1),T=W(e,"projection",3,void 0),$=W(e,"updateHash",3,oe=>{window.history.replaceState(window.history.state,"",oe)}),P=W(e,"loaded",15,!1),y=W(e,"minZoom",3,0),w=W(e,"maxZoom",3,22),O=W(e,"minPitch",3,0),D=W(e,"maxPitch",3,60),N=W(e,"renderWorldCopies",3,void 0),j=W(e,"dragPan",3,void 0),z=W(e,"dragRotate",3,void 0),d=W(e,"pitchWithRotate",3,void 0),g=W(e,"antialias",3,void 0),p=W(e,"zoomOnDoubleClick",3,!0),k=W(e,"locale",3,void 0),x=W(e,"interactive",3,!0),A=W(e,"attributionControl",3,void 0),F=W(e,"cooperativeGestures",3,!1),S=W(e,"preserveDrawingBuffer",3,!1),I=W(e,"maxBounds",3,void 0),E=W(e,"images",19,()=>[]),L=W(e,"standardControls",3,!1),R=W(e,"filterLayers",3,void 0),G=W(e,"transformRequest",3,void 0),J=u(()=>typeof L()=="boolean"?void 0:L());const H=ec();tc(new oc(void 0));let X=Ae(bt(new Set));async function le(oe,ye=!1){if(t()&&!(!t()?.loaded()&&!ye))if("url"in oe){r(X).add(oe.id);try{let he=await t().loadImage(oe.url);t().addImage(oe.id,he.data,oe.options),H.loadedImages.add(oe.id)}catch(he){e.onerror?e.onerror({error:he}):console.error(he)}finally{r(X).delete(oe.id)}}else t().addImage(oe.id,oe.data,oe.options),H.loadedImages.add(oe.id)}Qe(()=>{if(P()&&t()?.loaded())for(let oe of E())!H.loadedImages.has(oe.id)&&!r(X).has(oe.id)&&!t().hasImage(oe.id)&&le(oe)});let q=u(()=>E().every(oe=>H.loadedImages.has(oe.id))),ee=Ae(void 0),ue=Ae(void 0),K=Ae(void 0),V=Ae(void 0);function te(oe){e.onerror?e.onerror(oe):oe.error.name!=="AbortError"&&console.error(oe.error)}function re(oe){return ne(),t(H.map=new Er.Map(na({container:oe,style:e.style,locale:k(),center:l(),zoom:i(),pitch:v(),bearing:f(),bearingSnap:b(),minZoom:y(),maxZoom:w(),minPitch:O(),maxPitch:D(),renderWorldCopies:N(),dragPan:j(),dragRotate:z(),pitchWithRotate:d(),antialias:g(),interactive:x(),preserveDrawingBuffer:S(),maxBounds:I(),bounds:m(),attributionControl:A(),transformRequest:G(),cooperativeGestures:F()}))),t().on("load",ye=>{ye.target.getContainer().setAttribute("data-testid","map"),ye.target.getCanvas().setAttribute("data-testid","map-canvas"),e.onload&&e.onload(t()),H.loaded=!0,P(!0)}),t().on("error",te),e.onmovestart&&t().on("movestart",e.onmovestart),t().on("moveend",ye=>{if(l(ye.target.getCenter()),i(ye.target.getZoom()),v(ye.target.getPitch()),f(ye.target.getBearing()),m(ac(ye.target.getBounds(),m())),e.onmoveend?.(ye),B()){let he=new URL(window.location.href.replace(/(#.+)?$/,td(ye.target)));$()(he)}}),e.onclick&&t().on("click",e.onclick),e.ondblclick&&t().on("dblclick",e.ondblclick),e.oncontextmenu&&t().on("contextmenu",e.oncontextmenu),e.onmousemove&&t().on("mousemove",e.onmousemove),e.onzoomstart&&t().on("zoomstart",e.onzoomstart),e.onzoom&&t().on("zoom",e.onzoom),e.onzoomend&&t().on("zoomend",e.onzoomend),e.onpitch&&t().on("pitch",e.onpitch),e.onrotate&&t().on("rotate",e.onrotate),e.onwheel&&t().on("wheel",e.onwheel),e.ondata&&t().on("data",e.ondata),e.onidle&&t().on("idle",e.onidle),t().on("style.load",ye=>{if(t()){T()&&t().setProjection(T()),H.loaded=!0,P(!0);const he=t().getStyle();if(Y(ee,he.layers.map(xe=>xe.id),!0),Y(ue,Object.keys(he.sources),!0),r(V))for(const[xe,Se]of Object.entries(r(V)))t().addSource(xe,Se);if(r(K))for(const xe of r(K))t().addLayer(xe);for(const xe of E())le(xe,!0);e.onstyleload?.(ye)}}),t().on("styledata",ye=>{if(t()&&R()){const he=t().getStyle().layers;if(he)for(let xe of he)R()(xe)||t().setLayoutProperty(xe.id,"visibility","none")}e.onstyledata?.(ye)}),{destroy(){P(!1),H.loaded=!1,t()?.remove()}}}let ie=Ae(bt(e.style));Qe(()=>{if(t()&&!ko(e.style,r(ie))){const oe=t().getStyle();if(r(ee)&&Y(K,oe.layers.filter(ye=>!r(ee).includes(ye.id)),!0),r(ue)){const ye=Object.keys(oe.sources).filter(he=>!r(ue).includes(he));Y(V,{},!0);for(const he of ye)r(V)[he]=oe.sources[he]}Y(ie,e.style,!0),t().setStyle(e.style,{diff:s()}),H.loadedImages.clear(),Y(X,new Set,!0)}}),Qe(()=>{if(t()){let oe={};l()!=null&&!ko(l(),t().getCenter())&&(oe.center=l()),i()!=null&&!ko(i(),t().getZoom())&&(oe.zoom=i()),f()!=null&&!ko(f(),t().getBearing())&&(oe.bearing=f()),v()!=null&&!ko(v(),t().getPitch())&&(oe.pitch=v()),Object.keys(oe).length&&t().easeTo(oe)}}),Qe(()=>{T()&&P()&&t()?.setProjection(T())}),Qe(()=>{if(m()){const{equal:oe,bounds:ye}=rc(m(),t()?.getBounds());oe||t()?.fitBounds(ye,C())}}),Qe(()=>{p()?t()?.doubleClickZoom.enable():t()?.doubleClickZoom.disable()});function ne(){if(B()){let oe=rd(window.location.hash);oe.length>=3&&(i(oe[0]),l([oe[2],oe[1]])),oe.length==5&&(f(oe[3]),v(oe[4]))}}var ae=sd();Vn("hashchange",ua,ne);let _e;var se=c(ae);{var fe=oe=>{var ye=id(),he=Z(ye);{var xe=De=>{var ke=ad(),Ee=Z(ke);Bl(Ee,{get position(){return r(J)}});var pe=h(Ee,2);{let me=u(()=>({...C(),maxZoom:12}));Xc(pe,{get position(){return r(J)},get fitBoundsOptions(){return r(me)}})}var Ie=h(pe,2);Kc(Ie,{get position(){return r(J)}});var Te=h(Ie,2);Fl(Te,{get position(){return r(J)}}),_(De,ke)};ve(he,De=>{L()&&De(xe)})}var Se=h(he,2);It(Se,()=>e.children??Pe,()=>({map:t(),loaded:P(),loadedImages:H.loadedImages,allImagesLoaded:r(q)})),_(oe,ye)};ve(se,oe=>{t()&&oe(fe)})}rn(ae,oe=>o(oe),()=>o()),nc(ae,oe=>re?.(oe)),Q(oe=>_e=Et(ae,1,vl(a()),"svelte-xbukvd",_e,oe),[()=>({"expand-map":!a()})]),_(n,ae),Ne()}var ud=M('<div class="sv-popup"><!></div>');function Bt(n,e){Re(e,!0);let t=W(e,"closeButton",3,void 0),o=W(e,"closeOnClickOutside",3,!0),a=W(e,"closeOnClickInside",3,!1),s=W(e,"closeOnMove",3,!1),l=W(e,"openOn",3,"click"),i=W(e,"openIfTopMost",3,!0),v=W(e,"focusAfterOpen",3,!0),f=W(e,"anchor",3,void 0),b=W(e,"offset",3,void 0),m=W(e,"popupClass",3,void 0),C=W(e,"maxWidth",3,void 0),B=W(e,"lngLat",15,void 0),T=W(e,"html",3,void 0),$=W(e,"open",15,!1),P=W(e,"onopen",3,void 0),y=W(e,"onclose",3,void 0),w=W(e,"onhover",3,void 0),O=ic();const D=u(Ur),N=u(()=>r(D).map),j=u(()=>r(D).eventTopMost),z=u(()=>r(D).markerClickManager),d=u(()=>r(D).loaded),g=sc(),p=lc(),k=uc(),x=["click","dblclick","contextmenu"];let A=Ae(void 0),F=Ae(!1),S=Ae(void 0);function I(){if(!r(A))return;let se=r(A).getElement();!se||se===r(S)||(Y(S,se,!0),l()==="hover"&&(r(S).style.pointerEvents="none"),r(S).addEventListener("mouseenter",()=>{Y(F,!0)},{passive:!0}),r(S).addEventListener("mouseleave",()=>{Y(F,!1)},{passive:!0}),r(S).addEventListener("click",()=>{a()&&$(!1)},{passive:!0}))}nn(()=>{if(r(N))return r(N).on("click",K),r(N).on("contextmenu",K),r(z).add(V),typeof k?.value=="string"&&(r(N).on("click",k.value,H),r(N).on("dblclick",k.value,H),r(N).on("contextmenu",k.value,H),r(N).on("mousemove",k.value,ue),r(N).on("mouseleave",k.value,ee),r(N).on("touchstart",k.value,le),r(N).on("touchend",k.value,q)),()=>{r(d)&&(r(A)?.remove(),r(N).off("click",K),r(N).off("contextmenu",K),r(z).remove(V),k?.value instanceof Er.Marker?k.value.getPopup()===r(A)&&k.value.setPopup(void 0):typeof k?.value=="string"&&(r(N).off("click",k.value,H),r(N).off("dblclick",k.value,H),r(N).off("contextmenu",k.value,H),r(N).off("mousemove",k.value,ue),r(N).off("mouseleave",k.value,ee),r(N).off("touchstart",k.value,le),r(N).off("touchend",k.value,q)))}});function E(){if(e.canOpen&&!e.canOpen(r(R))){$(!1);return}$(!0)}function L(se){return i()?!("marker"in se)&&!cc(se)&&r(j)(se)!==g?.value:!1}let R=Ae(void 0),G=Ae("normal");function J(se){"layerType"in se&&se.layerType==="deckgl"?(B(se.coordinate),Y(R,se.object?[se.object]:void 0,!0)):(B(se.lngLat),Y(R,se.features??[],!0))}function H(se){se.type!==l()||L(se)||(J(se),setTimeout(E))}let X;function le(se){X=se.point}function q(se){if(!X||l()!=="hover")return;let fe=X.dist(se.point);X=void 0,fe<3&&(B(se.lngLat),Y(R,se.features??[],!0),r(A)?.isOpen()?Y(G,"justOpened"):(Y(G,"opening"),E()))}function ee(se){l()!=="hover"||X||r(G)!=="normal"||($(!1),Y(R,void 0))}function ue(se){if(!(l()!=="hover"||X||r(G)!=="normal")){if(L(se)){$(!1),Y(R,void 0);return}Y(R,se.features??[],!0),B(se.lngLat),E()}}function K(se){if(r(G)==="justOpened"){Y(G,"normal");return}if(!o())return;let fe=[r(S),k?.value instanceof Er.Marker?k.value?.getElement():void 0];$()&&r(A)?.isOpen()&&!fe.some(oe=>oe?.contains(se.originalEvent.target))&&(se.type==="contextmenu"&&l()==="contextmenu"||se.type!=="contextmenu")&&$(!1)}function V(se){o()&&$()&&r(A)?.isOpen()&&se.marker!==k?.value&&$(!1)}cr(()=>{r(d)&&r(A)?.isOpen()&&r(A).remove()});let te=Ae(void 0),re=u(()=>t()??(!o()&&!a()));Qe(()=>{if(!r(A)){let se=m()?`${m()} sv-maplibregl-popup`:"sv-maplibregl-popup";Y(A,new Er.Popup({closeButton:r(re),closeOnClick:!1,closeOnMove:s(),focusAfterOpen:v(),maxWidth:C(),className:se,anchor:f(),offset:b()}),!0),Y(S,r(A).getElement(),!0),r(A).on("open",()=>{E(),$()&&(I(),P()?.(r(A)))}),r(A).on("close",()=>{$(!1),y()?.(r(A))}),w()&&r(A).on("hover",()=>{w()?.(r(A))})}}),Qe(()=>{r(A)&&k?.value instanceof Er.Marker&&(l()==="click"?k.value.setPopup(r(A)):k.value.getPopup()===r(A)&&k.value.setPopup(void 0))}),Qe(()=>{x.includes(l())&&p.value?.type===l()&&(H(p.value),p.value=void 0)});let ie=u(()=>l()==="hover"&&(p.value?.type==="mousemove"||p.value?.type==="mouseenter"));Qe(()=>{l()==="hover"&&p&&(r(ie)&&p.value&&J(p.value),r(ie)||r(F)?E():$(!1))}),Qe(()=>{r(te)?r(A)?.setDOMContent(r(te)):T()&&r(A)?.setHTML(T())}),Qe(()=>{let se=B()??O?.value??void 0;se&&r(A)?.setLngLat(se)}),Qe(()=>{if(r(N)&&r(A)){let se=r(A).isOpen();$()&&!se?(r(A).addTo(r(N)),r(G)==="opening"&&Y(G,"justOpened")):!$()&&se&&r(A).remove()}});var ne=$e(),ae=Z(ne);{var _e=se=>{var fe=ud(),oe=c(fe);{var ye=he=>{var xe=$e(),Se=Z(xe);It(Se,()=>e.children??Pe,()=>({features:r(R),data:r(R)?.[0]??void 0,map:r(N),close:()=>$(!1),isOpen:$()})),_(he,xe)};ve(oe,he=>{(r(R)?.length||k?.value instanceof Er.Marker||!k&&$())&&he(ye)})}rn(fe,he=>Y(te,he),()=>r(te)),_(se,fe)};ve(ae,se=>{e.children&&se(_e)})}_(n,ne),Ne()}function fo(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("symbol")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"paint",3,void 0),v=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),b=W(e,"applyToClusters",3,void 0),m=W(e,"minzoom",3,void 0),C=W(e,"maxzoom",3,void 0),B=W(e,"hoverCursor",3,void 0),T=W(e,"manageHoverState",3,!1),$=W(e,"hovered",15),P=W(e,"eventsIfTopMost",3,!1),y=W(e,"interactive",3,!0),w=W(e,"children",3,void 0),O=W(e,"onclick",3,void 0),D=W(e,"ondblclick",3,void 0),N=W(e,"oncontextmenu",3,void 0),j=W(e,"onmouseenter",3,void 0),z=W(e,"onmousemove",3,void 0),d=W(e,"onmouseleave",3,void 0);da(n,{get id(){return t()},type:"symbol",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return i()},get layout(){return v()},get filter(){return f()},get applyToClusters(){return b()},get minzoom(){return m()},get maxzoom(){return C()},get hoverCursor(){return B()},get manageHoverState(){return T()},get eventsIfTopMost(){return P()},get interactive(){return y()},get onclick(){return O()},get ondblclick(){return D()},get oncontextmenu(){return N()},get onmouseenter(){return j()},get onmousemove(){return z()},get onmouseleave(){return d()},get hovered(){return $()},set hovered(g){$(g)},children:(g,p)=>{var k=$e(),x=Z(k);It(x,()=>w()??Pe),_(g,k)},$$slots:{default:!0}}),Ne()}function va(n,e){Re(e,!0);let t=W(e,"id",19,()=>Pn("vector")),o=W(e,"url",3,void 0),a=W(e,"tiles",3,void 0),s=W(e,"promoteId",3,void 0),l=W(e,"bounds",3,void 0),i=W(e,"scheme",3,void 0),v=W(e,"attribution",3,void 0),f=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"volatile",3,void 0);if(o()&&o().includes("pmtiles://")&&!Object.hasOwn(Er.config.REGISTERED_PROTOCOLS,"pmtiles")){let D=new dc;Er.addProtocol("pmtiles",D.tile)}const C=u(Ur),B=u(()=>r(C).map),T=u(()=>r(C).loaded),{source:$}=gl();let P=Ae(void 0);Qe(()=>{r(B)&&r(T)&&$.value!==t()&&($.value=t(),Rl(r(B),$.value,na({type:"vector",url:o(),tiles:a(),promoteId:s(),bounds:l(),scheme:i(),attribution:v(),minzoom:f(),maxzoom:b(),volatile:m()}),D=>r(B)&&D===$.value,()=>{$.value&&Y(P,r(B).getSource($.value),!0)}))}),Qe(()=>{r(B).on("style.load",()=>{Y(P,r(B).getSource(t()),!0)})}),cr(()=>{$.value&&r(B)&&(Nl(r(B),$.value,r(P)),$.value=void 0,Y(P,void 0))});var y=$e(),w=Z(y);{var O=D=>{var N=$e(),j=Z(N);Xa(j,()=>$.value,z=>{var d=$e(),g=Z(d);It(g,()=>e.children??Pe),_(z,d)}),_(D,N)};ve(w,D=>{$.value&&D(O)})}_(n,y),Ne()}var cd=M('<div class="form-check"><label class="form-check-label"><input class="form-check-input" type="checkbox"/> <!></label></div>');function dd(n,e){Re(e,!0);let t=W(e,"checked",15);var o=cd(),a=c(o),s=c(a),l=h(s,2);It(l,()=>e.children??Pe),kn(s,t),_(n,o),Ne()}var fd=M("<tr><td> </td><td> </td></tr>"),vd=M('<table class="svelte-7qv069"><tbody></tbody></table>');function to(n,e){var t=vd(),o=c(t);qt(o,21,()=>Object.entries(e.properties),Jt,(a,s)=>{var l=u(()=>Dr(r(s),2));let i=()=>r(l)[0],v=()=>r(l)[1];var f=fd(),b=c(f),m=c(b),C=h(b),B=c(C);Q(()=>{U(m,i()),U(B,v())}),_(a,f)}),_(n,t)}var gd=M('<div style="display: flex; align-items: center; gap: 6px;"><span></span> </div>'),_d=M("<div></div>");function Yi(n,e){let t=W(e,"swatchClass",3,"rectangle"),o=W(e,"itemsPerRow",3,2),a=u(()=>`${100/o()}%`);var s=_d();qt(s,21,()=>Object.entries(e.labelColors),Jt,(l,i)=>{var v=u(()=>Dr(r(i),2));let f=()=>r(v)[0],b=()=>r(v)[1];var m=gd(),C=c(m);let B;var T=h(C);Q($=>{Et(C,1,`color-swatch ${t()??""}`,"svelte-kgsne0"),B=dr(C,"",B,$),U(T,` ${f()??""}`)},[()=>({background:b()})]),_(l,m)}),Q(()=>dr(s,`display: grid; grid-template-columns: repeat(auto-fill, calc(${r(a)??""} - 10px)); gap: 10px;`)),_(n,s)}var pd=M('<span class="bucket svelte-1twtizg">&nbsp;</span>'),hd=M('<span class="svelte-1twtizg"> </span>'),md=M('<div><div class="colors svelte-1twtizg"></div> <div class="labels svelte-1twtizg"></div></div>');function br(n,e){Re(e,!0);let t=W(e,"decimalPlaces",3,0),o=W(e,"fullWidthBucketLegend",3,!1);function a(f,b){return("limits"in f?f.limits:f.buckets).map(C=>typeof C=="number"?b>0?C.toFixed(b):C.toLocaleString():C)}var s=md();let l;var i=c(s);qt(i,21,()=>e.colorScale,Jt,(f,b)=>{var m=pd();Q(()=>dr(m,`background: ${r(b)??""};`)),_(f,m)});var v=h(i,2);qt(v,21,()=>a(e.labels,t()),Jt,(f,b)=>{var m=hd(),C=c(m);Q(()=>U(C,r(b))),_(f,m)}),Q(f=>l=Et(s,1,"svelte-1twtizg",null,l,f),[()=>({"full-width-bucket-legend":o(),bucketed:e.labels.hasOwnProperty("buckets"),limits:e.labels.hasOwnProperty("limits")})]),_(n,s),Ne()}let je;const Ol=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Ol.decode();let Mo=null;function Uo(){return(Mo===null||Mo.byteLength===0)&&(Mo=new Uint8Array(je.memory.buffer)),Mo}function zr(n,e){return n=n>>>0,Ol.decode(Uo().subarray(n,n+e))}const dn=new Array(128).fill(void 0);dn.push(void 0,null,!0,!1);let Go=dn.length;function Vt(n){Go===dn.length&&dn.push(dn.length+1);const e=Go;return Go=dn[e],dn[e]=n,e}function ot(n){return dn[n]}function bd(n){n<132||(dn[n]=Go,Go=n)}function no(n){const e=ot(n);return bd(n),e}function si(n){return n==null}let Po=null;function yd(){return(Po===null||Po.byteLength===0)&&(Po=new Float64Array(je.memory.buffer)),Po}let To=null;function ft(){return(To===null||To.byteLength===0)&&(To=new Int32Array(je.memory.buffer)),To}let Sn=0;const Ca=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Ad=typeof Ca.encodeInto=="function"?function(n,e){return Ca.encodeInto(n,e)}:function(n,e){const t=Ca.encode(n);return e.set(t),{read:n.length,written:t.length}};function ya(n,e,t){if(t===void 0){const i=Ca.encode(n),v=e(i.length,1)>>>0;return Uo().subarray(v,v+i.length).set(i),Sn=i.length,v}let o=n.length,a=e(o,1)>>>0;const s=Uo();let l=0;for(;l<o;l++){const i=n.charCodeAt(l);if(i>127)break;s[a+l]=i}if(l!==o){l!==0&&(n=n.slice(l)),a=t(a,o,o=l+n.length*3,1)>>>0;const i=Uo().subarray(a+l,a+o),v=Ad(n,i);l+=v.written}return Sn=l,a}function Mi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const a=n.description;return a==null?"Symbol":`Symbol(${a})`}if(e=="function"){const a=n.name;return typeof a=="string"&&a.length>0?`Function(${a})`:"Function"}if(Array.isArray(n)){const a=n.length;let s="[";a>0&&(s+=Mi(n[0]));for(let l=1;l<a;l++)s+=", "+Mi(n[l]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let o;if(t.length>1)o=t[1];else return toString.call(n);if(o=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:o}function wd(n,e){const t=e(n.length*1,1)>>>0;return Uo().set(n,t/1),Sn=n.length,t}function li(n,e){try{return n.apply(this,e)}catch(t){je.__wbindgen_exn_store(Vt(t))}}class Oa{static __wrap(e){e=e>>>0;const t=Object.create(Oa.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();je.__wbg_jsroutesnapper_free(e)}constructor(e){try{const s=je.__wbindgen_add_to_stack_pointer(-16),l=wd(e,je.__wbindgen_malloc),i=Sn;je.jsroutesnapper_new(s,l,i);var t=ft()[s/4+0],o=ft()[s/4+1],a=ft()[s/4+2];if(a)throw no(o);return Oa.__wrap(t)}finally{je.__wbindgen_add_to_stack_pointer(16)}}setRouteConfig(e){je.jsroutesnapper_setRouteConfig(this.__wbg_ptr,Vt(e))}setAreaMode(){je.jsroutesnapper_setAreaMode(this.__wbg_ptr)}getConfig(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_getConfig(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}toFinalFeature(){try{const o=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_toFinalFeature(o,this.__wbg_ptr);var e=ft()[o/4+0],t=ft()[o/4+1];let a;return e!==0&&(a=zr(e,t).slice(),je.__wbindgen_free(e,t*1)),a}finally{je.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_renderGeojson(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}toggleSnapMode(){je.jsroutesnapper_toggleSnapMode(this.__wbg_ptr)}onMouseMove(e,t,o){return je.jsroutesnapper_onMouseMove(this.__wbg_ptr,e,t,o)!==0}onClick(){je.jsroutesnapper_onClick(this.__wbg_ptr)}onDragStart(){return je.jsroutesnapper_onDragStart(this.__wbg_ptr)!==0}onMouseUp(){return je.jsroutesnapper_onMouseUp(this.__wbg_ptr)!==0}clearState(){je.jsroutesnapper_clearState(this.__wbg_ptr)}editExisting(e){try{const a=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_editExisting(a,this.__wbg_ptr,Vt(e));var t=ft()[a/4+0],o=ft()[a/4+1];if(o)throw no(t)}finally{je.__wbindgen_add_to_stack_pointer(16)}}debugRenderGraph(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_debugRenderGraph(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}debugSnappableNodes(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_debugSnappableNodes(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}routeNameForWaypoints(e){let t,o;try{const b=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_routeNameForWaypoints(b,this.__wbg_ptr,Vt(e));var a=ft()[b/4+0],s=ft()[b/4+1],l=ft()[b/4+2],i=ft()[b/4+3],v=a,f=s;if(i)throw v=0,f=0,no(l);return t=v,o=f,zr(v,f)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(t,o,1)}}addSnappedWaypoint(e,t){je.jsroutesnapper_addSnappedWaypoint(this.__wbg_ptr,e,t)}undo(){je.jsroutesnapper_undo(this.__wbg_ptr)}calculateRoute(e){let t,o;try{const b=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_calculateRoute(b,this.__wbg_ptr,Vt(e));var a=ft()[b/4+0],s=ft()[b/4+1],l=ft()[b/4+2],i=ft()[b/4+3],v=a,f=s;if(i)throw v=0,f=0,no(l);return t=v,o=f,zr(v,f)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(t,o,1)}}getExtraNodes(e,t){let o,a;try{const m=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_getExtraNodes(m,this.__wbg_ptr,Vt(e),Vt(t));var s=ft()[m/4+0],l=ft()[m/4+1],i=ft()[m/4+2],v=ft()[m/4+3],f=s,b=l;if(v)throw f=0,b=0,no(i);return o=f,a=b,zr(f,b)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(o,a,1)}}}async function xd(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(o){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function $d(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const o=zr(e,t);return Vt(o)},n.wbg.__wbindgen_object_drop_ref=function(e){no(e)},n.wbg.__wbindgen_error_new=function(e,t){const o=new Error(zr(e,t));return Vt(o)},n.wbg.__wbindgen_number_get=function(e,t){const o=ot(t),a=typeof o=="number"?o:void 0;yd()[e/8+1]=si(a)?0:a,ft()[e/4+0]=!si(a)},n.wbg.__wbindgen_is_object=function(e){const t=ot(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return ot(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return ot(e)in ot(t)},n.wbg.__wbindgen_boolean_get=function(e){const t=ot(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return ot(e)==ot(t)},n.wbg.__wbindgen_string_get=function(e,t){const o=ot(t),a=typeof o=="string"?o:void 0;var s=si(a)?0:ya(a,je.__wbindgen_malloc,je.__wbindgen_realloc),l=Sn;ft()[e/4+1]=l,ft()[e/4+0]=s},n.wbg.__wbg_String_4370c5505c674d30=function(e,t){const o=String(ot(t)),a=ya(o,je.__wbindgen_malloc,je.__wbindgen_realloc),s=Sn;ft()[e/4+1]=s,ft()[e/4+0]=a},n.wbg.__wbindgen_object_clone_ref=function(e){const t=ot(e);return Vt(t)},n.wbg.__wbg_getwithrefkey_d1f0d12f1f1b63ea=function(e,t){const o=ot(e)[ot(t)];return Vt(o)},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return Vt(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const o=ot(t).stack,a=ya(o,je.__wbindgen_malloc,je.__wbindgen_realloc),s=Sn;ft()[e/4+1]=s,ft()[e/4+0]=a},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let o,a;try{o=e,a=t,console.error(zr(e,t))}finally{je.__wbindgen_free(o,a,1)}},n.wbg.__wbg_debug_9a6b3243fbbebb61=function(e){console.debug(ot(e))},n.wbg.__wbg_error_788ae33f81d3b84b=function(e){console.error(ot(e))},n.wbg.__wbg_info_2e30e8204b29d91d=function(e){console.info(ot(e))},n.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(ot(e))},n.wbg.__wbg_warn_d60e832f9882c1b2=function(e){console.warn(ot(e))},n.wbg.__wbg_get_44be0491f933a435=function(e,t){const o=ot(e)[t>>>0];return Vt(o)},n.wbg.__wbg_length_fff51ee6522a1a18=function(e){return ot(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof ot(e)=="function"},n.wbg.__wbg_next_526fc47e980da008=function(e){const t=ot(e).next;return Vt(t)},n.wbg.__wbg_next_ddb3312ca1c4e32a=function(){return li(function(e){const t=ot(e).next();return Vt(t)},arguments)},n.wbg.__wbg_done_5c1f01fb660d73b5=function(e){return ot(e).done},n.wbg.__wbg_value_1695675138684bd5=function(e){const t=ot(e).value;return Vt(t)},n.wbg.__wbg_iterator_97f0c81209c6c35a=function(){return Vt(Symbol.iterator)},n.wbg.__wbg_get_97b561fb56f034b5=function(){return li(function(e,t){const o=Reflect.get(ot(e),ot(t));return Vt(o)},arguments)},n.wbg.__wbg_call_cb65541d95d71282=function(){return li(function(e,t){const o=ot(e).call(ot(t));return Vt(o)},arguments)},n.wbg.__wbg_isArray_4c24b343cb13cfb1=function(e){return Array.isArray(ot(e))},n.wbg.__wbg_instanceof_ArrayBuffer_39ac22089b74fddb=function(e){let t;try{t=ot(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_085ec1f694018c4f=function(e){const t=ot(e).buffer;return Vt(t)},n.wbg.__wbg_new_8125e318e6245eed=function(e){const t=new Uint8Array(ot(e));return Vt(t)},n.wbg.__wbg_set_5cf90238115182c3=function(e,t,o){ot(e).set(ot(t),o>>>0)},n.wbg.__wbg_length_72e2208bbc0efc61=function(e){return ot(e).length},n.wbg.__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4=function(e){let t;try{t=ot(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbindgen_debug_string=function(e,t){const o=Mi(ot(t)),a=ya(o,je.__wbindgen_malloc,je.__wbindgen_realloc),s=Sn;ft()[e/4+1]=s,ft()[e/4+0]=a},n.wbg.__wbindgen_throw=function(e,t){throw new Error(zr(e,t))},n.wbg.__wbindgen_memory=function(){const e=je.memory;return Vt(e)},n}function kd(n,e){return je=n.exports,jl.__wbindgen_wasm_module=e,Po=null,To=null,Mo=null,je}async function jl(n){if(je!==void 0)return je;typeof n>"u"&&(n=new URL("/ltn/assets/route_snapper_bg-CaN5p6v7.wasm",import.meta.url));const e=$d();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:o}=await xd(await n,e);return kd(t,o)}const Sd=30;class Ed{constructor(e,t,o,a,s){this.onMouseMove=l=>{if(!this.active)return;const i=[l.point.x-Sd,l.point.y],v=this.map.unproject(l.point).distanceTo(this.map.unproject(i));this.inner.onMouseMove(l.lngLat.lng,l.lngLat.lat,v)&&(this.redraw(),this.dataUpdated())},this.onClick=()=>{this.active&&(this.inner.onClick(),this.redraw(),this.dataUpdated())},this.onDoubleClick=l=>{this.active&&(l.preventDefault(),this.inner.onClick(),this.finish())},this.onDragStart=()=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()},this.onMouseUp=()=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()},this.onKeyDown=l=>{if(!this.active)return;let i=l.target.tagName;i=="INPUT"||i=="TEXTAREA"||l.key=="Escape"&&(l.stopPropagation(),this.cancel())},this.onKeyPress=l=>{if(!this.active)return;let i=l.target.tagName;i=="INPUT"||i=="TEXTAREA"||(l.key=="Enter"?(l.stopPropagation(),this.finish()):l.key=="s"||l.key=="S"?(l.stopPropagation(),this.inner.toggleSnapMode(),this.redraw()):l.key=="z"&&l.ctrlKey&&this.undo())},this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new Oa(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.routeToolGj=o,this.snapMode=a,this.undoLength=s,this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("dragstart",this.onDragStart),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keypress",this.onKeyPress)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("dragstart",this.onDragStart),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keypress",this.onKeyPress)}startRoute(){this.active||(this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}startArea(){this.active||(this.inner.setAreaMode(),this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}stop(){this.active=!1,this.inner.clearState(),this.redraw(),this.map.boxZoom.enable(),this.map.doubleClickZoom.enable()}editExistingRoute(e){this.active&&window.alert("Bug: editExistingRoute called when tool is already active"),e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.startRoute(),this.inner.editExisting(e.properties.waypoints),this.redraw()}editExistingArea(e){this.active&&window.alert("Bug: editExistingArea called when tool is already active"),e.properties.waypoints||window.alert("Bug: editExistingArea called for a polygon not produced by the route-snapper"),this.startArea(),this.inner.editExisting(e.properties.waypoints),this.redraw()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}isActive(){return this.active}finish(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersSuccess)t(JSON.parse(e));else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){this.inner.clearState(),this.finish()}setRouteConfig(e){this.inner.setRouteConfig(e),this.redraw()}addSnappedWaypoint(e){this.inner.addSnappedWaypoint(e[0],e[1]),this.redraw()}undo(){this.inner.undo(),this.redraw()}toggleSnapMode(){this.inner.toggleSnapMode(),this.redraw()}redraw(){let e=JSON.parse(this.inner.renderGeojson());this.routeToolGj.set(e),this.map.getCanvas().style.cursor=e.cursor,this.snapMode.set(e.snap_mode),this.undoLength.set(e.undo_length)}dataUpdated(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersUpdated)t(JSON.parse(e))}}function Ld(n){const e=()=>we(fc,"$interactiveMapLayersEnabled",t),[t,o]=lt();let a={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]}};st(n,{get data(){return a},children:(s,l)=>{{let i=_l(()=>({visibility:e()?"none":"visible"}));ur(s,{paint:{"fill-color":"black","fill-opacity":0},get layout(){return r(i)}})}},$$slots:{default:!0}}),o()}var Cd=M('<span class="dot svelte-1j0tfn0"><!></span>'),Md=M('<span class="dot svelte-1j0tfn0"><!></span>');function Kn(n,e){Re(e,!0);let t=W(e,"lngLat",15),o=W(e,"draggable",3,!1);var a=$e(),s=Z(a);{var l=v=>{co(v,{draggable:!0,get lngLat(){return t()},set lngLat(f){t(f)},children:(f,b)=>{var m=Cd(),C=c(m);It(C,()=>e.children),_(f,m)},$$slots:{default:!0}})},i=v=>{co(v,{get lngLat(){return t()},children:(f,b)=>{var m=Md(),C=c(m);It(C,()=>e.children),_(f,m)},$$slots:{default:!0}})};ve(s,v=>{o()?v(l):v(i,!1)})}_(n,a),Ne()}var Pd=M("<progress></progress>"),Td=M('<progress max="100"></progress>'),Id=M("<div><!></div>"),Rd=M('<div class="cover svelte-1lcxh3p"><div class="background svelte-1lcxh3p"> <!></div></div>');function vo(n,e){Re(e,!0);let t=W(e,"progress",3,null),o=Ae(void 0),a=Ae(void 0);Qe(()=>{if(e.loading&&!r(o))Y(o,Date.now(),!0),Y(a,e.loading,!0);else if(!e.loading&&r(o)){const v=Date.now()-r(o);console.log(`Loading "${r(a)}" took ${v}ms`),Y(o,void 0)}});var s=$e(),l=Z(s);{var i=v=>{var f=Rd(),b=c(f),m=c(b),C=h(m);{var B=T=>{var $=Id(),P=c($);{var y=O=>{var D=Pd();dr(D,"",{},{width:"100%"}),_(O,D)},w=O=>{var D=Td();dr(D,"",{},{width:"100%"}),Q(()=>vc(D,t())),_(O,D)};ve(P,O=>{t()==100?O(y):O(w,!1)})}_(T,$)};ve(C,T=>{t()!=null&&T(B)})}Q(()=>U(m,`${e.loading??""} `)),_(v,f)};ve(l,v=>{e.loading&&v(i)})}_(n,s),Ne()}function Ar(n){switch(n){case"title":return"Choose project";case"new-project":return"New project";case"pick-neighbourhood":return Hr(pl)?.project_name||"Pick neighbourhood";case"set-boundary":return"Adjust boundary";case"add-neighbourhood":return"Add a neighbourhood";case"neighbourhood":return Hr(io)||"Editing";case"view-shortcuts":return"Shortcuts";case"impact-one-destination":return"Impact on one destination";case"route":return"Route";case"predict-impact":return"Predict impact";case"impact-detail":return"Impact detail";case"debug-intersections":return"Debug intersections";case"debug-neighbourhood":return"Debug neighbourhood";case"debug-demand":return"Explore origin/destination demand data"}}var Nd=M('<span class="page-title svelte-tym4cg"> </span>');function Xe(n,e){Re(e,!0);const[t,o]=lt();let a=W(e,"children",3,void 0);ca(n,{onclick:()=>Ve(wt,e.mode),children:(s,l)=>{var i=$e(),v=Z(i);{var f=m=>{var C=$e(),B=Z(C);It(B,a),_(m,C)},b=m=>{var C=Nd(),B=c(C);Q(T=>U(B,T),[()=>Ar(e.mode.mode)]),_(m,C)};ve(v,m=>{a()?m(f):m(b,!1)})}_(s,i)}}),Ne(),o()}function He(n,e=!0){return{id:n,beforeId:zl(n),eventsIfTopMost:e}}function zl(n){let e=Hr(Zr);if(!e){console.warn(`getBeforeId(${n}) called before map is ready. Z-ordering may be incorrect.`);return}let t,o=!1;for(let a=ja.length-1;a>=0;a--){let s=ja[a];if(s==n){o=!0;break}e.getLayer(s)&&(t=s)}if(!o)throw new Error(`Layer ID ${n} not defined in layerZorder`);return t}let ui=n=>n,ci=n=>n;const ja=[ui(ci("Background")),"neighbourhood-boundaries",ui("Ferry line"),"neighbourhood-boundaries-outline","neighbourhood-boundaries-selected-outline-base","neighbourhood-boundaries-selected-outline","debug-borders","debug-filters","cells","before-edits-cells","interior-roads-outlines","before-edits-interior-roads-outlines","interior-roads","before-edits-interior-roads","main-roads-outlines","before-edits-main-roads-outlines","main-roads","before-edits-main-roads","turn-restriction-targets","debug-intersections","debug-movements-outline","debug-movements-fill","debug-editable-intersections","editable-intersections","intersection-filters","before-edits-intersection-filters","border-entries","before-edits-border-entries","compare-route","shortcuts","shortcuts-focus","predict-impact-outline","predict-impact",ci("Building"),"draw-area-lines","draw-area-area","draw-area-lines-preview","draw-route-lines","draw-route-preview","debug-demand-fill","debug-demand-outline","one-ways","before-edits-one-ways","context-population-car-ownership","context-simd","context-population-density","context-population-outline","context-traffic","context-los","context-existing-infra","context-route-network","context-bus-routes","context-pois","context-railway-stations","context-stats19-heatmap","context-stats19-points",ci("Road labels"),ui("road_label"),"animate-shortcuts","modal-filters","before-edits-modal-filters","turn-restrictions","before-edits-turn-restrictions","turn-restrictions-debug-arrows","before-edits-turn-restrictions-debug-arrows","boundary","neighbourhood-boundary","freehand-line","edit-polygon-fill","edit-polygon-lines","edit-polygon-vertices"];function Bd(){let n=Hr(Zr);if(!n)return;let e=["Background","Ferry line","Building","Road labels","road_label"];for(let t=ja.length-1;t>=0;t--){let o=ja[t];if(e.includes(o)||!n.getLayer(o))continue;let a=zl(o);a&&n.moveLayer(o,a)}}var Fd=M('<a href="https://wiki.openstreetmap.org/wiki/Tag:route%3Dbus" target="_blank"> </a>'),Od=M("<p><!></p>"),jd=M("<!> <!>",1);function zd(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=Ae(!1);var a=jd(),s=Z(a);{const i=f=>{var b=Od();{const C=(B,T=Pe)=>{var $=Fd(),P=c($);Q(y=>U(P,y),[()=>r(t).tx(T())]),_(B,$)};var m=c(b);{let B=u(()=>[C]),T=u(()=>r(t).cx(186));be(m,{get t(){return r(B)},get x(){return r(T)}})}}_(f,b)};let v=u(()=>r(t).t(185));Rr(s,{get label(){return r(v)},get show(){return r(o)},set show(f){Y(o,f,!0)},help:i,$$slots:{help:!0}})}var l=h(s,2);{let i=u(()=>`pmtiles://${qr("cnt/layers/bus_routes.pmtiles")}`);va(l,{get url(){return r(i)},children:(v,f)=>{{let b=u(()=>He("context-bus-routes")),m=u(()=>({"line-color":"blue","line-width":so(0)})),C=u(()=>({visibility:r(o)?"visible":"none"}));gt(v,Ce(()=>r(b),{sourceLayer:"bus_routes",get paint(){return r(m)},get layout(){return r(C)}}))}},$$slots:{default:!0}})}_(n,a),Ne()}var Mr=63710088e-1,Dl={centimeters:Mr*100,centimetres:Mr*100,degrees:360/(2*Math.PI),feet:Mr*3.28084,inches:Mr*39.37,kilometers:Mr/1e3,kilometres:Mr/1e3,meters:Mr,metres:Mr,miles:Mr/1609.344,millimeters:Mr*1e3,millimetres:Mr*1e3,nauticalmiles:Mr/1852,radians:1,yards:Mr*1.0936};function Pi(n,e,t={}){const o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=e||{},o.geometry=n,o}function Qn(n,e,t={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ys(n[0])||!ys(n[1]))throw new Error("coordinates must contain numbers");return Pi({type:"Point",coordinates:n},e,t)}function Dd(n,e="kilometers"){const t=Dl[e];if(!t)throw new Error(e+" units is invalid");return n*t}function Ud(n,e="kilometers"){const t=Dl[e];if(!t)throw new Error(e+" units is invalid");return n/t}function oa(n){return n%(2*Math.PI)*180/Math.PI}function Ir(n){return n%360*Math.PI/180}function ys(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}var Gd=Object.defineProperty,Ul=n=>{throw TypeError(n)},Wd=(n,e,t)=>e in n?Gd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ze=(n,e,t)=>Wd(n,typeof e!="symbol"?e+"":e,t),Gl=(n,e,t)=>e.has(n)||Ul("Cannot "+t),Xt=(n,e,t)=>(Gl(n,e,"read from private field"),e.get(n)),di=(n,e,t)=>e.has(n)?Ul("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Aa=(n,e,t,o)=>(Gl(n,e,"write to private field"),e.set(n,t),t);function zt(){}function Hd(n,e){for(const t in e)n[t]=e[t];return n}function Wl(n){return n()}function As(){return Object.create(null)}function yn(n){n.forEach(Wl)}function Hl(n){return typeof n=="function"}function Tn(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let wa;function fr(n,e){return n===e?!0:(wa||(wa=document.createElement("a")),wa.href=e,n===wa.href)}function qd(n){return Object.keys(n).length===0}function Jd(n,e,t,o){if(n){const a=ql(n,e,t,o);return n[0](a)}}function ql(n,e,t,o){return n[1]&&o?Hd(t.ctx.slice(),n[1](o(e))):t.ctx}function Qd(n,e,t,o){return n[2],e.dirty}function Zd(n,e,t,o,a,s){if(a){const l=ql(e,t,o,s);n.p(l,a)}}function Vd(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let o=0;o<t;o++)e[o]=-1;return e}return-1}function za(n){return n??""}function mt(n,e){n.appendChild(e)}function Ft(n,e,t){n.insertBefore(e,t||null)}function Nt(n){n.parentNode&&n.parentNode.removeChild(n)}function Lt(n){return document.createElement(n)}function Qr(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Cn(n){return document.createTextNode(n)}function Tr(){return Cn(" ")}function Kd(){return Cn("")}function or(n,e,t,o){return n.addEventListener(e,t,o),()=>n.removeEventListener(e,t,o)}function Xd(n){return function(e){return e.preventDefault(),n.call(this,e)}}function de(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Yd(n){return Array.from(n.childNodes)}function aa(n,e){e=""+e,n.data!==e&&(n.data=e)}function ws(n,e){n.value=e??""}function en(n,e,t){n.classList.toggle(e,!!t)}function ef(n,e,{bubbles:t=!1,cancelable:o=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:o})}let ia;function Wo(n){ia=n}function Jl(){if(!ia)throw new Error("Function called outside component initialization");return ia}function tf(n){Jl().$$.on_destroy.push(n)}function Ql(){const n=Jl();return(e,t,{cancelable:o=!1}={})=>{const a=n.$$.callbacks[e];if(a){const s=ef(e,t,{cancelable:o});return a.slice().forEach(l=>{l.call(n,s)}),!s.defaultPrevented}return!0}}function rf(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(o=>o.call(this,e))}const oo=[],Ti=[];let lo=[];const xs=[],nf=Promise.resolve();let Ii=!1;function of(){Ii||(Ii=!0,nf.then(Zl))}function Ri(n){lo.push(n)}const fi=new Set;let ro=0;function Zl(){if(ro!==0)return;const n=ia;do{try{for(;ro<oo.length;){const e=oo[ro];ro++,Wo(e),af(e.$$)}}catch(e){throw oo.length=0,ro=0,e}for(Wo(null),oo.length=0,ro=0;Ti.length;)Ti.pop()();for(let e=0;e<lo.length;e+=1){const t=lo[e];fi.has(t)||(fi.add(t),t())}lo.length=0}while(oo.length);for(;xs.length;)xs.pop()();Ii=!1,fi.clear(),Wo(n)}function af(n){if(n.fragment!==null){n.update(),yn(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ri)}}function sf(n){const e=[],t=[];lo.forEach(o=>n.indexOf(o)===-1?e.push(o):t.push(o)),t.forEach(o=>o()),lo=e}const Ma=new Set;let Zn;function Io(){Zn={r:0,c:[],p:Zn}}function Ro(){Zn.r||yn(Zn.c),Zn=Zn.p}function Ut(n,e){n&&n.i&&(Ma.delete(n),n.i(e))}function rr(n,e,t,o){if(n&&n.o){if(Ma.has(n))return;Ma.add(n),Zn.c.push(()=>{Ma.delete(n),o&&(t&&n.d(1),o())}),n.o(e)}else o&&o()}function $s(n){return n?.length!==void 0?n:Array.from(n)}function lf(n,e){rr(n,1,1,()=>{e.delete(n.key)})}function uf(n,e,t,o,a,s,l,i,v,f,b,m){let C=n.length,B=s.length,T=C;const $={};for(;T--;)$[n[T].key]=T;const P=[],y=new Map,w=new Map,O=[];for(T=B;T--;){const z=m(a,s,T),d=t(z);let g=l.get(d);g?O.push(()=>g.p(z,e)):(g=f(d,z),g.c()),y.set(d,P[T]=g),d in $&&w.set(d,Math.abs(T-$[d]))}const D=new Set,N=new Set;function j(z){Ut(z,1),z.m(i,b),l.set(z.key,z),b=z.first,B--}for(;C&&B;){const z=P[B-1],d=n[C-1],g=z.key,p=d.key;z===d?(b=z.first,C--,B--):y.has(p)?!l.has(g)||D.has(g)?j(z):N.has(p)?C--:w.get(g)>w.get(p)?(N.add(g),j(z)):(D.add(p),C--):(v(d,l),C--)}for(;C--;){const z=n[C];y.has(z.key)||v(z,l)}for(;B;)j(P[B-1]);return yn(O),P}function Mn(n){n&&n.c()}function hn(n,e,t){const{fragment:o,after_update:a}=n.$$;o&&o.m(e,t),Ri(()=>{const s=n.$$.on_mount.map(Wl).filter(Hl);n.$$.on_destroy?n.$$.on_destroy.push(...s):yn(s),n.$$.on_mount=[]}),a.forEach(Ri)}function mn(n,e){const t=n.$$;t.fragment!==null&&(sf(t.after_update),yn(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function cf(n,e){n.$$.dirty[0]===-1&&(oo.push(n),of(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function In(n,e,t,o,a,s,l=null,i=[-1]){const v=ia;Wo(n);const f=n.$$={fragment:null,ctx:[],props:s,update:zt,not_equal:a,bound:As(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(v?v.$$.context:[])),callbacks:As(),dirty:i,skip_bound:!1,root:e.target||v.$$.root};l&&l(f.root);let b=!1;if(f.ctx=t?t(n,e.props||{},(m,C,...B)=>{const T=B.length?B[0]:C;return f.ctx&&a(f.ctx[m],f.ctx[m]=T)&&(!f.skip_bound&&f.bound[m]&&f.bound[m](T),b&&cf(n,m)),C}):[],f.update(),b=!0,yn(f.before_update),f.fragment=o?o(f.ctx):!1,e.target){if(e.hydrate){const m=Yd(e.target);f.fragment&&f.fragment.l(m),m.forEach(Nt)}else f.fragment&&f.fragment.c();e.intro&&Ut(n.$$.fragment),hn(n,e.target,e.anchor),Zl()}Wo(v)}class Rn{constructor(){ze(this,"$$"),ze(this,"$$set")}$destroy(){mn(this,1),this.$destroy=zt}$on(e,t){if(!Hl(t))return zt;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{const a=o.indexOf(t);a!==-1&&o.splice(a,1)}}$set(e){this.$$set&&!qd(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const df="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(df);function ff(n){let e,t;return{c(){e=Qr("svg"),t=Qr("path"),de(t,"d","M13.12.706a.982.982 0 0 0-1.391 0L6.907 5.517 2.087.696a.982.982 0 1 0-1.391 1.39l4.821 4.821L.696 11.73a.982.982 0 1 0 1.39 1.39l4.821-4.821 4.822 4.821a.982.982 0 1 0 1.39-1.39L8.298 6.908l4.821-4.822a.988.988 0 0 0 0-1.38Z"),de(e,"viewBox","0 0 14 14"),de(e,"width","13"),de(e,"height","13"),de(e,"class","svelte-en2qvf")},m(o,a){Ft(o,e,a),mt(e,t)},p:zt,i:zt,o:zt,d(o){o&&Nt(e)}}}class Vl extends Rn{constructor(e){super(),In(this,e,null,ff,Tn,{})}}function vf(n){let e,t;return{c(){e=Qr("svg"),t=Qr("path"),de(t,"d","M15 0C6.705 0 0 6.705 0 15C0 23.295 6.705 30 15 30C23.295 30 30 23.295 30 15C30 6.705 23.295 0 15 0ZM22.5 20.385L20.385 22.5L15 17.115L9.615 22.5L7.5 20.385L12.885 15L7.5 9.615L9.615 7.5L15 12.885L20.385 7.5L22.5 9.615L17.115 15L22.5 20.385Z"),de(e,"viewBox","0 0 30 30"),de(e,"fill","none"),de(e,"xmlns","http://www.w3.org/2000/svg"),de(e,"class","svelte-d2loi5")},m(o,a){Ft(o,e,a),mt(e,t)},p:zt,i:zt,o:zt,d(o){o&&Nt(e)}}}class Kl extends Rn{constructor(e){super(),In(this,e,null,vf,Tn,{})}}function gf(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"area.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"area.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function _f(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"reverse.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"reverse.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function pf(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"poi.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"poi.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function hf(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"postal_code.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"postal_code.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function mf(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"street.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"street.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function bf(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"road.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"road.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function yf(n){let e,t;return{c(){e=Lt("img"),fr(e.src,t=n[3]+"housenumber.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!fr(e.src,t=o[3]+"housenumber.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Af(n){let e,t,o,a;return{c(){e=Lt("img"),fr(e.src,t=n[5])||de(e,"src",t),de(e,"alt",n[4]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(s,l){Ft(s,e,l),o||(a=or(e,"error",n[14]),o=!0)},p(s,l){l&32&&!fr(e.src,t=s[5])&&de(e,"src",t),l&16&&de(e,"alt",s[4]),l&128&&de(e,"title",s[7])},d(s){s&&Nt(e),o=!1,a()}}}function wf(n){let e,t;return{c(){e=Lt("div"),de(e,"class","sprite-icon svelte-w9y5n9"),de(e,"style",t=`
        width: ${n[6].width/Br}px;
        height: ${n[6].height/Br}px;
        background-image: url(${n[3]}sprite${Ni}.png);
        background-position: -${n[6].x/Br}px -${n[6].y/Br}px;
        background-size: ${Yr.width/Br}px ${Yr.height/Br}px;
      `),de(e,"title",n[7])},m(o,a){Ft(o,e,a)},p(o,a){a&72&&t!==(t=`
        width: ${o[6].width/Br}px;
        height: ${o[6].height/Br}px;
        background-image: url(${o[3]}sprite${Ni}.png);
        background-position: -${o[6].x/Br}px -${o[6].y/Br}px;
        background-size: ${Yr.width/Br}px ${Yr.height/Br}px;
      `)&&de(e,"style",t),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function ks(n){let e,t;return{c(){e=Lt("span"),t=Cn(n[7]),de(e,"class","secondary svelte-w9y5n9")},m(o,a){Ft(o,e,a),mt(e,t)},p(o,a){a&128&&aa(t,o[7])},d(o){o&&Nt(e)}}}function xf(n){let e,t,o,a,s,l,i,v,f,b=(n[8]?n[0].place_name:n[0].place_name.replace(/,.*/,""))+"",m,C,B=n[2]==="always"||n[2]!=="never"&&!n[0].address&&!n[0].id.startsWith("road.")&&!n[0].id.startsWith("address.")&&!n[0].id.startsWith("postal_code.")&&(!n[0].id.startsWith("poi.")||!n[5])&&!n[8],T,$,P=(n[8]?"":n[0].place_name.replace(/[^,]*,?\s*/,""))+"",y,w,O,D,N,j;function z(k,x){return x&1&&(t=null),x&1&&(o=null),x&1&&(a=null),x&1&&(s=null),Yr&&k[6]?wf:k[5]?Af:k[0].address?yf:(t==null&&(t=!!k[0].id.startsWith("road.")),t?bf:(o==null&&(o=!!k[0].id.startsWith("address.")),o?mf:(a==null&&(a=!!k[0].id.startsWith("postal_code.")),a?hf:(s==null&&(s=!!k[0].id.startsWith("poi.")),s?pf:k[8]?_f:gf))))}let d=z(n,-1),g=d(n),p=B&&ks(n);return{c(){e=Lt("li"),g.c(),l=Tr(),i=Lt("span"),v=Lt("span"),f=Lt("span"),m=Cn(b),C=Tr(),p&&p.c(),T=Tr(),$=Lt("span"),y=Cn(P),de(f,"class","primary svelte-w9y5n9"),de(v,"class","svelte-w9y5n9"),de($,"class","line2 svelte-w9y5n9"),de(i,"class","texts svelte-w9y5n9"),de(e,"tabindex","-1"),de(e,"role","option"),de(e,"aria-selected",w=n[1]==="selected"),de(e,"aria-checked",O=n[1]==="picked"),de(e,"class",D=za(n[1])+" svelte-w9y5n9")},m(k,x){Ft(k,e,x),g.m(e,null),mt(e,l),mt(e,i),mt(i,v),mt(v,f),mt(f,m),mt(v,C),p&&p.m(v,null),mt(i,T),mt(i,$),mt($,y),N||(j=[or(e,"mouseenter",n[13]),or(e,"focus",n[15]),or(e,"click",n[16])],N=!0)},p(k,[x]){d===(d=z(k,x))&&g?g.p(k,x):(g.d(1),g=d(k),g&&(g.c(),g.m(e,l))),x&257&&b!==(b=(k[8]?k[0].place_name:k[0].place_name.replace(/,.*/,""))+"")&&aa(m,b),x&293&&(B=k[2]==="always"||k[2]!=="never"&&!k[0].address&&!k[0].id.startsWith("road.")&&!k[0].id.startsWith("address.")&&!k[0].id.startsWith("postal_code.")&&(!k[0].id.startsWith("poi.")||!k[5])&&!k[8]),B?p?p.p(k,x):(p=ks(k),p.c(),p.m(v,null)):p&&(p.d(1),p=null),x&257&&P!==(P=(k[8]?"":k[0].place_name.replace(/[^,]*,?\s*/,""))+"")&&aa(y,P),x&2&&w!==(w=k[1]==="selected")&&de(e,"aria-selected",w),x&2&&O!==(O=k[1]==="picked")&&de(e,"aria-checked",O),x&2&&D!==(D=za(k[1])+" svelte-w9y5n9")&&de(e,"class",D)},i:zt,o:zt,d(k){k&&Nt(e),g.d(),p&&p.d(),N=!1,yn(j)}}}const Xl=typeof devicePixelRatio>"u"?1:devicePixelRatio>1.25,Ni=Xl?"@2x":"",Br=Xl?2:1;let Yr,xa;function $f(n,e,t){let o,a,s,{feature:l}=e,{style:i="default"}=e,{showPlaceType:v}=e,{missingIconsCache:f}=e,{iconsBaseUrl:b}=e;const m=Ql();let C,B,T,$;function P(){xa??(xa=fetch(`${b}sprite${Ni}.json`).then(d=>d.json()).then(d=>{Yr=d}).catch(()=>{Yr=null}))}function y(){B&&f.add(B),w()}function w(){Yr!==void 0?O():(P(),xa?.then(O))}function O(){do{if($--,t(4,C=o?.[$]),t(6,T=C?Yr?.icons[C]:void 0),T)break;t(5,B=C?b+C.replace(/ /g,"_")+".svg":void 0)}while($>-1&&(!B||f.has(B)))}function D(d){rf.call(this,n,d)}const N=()=>y(),j=()=>m("select",void 0),z=d=>{document.activeElement!==d.target&&m("select",void 0)};return n.$$set=d=>{"feature"in d&&t(0,l=d.feature),"style"in d&&t(1,i=d.style),"showPlaceType"in d&&t(2,v=d.showPlaceType),"missingIconsCache"in d&&t(11,f=d.missingIconsCache),"iconsBaseUrl"in d&&t(3,b=d.iconsBaseUrl)},n.$$.update=()=>{var d,g,p,k,x;n.$$.dirty&1&&t(12,o=(d=l.properties)==null?void 0:d.categories),n.$$.dirty&1&&t(8,a=l.place_type[0]==="reverse"),n.$$.dirty&1&&t(7,s=((p=(g=l.properties)==null?void 0:g.categories)==null?void 0:p.join(", "))??((x=(k=l.properties)==null?void 0:k.place_type_name)==null?void 0:x[0])??l.place_type[0]),n.$$.dirty&4096&&($=o?.length??0,w())},[l,i,v,b,C,B,T,s,a,m,y,f,o,D,N,j,z]}class kf extends Rn{constructor(e){super(),In(this,e,$f,xf,Tn,{feature:0,style:1,showPlaceType:2,missingIconsCache:11,iconsBaseUrl:3})}}function Sf(n){let e;return{c(){e=Lt("div"),e.innerHTML='<svg viewBox="0 0 18 18" width="24" height="24" class="loading-icon svelte-1ocfouu"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"></path><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"></path></svg>',de(e,"class","svelte-1ocfouu")},m(t,o){Ft(t,e,o)},p:zt,i:zt,o:zt,d(t){t&&Nt(e)}}}class Ef extends Rn{constructor(e){super(),In(this,e,null,Sf,Tn,{})}}function Lf(n){let e,t,o;return{c(){e=Qr("svg"),t=Qr("path"),de(t,"stroke-width","4"),de(t,"d","M 5,33.103579 C 5,17.607779 18.457,5 35,5 C 51.543,5 65,17.607779 65,33.103579 C 65,56.388679 40.4668,76.048179 36.6112,79.137779 C 36.3714,79.329879 36.2116,79.457979 36.1427,79.518879 C 35.8203,79.800879 35.4102,79.942779 35,79.942779 C 34.5899,79.942779 34.1797,79.800879 33.8575,79.518879 C 33.7886,79.457979 33.6289,79.330079 33.3893,79.138079 C 29.5346,76.049279 5,56.389379 5,33.103579 Z M 35.0001,49.386379 C 43.1917,49.386379 49.8323,42.646079 49.8323,34.331379 C 49.8323,26.016779 43.1917,19.276479 35.0001,19.276479 C 26.8085,19.276479 20.1679,26.016779 20.1679,34.331379 C 20.1679,42.646079 26.8085,49.386379 35.0001,49.386379 Z"),de(t,"class","svelte-gzo3ar"),de(e,"width",o=n[0]==="list"?20:void 0),de(e,"viewBox","0 0 70 85"),de(e,"fill","none"),de(e,"class","svelte-gzo3ar"),en(e,"in-map",n[0]!=="list"),en(e,"list-icon",n[0]==="list")},m(a,s){Ft(a,e,s),mt(e,t)},p(a,[s]){s&1&&o!==(o=a[0]==="list"?20:void 0)&&de(e,"width",o),s&1&&en(e,"in-map",a[0]!=="list"),s&1&&en(e,"list-icon",a[0]==="list")},i:zt,o:zt,d(a){a&&Nt(e)}}}function Cf(n,e,t){let{displayIn:o}=e;return n.$$set=a=>{"displayIn"in a&&t(0,o=a.displayIn)},[o]}class Mf extends Rn{constructor(e){super(),In(this,e,Cf,Lf,Tn,{displayIn:0})}}function Pf(n){let e,t;return{c(){e=Qr("svg"),t=Qr("path"),de(t,"d","M30.003-26.765C13.46-26.765 0-14.158 0 1.337c0 23.286 24.535 42.952 28.39 46.04.24.192.402.316.471.376.323.282.732.424 1.142.424.41 0 .82-.142 1.142-.424.068-.06.231-.183.471-.376 3.856-3.09 28.39-22.754 28.39-46.04 0-15.495-13.46-28.102-30.003-28.102Zm1.757 12.469c4.38 0 7.858 1.052 10.431 3.158 2.595 2.105 3.89 4.913 3.89 8.422 0 2.34-.53 4.362-1.593 6.063-1.063 1.702-3.086 3.616-6.063 5.742-2.042 1.51-3.337 2.659-3.89 3.446-.532.787-.8 1.82-.8 3.096v1.914h-8.449V15.18c0-2.041.434-3.815 1.306-5.325.872-1.51 2.467-3.118 4.785-4.82 2.233-1.594 3.7-2.89 4.402-3.889a5.582 5.582 0 0 0 1.087-3.35c0-1.382-.51-2.435-1.531-3.158-1.02-.723-2.45-1.087-4.28-1.087-3.19 0-6.826 1.047-10.91 3.131l-3.472-6.986c4.742-2.659 9.77-3.992 15.087-3.992Zm-1.88 37.324c1.765 0 3.124.472 4.08 1.408.98.936 1.47 2.276 1.47 4.02 0 1.68-.49 3.007-1.47 3.985-.977.957-2.336 1.435-4.08 1.435-1.787 0-3.171-.465-4.15-1.4-.978-.958-1.47-2.298-1.47-4.02 0-1.787.48-3.14 1.436-4.054.957-.915 2.355-1.374 4.184-1.374Z"),de(e,"viewBox","0 0 60.006 21.412"),de(e,"width","14"),de(e,"height","20"),de(e,"class","svelte-en2qvf")},m(o,a){Ft(o,e,a),mt(e,t)},p:zt,i:zt,o:zt,d(o){o&&Nt(e)}}}class Tf extends Rn{constructor(e){super(),In(this,e,null,Pf,Tn,{})}}function If(n){let e,t,o;return{c(){e=Qr("svg"),t=Qr("circle"),o=Qr("path"),de(t,"cx","4.789"),de(t,"cy","4.787"),de(t,"r","3.85"),de(t,"class","svelte-1aq105l"),de(o,"d","M12.063 12.063 7.635 7.635"),de(o,"class","svelte-1aq105l"),de(e,"xmlns","http://www.w3.org/2000/svg"),de(e,"width","13"),de(e,"height","13"),de(e,"viewBox","0 0 13 13"),de(e,"class","svelte-1aq105l")},m(a,s){Ft(a,e,s),mt(e,t),mt(e,o)},p:zt,i:zt,o:zt,d(a){a&&Nt(e)}}}class Rf extends Rn{constructor(e){super(),In(this,e,null,If,Tn,{})}}function Nf(n,e,t){const o=e[1],a=e[0],s=o-a;return n===o&&t?n:((n-a)%s+s)%s+a}function Da(n){const e=[...n];return e[2]<e[0]&&(Math.abs((e[0]+e[2]+360)/2)>Math.abs((e[0]-360+e[2])/2)?e[0]-=360:e[2]+=360),e}let So;async function Bf(n,e,t){const o=n?.getCenterAndZoom();for(const a of e??[])if(!(o&&(a.minZoom!=null&&a.minZoom>o[0]||a.maxZoom!=null&&a.maxZoom<o[0]))){if(a.type==="fixed")return a.coordinates.join(",");e:if(a.type==="client-geolocation"){if(So&&a.cachedLocationExpiry&&So.time+a.cachedLocationExpiry>Date.now()){if(!So.coords)break e;return So.coords}let s;try{return s=await new Promise((l,i)=>{t.signal.addEventListener("abort",()=>{i(Error("aborted"))}),navigator.geolocation.getCurrentPosition(v=>{l([v.coords.longitude,v.coords.latitude].map(f=>f.toFixed(6)).join(","))},v=>{i(v)},a)}),s}catch{}finally{a.cachedLocationExpiry&&(So={time:Date.now(),coords:s})}if(t.signal.aborted)return}if(a.type==="server-geolocation")return"ip";if(o&&a.type==="map-center")return o[1].toFixed(6)+","+o[2].toFixed(6)}}const Ff=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*(EAST|WEST|[EW])?$/i,Ss=/^([+-]?[0-8]?[0-9])\s+([0-5]?[0-9]\.\d{3,})[\s,]{1,}([+-]?[0-1]?[0-9]?[0-9])\s+([0-5]?[0-9]\.\d{3,})$/,Es=/^(NORTH|SOUTH|[NS])?[\s]*([+-]?[0-8]?[0-9](?:[\.,]\d{3,}))[\s]*([•º°]?)[\s]*(NORTH|SOUTH|[NS])?[\s]*[,/;]?[\s]*(EAST|WEST|[EW])?[\s]*([+-]?[0-1]?[0-9]?[0-9](?:[\.,]\d{3,}))[\s]*([•º°]?)[\s]*(EAST|WEST|[EW])?$/i,Ls=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(EAST|WEST|[EW])?$/i,Cs=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)\s*(EAST|WEST|[EW])?$/i,Ms=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''|′′|’’|´´|["″”\.])?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''|′′|´´|’’|["″”\.])?\s*(EAST|WEST|[EW])?$/i;function Of(n){if(!["DMS","DM","DD"].includes(n))throw new Error("invalid format specified");if(this.decimalCoordinates&&this.decimalCoordinates.trim()){const e=this.decimalCoordinates.split(",").map(B=>Number(B.trim())),t=Number(e[0]),o=Number(e[1]),a=Math.abs(t),s=Math.abs(o),l=t>0?"N":"S",i=o>0?"E":"W";let v;n=="DD"&&(v=`${a}° ${l}, ${s}° ${i}`);const f=Math.floor(a),b=Math.floor(s),m=(a-f)*60,C=(s-b)*60;if(n=="DM"){let B=Ps(m,3).toFixed(3).padStart(6,"0"),T=Ps(C,3).toFixed(3).padStart(6,"0");B.endsWith(".000")&&T.endsWith(".000")&&(B=B.replace(/\.000$/,""),T=T.replace(/\.000$/,"")),v=`${f}° ${B}' ${l}, ${b}° ${T}' ${i}`}if(n=="DMS"){const B=Math.floor(m),T=Math.floor(C);let $=((m-B)*60).toFixed(1).padStart(4,"0"),P=((C-T)*60).toFixed(1).padStart(4,"0");const y=B.toString().padStart(2,"0"),w=T.toString().padStart(2,"0");$.endsWith(".0")&&P.endsWith(".0")&&($=$.replace(/\.0$/,""),P=P.replace(/\.0$/,"")),v=`${f}° ${y}' ${$}" ${l}, ${b}° ${w}' ${P}" ${i}`}return v}else throw new Error("no decimal coordinates to convert")}function Ps(n,e){const t=Math.pow(10,e);return Math.round((n+Number.EPSILON)*t)/t}function es(n,e){e||(e=5),n=n.replace(/\s+/g," ").trim();let t=null,o=null,a="",s="",l=null,i=[],v=!1;if(Ff.test(n))throw new Error("invalid coordinate value");if(Ss.test(n))if(i=Ss.exec(n),v=Eo(i),v)t=Math.abs(i[1])+i[2]/60,Number(i[1])<0&&(t*=-1),o=Math.abs(i[3])+i[4]/60,Number(i[3])<0&&(o*=-1),l="DM";else throw new Error("invalid coordinate format");else if(Es.test(n))if(i=Es.exec(n),v=Eo(i),v){if(t=i[2],o=i[6],t.includes(",")&&(t=t.replace(",",".")),o.includes(",")&&(o=o.replace(",",".")),l="DD",Number(Math.round(t))==Number(t))throw new Error("integer only coordinate provided");if(Number(Math.round(o))==Number(o))throw new Error("integer only coordinate provided");i[1]?(a=i[1],s=i[5]):i[4]&&(a=i[4],s=i[8])}else throw new Error("invalid decimal coordinate format");else if(Ls.test(n))if(i=Ls.exec(n),v=Eo(i),v)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4]/60,l="DM"),i[6]&&(t+=i[6].replace(",",".")/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[9])),i[11]&&(o+=i[11]/60),i[13]&&(o+=i[13].replace(",",".")/3600),parseInt(i[9])<0&&(o=-1*o),i[1]?(a=i[1],s=i[8]):i[7]&&(a=i[7],s=i[14]);else throw new Error("invalid DMS coordinates format");else if(Cs.test(n))if(i=Cs.exec(n),v=Eo(i),v)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4]/60,l="DM"),i[6]&&(t+=i[6]/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[10])),i[12]&&(o+=i[12]/60),i[14]&&(o+=i[14]/3600),parseInt(i[10])<0&&(o=-1*o),i[1]?(a=i[1],s=i[9]):i[8]&&(a=i[8],s=i[16]);else throw new Error("invalid DMS coordinates format");else if(Ms.test(n)){if(i=Ms.exec(n),v=Eo(i),i.filter(f=>f).length<=5)throw new Error("invalid coordinates format");if(v)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4].replace(",",".")/60,l="DM"),i[6]&&(t+=i[6].replace(",",".")/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[10])),i[12]&&(o+=i[12].replace(",",".")/60),i[14]&&(o+=i[14].replace(",",".")/3600),parseInt(i[10])<0&&(o=-1*o),i[1]?(a=i[1],s=i[9]):i[8]&&(a=i[8],s=i[16]);else throw new Error("invalid coordinates format")}if(v){if(Math.abs(o)>=180)throw new Error("invalid longitude value");if(Math.abs(t)>=90)throw new Error("invalid latitude value");if(a&&!s||!a&&s)throw new Error("invalid coordinates value");if(a&&a==s)throw new Error("invalid coordinates format");t.toString().includes(",")&&(t=t.replace(",",".")),o.toString().includes(",")&&(o=o.replace(",","."));let f=/S|SOUTH/i;f.test(a)&&t>0&&(t=-1*t),f=/W|WEST/i,f.test(s)&&o>0&&(o=-1*o);const b=i[0].trim();let m,C;const B=/[,/;\u0020]/g,T=b.match(B);if(T==null){const y=Math.floor(n.length/2);m=b.substring(0,y).trim(),C=b.substring(y).trim()}else{let y;T.length%2==1?y=Math.floor(T.length/2):y=T.length/2-1;let w=0;if(y==0)w=b.indexOf(T[0]),m=b.substring(0,w).trim(),C=b.substring(w+1).trim();else{let O=0,D=0;for(;O<=y;)w=b.indexOf(T[O],D),D=w+1,O++;m=b.substring(0,w).trim(),C=b.substring(w+1).trim()}}const $=m.split(".");if($.length==2&&$[1]==0&&$[1].length!=2)throw new Error("invalid coordinates format");const P=C.split(".");if(P.length==2&&P[1]==0&&P[1].length!=2)throw new Error("invalid coordinates format");if(/^\d+$/.test(m)||/^\d+$/.test(C))throw new Error("degree only coordinate/s provided");return t=Number(Number(t).toFixed(e)),o=Number(Number(o).toFixed(e)),Object.freeze({verbatimCoordinates:b,verbatimLatitude:m,verbatimLongitude:C,decimalLatitude:t,decimalLongitude:o,decimalCoordinates:`${t},${o}`,originalFormat:l,closeEnough:jf,toCoordinateFormat:Of})}else throw new Error("coordinates pattern match failed")}function Eo(n){if(!isNaN(n[0]))return!1;const e=[...n];if(e.shift(),e.length%2>0)return!1;const t=/^[-+]?\d+([\.,]\d+)?$/,o=/[eastsouthnorthwest]+/i,a=e.length/2;for(let s=0;s<a;s++){const l=e[s],i=e[s+a],v=t.test(l)&&t.test(i),f=o.test(l)&&o.test(i),b=l==i;if(!(l==null&&i==null)){if(l==null||i==null)return!1;if(v||f||b)continue;return!1}}return!0}function Ts(n,e){const t=Math.abs(n-e);return Number(t.toFixed(6))<=1e-5}function jf(n){if(!n)throw new Error("coords must be provided");if(n.includes(",")){const e=n.split(",");if(Number(e[0])==NaN||Number(e[1])==NaN)throw new Error("coords are not valid decimals");return Ts(this.decimalLatitude,Number(e[0]))&&Ts(this.decimalLongitude,e[1])}else throw new Error("coords being tested must be separated by a comma")}const zf=Object.freeze({DMS:"DMS",DM:"DM",DD:"DD"});es.to=zf;const Df=[{verbatimCoordinates:"40.123, -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123° N 74.123° W",verbatimLatitude:"40.123° N",verbatimLongitude:"74.123° W"},{verbatimCoordinates:"40.123° N 74.123° W",verbatimLatitude:"40.123° N",verbatimLongitude:"74.123° W"},{verbatimCoordinates:'40° 7´ 22.8" N 74° 7´ 22.8" W',verbatimLatitude:'40° 7´ 22.8" N',verbatimLongitude:'74° 7´ 22.8" W'},{verbatimCoordinates:"40° 7.38’ , -74° 7.38’",verbatimLatitude:"40° 7.38’",verbatimLongitude:"-74° 7.38’"},{verbatimCoordinates:"N40°7’22.8’’, W74°7’22.8’’",verbatimLatitude:"N40°7’22.8’’",verbatimLongitude:"W74°7’22.8’’"},{verbatimCoordinates:'40°7’22.8"N, 74°7’22.8"W',verbatimLatitude:'40°7’22.8"N',verbatimLongitude:'74°7’22.8"W'},{verbatimCoordinates:`40°7'22.8"N, 74°7'22.8"W`,verbatimLatitude:`40°7'22.8"N`,verbatimLongitude:`74°7'22.8"W`},{verbatimCoordinates:"40 7 22.8, -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"},{verbatimCoordinates:"40.123 -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123°,-74.123°",verbatimLatitude:"40.123°",verbatimLongitude:"-74.123°"},{verbatimCoordinates:"40.123N74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"4007.38N7407.38W",verbatimLatitude:"4007.38N",verbatimLongitude:"7407.38W"},{verbatimCoordinates:'40°7’22.8"N, 74°7’22.8"W',verbatimLatitude:'40°7’22.8"N',verbatimLongitude:'74°7’22.8"W'},{verbatimCoordinates:"400722.8N740722.8W",verbatimLatitude:"400722.8N",verbatimLongitude:"740722.8W"},{verbatimCoordinates:"N 40 7.38 W 74 7.38",verbatimLatitude:"N 40 7.38",verbatimLongitude:"W 74 7.38"},{verbatimCoordinates:"40:7:22.8N 74:7:22.8W",verbatimLatitude:"40:7:22.8N",verbatimLongitude:"74:7:22.8W"},{verbatimCoordinates:"40:7:23N,74:7:23W",verbatimLatitude:"40:7:23N",verbatimLongitude:"74:7:23W",decimalLatitude:40.1230555555,decimalLongitude:-74.1230555555},{verbatimCoordinates:'40°7’23"N 74°7’23"W',verbatimLatitude:'40°7’23"N',verbatimLongitude:'74°7’23"W',decimalLatitude:40.1230555555,decimalLongitude:-74.12305555555555},{verbatimCoordinates:'40°7’23"S 74°7’23"E',verbatimLatitude:'40°7’23"S',verbatimLongitude:'74°7’23"E',decimalLatitude:-40.1230555555,decimalLongitude:74.12305555555555},{verbatimCoordinates:'40°7’23" -74°7’23"',verbatimLatitude:'40°7’23"',verbatimLongitude:'-74°7’23"',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:'40d 7’ 23" N 74d 7’ 23" W',verbatimLatitude:'40d 7’ 23" N',verbatimLongitude:'74d 7’ 23" W',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:"40.123N 74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"40° 7.38, -74° 7.38",verbatimLatitude:"40° 7.38",verbatimLongitude:"-74° 7.38"},{verbatimCoordinates:"40° 7.38, -74° 7.38",verbatimLatitude:"40° 7.38",verbatimLongitude:"-74° 7.38"},{verbatimCoordinates:"40 7 22.8; -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"}],Uf={decimalLatitude:40.123,decimalLongitude:-74.123},Gf=[{verbatimCoordinates:`50°4'17.698"south, 14°24'2.826"east`,verbatimLatitude:`50°4'17.698"south`,verbatimLongitude:`14°24'2.826"east`,decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"50d4m17.698S 14d24m2.826E",verbatimLatitude:"50d4m17.698S",verbatimLongitude:"14d24m2.826E",decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"40:26:46N,79:56:55W",verbatimLatitude:"40:26:46N",verbatimLongitude:"79:56:55W",decimalLatitude:40.44611111111111,decimalLongitude:-79.9486111111111},{verbatimCoordinates:"40:26:46.302N 79:56:55.903W",verbatimLatitude:"40:26:46.302N",verbatimLongitude:"79:56:55.903W",decimalLatitude:40.446195,decimalLongitude:-79.94886194444445},{verbatimCoordinates:"40°26′47″N 79°58′36″W",verbatimLatitude:"40°26′47″N",verbatimLongitude:"79°58′36″W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40d 26′ 47″ N 79d 58′ 36″ W",verbatimLatitude:"40d 26′ 47″ N",verbatimLongitude:"79d 58′ 36″ W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40.446195N 79.948862W",verbatimLatitude:"40.446195N",verbatimLongitude:"79.948862W",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40,446195° 79,948862°",verbatimLatitude:"40,446195°",verbatimLongitude:"79,948862°",decimalLatitude:40.446195,decimalLongitude:79.948862},{verbatimCoordinates:"40° 26.7717, -79° 56.93172",verbatimLatitude:"40° 26.7717",verbatimLongitude:"-79° 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.446195, -79.948862",verbatimLatitude:"40.446195",verbatimLongitude:"-79.948862",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.123256; -74.123256",verbatimLatitude:"40.123256",verbatimLongitude:"-74.123256",decimalLatitude:40.123256,decimalLongitude:-74.123256},{verbatimCoordinates:"18°24S 22°45E",verbatimLatitude:"18°24S",verbatimLongitude:"22°45E",decimalLatitude:-18.4,decimalLongitude:22.75}],Wf=[{verbatimCoordinates:"10.432342S 10.6345345E",verbatimLatitude:"10.432342S",verbatimLongitude:"10.6345345E",decimalLatitude:-10.432342,decimalLongitude:10.6345345},{verbatimCoordinates:"10.00S 10.00E",verbatimLatitude:"10.00S",verbatimLongitude:"10.00E",decimalLatitude:-10,decimalLongitude:10},{verbatimCoordinates:"00.00S 01.00E",verbatimLatitude:"00.00S",verbatimLongitude:"01.00E",decimalLatitude:0,decimalLongitude:1},{verbatimCoordinates:"18.24S 22.45E",verbatimLatitude:"18.24S",verbatimLongitude:"22.45E",decimalLatitude:-18.4,decimalLongitude:22.75},{verbatimCoordinates:"27deg 15min 45.2sec S 18deg 32min 53.7sec E",verbatimLatitude:"27deg 15min 45.2sec S",verbatimLongitude:"18deg 32min 53.7sec E",decimalLatitude:-27.262555555555554,decimalLongitude:18.54825},{verbatimCoordinates:"-23.3245° S / 28.2344° E",verbatimLatitude:"-23.3245° S",verbatimLongitude:"28.2344° E",decimalLatitude:-23.3245,decimalLongitude:28.2344},{verbatimCoordinates:"40° 26.7717 -79° 56.93172",verbatimLatitude:"40° 26.7717",verbatimLongitude:"-79° 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"27.15.45S 18.32.53E",verbatimLatitude:"27.15.45S",verbatimLongitude:"18.32.53E",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"-27.15.45 18.32.53",verbatimLatitude:"-27.15.45",verbatimLongitude:"18.32.53",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"27.15.45.2S 18.32.53.4E",verbatimLatitude:"27.15.45.2S",verbatimLongitude:"18.32.53.4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"27.15.45,2S 18.32.53,4E",verbatimLatitude:"27.15.45,2S",verbatimLongitude:"18.32.53,4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"S23.43563 °  E22.45634 °",verbatimLatitude:"S23.43563 °",verbatimLongitude:"E22.45634 °",decimalLatitude:-23.43563,decimalLongitude:22.45634},{verbatimCoordinates:"27,71372° S 23,07771° E",verbatimLatitude:"27,71372° S",verbatimLongitude:"23,07771° E",decimalLatitude:-27.71372,decimalLongitude:23.07771},{verbatimCoordinates:"27.45.34 S 23.23.23 E",verbatimLatitude:"27.45.34 S",verbatimLongitude:"23.23.23 E",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"S 27.45.34 E 23.23.23",verbatimLatitude:"S 27.45.34",verbatimLongitude:"E 23.23.23",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"53 16.3863,4 52.8171",verbatimLatitude:"53 16.3863",verbatimLongitude:"4 52.8171",decimalLatitude:53.273105,decimalLongitude:4.88029},{verbatimCoordinates:"50 8.2914,-5 2.4447",verbatimLatitude:"50 8.2914",verbatimLongitude:"-5 2.4447",decimalLatitude:50.13819,decimalLongitude:-5.040745},{verbatimCoordinates:"N 48° 30,6410', E 18° 57,4583'",verbatimLatitude:"N 48° 30,6410'",verbatimLongitude:"E 18° 57,4583'",decimalLatitude:48.51068,decimalLongitude:18.95764},{verbatimCoordinates:"1.23456, 18.33453",verbatimLatitude:"1.23456",verbatimLongitude:"18.33453",decimalLatitude:1.23456,decimalLongitude:18.33453}];function Hf(){const n=[];return Df.forEach(e=>{e.decimalLatitude?n.push(e):n.push({...e,...Uf})}),[...n,...Gf,...Wf]}const qf=Hf();es.formats=qf.map(n=>n.verbatimCoordinates);const Jf=es;function Is(n,e,t){const o=n.slice();return o[97]=e[t],o[99]=t,o}function Rs(n){let e,t,o,a,s;return t=new Vl({}),{c(){e=Lt("button"),Mn(t.$$.fragment),de(e,"type","button"),de(e,"title",n[3]),de(e,"class","svelte-bz0zu3")},m(l,i){Ft(l,e,i),hn(t,e,null),o=!0,a||(s=or(e,"click",n[78]),a=!0)},p(l,i){(!o||i[0]&8)&&de(e,"title",l[3])},i(l){o||(Ut(t.$$.fragment,l),o=!0)},o(l){rr(t.$$.fragment,l),o=!1},d(l){l&&Nt(e),mn(t),a=!1,s()}}}function Ns(n){let e,t;return e=new Ef({}),{c(){Mn(e.$$.fragment)},m(o,a){hn(e,o,a),t=!0},i(o){t||(Ut(e.$$.fragment,o),t=!0)},o(o){rr(e.$$.fragment,o),t=!1},d(o){mn(e,o)}}}function Bs(n){let e,t,o,a,s;return t=new Tf({}),{c(){e=Lt("button"),Mn(t.$$.fragment),de(e,"type","button"),de(e,"title",n[10]),de(e,"class","svelte-bz0zu3"),en(e,"active",n[0])},m(l,i){Ft(l,e,i),hn(t,e,null),o=!0,a||(s=or(e,"click",n[79]),a=!0)},p(l,i){(!o||i[0]&1024)&&de(e,"title",l[10]),(!o||i[0]&1)&&en(e,"active",l[0])},i(l){o||(Ut(t.$$.fragment,l),o=!0)},o(l){rr(t.$$.fragment,l),o=!1},d(l){l&&Nt(e),mn(t),a=!1,s()}}}function Qf(n){let e,t=[],o=new Map,a,s,l,i=$s(n[13]);const v=f=>f[97].id+(f[97].address?","+f[97].address:"");for(let f=0;f<i.length;f+=1){let b=Is(n,i,f),m=v(b);o.set(m,t[f]=Fs(m,b))}return{c(){e=Lt("ul");for(let f=0;f<t.length;f+=1)t[f].c();de(e,"class","options svelte-bz0zu3"),de(e,"role","listbox")},m(f,b){Ft(f,e,b);for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(e,null);a=!0,s||(l=[or(e,"mouseleave",n[27]),or(e,"blur",n[83]),or(e,"keydown",n[23])],s=!0)},p(f,b){b[0]&102823936&&(i=$s(f[13]),Io(),t=uf(t,b,v,1,f,i,o,e,lf,Fs,null,Is),Ro())},i(f){if(!a){for(let b=0;b<i.length;b+=1)Ut(t[b]);a=!0}},o(f){for(let b=0;b<t.length;b+=1)rr(t[b]);a=!1},d(f){f&&Nt(e);for(let b=0;b<t.length;b+=1)t[b].d();s=!1,yn(l)}}}function Zf(n){let e,t,o,a,s,l;return t=new Kl({}),{c(){e=Lt("div"),Mn(t.$$.fragment),o=Tr(),a=Lt("div"),s=Cn(n[8]),de(a,"class","svelte-bz0zu3"),de(e,"class","no-results svelte-bz0zu3")},m(i,v){Ft(i,e,v),hn(t,e,null),mt(e,o),mt(e,a),mt(a,s),l=!0},p(i,v){(!l||v[0]&256)&&aa(s,i[8])},i(i){l||(Ut(t.$$.fragment,i),l=!0)},o(i){rr(t.$$.fragment,i),l=!1},d(i){i&&Nt(e),mn(t)}}}function Vf(n){let e="",t;return{c(){t=Cn(e)},m(o,a){Ft(o,t,a)},p:zt,i:zt,o:zt,d(o){o&&Nt(t)}}}function Kf(n){let e,t,o,a,s,l,i,v,f,b,m;return t=new Kl({}),v=new Vl({}),{c(){e=Lt("div"),Mn(t.$$.fragment),o=Tr(),a=Lt("div"),s=Cn(n[7]),l=Tr(),i=Lt("button"),Mn(v.$$.fragment),de(a,"class","svelte-bz0zu3"),de(i,"class","svelte-bz0zu3"),de(e,"class","error svelte-bz0zu3")},m(C,B){Ft(C,e,B),hn(t,e,null),mt(e,o),mt(e,a),mt(a,s),mt(e,l),mt(e,i),hn(v,i,null),f=!0,b||(m=or(i,"click",n[80]),b=!0)},p(C,B){(!f||B[0]&128)&&aa(s,C[7])},i(C){f||(Ut(t.$$.fragment,C),Ut(v.$$.fragment,C),f=!0)},o(C){rr(t.$$.fragment,C),rr(v.$$.fragment,C),f=!1},d(C){C&&Nt(e),mn(t),mn(v),b=!1,m()}}}function Fs(n,e){var t;let o,a,s;function l(){return e[81](e[99])}function i(){return e[82](e[97])}return a=new kf({props:{feature:e[97],showPlaceType:e[11],style:e[15]===e[99]?"selected":((t=e[14])==null?void 0:t.id)===e[97].id?"picked":"default",missingIconsCache:e[21],iconsBaseUrl:e[12]}}),a.$on("mouseenter",l),a.$on("select",i),{key:n,first:null,c(){o=Kd(),Mn(a.$$.fragment),this.first=o},m(v,f){Ft(v,o,f),hn(a,v,f),s=!0},p(v,f){var b;e=v;const m={};f[0]&8192&&(m.feature=e[97]),f[0]&2048&&(m.showPlaceType=e[11]),f[0]&57344&&(m.style=e[15]===e[99]?"selected":((b=e[14])==null?void 0:b.id)===e[97].id?"picked":"default"),f[0]&4096&&(m.iconsBaseUrl=e[12]),a.$set(m)},i(v){s||(Ut(a.$$.fragment,v),s=!0)},o(v){rr(a.$$.fragment,v),s=!1},d(v){v&&Nt(o),mn(a,v)}}}function Xf(n){let e,t,o,a,s,l,i,v,f,b,m,C,B,T,$,P,y,w,O,D=!1;s=new Rf({});let N=!n[20]&&Rs(n),j=n[20]&&Ns(),z=n[6]==="button"&&Bs(n);const d=n[70].default,g=Jd(d,n,n[69],null),p=[Kf,Vf,Zf,Qf],k=[];function x(A,F){var S,I;return A[19]?0:!A[16]&&!A[4]?1:((S=A[13])==null?void 0:S.length)===0?2:(I=A[13])!=null&&I.length&&(A[16]||A[4])?3:-1}return~(T=x(n))&&($=k[T]=p[T](n)),{c(){e=Tr(),t=Lt("form"),o=Lt("div"),a=Lt("button"),Mn(s.$$.fragment),l=Tr(),i=Lt("input"),v=Tr(),f=Lt("div"),N&&N.c(),b=Tr(),j&&j.c(),m=Tr(),z&&z.c(),C=Tr(),g&&g.c(),B=Tr(),$&&$.c(),de(a,"class","search-button svelte-bz0zu3"),de(a,"type","button"),de(i,"placeholder",n[9]),de(i,"aria-label",n[9]),de(i,"class","svelte-bz0zu3"),de(f,"class","clear-button-container svelte-bz0zu3"),en(f,"displayable",n[1]!==""),de(o,"class","input-group svelte-bz0zu3"),de(t,"class",P=za(n[2])+" svelte-bz0zu3"),en(t,"can-collapse",n[5]&&n[1]==="")},m(A,F){Ft(A,e,F),Ft(A,t,F),mt(t,o),mt(o,a),hn(s,a,null),mt(o,l),mt(o,i),n[72](i),ws(i,n[1]),mt(o,v),mt(o,f),N&&N.m(f,null),mt(f,b),j&&j.m(f,null),mt(o,m),z&&z.m(o,null),mt(o,C),g&&g.m(o,null),mt(t,B),~T&&k[T].m(t,null),y=!0,w||(O=[or(a,"click",n[71]),or(i,"input",n[73]),or(i,"focus",n[74]),or(i,"blur",n[75]),or(i,"click",n[76]),or(i,"keydown",n[23]),or(i,"input",n[24]),or(i,"change",n[77]),or(t,"submit",Xd(n[22]))],w=!0)},p(A,F){(!y||F[0]&512)&&de(i,"placeholder",A[9]),(!y||F[0]&512)&&de(i,"aria-label",A[9]),F[0]&2&&i.value!==A[1]&&ws(i,A[1]),A[20]?N&&(Io(),rr(N,1,1,()=>{N=null}),Ro()):N?(N.p(A,F),F[0]&1048576&&Ut(N,1)):(N=Rs(A),N.c(),Ut(N,1),N.m(f,b)),A[20]?j?F[0]&1048576&&Ut(j,1):(j=Ns(),j.c(),Ut(j,1),j.m(f,null)):j&&(Io(),rr(j,1,1,()=>{j=null}),Ro()),(!y||F[0]&2)&&en(f,"displayable",A[1]!==""),A[6]==="button"?z?(z.p(A,F),F[0]&64&&Ut(z,1)):(z=Bs(A),z.c(),Ut(z,1),z.m(o,C)):z&&(Io(),rr(z,1,1,()=>{z=null}),Ro()),g&&g.p&&(!y||F[2]&128)&&Zd(g,d,A,A[69],y?Qd(d,A[69]):Vd(A[69]),null);let S=T;T=x(A),T===S?~T&&k[T].p(A,F):($&&(Io(),rr(k[S],1,1,()=>{k[S]=null}),Ro()),~T?($=k[T],$?$.p(A,F):($=k[T]=p[T](A),$.c()),Ut($,1),$.m(t,null)):$=null),(!y||F[0]&4&&P!==(P=za(A[2])+" svelte-bz0zu3"))&&de(t,"class",P),(!y||F[0]&38)&&en(t,"can-collapse",A[5]&&A[1]==="")},i(A){y||(Ut(D),Ut(s.$$.fragment,A),Ut(N),Ut(j),Ut(z),Ut(g,A),Ut($),y=!0)},o(A){rr(D),rr(s.$$.fragment,A),rr(N),rr(j),rr(z),rr(g,A),rr($),y=!1},d(A){A&&(Nt(e),Nt(t)),mn(s),n[72](null),N&&N.d(),j&&j.d(),z&&z.d(),g&&g.d(A),~T&&k[T].d(),w=!1,yn(O)}}}function Yf(n,e,t){let o,a,s,{$$slots:l={},$$scope:i}=e;const v={continental_marine:4,country:4,major_landform:8,region:5,subregion:6,county:7,joint_municipality:8,joint_submunicipality:9,municipality:10,municipal_district:11,locality:12,neighbourhood:13,place:14,postal_code:14,road:16,poi:17,address:18,"poi.peak":15,"poi.shop":18,"poi.cafe":18,"poi.restaurant":18,"poi.aerodrome":13};let{class:f=void 0}=e,{apiKey:b=void 0}=e,{bbox:m=void 0}=e,{clearButtonTitle:C="clear"}=e,{clearOnBlur:B=!1}=e,{clearListOnPick:T=!1}=e,{keepListOpen:$=!1}=e,{collapsed:P=!1}=e,{country:y=void 0}=e,{debounceSearch:w=200}=e,{enableReverse:O="never"}=e,{errorMessage:D="Something went wrong…"}=e,{filter:N=()=>!0}=e,{flyTo:j=!0}=e,{fuzzyMatch:z=!0}=e,{language:d=void 0}=e,{limit:g=void 0}=e;const p=41415112612;let{reverseGeocodingLimit:k=p}=e,{mapController:x=void 0}=e,{minLength:A=2}=e,{noResultsMessage:F="Oops! Looks like you're trying to predict something that's not quite right. We can't seem to find what you're looking for. Maybe try double-checking your spelling or try a different search term. Keep on typing - we'll do our best to get you where you need to go!"}=e,{placeholder:S="Search"}=e,{proximity:I=[{type:"server-geolocation"}]}=e,{reverseActive:E=O==="always"}=e,{reverseButtonTitle:L="toggle reverse geocoding"}=e,{searchValue:R=""}=e,{pickedResultStyle:G="full-geometry"}=e,{showPlaceType:J="if-needed"}=e,{showResultsWhileTyping:H=!0}=e,{selectFirst:X=!0}=e,{flyToSelected:le=!1}=e,{markerOnSelected:q=!0}=e,{types:ee=void 0}=e;const ue=[];let{reverseGeocodingTypes:K=ue}=e,{exhaustiveReverseGeocoding:V=!1}=e,{excludeTypes:te=!1}=e;const re=void 0;let{reverseGeocodingExcludeTypes:ie=re}=e,{zoom:ne=v}=e,{apiUrl:ae="https://api.maptiler.com/geocoding"}=e,{fetchParameters:_e={}}=e,{iconsBaseUrl:se="https://cdn.maptiler.com/maptiler-geocoding-control/v2.1.7/icons/"}=e,{adjustUrlQuery:fe=()=>{}}=e,{adjustUrl:oe=()=>{}}=e;function ye(ce){Te.focus(ce)}function he(){Te.blur()}function xe(ce,At=!0,Qt=!1){t(1,R=ce),At?(t(15,me=-1),tt()):(pt(void 0,!Qt,Qt),setTimeout(()=>{Te.focus(),Te.select()}))}function Se(){t(13,ke=void 0),t(14,pe=void 0),t(15,me=-1)}function De(){t(64,Ee=[]),t(14,pe=void 0)}let ke,Ee,pe,Ie="",Te,me=-1,Me,Fe=[],Le,qe,Oe,Ze,Be=!1;const We=new Set,Je=Ql();tf(()=>{x&&(x.setEventHandler(void 0),x.indicateReverse(!1),x.setSelectedMarker(-1),x.setFeatures(void 0,void 0,!1))});function tt(ce){if(t(17,Be=!1),qe&&(clearTimeout(qe),qe=void 0),me>-1&&ke)t(14,pe=ke[me]),t(1,R=pe.place_type[0]==="reverse"?pe.place_name:pe.place_name.replace(/,.*/,"")),t(19,Me=void 0),t(64,Ee=void 0),t(15,me=-1);else if(R){const At=ce||!yt(R);dt(R,{exact:!0}).then(()=>{t(64,Ee=ke),t(14,pe=void 0),At&&kt()}).catch(Qt=>t(19,Me=Qt))}}function yt(ce){try{return Jf(ce,6)}catch{return!1}}async function dt(ce,{byId:At=!1,exact:Qt=!1}={}){var Wt,ar,it;t(19,Me=void 0),Le?.abort();const vt=new AbortController;t(20,Le=vt);try{const Ge=yt(ce),Ke=new URL(ae+"/"+encodeURIComponent(Ge?Ge.decimalLongitude+","+Ge.decimalLatitude:ce)+".json"),nt=Ke.searchParams;d!==void 0&&nt.set("language",Array.isArray(d)?d.join(","):d??"");const[Zt]=x?.getCenterAndZoom()??[];let Pt=(Wt=!Ge||K===ue?ee:K)==null?void 0:Wt.map(Tt=>typeof Tt=="string"?Tt:Zt===void 0||(Tt[0]??0)<=Zt&&Zt<(Tt[1]??1/0)?Tt[2]:void 0).filter(Tt=>Tt!==void 0);Pt&&(Pt=[...new Set(Pt)],nt.set("types",Pt.join(",")));const hr=!Ge||ie===re?te:ie;if(hr&&nt.set("excludeTypes",String(hr)),m&&nt.set("bbox",m.map(Tt=>Tt.toFixed(6)).join(",")),y&&nt.set("country",Array.isArray(y)?y.join(","):y),!At&&!Ge){const Tt=await Bf(x,I,vt);Tt&&nt.set("proximity",Tt),(Qt||!H)&&nt.set("autocomplete","false"),nt.set("fuzzyMatch",String(z))}const mr=k===p?g:k;mr!==void 0&&mr>1&&Pt?.length!==1&&console.warn("For reverse geocoding when limit > 1 then types must contain single value."),Ge?(mr===1||mr!==void 0&&(V||Pt?.length===1))&&nt.set("limit",String(mr)):g!==void 0&&nt.set("limit",String(g)),b&&nt.set("key",b),fe(nt),oe(Ke);const ln=Ke.searchParams.get("types")===""&&Ke.searchParams.get("excludeTypes")!=="true",tr=Ke.toString();if(tr===Ie){At?(T&&t(13,ke=void 0),t(14,pe=Fe[0])):(t(13,ke=Fe),((ar=ke[me])==null?void 0:ar.id)!==a?.id&&t(15,me=-1));return}Ie=tr;let ir;if(ln)ir={type:"FeatureCollection",features:[]};else{const Tt=await fetch(tr,{signal:vt.signal,..._e});if(!Tt.ok)throw new Error(await Tt.text());ir=await Tt.json()}Je("response",{url:tr,featureCollection:ir}),At?(T&&t(13,ke=void 0),t(14,pe=ir.features[0]),Fe=[pe]):(t(13,ke=ir.features.filter(N)),Ge&&ke.unshift({type:"Feature",properties:{},id:"reverse_"+Ge.decimalLongitude+"_"+Ge.decimalLatitude,text:Ge.decimalLatitude+", "+Ge.decimalLongitude,place_name:Ge.decimalLatitude+", "+Ge.decimalLongitude,place_type:["reverse"],center:[Ge.decimalLongitude,Ge.decimalLatitude],bbox:[Ge.decimalLongitude,Ge.decimalLatitude,Ge.decimalLongitude,Ge.decimalLatitude],geometry:{type:"Point",coordinates:[Ge.decimalLongitude,Ge.decimalLatitude]}}),Fe=ke,((it=ke[me])==null?void 0:it.id)!==a?.id&&t(15,me=-1),Ge&&Te.focus())}catch(Ge){if(Ge&&typeof Ge=="object"&&"name"in Ge&&Ge.name==="AbortError")return;throw Ge}finally{vt===Le&&t(20,Le=void 0)}}function kt(){var ce;if(!(Ee!=null&&Ee.length)||!j)return;const At=[180,90,-180,-90],Qt=!Ee.some(ar=>!ar.matching_text);let Wt;for(const ar of Ee){const it=_t(ar);if(Wt=Wt===void 0?it:it===void 0?Wt:Math.max(Wt,it),Qt||!ar.matching_text)for(const vt of[0,1,2,3])At[vt]=Math[vt<2?"min":"max"](At[vt],((ce=ar.bbox)==null?void 0:ce[vt])??ar.center[vt%2])}x&&Ee.length>0&&(pe&&At[0]===At[2]&&At[1]===At[3]?x.flyTo(pe.center,_t(pe)):x.fitBounds(Da(At),50,Wt))}function $t(){!pe||!x||(!pe.bbox||pe.bbox[0]===pe.bbox[2]&&pe.bbox[1]===pe.bbox[3]?x.flyTo(pe.center,_t(pe)):x.fitBounds(Da(pe.bbox),50,_t(pe)))}function _t(ce){var At;if(!ce.bbox||ce.bbox[0]!==ce.bbox[2]&&ce.bbox[1]!==ce.bbox[3])return;const Qt=ce.id.replace(/\..*/,"");return(Array.isArray((At=ce.properties)==null?void 0:At.categories)?ce.properties.categories.reduce((Wt,ar)=>{const it=ne[Qt+"."+ar];return Wt===void 0?it:it===void 0?Wt:Math.max(Wt,it)},void 0):void 0)??ne[Qt]}function at(ce){t(0,E=O==="always"),t(13,ke=void 0),t(14,pe=void 0),t(15,me=-1),xe(ce[1].toFixed(6)+", "+Nf(ce[0],[-180,180],!0).toFixed(6),!1,!0)}function et(ce){if(!ke)return;let At=ce.key==="ArrowDown"?1:ce.key==="ArrowUp"?-1:0;At&&(Te.focus(),t(17,Be=!0),ce.preventDefault(),pe&&me===-1&&t(15,me=ke.findIndex(Qt=>Qt.id===pe?.id)),me===(pe||X?0:-1)&&At===-1&&t(15,me=ke.length),t(15,me+=At),me>=ke.length&&t(15,me=-1),me<0&&(pe||X)&&t(15,me=0))}function pt(ce,At=!0,Qt=!1){if(t(19,Me=void 0),t(14,pe=void 0),t(17,Be=!0),H||Qt){if(qe&&clearTimeout(qe),R.length<A)return;const Wt=R;qe=window.setTimeout(()=>{dt(Wt).catch(ar=>t(19,Me=ar))},At?w:0)}else t(13,ke=void 0),t(19,Me=void 0)}function Mt(ce){pe&&pe?.id===ce?.id?$t():(t(14,pe=ce),t(1,R=ce.place_name))}function Ct(ce){t(15,me=ce)}function ht(){(!X||pe)&&t(15,me=-1),le&&$t()}const Gt=()=>Te.focus();function Dt(ce){Ti[ce?"unshift":"push"](()=>{Te=ce,t(18,Te)})}function sr(){R=this.value,t(1,R),t(17,Be),t(31,B),t(16,Oe)}const an=()=>t(17,Be=!0),pr=()=>t(17,Be=!1),wr=()=>t(17,Be=!0),xr=()=>t(14,pe=void 0),Cr=()=>{t(1,R=""),t(14,pe=void 0),Te.focus()},sn=()=>t(0,E=!E),Gr=()=>t(19,Me=void 0),Nn=ce=>Ct(ce),$r=ce=>Mt(ce),Xn=()=>{};return n.$$set=ce=>{"class"in ce&&t(2,f=ce.class),"apiKey"in ce&&t(29,b=ce.apiKey),"bbox"in ce&&t(30,m=ce.bbox),"clearButtonTitle"in ce&&t(3,C=ce.clearButtonTitle),"clearOnBlur"in ce&&t(31,B=ce.clearOnBlur),"clearListOnPick"in ce&&t(32,T=ce.clearListOnPick),"keepListOpen"in ce&&t(4,$=ce.keepListOpen),"collapsed"in ce&&t(5,P=ce.collapsed),"country"in ce&&t(33,y=ce.country),"debounceSearch"in ce&&t(34,w=ce.debounceSearch),"enableReverse"in ce&&t(6,O=ce.enableReverse),"errorMessage"in ce&&t(7,D=ce.errorMessage),"filter"in ce&&t(35,N=ce.filter),"flyTo"in ce&&t(36,j=ce.flyTo),"fuzzyMatch"in ce&&t(37,z=ce.fuzzyMatch),"language"in ce&&t(38,d=ce.language),"limit"in ce&&t(39,g=ce.limit),"reverseGeocodingLimit"in ce&&t(40,k=ce.reverseGeocodingLimit),"mapController"in ce&&t(41,x=ce.mapController),"minLength"in ce&&t(42,A=ce.minLength),"noResultsMessage"in ce&&t(8,F=ce.noResultsMessage),"placeholder"in ce&&t(9,S=ce.placeholder),"proximity"in ce&&t(43,I=ce.proximity),"reverseActive"in ce&&t(0,E=ce.reverseActive),"reverseButtonTitle"in ce&&t(10,L=ce.reverseButtonTitle),"searchValue"in ce&&t(1,R=ce.searchValue),"pickedResultStyle"in ce&&t(44,G=ce.pickedResultStyle),"showPlaceType"in ce&&t(11,J=ce.showPlaceType),"showResultsWhileTyping"in ce&&t(45,H=ce.showResultsWhileTyping),"selectFirst"in ce&&t(46,X=ce.selectFirst),"flyToSelected"in ce&&t(47,le=ce.flyToSelected),"markerOnSelected"in ce&&t(48,q=ce.markerOnSelected),"types"in ce&&t(49,ee=ce.types),"reverseGeocodingTypes"in ce&&t(50,K=ce.reverseGeocodingTypes),"exhaustiveReverseGeocoding"in ce&&t(51,V=ce.exhaustiveReverseGeocoding),"excludeTypes"in ce&&t(52,te=ce.excludeTypes),"reverseGeocodingExcludeTypes"in ce&&t(53,ie=ce.reverseGeocodingExcludeTypes),"zoom"in ce&&t(54,ne=ce.zoom),"apiUrl"in ce&&t(55,ae=ce.apiUrl),"fetchParameters"in ce&&t(56,_e=ce.fetchParameters),"iconsBaseUrl"in ce&&t(12,se=ce.iconsBaseUrl),"adjustUrlQuery"in ce&&t(57,fe=ce.adjustUrlQuery),"adjustUrl"in ce&&t(58,oe=ce.adjustUrl),"$$scope"in ce&&t(69,i=ce.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&64&&t(0,E=O==="always"),n.$$.dirty[0]&16384|n.$$.dirty[1]&8192&&G!=="marker-only"&&pe&&!pe.address&&pe.geometry.type==="Point"&&pe.place_type[0]!=="reverse"&&dt(pe.id,{byId:!0}).catch(ce=>t(19,Me=ce)),n.$$.dirty[0]&16384|n.$$.dirty[1]&1058|n.$$.dirty[2]&8&&(x&&pe&&pe.id!==Ze&&j&&($t(),T&&t(13,ke=void 0),t(64,Ee=void 0),t(15,me=-1)),t(65,Ze=pe?.id)),n.$$.dirty[0]&196608|n.$$.dirty[1]&1&&setTimeout(()=>{t(16,Oe=Be),B&&!Oe&&t(1,R="")}),n.$$.dirty[0]&8194|n.$$.dirty[1]&2048&&R.length<A&&(t(13,ke=void 0),t(19,Me=void 0),t(64,Ee=ke)),n.$$.dirty[0]&57344|n.$$.dirty[1]&32768&&X&&ke!=null&&ke.length&&me==-1&&!pe&&t(15,me=0),n.$$.dirty[0]&8192|n.$$.dirty[2]&4&&Ee!==ke&&t(64,Ee=void 0),n.$$.dirty[0]&73729|n.$$.dirty[1]&1024|n.$$.dirty[2]&4&&x&&x.setEventHandler(ce=>{switch(ce.type){case"mapClick":E&&at(ce.coordinates);break;case"markerClick":{const At=ke?.find(Qt=>Qt.id===ce.id);At&&Mt(At)}break;case"markerMouseEnter":Ee&&t(15,me=Oe?ke?.findIndex(At=>At.id===ce.id)??-1:-1);break;case"markerMouseLeave":Ee&&t(15,me=-1);break}}),n.$$.dirty[0]&40960&&t(66,a=ke?.[me]),n.$$.dirty[1]&66592|n.$$.dirty[2]&16&&x&&a&&j&&le&&x.flyTo(a.center,_t(a)),n.$$.dirty[1]&8192&&t(68,o=G==="full-geometry-including-polygon-center-marker"),n.$$.dirty[1]&132096|n.$$.dirty[2]&64&&(q||x==null||x.setFeatures(void 0,void 0,o)),n.$$.dirty[0]&16384|n.$$.dirty[1]&132096|n.$$.dirty[2]&84&&x&&q&&!Ee&&(x.setFeatures(a?[a]:void 0,pe,o),x.setSelectedMarker(a?0:-1)),n.$$.dirty[0]&16384|n.$$.dirty[1]&1024|n.$$.dirty[2]&68&&x&&x.setFeatures(Ee,pe,o),n.$$.dirty[0]&32768|n.$$.dirty[1]&1024|n.$$.dirty[2]&4&&Ee&&x&&x.setSelectedMarker(me),n.$$.dirty[0]&2|n.$$.dirty[1]&1024&&x){const ce=yt(R);x.setReverseMarker(ce?[ce.decimalLongitude,ce.decimalLatitude]:void 0)}n.$$.dirty[2]&16&&Je("select",{feature:a}),n.$$.dirty[0]&16384&&Je("pick",{feature:pe}),n.$$.dirty[0]&73744&&t(67,s=!!(ke!=null&&ke.length)&&(Oe||$)),n.$$.dirty[2]&32&&Je("optionsvisibilitychange",{optionsVisible:s}),n.$$.dirty[0]&8192&&Je("featureslisted",{features:ke}),n.$$.dirty[2]&4&&Je("featuresmarked",{features:Ee}),n.$$.dirty[0]&1&&Je("reversetoggle",{reverse:E}),n.$$.dirty[0]&2&&Je("querychange",{query:R}),n.$$.dirty[0]&1|n.$$.dirty[1]&1024&&x&&x.indicateReverse(E)},[E,R,f,C,$,P,O,D,F,S,L,J,se,ke,pe,me,Oe,Be,Te,Me,Le,We,tt,et,pt,Mt,Ct,ht,v,b,m,B,T,y,w,N,j,z,d,g,k,x,A,I,G,H,X,le,q,ee,K,V,te,ie,ne,ae,_e,fe,oe,ye,he,xe,Se,De,Ee,Ze,a,s,o,i,l,Gt,Dt,sr,an,pr,wr,xr,Cr,sn,Gr,Nn,$r,Xn]}let ev=class extends Rn{constructor(n){super(),In(this,n,Yf,Xf,Tn,{ZOOM_DEFAULTS:28,class:2,apiKey:29,bbox:30,clearButtonTitle:3,clearOnBlur:31,clearListOnPick:32,keepListOpen:4,collapsed:5,country:33,debounceSearch:34,enableReverse:6,errorMessage:7,filter:35,flyTo:36,fuzzyMatch:37,language:38,limit:39,reverseGeocodingLimit:40,mapController:41,minLength:42,noResultsMessage:8,placeholder:9,proximity:43,reverseActive:0,reverseButtonTitle:10,searchValue:1,pickedResultStyle:44,showPlaceType:11,showResultsWhileTyping:45,selectFirst:46,flyToSelected:47,markerOnSelected:48,types:49,reverseGeocodingTypes:50,exhaustiveReverseGeocoding:51,excludeTypes:52,reverseGeocodingExcludeTypes:53,zoom:54,apiUrl:55,fetchParameters:56,iconsBaseUrl:12,adjustUrlQuery:57,adjustUrl:58,focus:59,blur:60,setQuery:61,clearList:62,clearMap:63},null,[-1,-1,-1,-1])}get ZOOM_DEFAULTS(){return this.$$.ctx[28]}get focus(){return this.$$.ctx[59]}get blur(){return this.$$.ctx[60]}get setQuery(){return this.$$.ctx[61]}get clearList(){return this.$$.ctx[62]}get clearMap(){return this.$$.ctx[63]}};function sa(n,e,t={}){const o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=e||{},o.geometry=n,o}function ts(n,e,t={}){for(const o of n){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return sa({type:"Polygon",coordinates:n},e,t)}function la(n,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function Yl(n,e,t={}){return sa({type:"MultiPolygon",coordinates:n},e,t)}var tv=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,vi=Math.ceil,Or=Math.floor,kr="[BigNumber Error] ",Os=kr+"Number primitive has more than 15 significant digits: ",Wr=1e14,Ye=14,js=9007199254740991,gi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],$n=1e7,Pr=1e9;function eu(n){var e,t,o,a=w.prototype={constructor:w,toString:null,valueOf:null},s=new w(1),l=20,i=4,v=-7,f=21,b=-1e7,m=1e7,C=!1,B=1,T=0,$={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},P="0123456789abcdefghijklmnopqrstuvwxyz",y=!0;function w(d,g){var p,k,x,A,F,S,I,E,L=this;if(!(L instanceof w))return new w(d,g);if(g==null){if(d&&d._isBigNumber===!0){L.s=d.s,!d.c||d.e>m?L.c=L.e=null:d.e<b?L.c=[L.e=0]:(L.e=d.e,L.c=d.c.slice());return}if((S=typeof d=="number")&&d*0==0){if(L.s=1/d<0?(d=-d,-1):1,d===~~d){for(A=0,F=d;F>=10;F/=10,A++);A>m?L.c=L.e=null:(L.e=A,L.c=[d]);return}E=String(d)}else{if(!tv.test(E=String(d)))return o(L,E,S);L.s=E.charCodeAt(0)==45?(E=E.slice(1),-1):1}(A=E.indexOf("."))>-1&&(E=E.replace(".","")),(F=E.search(/e/i))>0?(A<0&&(A=F),A+=+E.slice(F+1),E=E.substring(0,F)):A<0&&(A=E.length)}else{if(Ht(g,2,P.length,"Base"),g==10&&y)return L=new w(d),j(L,l+L.e+1,i);if(E=String(d),S=typeof d=="number"){if(d*0!=0)return o(L,E,S,g);if(L.s=1/d<0?(E=E.slice(1),-1):1,w.DEBUG&&E.replace(/^0\.0*|\./,"").length>15)throw Error(Os+d)}else L.s=E.charCodeAt(0)===45?(E=E.slice(1),-1):1;for(p=P.slice(0,g),A=F=0,I=E.length;F<I;F++)if(p.indexOf(k=E.charAt(F))<0){if(k=="."){if(F>A){A=I;continue}}else if(!x&&(E==E.toUpperCase()&&(E=E.toLowerCase())||E==E.toLowerCase()&&(E=E.toUpperCase()))){x=!0,F=-1,A=0;continue}return o(L,String(d),S,g)}S=!1,E=t(E,g,10,L.s),(A=E.indexOf("."))>-1?E=E.replace(".",""):A=E.length}for(F=0;E.charCodeAt(F)===48;F++);for(I=E.length;E.charCodeAt(--I)===48;);if(E=E.slice(F,++I)){if(I-=F,S&&w.DEBUG&&I>15&&(d>js||d!==Or(d)))throw Error(Os+L.s*d);if((A=A-F-1)>m)L.c=L.e=null;else if(A<b)L.c=[L.e=0];else{if(L.e=A,L.c=[],F=(A+1)%Ye,A<0&&(F+=Ye),F<I){for(F&&L.c.push(+E.slice(0,F)),I-=Ye;F<I;)L.c.push(+E.slice(F,F+=Ye));F=Ye-(E=E.slice(F)).length}else F-=I;for(;F--;E+="0");L.c.push(+E)}}else L.c=[L.e=0]}w.clone=eu,w.ROUND_UP=0,w.ROUND_DOWN=1,w.ROUND_CEIL=2,w.ROUND_FLOOR=3,w.ROUND_HALF_UP=4,w.ROUND_HALF_DOWN=5,w.ROUND_HALF_EVEN=6,w.ROUND_HALF_CEIL=7,w.ROUND_HALF_FLOOR=8,w.EUCLID=9,w.config=w.set=function(d){var g,p;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(g="DECIMAL_PLACES")&&(p=d[g],Ht(p,0,Pr,g),l=p),d.hasOwnProperty(g="ROUNDING_MODE")&&(p=d[g],Ht(p,0,8,g),i=p),d.hasOwnProperty(g="EXPONENTIAL_AT")&&(p=d[g],p&&p.pop?(Ht(p[0],-1e9,0,g),Ht(p[1],0,Pr,g),v=p[0],f=p[1]):(Ht(p,-1e9,Pr,g),v=-(f=p<0?-p:p))),d.hasOwnProperty(g="RANGE"))if(p=d[g],p&&p.pop)Ht(p[0],-1e9,-1,g),Ht(p[1],1,Pr,g),b=p[0],m=p[1];else if(Ht(p,-1e9,Pr,g),p)b=-(m=p<0?-p:p);else throw Error(kr+g+" cannot be zero: "+p);if(d.hasOwnProperty(g="CRYPTO"))if(p=d[g],p===!!p)if(p)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))C=p;else throw C=!p,Error(kr+"crypto unavailable");else C=p;else throw Error(kr+g+" not true or false: "+p);if(d.hasOwnProperty(g="MODULO_MODE")&&(p=d[g],Ht(p,0,9,g),B=p),d.hasOwnProperty(g="POW_PRECISION")&&(p=d[g],Ht(p,0,Pr,g),T=p),d.hasOwnProperty(g="FORMAT"))if(p=d[g],typeof p=="object")$=p;else throw Error(kr+g+" not an object: "+p);if(d.hasOwnProperty(g="ALPHABET"))if(p=d[g],typeof p=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(p))y=p.slice(0,10)=="0123456789",P=p;else throw Error(kr+g+" invalid: "+p)}else throw Error(kr+"Object expected: "+d);return{DECIMAL_PLACES:l,ROUNDING_MODE:i,EXPONENTIAL_AT:[v,f],RANGE:[b,m],CRYPTO:C,MODULO_MODE:B,POW_PRECISION:T,FORMAT:$,ALPHABET:P}},w.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!w.DEBUG)return!0;var g,p,k=d.c,x=d.e,A=d.s;e:if({}.toString.call(k)=="[object Array]"){if((A===1||A===-1)&&x>=-1e9&&x<=Pr&&x===Or(x)){if(k[0]===0){if(x===0&&k.length===1)return!0;break e}if(g=(x+1)%Ye,g<1&&(g+=Ye),String(k[0]).length==g){for(g=0;g<k.length;g++)if(p=k[g],p<0||p>=Wr||p!==Or(p))break e;if(p!==0)return!0}}}else if(k===null&&x===null&&(A===null||A===1||A===-1))return!0;throw Error(kr+"Invalid BigNumber: "+d)},w.maximum=w.max=function(){return D(arguments,-1)},w.minimum=w.min=function(){return D(arguments,1)},w.random=(function(){var d=9007199254740992,g=Math.random()*d&2097151?function(){return Or(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(p){var k,x,A,F,S,I=0,E=[],L=new w(s);if(p==null?p=l:Ht(p,0,Pr),F=vi(p/Ye),C)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(F*=2));I<F;)S=k[I]*131072+(k[I+1]>>>11),S>=9e15?(x=crypto.getRandomValues(new Uint32Array(2)),k[I]=x[0],k[I+1]=x[1]):(E.push(S%1e14),I+=2);I=F/2}else if(crypto.randomBytes){for(k=crypto.randomBytes(F*=7);I<F;)S=(k[I]&31)*281474976710656+k[I+1]*1099511627776+k[I+2]*4294967296+k[I+3]*16777216+(k[I+4]<<16)+(k[I+5]<<8)+k[I+6],S>=9e15?crypto.randomBytes(7).copy(k,I):(E.push(S%1e14),I+=7);I=F/7}else throw C=!1,Error(kr+"crypto unavailable");if(!C)for(;I<F;)S=g(),S<9e15&&(E[I++]=S%1e14);for(F=E[--I],p%=Ye,F&&p&&(S=gi[Ye-p],E[I]=Or(F/S)*S);E[I]===0;E.pop(),I--);if(I<0)E=[A=0];else{for(A=-1;E[0]===0;E.splice(0,1),A-=Ye);for(I=1,S=E[0];S>=10;S/=10,I++);I<Ye&&(A-=Ye-I)}return L.e=A,L.c=E,L}})(),w.sum=function(){for(var d=1,g=arguments,p=new w(g[0]);d<g.length;)p=p.plus(g[d++]);return p},t=(function(){var d="0123456789";function g(p,k,x,A){for(var F,S=[0],I,E=0,L=p.length;E<L;){for(I=S.length;I--;S[I]*=k);for(S[0]+=A.indexOf(p.charAt(E++)),F=0;F<S.length;F++)S[F]>x-1&&(S[F+1]==null&&(S[F+1]=0),S[F+1]+=S[F]/x|0,S[F]%=x)}return S.reverse()}return function(p,k,x,A,F){var S,I,E,L,R,G,J,H,X=p.indexOf("."),le=l,q=i;for(X>=0&&(L=T,T=0,p=p.replace(".",""),H=new w(k),G=H.pow(p.length-X),T=L,H.c=g(cn(Fr(G.c),G.e,"0"),10,x,d),H.e=H.c.length),J=g(p,k,x,F?(S=P,d):(S=d,P)),E=L=J.length;J[--L]==0;J.pop());if(!J[0])return S.charAt(0);if(X<0?--E:(G.c=J,G.e=E,G.s=A,G=e(G,H,le,q,x),J=G.c,R=G.r,E=G.e),I=E+le+1,X=J[I],L=x/2,R=R||I<0||J[I+1]!=null,R=q<4?(X!=null||R)&&(q==0||q==(G.s<0?3:2)):X>L||X==L&&(q==4||R||q==6&&J[I-1]&1||q==(G.s<0?8:7)),I<1||!J[0])p=R?cn(S.charAt(1),-le,S.charAt(0)):S.charAt(0);else{if(J.length=I,R)for(--x;++J[--I]>x;)J[I]=0,I||(++E,J=[1].concat(J));for(L=J.length;!J[--L];);for(X=0,p="";X<=L;p+=S.charAt(J[X++]));p=cn(p,E,S.charAt(0))}return p}})(),e=(function(){function d(k,x,A){var F,S,I,E,L=0,R=k.length,G=x%$n,J=x/$n|0;for(k=k.slice();R--;)I=k[R]%$n,E=k[R]/$n|0,F=J*I+E*G,S=G*I+F%$n*$n+L,L=(S/A|0)+(F/$n|0)+J*E,k[R]=S%A;return L&&(k=[L].concat(k)),k}function g(k,x,A,F){var S,I;if(A!=F)I=A>F?1:-1;else for(S=I=0;S<A;S++)if(k[S]!=x[S]){I=k[S]>x[S]?1:-1;break}return I}function p(k,x,A,F){for(var S=0;A--;)k[A]-=S,S=k[A]<x[A]?1:0,k[A]=S*F+k[A]-x[A];for(;!k[0]&&k.length>1;k.splice(0,1));}return function(k,x,A,F,S){var I,E,L,R,G,J,H,X,le,q,ee,ue,K,V,te,re,ie,ne=k.s==x.s?1:-1,ae=k.c,_e=x.c;if(!ae||!ae[0]||!_e||!_e[0])return new w(!k.s||!x.s||(ae?_e&&ae[0]==_e[0]:!_e)?NaN:ae&&ae[0]==0||!_e?ne*0:ne/0);for(X=new w(ne),le=X.c=[],E=k.e-x.e,ne=A+E+1,S||(S=Wr,E=jr(k.e/Ye)-jr(x.e/Ye),ne=ne/Ye|0),L=0;_e[L]==(ae[L]||0);L++);if(_e[L]>(ae[L]||0)&&E--,ne<0)le.push(1),R=!0;else{for(V=ae.length,re=_e.length,L=0,ne+=2,G=Or(S/(_e[0]+1)),G>1&&(_e=d(_e,G,S),ae=d(ae,G,S),re=_e.length,V=ae.length),K=re,q=ae.slice(0,re),ee=q.length;ee<re;q[ee++]=0);ie=_e.slice(),ie=[0].concat(ie),te=_e[0],_e[1]>=S/2&&te++;do{if(G=0,I=g(_e,q,re,ee),I<0){if(ue=q[0],re!=ee&&(ue=ue*S+(q[1]||0)),G=Or(ue/te),G>1)for(G>=S&&(G=S-1),J=d(_e,G,S),H=J.length,ee=q.length;g(J,q,H,ee)==1;)G--,p(J,re<H?ie:_e,H,S),H=J.length,I=1;else G==0&&(I=G=1),J=_e.slice(),H=J.length;if(H<ee&&(J=[0].concat(J)),p(q,J,ee,S),ee=q.length,I==-1)for(;g(_e,q,re,ee)<1;)G++,p(q,re<ee?ie:_e,ee,S),ee=q.length}else I===0&&(G++,q=[0]);le[L++]=G,q[0]?q[ee++]=ae[K]||0:(q=[ae[K]],ee=1)}while((K++<V||q[0]!=null)&&ne--);R=q[0]!=null,le[0]||le.splice(0,1)}if(S==Wr){for(L=1,ne=le[0];ne>=10;ne/=10,L++);j(X,A+(X.e=L+E*Ye-1)+1,F,R)}else X.e=E,X.r=+R;return X}})();function O(d,g,p,k){var x,A,F,S,I;if(p==null?p=i:Ht(p,0,8),!d.c)return d.toString();if(x=d.c[0],F=d.e,g==null)I=Fr(d.c),I=k==1||k==2&&(F<=v||F>=f)?ka(I,F):cn(I,F,"0");else if(d=j(new w(d),g,p),A=d.e,I=Fr(d.c),S=I.length,k==1||k==2&&(g<=A||A<=v)){for(;S<g;I+="0",S++);I=ka(I,A)}else if(g-=F,I=cn(I,A,"0"),A+1>S){if(--g>0)for(I+=".";g--;I+="0");}else if(g+=A-S,g>0)for(A+1==S&&(I+=".");g--;I+="0");return d.s<0&&x?"-"+I:I}function D(d,g){for(var p,k,x=1,A=new w(d[0]);x<d.length;x++)k=new w(d[x]),(!k.s||(p=Dn(A,k))===g||p===0&&A.s===g)&&(A=k);return A}function N(d,g,p){for(var k=1,x=g.length;!g[--x];g.pop());for(x=g[0];x>=10;x/=10,k++);return(p=k+p*Ye-1)>m?d.c=d.e=null:p<b?d.c=[d.e=0]:(d.e=p,d.c=g),d}o=(function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,g=/^([^.]+)\.$/,p=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(A,F,S,I){var E,L=S?F:F.replace(x,"");if(k.test(L))A.s=isNaN(L)?null:L<0?-1:1;else{if(!S&&(L=L.replace(d,function(R,G,J){return E=(J=J.toLowerCase())=="x"?16:J=="b"?2:8,!I||I==E?G:R}),I&&(E=I,L=L.replace(g,"$1").replace(p,"0.$1")),F!=L))return new w(L,E);if(w.DEBUG)throw Error(kr+"Not a"+(I?" base "+I:"")+" number: "+F);A.s=null}A.c=A.e=null}})();function j(d,g,p,k){var x,A,F,S,I,E,L,R=d.c,G=gi;if(R){e:{for(x=1,S=R[0];S>=10;S/=10,x++);if(A=g-x,A<0)A+=Ye,F=g,I=R[E=0],L=Or(I/G[x-F-1]%10);else if(E=vi((A+1)/Ye),E>=R.length)if(k){for(;R.length<=E;R.push(0));I=L=0,x=1,A%=Ye,F=A-Ye+1}else break e;else{for(I=S=R[E],x=1;S>=10;S/=10,x++);A%=Ye,F=A-Ye+x,L=F<0?0:Or(I/G[x-F-1]%10)}if(k=k||g<0||R[E+1]!=null||(F<0?I:I%G[x-F-1]),k=p<4?(L||k)&&(p==0||p==(d.s<0?3:2)):L>5||L==5&&(p==4||k||p==6&&(A>0?F>0?I/G[x-F]:0:R[E-1])%10&1||p==(d.s<0?8:7)),g<1||!R[0])return R.length=0,k?(g-=d.e+1,R[0]=G[(Ye-g%Ye)%Ye],d.e=-g||0):R[0]=d.e=0,d;if(A==0?(R.length=E,S=1,E--):(R.length=E+1,S=G[Ye-A],R[E]=F>0?Or(I/G[x-F]%G[F])*S:0),k)for(;;)if(E==0){for(A=1,F=R[0];F>=10;F/=10,A++);for(F=R[0]+=S,S=1;F>=10;F/=10,S++);A!=S&&(d.e++,R[0]==Wr&&(R[0]=1));break}else{if(R[E]+=S,R[E]!=Wr)break;R[E--]=0,S=1}for(A=R.length;R[--A]===0;R.pop());}d.e>m?d.c=d.e=null:d.e<b&&(d.c=[d.e=0])}return d}function z(d){var g,p=d.e;return p===null?d.toString():(g=Fr(d.c),g=p<=v||p>=f?ka(g,p):cn(g,p,"0"),d.s<0?"-"+g:g)}return a.absoluteValue=a.abs=function(){var d=new w(this);return d.s<0&&(d.s=1),d},a.comparedTo=function(d,g){return Dn(this,new w(d,g))},a.decimalPlaces=a.dp=function(d,g){var p,k,x,A=this;if(d!=null)return Ht(d,0,Pr),g==null?g=i:Ht(g,0,8),j(new w(A),d+A.e+1,g);if(!(p=A.c))return null;if(k=((x=p.length-1)-jr(this.e/Ye))*Ye,x=p[x])for(;x%10==0;x/=10,k--);return k<0&&(k=0),k},a.dividedBy=a.div=function(d,g){return e(this,new w(d,g),l,i)},a.dividedToIntegerBy=a.idiv=function(d,g){return e(this,new w(d,g),0,1)},a.exponentiatedBy=a.pow=function(d,g){var p,k,x,A,F,S,I,E,L,R=this;if(d=new w(d),d.c&&!d.isInteger())throw Error(kr+"Exponent not an integer: "+z(d));if(g!=null&&(g=new w(g)),S=d.e>14,!R.c||!R.c[0]||R.c[0]==1&&!R.e&&R.c.length==1||!d.c||!d.c[0])return L=new w(Math.pow(+z(R),S?d.s*(2-$a(d)):+z(d))),g?L.mod(g):L;if(I=d.s<0,g){if(g.c?!g.c[0]:!g.s)return new w(NaN);k=!I&&R.isInteger()&&g.isInteger(),k&&(R=R.mod(g))}else{if(d.e>9&&(R.e>0||R.e<-1||(R.e==0?R.c[0]>1||S&&R.c[1]>=24e7:R.c[0]<8e13||S&&R.c[0]<=9999975e7)))return A=R.s<0&&$a(d)?-0:0,R.e>-1&&(A=1/A),new w(I?1/A:A);T&&(A=vi(T/Ye+2))}for(S?(p=new w(.5),I&&(d.s=1),E=$a(d)):(x=Math.abs(+z(d)),E=x%2),L=new w(s);;){if(E){if(L=L.times(R),!L.c)break;A?L.c.length>A&&(L.c.length=A):k&&(L=L.mod(g))}if(x){if(x=Or(x/2),x===0)break;E=x%2}else if(d=d.times(p),j(d,d.e+1,1),d.e>14)E=$a(d);else{if(x=+z(d),x===0)break;E=x%2}R=R.times(R),A?R.c&&R.c.length>A&&(R.c.length=A):k&&(R=R.mod(g))}return k?L:(I&&(L=s.div(L)),g?L.mod(g):A?j(L,T,i,F):L)},a.integerValue=function(d){var g=new w(this);return d==null?d=i:Ht(d,0,8),j(g,g.e+1,d)},a.isEqualTo=a.eq=function(d,g){return Dn(this,new w(d,g))===0},a.isFinite=function(){return!!this.c},a.isGreaterThan=a.gt=function(d,g){return Dn(this,new w(d,g))>0},a.isGreaterThanOrEqualTo=a.gte=function(d,g){return(g=Dn(this,new w(d,g)))===1||g===0},a.isInteger=function(){return!!this.c&&jr(this.e/Ye)>this.c.length-2},a.isLessThan=a.lt=function(d,g){return Dn(this,new w(d,g))<0},a.isLessThanOrEqualTo=a.lte=function(d,g){return(g=Dn(this,new w(d,g)))===-1||g===0},a.isNaN=function(){return!this.s},a.isNegative=function(){return this.s<0},a.isPositive=function(){return this.s>0},a.isZero=function(){return!!this.c&&this.c[0]==0},a.minus=function(d,g){var p,k,x,A,F=this,S=F.s;if(d=new w(d,g),g=d.s,!S||!g)return new w(NaN);if(S!=g)return d.s=-g,F.plus(d);var I=F.e/Ye,E=d.e/Ye,L=F.c,R=d.c;if(!I||!E){if(!L||!R)return L?(d.s=-g,d):new w(R?F:NaN);if(!L[0]||!R[0])return R[0]?(d.s=-g,d):new w(L[0]?F:i==3?-0:0)}if(I=jr(I),E=jr(E),L=L.slice(),S=I-E){for((A=S<0)?(S=-S,x=L):(E=I,x=R),x.reverse(),g=S;g--;x.push(0));x.reverse()}else for(k=(A=(S=L.length)<(g=R.length))?S:g,S=g=0;g<k;g++)if(L[g]!=R[g]){A=L[g]<R[g];break}if(A&&(x=L,L=R,R=x,d.s=-d.s),g=(k=R.length)-(p=L.length),g>0)for(;g--;L[p++]=0);for(g=Wr-1;k>S;){if(L[--k]<R[k]){for(p=k;p&&!L[--p];L[p]=g);--L[p],L[k]+=Wr}L[k]-=R[k]}for(;L[0]==0;L.splice(0,1),--E);return L[0]?N(d,L,E):(d.s=i==3?-1:1,d.c=[d.e=0],d)},a.modulo=a.mod=function(d,g){var p,k,x=this;return d=new w(d,g),!x.c||!d.s||d.c&&!d.c[0]?new w(NaN):!d.c||x.c&&!x.c[0]?new w(x):(B==9?(k=d.s,d.s=1,p=e(x,d,0,3),d.s=k,p.s*=k):p=e(x,d,0,B),d=x.minus(p.times(d)),!d.c[0]&&B==1&&(d.s=x.s),d)},a.multipliedBy=a.times=function(d,g){var p,k,x,A,F,S,I,E,L,R,G,J,H,X,le,q=this,ee=q.c,ue=(d=new w(d,g)).c;if(!ee||!ue||!ee[0]||!ue[0])return!q.s||!d.s||ee&&!ee[0]&&!ue||ue&&!ue[0]&&!ee?d.c=d.e=d.s=null:(d.s*=q.s,!ee||!ue?d.c=d.e=null:(d.c=[0],d.e=0)),d;for(k=jr(q.e/Ye)+jr(d.e/Ye),d.s*=q.s,I=ee.length,R=ue.length,I<R&&(H=ee,ee=ue,ue=H,x=I,I=R,R=x),x=I+R,H=[];x--;H.push(0));for(X=Wr,le=$n,x=R;--x>=0;){for(p=0,G=ue[x]%le,J=ue[x]/le|0,F=I,A=x+F;A>x;)E=ee[--F]%le,L=ee[F]/le|0,S=J*E+L*G,E=G*E+S%le*le+H[A]+p,p=(E/X|0)+(S/le|0)+J*L,H[A--]=E%X;H[A]=p}return p?++k:H.splice(0,1),N(d,H,k)},a.negated=function(){var d=new w(this);return d.s=-d.s||null,d},a.plus=function(d,g){var p,k=this,x=k.s;if(d=new w(d,g),g=d.s,!x||!g)return new w(NaN);if(x!=g)return d.s=-g,k.minus(d);var A=k.e/Ye,F=d.e/Ye,S=k.c,I=d.c;if(!A||!F){if(!S||!I)return new w(x/0);if(!S[0]||!I[0])return I[0]?d:new w(S[0]?k:x*0)}if(A=jr(A),F=jr(F),S=S.slice(),x=A-F){for(x>0?(F=A,p=I):(x=-x,p=S),p.reverse();x--;p.push(0));p.reverse()}for(x=S.length,g=I.length,x-g<0&&(p=I,I=S,S=p,g=x),x=0;g;)x=(S[--g]=S[g]+I[g]+x)/Wr|0,S[g]=Wr===S[g]?0:S[g]%Wr;return x&&(S=[x].concat(S),++F),N(d,S,F)},a.precision=a.sd=function(d,g){var p,k,x,A=this;if(d!=null&&d!==!!d)return Ht(d,1,Pr),g==null?g=i:Ht(g,0,8),j(new w(A),d,g);if(!(p=A.c))return null;if(x=p.length-1,k=x*Ye+1,x=p[x]){for(;x%10==0;x/=10,k--);for(x=p[0];x>=10;x/=10,k++);}return d&&A.e+1>k&&(k=A.e+1),k},a.shiftedBy=function(d){return Ht(d,-9007199254740991,js),this.times("1e"+d)},a.squareRoot=a.sqrt=function(){var d,g,p,k,x,A=this,F=A.c,S=A.s,I=A.e,E=l+4,L=new w("0.5");if(S!==1||!F||!F[0])return new w(!S||S<0&&(!F||F[0])?NaN:F?A:1/0);if(S=Math.sqrt(+z(A)),S==0||S==1/0?(g=Fr(F),(g.length+I)%2==0&&(g+="0"),S=Math.sqrt(+g),I=jr((I+1)/2)-(I<0||I%2),S==1/0?g="5e"+I:(g=S.toExponential(),g=g.slice(0,g.indexOf("e")+1)+I),p=new w(g)):p=new w(S+""),p.c[0]){for(I=p.e,S=I+E,S<3&&(S=0);;)if(x=p,p=L.times(x.plus(e(A,x,E,1))),Fr(x.c).slice(0,S)===(g=Fr(p.c)).slice(0,S))if(p.e<I&&--S,g=g.slice(S-3,S+1),g=="9999"||!k&&g=="4999"){if(!k&&(j(x,x.e+l+2,0),x.times(x).eq(A))){p=x;break}E+=4,S+=4,k=1}else{(!+g||!+g.slice(1)&&g.charAt(0)=="5")&&(j(p,p.e+l+2,1),d=!p.times(p).eq(A));break}}return j(p,p.e+l+1,i,d)},a.toExponential=function(d,g){return d!=null&&(Ht(d,0,Pr),d++),O(this,d,g,1)},a.toFixed=function(d,g){return d!=null&&(Ht(d,0,Pr),d=d+this.e+1),O(this,d,g)},a.toFormat=function(d,g,p){var k,x=this;if(p==null)d!=null&&g&&typeof g=="object"?(p=g,g=null):d&&typeof d=="object"?(p=d,d=g=null):p=$;else if(typeof p!="object")throw Error(kr+"Argument not an object: "+p);if(k=x.toFixed(d,g),x.c){var A,F=k.split("."),S=+p.groupSize,I=+p.secondaryGroupSize,E=p.groupSeparator||"",L=F[0],R=F[1],G=x.s<0,J=G?L.slice(1):L,H=J.length;if(I&&(A=S,S=I,I=A,H-=A),S>0&&H>0){for(A=H%S||S,L=J.substr(0,A);A<H;A+=S)L+=E+J.substr(A,S);I>0&&(L+=E+J.slice(A)),G&&(L="-"+L)}k=R?L+(p.decimalSeparator||"")+((I=+p.fractionGroupSize)?R.replace(new RegExp("\\d{"+I+"}\\B","g"),"$&"+(p.fractionGroupSeparator||"")):R):L}return(p.prefix||"")+k+(p.suffix||"")},a.toFraction=function(d){var g,p,k,x,A,F,S,I,E,L,R,G,J=this,H=J.c;if(d!=null&&(S=new w(d),!S.isInteger()&&(S.c||S.s!==1)||S.lt(s)))throw Error(kr+"Argument "+(S.isInteger()?"out of range: ":"not an integer: ")+z(S));if(!H)return new w(J);for(g=new w(s),E=p=new w(s),k=I=new w(s),G=Fr(H),A=g.e=G.length-J.e-1,g.c[0]=gi[(F=A%Ye)<0?Ye+F:F],d=!d||S.comparedTo(g)>0?A>0?g:E:S,F=m,m=1/0,S=new w(G),I.c[0]=0;L=e(S,g,0,1),x=p.plus(L.times(k)),x.comparedTo(d)!=1;)p=k,k=x,E=I.plus(L.times(x=E)),I=x,g=S.minus(L.times(x=g)),S=x;return x=e(d.minus(p),k,0,1),I=I.plus(x.times(E)),p=p.plus(x.times(k)),I.s=E.s=J.s,A=A*2,R=e(E,k,A,i).minus(J).abs().comparedTo(e(I,p,A,i).minus(J).abs())<1?[E,k]:[I,p],m=F,R},a.toNumber=function(){return+z(this)},a.toPrecision=function(d,g){return d!=null&&Ht(d,1,Pr),O(this,d,g,2)},a.toString=function(d){var g,p=this,k=p.s,x=p.e;return x===null?k?(g="Infinity",k<0&&(g="-"+g)):g="NaN":(d==null?g=x<=v||x>=f?ka(Fr(p.c),x):cn(Fr(p.c),x,"0"):d===10&&y?(p=j(new w(p),l+x+1,i),g=cn(Fr(p.c),p.e,"0")):(Ht(d,2,P.length,"Base"),g=t(cn(Fr(p.c),x,"0"),10,d,k,!0)),k<0&&p.c[0]&&(g="-"+g)),g},a.valueOf=a.toJSON=function(){return z(this)},a._isBigNumber=!0,a[Symbol.toStringTag]="BigNumber",a[Symbol.for("nodejs.util.inspect.custom")]=a.valueOf,n!=null&&w.set(n),w}function jr(n){var e=n|0;return n>0||n===e?e:e-1}function Fr(n){for(var e,t,o=1,a=n.length,s=n[0]+"";o<a;){for(e=n[o++]+"",t=Ye-e.length;t--;e="0"+e);s+=e}for(a=s.length;s.charCodeAt(--a)===48;);return s.slice(0,a+1||1)}function Dn(n,e){var t,o,a=n.c,s=e.c,l=n.s,i=e.s,v=n.e,f=e.e;if(!l||!i)return null;if(t=a&&!a[0],o=s&&!s[0],t||o)return t?o?0:-i:l;if(l!=i)return l;if(t=l<0,o=v==f,!a||!s)return o?0:!a^t?1:-1;if(!o)return v>f^t?1:-1;for(i=(v=a.length)<(f=s.length)?v:f,l=0;l<i;l++)if(a[l]!=s[l])return a[l]>s[l]^t?1:-1;return v==f?0:v>f^t?1:-1}function Ht(n,e,t,o){if(n<e||n>t||n!==Or(n))throw Error(kr+(o||"Argument")+(typeof n=="number"?n<e||n>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function $a(n){var e=n.c.length-1;return jr(n.e/Ye)==e&&n.c[e]%2!=0}function ka(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function cn(n,e,t){var o,a;if(e<0){for(a=t+".";++e;a+=t);n=a+n}else if(o=n.length,++e>o){for(a=t,e-=o;--e;a+=t);n+=a}else e<o&&(n=n.slice(0,e)+"."+n.slice(e));return n}var tn=eu(),rv=class{constructor(n){ze(this,"key"),ze(this,"left",null),ze(this,"right",null),this.key=n}},Lo=class extends rv{constructor(n){super(n)}},nv=class{constructor(){ze(this,"size",0),ze(this,"modificationCount",0),ze(this,"splayCount",0)}splay(n){const e=this.root;if(e==null)return this.compare(n,n),-1;let t=null,o=null,a=null,s=null,l=e;const i=this.compare;let v;for(;;)if(v=i(l.key,n),v>0){let f=l.left;if(f==null||(v=i(f.key,n),v>0&&(l.left=f.right,f.right=l,l=f,f=l.left,f==null)))break;t==null?o=l:t.left=l,t=l,l=f}else if(v<0){let f=l.right;if(f==null||(v=i(f.key,n),v<0&&(l.right=f.left,f.left=l,l=f,f=l.right,f==null)))break;a==null?s=l:a.right=l,a=l,l=f}else break;return a!=null&&(a.right=l.left,l.left=s),t!=null&&(t.left=l.right,l.right=o),this.root!==l&&(this.root=l,this.splayCount++),v}splayMin(n){let e=n,t=e.left;for(;t!=null;){const o=t;e.left=o.right,o.right=e,e=o,t=e.left}return e}splayMax(n){let e=n,t=e.right;for(;t!=null;){const o=t;e.right=o.left,o.left=e,e=o,t=e.right}return e}_delete(n){if(this.root==null||this.splay(n)!=0)return null;let e=this.root;const t=e,o=e.left;if(this.size--,o==null)this.root=e.right;else{const a=e.right;e=this.splayMax(o),e.right=a,this.root=e}return this.modificationCount++,t}addNewRoot(n,e){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=n;return}e<0?(n.left=t,n.right=t.right,t.right=null):(n.right=t,n.left=t.left,t.left=null),this.root=n}_first(){const n=this.root;return n==null?null:(this.root=this.splayMin(n),this.root)}_last(){const n=this.root;return n==null?null:(this.root=this.splayMax(n),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(n){return this.validKey(n)&&this.splay(n)==0}defaultCompare(){return(n,e)=>n<e?-1:n>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:n=>{this.root=n},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:n=>{this.splayCount=n},splay:n=>this.splay(n),has:n=>this.has(n)}}},zs,Ds,Ua=class No extends nv{constructor(e,t){super(),ze(this,"root",null),ze(this,"compare"),ze(this,"validKey"),ze(this,zs,"[object Set]"),this.compare=e??this.defaultCompare(),this.validKey=t??(o=>o!=null&&o!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const t of e)this.delete(t)}forEach(e){const t=this[Symbol.iterator]();let o;for(;o=t.next(),!o.done;)e(o.value,o.value,this)}add(e){const t=this.splay(e);return t!=0&&this.addNewRoot(new Lo(e),t),this}addAndReturn(e){const t=this.splay(e);return t!=0&&this.addNewRoot(new Lo(e),t),this.root.key}addAll(e){for(const t of e)this.add(t)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let t=this.root.left;if(t==null)return null;let o=t.right;for(;o!=null;)t=o,o=t.right;return t.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let t=this.root.right;if(t==null)return null;let o=t.left;for(;o!=null;)t=o,o=t.left;return t.key}retainAll(e){const t=new No(this.compare,this.validKey),o=this.modificationCount;for(const a of e){if(o!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(a)&&this.splay(a)==0&&t.add(this.root.key)}t.size!=this.size&&(this.root=t.root,this.size=t.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const t=new No(this.compare,this.validKey);for(const o of this)e.has(o)&&t.add(o);return t}difference(e){const t=new No(this.compare,this.validKey);for(const o of this)e.has(o)||t.add(o);return t}union(e){const t=this.clone();return t.addAll(e),t}clone(){const e=new No(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function t(a,s){let l,i;do{if(l=a.left,i=a.right,l!=null){const v=new Lo(l.key);s.left=v,t(l,v)}if(i!=null){const v=new Lo(i.key);s.right=v,a=i,s=v}}while(i!=null)}const o=new Lo(e.key);return t(e,o),o}toSet(){return this.clone()}entries(){return new av(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Ds=Symbol.iterator,zs=Symbol.toStringTag,Ds)](){return new ov(this.wrap())}},tu=class{constructor(n){ze(this,"tree"),ze(this,"path",new Array),ze(this,"modificationCount",null),ze(this,"splayCount"),this.tree=n,this.splayCount=n.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const n=this.path[this.path.length-1];return this.getValue(n)}rebuildPath(n){this.path.splice(0,this.path.length),this.tree.splay(n),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(n){for(;n!=null;)this.path.push(n),n=n.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let n=this.path[this.path.length-1],e=n.right;if(e!=null){for(;e!=null;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===n;)n=this.path.pop();return this.path.length>0}},ov=class extends tu{getValue(n){return n.key}},av=class extends tu{getValue(n){return[n.key,n.key]}},ru=n=>()=>n,Bi=n=>{const e=n?(t,o)=>o.minus(t).abs().isLessThanOrEqualTo(n):ru(!1);return(t,o)=>e(t,o)?0:t.comparedTo(o)};function iv(n){const e=n?(t,o,a,s,l)=>t.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(o).exponentiatedBy(2).plus(l.minus(a).exponentiatedBy(2)).times(n)):ru(!1);return(t,o,a)=>{const s=t.x,l=t.y,i=a.x,v=a.y,f=l.minus(v).times(o.x.minus(i)).minus(s.minus(i).times(o.y.minus(v)));return e(f,s,l,i,v)?0:f.comparedTo(0)}}var sv=n=>n,lv=n=>{if(n){const e=new Ua(Bi(n)),t=new Ua(Bi(n)),o=(s,l)=>l.addAndReturn(s),a=s=>({x:o(s.x,e),y:o(s.y,t)});return a({x:new tn(0),y:new tn(0)}),a}return sv},Fi=n=>({set:e=>{bn=Fi(e)},reset:()=>Fi(n),compare:Bi(n),snap:lv(n),orient:iv(n)}),bn=Fi(),Co=(n,e)=>n.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(n.ur.x)&&n.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(n.ur.y),Oi=(n,e)=>{if(e.ur.x.isLessThan(n.ll.x)||n.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(n.ll.y)||n.ur.y.isLessThan(e.ll.y))return null;const t=n.ll.x.isLessThan(e.ll.x)?e.ll.x:n.ll.x,o=n.ur.x.isLessThan(e.ur.x)?n.ur.x:e.ur.x,a=n.ll.y.isLessThan(e.ll.y)?e.ll.y:n.ll.y,s=n.ur.y.isLessThan(e.ur.y)?n.ur.y:e.ur.y;return{ll:{x:t,y:a},ur:{x:o,y:s}}},Pa=(n,e)=>n.x.times(e.y).minus(n.y.times(e.x)),nu=(n,e)=>n.x.times(e.x).plus(n.y.times(e.y)),Ga=n=>nu(n,n).sqrt(),uv=(n,e,t)=>{const o={x:e.x.minus(n.x),y:e.y.minus(n.y)},a={x:t.x.minus(n.x),y:t.y.minus(n.y)};return Pa(a,o).div(Ga(a)).div(Ga(o))},cv=(n,e,t)=>{const o={x:e.x.minus(n.x),y:e.y.minus(n.y)},a={x:t.x.minus(n.x),y:t.y.minus(n.y)};return nu(a,o).div(Ga(a)).div(Ga(o))},Us=(n,e,t)=>e.y.isZero()?null:{x:n.x.plus(e.x.div(e.y).times(t.minus(n.y))),y:t},Gs=(n,e,t)=>e.x.isZero()?null:{x:t,y:n.y.plus(e.y.div(e.x).times(t.minus(n.x)))},dv=(n,e,t,o)=>{if(e.x.isZero())return Gs(t,o,n.x);if(o.x.isZero())return Gs(n,e,t.x);if(e.y.isZero())return Us(t,o,n.y);if(o.y.isZero())return Us(n,e,t.y);const a=Pa(e,o);if(a.isZero())return null;const s={x:t.x.minus(n.x),y:t.y.minus(n.y)},l=Pa(s,e).div(a),i=Pa(s,o).div(a),v=n.x.plus(i.times(e.x)),f=t.x.plus(l.times(o.x)),b=n.y.plus(i.times(e.y)),m=t.y.plus(l.times(o.y)),C=v.plus(f).div(2),B=b.plus(m).div(2);return{x:C,y:B}},Xr=class ou{constructor(e,t){ze(this,"point"),ze(this,"isLeft"),ze(this,"segment"),ze(this,"otherSE"),ze(this,"consumedBy"),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}static compare(e,t){const o=ou.comparePoints(e.point,t.point);return o!==0?o:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:Ha.compare(e.segment,t.segment))}static comparePoints(e,t){return e.x.isLessThan(t.x)?-1:e.x.isGreaterThan(t.x)?1:e.y.isLessThan(t.y)?-1:e.y.isGreaterThan(t.y)?1:0}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const t=e.point.events;for(let o=0,a=t.length;o<a;o++){const s=t[o];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let t=0;t<e;t++){const o=this.point.events[t];if(o.segment.consumedBy===void 0)for(let a=t+1;a<e;a++){const s=this.point.events[a];s.consumedBy===void 0&&o.otherSE.point.events===s.otherSE.point.events&&o.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let t=0,o=this.point.events.length;t<o;t++){const a=this.point.events[t];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&e.push(a)}return e}getLeftmostComparator(e){const t=new Map,o=a=>{const s=a.otherSE;t.set(a,{sine:uv(this.point,e.point,s.point),cosine:cv(this.point,e.point,s.point)})};return(a,s)=>{t.has(a)||o(a),t.has(s)||o(s);const{sine:l,cosine:i}=t.get(a),{sine:v,cosine:f}=t.get(s);return l.isGreaterThanOrEqualTo(0)&&v.isGreaterThanOrEqualTo(0)?i.isLessThan(f)?1:i.isGreaterThan(f)?-1:0:l.isLessThan(0)&&v.isLessThan(0)?i.isLessThan(f)?-1:i.isGreaterThan(f)?1:0:v.isLessThan(l)?-1:v.isGreaterThan(l)?1:0}}},fv=class ji{constructor(e){ze(this,"events"),ze(this,"poly"),ze(this,"_isExteriorRing"),ze(this,"_enclosingRing"),this.events=e;for(let t=0,o=e.length;t<o;t++)e[t].segment.ringOut=this;this.poly=null}static factory(e){const t=[];for(let o=0,a=e.length;o<a;o++){const s=e[o];if(!s.isInResult()||s.ringOut)continue;let l=null,i=s.leftSE,v=s.rightSE;const f=[i],b=i.point,m=[];for(;l=i,i=v,f.push(i),i.point!==b;)for(;;){const C=i.getAvailableLinkedEvents();if(C.length===0){const $=f[0].point,P=f[f.length-1].point;throw new Error(`Unable to complete output ring starting at [${$.x}, ${$.y}]. Last matching segment found ends at [${P.x}, ${P.y}].`)}if(C.length===1){v=C[0].otherSE;break}let B=null;for(let $=0,P=m.length;$<P;$++)if(m[$].point===i.point){B=$;break}if(B!==null){const $=m.splice(B)[0],P=f.splice($.index);P.unshift(P[0].otherSE),t.push(new ji(P.reverse()));continue}m.push({index:f.length,point:i.point});const T=i.getLeftmostComparator(l);v=C.sort(T)[0].otherSE;break}t.push(new ji(f))}return t}getGeom(){let e=this.events[0].point;const t=[e];for(let f=1,b=this.events.length-1;f<b;f++){const m=this.events[f].point,C=this.events[f+1].point;bn.orient(m,e,C)!==0&&(t.push(m),e=m)}if(t.length===1)return null;const o=t[0],a=t[1];bn.orient(o,e,a)===0&&t.shift(),t.push(t[0]);const s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:t.length-1,i=this.isExteriorRing()?t.length:-1,v=[];for(let f=l;f!=i;f+=s)v.push([t[f].x.toNumber(),t[f].y.toNumber()]);return v}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var e,t;let o=this.events[0];for(let l=1,i=this.events.length;l<i;l++){const v=this.events[l];Xr.compare(o,v)>0&&(o=v)}let a=o.segment.prevInResult(),s=a?a.prevInResult():null;for(;;){if(!a)return null;if(!s)return a.ringOut;if(s.ringOut!==a.ringOut)return((e=s.ringOut)==null?void 0:e.enclosingRing())!==a.ringOut?a.ringOut:(t=a.ringOut)==null?void 0:t.enclosingRing();a=s.prevInResult(),s=a?a.prevInResult():null}}},Ws=class{constructor(n){ze(this,"exteriorRing"),ze(this,"interiorRings"),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}addInterior(n){this.interiorRings.push(n),n.poly=this}getGeom(){const n=this.exteriorRing.getGeom();if(n===null)return null;const e=[n];for(let t=0,o=this.interiorRings.length;t<o;t++){const a=this.interiorRings[t].getGeom();a!==null&&e.push(a)}return e}},vv=class{constructor(n){ze(this,"rings"),ze(this,"polys"),this.rings=n,this.polys=this._composePolys(n)}getGeom(){const n=[];for(let e=0,t=this.polys.length;e<t;e++){const o=this.polys[e].getGeom();o!==null&&n.push(o)}return n}_composePolys(n){var e;const t=[];for(let o=0,a=n.length;o<a;o++){const s=n[o];if(!s.poly)if(s.isExteriorRing())t.push(new Ws(s));else{const l=s.enclosingRing();l!=null&&l.poly||t.push(new Ws(l)),(e=l?.poly)==null||e.addInterior(s)}}return t}},gv=class{constructor(n,e=Ha.compare){ze(this,"queue"),ze(this,"tree"),ze(this,"segments"),this.queue=n,this.tree=new Ua(e),this.segments=[]}process(n){const e=n.segment,t=[];if(n.consumedBy)return n.isLeft?this.queue.delete(n.otherSE):this.tree.delete(e),t;n.isLeft&&this.tree.add(e);let o=e,a=e;do o=this.tree.lastBefore(o);while(o!=null&&o.consumedBy!=null);do a=this.tree.firstAfter(a);while(a!=null&&a.consumedBy!=null);if(n.isLeft){let s=null;if(o){const i=o.getIntersection(e);if(i!==null&&(e.isAnEndpoint(i)||(s=i),!o.isAnEndpoint(i))){const v=this._splitSafely(o,i);for(let f=0,b=v.length;f<b;f++)t.push(v[f])}}let l=null;if(a){const i=a.getIntersection(e);if(i!==null&&(e.isAnEndpoint(i)||(l=i),!a.isAnEndpoint(i))){const v=this._splitSafely(a,i);for(let f=0,b=v.length;f<b;f++)t.push(v[f])}}if(s!==null||l!==null){let i=null;s===null?i=l:l===null?i=s:i=Xr.comparePoints(s,l)<=0?s:l,this.queue.delete(e.rightSE),t.push(e.rightSE);const v=e.split(i);for(let f=0,b=v.length;f<b;f++)t.push(v[f])}t.length>0?(this.tree.delete(e),t.push(n)):(this.segments.push(e),e.prev=o)}else{if(o&&a){const s=o.getIntersection(a);if(s!==null){if(!o.isAnEndpoint(s)){const l=this._splitSafely(o,s);for(let i=0,v=l.length;i<v;i++)t.push(l[i])}if(!a.isAnEndpoint(s)){const l=this._splitSafely(a,s);for(let i=0,v=l.length;i<v;i++)t.push(l[i])}}}this.tree.delete(e)}return t}_splitSafely(n,e){this.tree.delete(n);const t=n.rightSE;this.queue.delete(t);const o=n.split(e);return o.push(t),n.consumedBy===void 0&&this.tree.add(n),o}},_v=class{constructor(){ze(this,"type"),ze(this,"numMultiPolys")}run(n,e,t){Bo.type=n;const o=[new qs(e,!0)];for(let v=0,f=t.length;v<f;v++)o.push(new qs(t[v],!1));if(Bo.numMultiPolys=o.length,Bo.type==="difference"){const v=o[0];let f=1;for(;f<o.length;)Oi(o[f].bbox,v.bbox)!==null?f++:o.splice(f,1)}if(Bo.type==="intersection")for(let v=0,f=o.length;v<f;v++){const b=o[v];for(let m=v+1,C=o.length;m<C;m++)if(Oi(b.bbox,o[m].bbox)===null)return[]}const a=new Ua(Xr.compare);for(let v=0,f=o.length;v<f;v++){const b=o[v].getSweepEvents();for(let m=0,C=b.length;m<C;m++)a.add(b[m])}const s=new gv(a);let l=null;for(a.size!=0&&(l=a.first(),a.delete(l));l;){const v=s.process(l);for(let f=0,b=v.length;f<b;f++){const m=v[f];m.consumedBy===void 0&&a.add(m)}a.size!=0?(l=a.first(),a.delete(l)):l=null}bn.reset();const i=fv.factory(s.segments);return new vv(i).getGeom()}},Bo=new _v,Wa=Bo,pv=0,Ha=class Ta{constructor(e,t,o,a){ze(this,"id"),ze(this,"leftSE"),ze(this,"rightSE"),ze(this,"rings"),ze(this,"windings"),ze(this,"ringOut"),ze(this,"consumedBy"),ze(this,"prev"),ze(this,"_prevInResult"),ze(this,"_beforeState"),ze(this,"_afterState"),ze(this,"_isInResult"),this.id=++pv,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=o,this.windings=a}static compare(e,t){const o=e.leftSE.point.x,a=t.leftSE.point.x,s=e.rightSE.point.x,l=t.rightSE.point.x;if(l.isLessThan(o))return 1;if(s.isLessThan(a))return-1;const i=e.leftSE.point.y,v=t.leftSE.point.y,f=e.rightSE.point.y,b=t.rightSE.point.y;if(o.isLessThan(a)){if(v.isLessThan(i)&&v.isLessThan(f))return 1;if(v.isGreaterThan(i)&&v.isGreaterThan(f))return-1;const m=e.comparePoint(t.leftSE.point);if(m<0)return 1;if(m>0)return-1;const C=t.comparePoint(e.rightSE.point);return C!==0?C:-1}if(o.isGreaterThan(a)){if(i.isLessThan(v)&&i.isLessThan(b))return-1;if(i.isGreaterThan(v)&&i.isGreaterThan(b))return 1;const m=t.comparePoint(e.leftSE.point);if(m!==0)return m;const C=e.comparePoint(t.rightSE.point);return C<0?1:C>0?-1:1}if(i.isLessThan(v))return-1;if(i.isGreaterThan(v))return 1;if(s.isLessThan(l)){const m=t.comparePoint(e.rightSE.point);if(m!==0)return m}if(s.isGreaterThan(l)){const m=e.comparePoint(t.rightSE.point);if(m<0)return 1;if(m>0)return-1}if(!s.eq(l)){const m=f.minus(i),C=s.minus(o),B=b.minus(v),T=l.minus(a);if(m.isGreaterThan(C)&&B.isLessThan(T))return 1;if(m.isLessThan(C)&&B.isGreaterThan(T))return-1}return s.isGreaterThan(l)?1:s.isLessThan(l)||f.isLessThan(b)?-1:f.isGreaterThan(b)?1:e.id<t.id?-1:e.id>t.id?1:0}static fromRing(e,t,o){let a,s,l;const i=Xr.comparePoints(e,t);if(i<0)a=e,s=t,l=1;else if(i>0)a=t,s=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const v=new Xr(a,!0),f=new Xr(s,!1);return new Ta(v,f,[o],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e.isLessThan(t)?e:t},ur:{x:this.rightSE.point.x,y:e.isGreaterThan(t)?e:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(e){return e.x.eq(this.leftSE.point.x)&&e.y.eq(this.leftSE.point.y)||e.x.eq(this.rightSE.point.x)&&e.y.eq(this.rightSE.point.y)}comparePoint(e){return bn.orient(this.leftSE.point,e,this.rightSE.point)}getIntersection(e){const t=this.bbox(),o=e.bbox(),a=Oi(t,o);if(a===null)return null;const s=this.leftSE.point,l=this.rightSE.point,i=e.leftSE.point,v=e.rightSE.point,f=Co(t,i)&&this.comparePoint(i)===0,b=Co(o,s)&&e.comparePoint(s)===0,m=Co(t,v)&&this.comparePoint(v)===0,C=Co(o,l)&&e.comparePoint(l)===0;if(b&&f)return C&&!m?l:!C&&m?v:null;if(b)return m&&s.x.eq(v.x)&&s.y.eq(v.y)?null:s;if(f)return C&&l.x.eq(i.x)&&l.y.eq(i.y)?null:i;if(C&&m)return null;if(C)return l;if(m)return v;const B=dv(s,this.vector(),i,e.vector());return B===null||!Co(a,B)?null:bn.snap(B)}split(e){const t=[],o=e.events!==void 0,a=new Xr(e,!0),s=new Xr(e,!1),l=this.rightSE;this.replaceRightSE(s),t.push(s),t.push(a);const i=new Ta(a,l,this.rings.slice(),this.windings.slice());return Xr.comparePoints(i.leftSE.point,i.rightSE.point)>0&&i.swapEvents(),Xr.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(a.checkForConsuming(),s.checkForConsuming()),t}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,o=this.windings.length;t<o;t++)this.windings[t]*=-1}consume(e){let t=this,o=e;for(;t.consumedBy;)t=t.consumedBy;for(;o.consumedBy;)o=o.consumedBy;const a=Ta.compare(t,o);if(a!==0){if(a>0){const s=t;t=o,o=s}if(t.prev===o){const s=t;t=o,o=s}for(let s=0,l=o.rings.length;s<l;s++){const i=o.rings[s],v=o.windings[s],f=t.rings.indexOf(i);f===-1?(t.rings.push(i),t.windings.push(v)):t.windings[f]+=v}o.rings=null,o.windings=null,o.consumedBy=t,o.leftSE.consumedBy=t.leftSE,o.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,o=this._afterState.windings,a=this._afterState.multiPolys;for(let i=0,v=this.rings.length;i<v;i++){const f=this.rings[i],b=this.windings[i],m=t.indexOf(f);m===-1?(t.push(f),o.push(b)):o[m]+=b}const s=[],l=[];for(let i=0,v=t.length;i<v;i++){if(o[i]===0)continue;const f=t[i],b=f.poly;if(l.indexOf(b)===-1)if(f.isExterior)s.push(b);else{l.indexOf(b)===-1&&l.push(b);const m=s.indexOf(f.poly);m!==-1&&s.splice(m,1)}}for(let i=0,v=s.length;i<v;i++){const f=s[i].multiPoly;a.indexOf(f)===-1&&a.push(f)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Wa.type){case"union":{const o=e.length===0,a=t.length===0;this._isInResult=o!==a;break}case"intersection":{let o,a;e.length<t.length?(o=e.length,a=t.length):(o=t.length,a=e.length),this._isInResult=a===Wa.numMultiPolys&&o<a;break}case"xor":{const o=Math.abs(e.length-t.length);this._isInResult=o%2===1;break}case"difference":{const o=a=>a.length===1&&a[0].isSubject;this._isInResult=o(e)!==o(t);break}}return this._isInResult}},Hs=class{constructor(n,e,t){if(ze(this,"poly"),ze(this,"isExterior"),ze(this,"segments"),ze(this,"bbox"),!Array.isArray(n)||n.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=t,this.segments=[],typeof n[0][0]!="number"||typeof n[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const o=bn.snap({x:new tn(n[0][0]),y:new tn(n[0][1])});this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};let a=o;for(let s=1,l=n.length;s<l;s++){if(typeof n[s][0]!="number"||typeof n[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=bn.snap({x:new tn(n[s][0]),y:new tn(n[s][1])});i.x.eq(a.x)&&i.y.eq(a.y)||(this.segments.push(Ha.fromRing(a,i,this)),i.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.x),i.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.y),i.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.x),i.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.y),a=i)}(!o.x.eq(a.x)||!o.y.eq(a.y))&&this.segments.push(Ha.fromRing(a,o,this))}getSweepEvents(){const n=[];for(let e=0,t=this.segments.length;e<t;e++){const o=this.segments[e];n.push(o.leftSE),n.push(o.rightSE)}return n}},hv=class{constructor(n,e){if(ze(this,"multiPoly"),ze(this,"exteriorRing"),ze(this,"interiorRings"),ze(this,"bbox"),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Hs(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,o=n.length;t<o;t++){const a=new Hs(n[t],this,!1);a.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=e}getSweepEvents(){const n=this.exteriorRing.getSweepEvents();for(let e=0,t=this.interiorRings.length;e<t;e++){const o=this.interiorRings[e].getSweepEvents();for(let a=0,s=o.length;a<s;a++)n.push(o[a])}return n}},qs=class{constructor(n,e){if(ze(this,"isSubject"),ze(this,"polys"),ze(this,"bbox"),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof n[0][0][0]=="number"&&(n=[n])}catch{}this.polys=[],this.bbox={ll:{x:new tn(Number.POSITIVE_INFINITY),y:new tn(Number.POSITIVE_INFINITY)},ur:{x:new tn(Number.NEGATIVE_INFINITY),y:new tn(Number.NEGATIVE_INFINITY)}};for(let t=0,o=n.length;t<o;t++){const a=new hv(n[t],this);a.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=e}getSweepEvents(){const n=[];for(let e=0,t=this.polys.length;e<t;e++){const o=this.polys[e].getSweepEvents();for(let a=0,s=o.length;a<s;a++)n.push(o[a])}return n}},mv=(n,...e)=>Wa.run("union",n,e),bv=(n,...e)=>Wa.run("difference",n,e);bn.set;function au(n,e,t){if(n!==null)for(var o,a,s,l,i,v,f,b=0,m=0,C,B=n.type,T=B==="FeatureCollection",$=B==="Feature",P=T?n.features.length:1,y=0;y<P;y++){f=T?n.features[y].geometry:$?n.geometry:n,C=f?f.type==="GeometryCollection":!1,i=C?f.geometries.length:1;for(var w=0;w<i;w++){var O=0,D=0;if(l=C?f.geometries[w]:f,l!==null){v=l.coordinates;var N=l.type;switch(b=0,N){case null:break;case"Point":if(e(v,m,y,O,D)===!1)return!1;m++,O++;break;case"LineString":case"MultiPoint":for(o=0;o<v.length;o++){if(e(v[o],m,y,O,D)===!1)return!1;m++,N==="MultiPoint"&&O++}N==="LineString"&&O++;break;case"Polygon":case"MultiLineString":for(o=0;o<v.length;o++){for(a=0;a<v[o].length-b;a++){if(e(v[o][a],m,y,O,D)===!1)return!1;m++}N==="MultiLineString"&&O++,N==="Polygon"&&D++}N==="Polygon"&&O++;break;case"MultiPolygon":for(o=0;o<v.length;o++){for(D=0,a=0;a<v[o].length;a++){for(s=0;s<v[o][a].length-b;s++){if(e(v[o][a][s],m,y,O,D)===!1)return!1;m++}D++}O++}break;case"GeometryCollection":for(o=0;o<l.geometries.length;o++)if(au(l.geometries[o],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function rs(n,e){var t,o,a,s,l,i,v,f,b,m,C=0,B=n.type==="FeatureCollection",T=n.type==="Feature",$=B?n.features.length:1;for(t=0;t<$;t++){for(i=B?n.features[t].geometry:T?n.geometry:n,f=B?n.features[t].properties:T?n.properties:{},b=B?n.features[t].bbox:T?n.bbox:void 0,m=B?n.features[t].id:T?n.id:void 0,v=i?i.type==="GeometryCollection":!1,l=v?i.geometries.length:1,a=0;a<l;a++){if(s=v?i.geometries[a]:i,s===null){if(e(null,C,f,b,m)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,C,f,b,m)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(e(s.geometries[o],C,f,b,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}C++}}function yv(n,e){rs(n,function(t,o,a,s,l){var i=t===null?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return e(sa(t,a,{bbox:s,id:l}),o,0)===!1?!1:void 0}var v;switch(i){case"MultiPoint":v="Point";break;case"MultiLineString":v="LineString";break;case"MultiPolygon":v="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var b=t.coordinates[f],m={type:v,coordinates:b};if(e(sa(m,a),o,f)===!1)return!1}})}function Av(n,e={}){const t=[];if(rs(n,a=>{t.push(a.coordinates)}),t.length<2)throw new Error("Must have at least 2 geometries");const o=mv(t[0],...t.slice(1));return o.length===0?null:o.length===1?ts(o[0],e.properties):Yl(o,e.properties)}var iu=Av;function wv(n,e={}){if(n.bbox!=null&&e.recompute!==!0)return n.bbox;const t=[1/0,1/0,-1/0,-1/0];return au(n,o=>{t[0]>o[0]&&(t[0]=o[0]),t[1]>o[1]&&(t[1]=o[1]),t[2]<o[0]&&(t[2]=o[0]),t[3]<o[1]&&(t[3]=o[1])}),t}var Js=wv;function xv(n){const e=[];if(rs(n,a=>{e.push(a.coordinates)}),e.length<2)throw new Error("Must have at least two features");const t=n.features[0].properties||{},o=bv(e[0],...e.slice(1));return o.length===0?null:o.length===1?ts(o[0],t):Yl(o,t)}var $v=xv;function kv(n){if(!n)throw new Error("geojson is required");var e=[];return yv(n,function(t){e.push(t)}),la(e)}var Sv=kv;function Qs(n,e){const t=$v(la([ts([[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]),n]));if(!t)return;t.properties={isMask:!0};const o=Da(Js(n)),a=(o[2]-o[0])/360/1e3,s=o[0]<-180,l=o[2]>180,i=Sv(n);if(i.features.length>1&&(s||l))for(const v of i.features){const f=Da(Js(v));if(l&&f[0]<-180+a)for(const b of v.geometry.coordinates)for(const m of b)m[0]+=360-a;if(s&&f[2]>180-a)for(const b of v.geometry.coordinates)for(const m of b)m[0]-=360-a}e(la([i.features.length<2?n:iu(i)??n,t]))}const Zs={fill:{paint:{"fill-color":"#000","fill-opacity":.1},filter:["all",["==",["geometry-type"],"Polygon"],["has","isMask"]]},line:{layout:{"line-cap":"square"},paint:{"line-width":["case",["==",["geometry-type"],"Polygon"],2,3],"line-dasharray":[1,1],"line-color":"#3170fe"},filter:["!",["has","isMask"]]}},Sa="mtlr-gc-full-geom",Vs="mtlr-gc-full-geom-fill",Ks="mtlr-gc-full-geom-line";function Ev(n,e,t=!0,o=!0,a={},s={},l=Zs){let i;const v=[];let f,b,m;function C(){if(!n.loaded){n.once("load",C);return}const P=l?l===!0?Zs:l:void 0;if(!(P!=null&&P.fill)&&!(P!=null&&P.line))return;const y=n.getSource(Sa);if(y)y.setData(m??la([]));else if(m)n.addSource(Sa,{type:"geojson",data:m});else return;!n.getLayer(Vs)&&P!=null&&P.fill&&n.addLayer({...P?.fill,id:Vs,type:"fill",source:Sa}),!n.getLayer(Ks)&&P!=null&&P.line&&n.addLayer({...P?.line,id:Ks,type:"line",source:Sa})}function B(P){m=P,C()}n.on("styledata",()=>{setTimeout(()=>{m&&C()})});const T=P=>{i?.({type:"mapClick",coordinates:[P.lngLat.lng,P.lngLat.lat]})};function $(P=!1){if(!e)throw new Error;const y=document.createElement("div");return P&&y.classList.add("marker-interactive"),new Mf({props:{displayIn:"maplibre"},target:y}),new e.Marker({element:y,offset:[1,-13]})}return{setEventHandler(P){P?(i=P,n.on("click",T)):(i=void 0,n.off("click",T))},flyTo(P,y){n.flyTo({center:P,...y?{zoom:y}:{},...a})},fitBounds(P,y,w){n.fitBounds([[P[0],P[1]],[P[2],P[3]]],{padding:y,...w?{maxZoom:w}:{},...s})},indicateReverse(P){n.getCanvasContainer().style.cursor=P?"crosshair":""},setReverseMarker(P){!e||!t||(b?P?b.setLngLat(P):(b.remove(),b=void 0):P&&(t instanceof Function?b=t(n)??void 0:(b=(typeof t=="object"?new e.Marker(t):$()).setLngLat(P).addTo(n),b.getElement().classList.add("marker-reverse"))))},setFeatures(P,y,w){for(const O of v)O.remove();if(v.length=0,B(void 0),!!e){e:if(y){let O=!1;if(y.geometry.type==="GeometryCollection"){const D=y.geometry.geometries.filter(N=>N.type==="Polygon"||N.type==="MultiPolygon");t:if(D.length>0){const N=iu(la(D.map(j=>sa(j))));if(!N)break t;Qs({...y,geometry:N.geometry},B),O=!0}else{const N=y.geometry.geometries.filter(j=>j.type==="LineString"||j.type==="MultiLineString");N.length>0&&(B({...y,geometry:{type:"GeometryCollection",geometries:N}}),O=!0)}}if(!O){if(y.geometry.type==="Polygon"||y.geometry.type==="MultiPolygon")Qs(y,B);else if(y.geometry.type==="LineString"||y.geometry.type==="MultiLineString"){B(y);break e}}if(!w&&!y.geometry.type.endsWith("Point"))break e;if(t instanceof Function){const D=t(n,y);D&&v.push(D)}else t&&v.push(typeof t=="object"?new e.Marker(t):$().setLngLat(y.center).addTo(n))}if(o)for(const O of P??[]){if(O===y)continue;let D;if(o instanceof Function){if(D=o(n,O),!D)continue}else D=(typeof o=="object"?new e.Marker(o):$(!0)).setLngLat(O.center).setPopup(new e.Popup({offset:[1,-27],closeButton:!1,closeOnMove:!0,className:"maptiler-gc-popup"}).setText(O.place_type[0]==="reverse"?O.place_name:O.place_name.replace(/,.*/,""))).addTo(n);const N=D.getElement();N.addEventListener("click",j=>{j.stopPropagation(),i?.({type:"markerClick",id:O.id})}),N.addEventListener("mouseenter",()=>{i?.({type:"markerMouseEnter",id:O.id}),D.togglePopup()}),N.addEventListener("mouseleave",()=>{i?.({type:"markerMouseLeave",id:O.id}),D.togglePopup()}),v.push(D)}}},setSelectedMarker(P){f&&f.getElement().classList.toggle("marker-selected",!1),f=P>-1?v[P]:void 0,f?.getElement().classList.toggle("marker-selected",!0)},getCenterAndZoom(){const P=n.getCenter();return[n.getZoom(),P.lng,P.lat]}}}function Lv(n,e,t){var o,a,s;class l{constructor(y,w){ze(this,"type"),ze(this,"target"),this.type=w,this.target=y}}class i extends l{constructor(y,w){super(y,"select"),ze(this,"feature"),Object.assign(this,w)}}class v extends l{constructor(y,w){super(y,"featureslisted"),ze(this,"features"),this.features=w}}class f extends l{constructor(y,w){super(y,"featuresmarked"),ze(this,"features"),this.features=w}}class b extends l{constructor(y,w){super(y,"optionsvisibilitychange"),ze(this,"optionsVisible"),this.optionsVisible=w}}class m extends l{constructor(y,w){super(y,"pick"),ze(this,"feature"),this.feature=w}}class C extends l{constructor(y,w){super(y,"querychange"),ze(this,"query"),this.query=w}}class B extends l{constructor(y,w,O){super(y,"response"),ze(this,"url"),ze(this,"featureCollection"),this.url=w,this.featureCollection=O}}class T extends l{constructor(y,w){super(y,"reversetoggle"),ze(this,"reverse"),this.reverse=w}}class $ extends n{constructor(y={}){super(),di(this,o),di(this,a),di(this,s),Aa(this,a,y)}onAddInt(y){const w=document.createElement("div");w.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl mapboxgl-ctrl-group";const{marker:O,showResultMarkers:D,flyTo:N,fullGeometryStyle:j,...z}=Xt(this,a),d=typeof N=="boolean"?{}:N,g={mapController:Ev(y,e,O,D,d,d,j),flyTo:N===void 0?!0:!!N,apiKey:"",...z};return g.apiKey||console.warn("No MapTiler Cloud API key was provided, some or all geocoding requests may fail"),Aa(this,o,new ev({target:w,props:g})),Xt(this,o).$on("select",p=>{this.fire(new i(this,p.detail))}),Xt(this,o).$on("pick",p=>{this.fire(new m(this,p.detail.feature))}),Xt(this,o).$on("featureslisted",p=>{this.fire(new v(this,p.detail.features))}),Xt(this,o).$on("featuresmarked",p=>{this.fire(new f(this,p.detail.features))}),Xt(this,o).$on("response",p=>{this.fire(new B(this,p.detail.url,p.detail.featureCollection))}),Xt(this,o).$on("optionsvisibilitychange",p=>{this.fire(new b(this,p.detail.optionsVisible))}),Xt(this,o).$on("reversetoggle",p=>{this.fire(new T(this,p.detail.reverse))}),Xt(this,o).$on("querychange",p=>{this.fire(new C(this,p.detail.query))}),Aa(this,s,w),w}on(y,w){return super.on(y,w)}once(y,w){return super.once(y,w)}off(y,w){return super.off(y,w)}listens(y){return super.listens(y)}setOptions(y){var w;Object.assign(Xt(this,a),y);const{marker:O,showResultMarkers:D,flyTo:N,fullGeometryStyle:j,...z}=Xt(this,a);(w=Xt(this,o))==null||w.$set(z)}setQuery(y,w=!0){var O;(O=Xt(this,o))==null||O.setQuery(y,w)}clearMap(){var y;(y=Xt(this,o))==null||y.clearMap()}clearList(){var y;(y=Xt(this,o))==null||y.clearList()}setReverseMode(y){var w;(w=Xt(this,o))==null||w.$set({reverseActive:y})}focus(y){var w;(w=Xt(this,o))==null||w.focus(y)}blur(){var y;(y=Xt(this,o))==null||y.blur()}onRemove(){var y,w,O;(y=Xt(this,o))==null||y.$destroy(),Aa(this,o,void 0),(O=(w=Xt(this,s))==null?void 0:w.parentNode)==null||O.removeChild(Xt(this,s))}}return o=new WeakMap,a=new WeakMap,s=new WeakMap,{MapLibreBasedGeocodingControl:$,events:{SelectEvent:i,FeaturesListedEvent:v,FeaturesMarkedEvent:f,OptionsVisibilityChangeEvent:b,PickEvent:m,QueryChangeEvent:C,ResponseEvent:B,ReverseToggleEvent:T}}}const{MapLibreBasedGeocodingControl:Cv}=Lv(bi.Evented,gc);class Mv extends Cv{onAdd(e){return super.onAddInt(e)}}function Pv(n,e){Re(e,!0);let t=Ae(void 0),o=["continental_marine","country","major_landform","region","subregion","county","joint_municipality","joint_submunicipality","municipality","municipal_district","locality","neighbourhood","place","postal_code","address","road","poi"];cr(()=>{r(t)&&(e.map?.removeControl(r(t)),Y(t,void 0))}),Qe(()=>{e.map&&e.loaded&&!r(t)&&(Y(t,new Mv({apiKey:Jn,maplibregl:Er,proximity:[{type:"map-center"}],types:o,country:e.country,marker:!0,showResultMarkers:!0,flyToOptions:{duration:1e3},fitBoundsOptions:{duration:1e3}}),!0),e.map.addControl(r(t),"top-left"))}),Ne()}er(["click"]);function pn(n,e,t){let o=["match",n];for(let[a,s]of Object.entries(e))o.push(a),o.push(s);return o.push(t),o}function yr(n,e,t){let o=["step",n];for(let a=1;a<e.length;a++)o.push(t[a-1]),o.push(e[a]);return o.push(t[t.length-1]),o}function nr(){return{type:"FeatureCollection",features:[]}}let Jn="MZEJTanw3WpxRvt7qDfo",Xs=`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${Jn}`;new qc([["Blank",{version:8,sources:{},layers:[],glyphs:Xs}],["Maptiler Streets",`https://api.maptiler.com/maps/streets-v2/style.json?key=${Jn}`],["Maptiler Dataviz",`https://api.maptiler.com/maps/dataviz/style.json?key=${Jn}`],["Maptiler Hybrid",`https://api.maptiler.com/maps/hybrid/style.json?key=${Jn}`],["Maptiler OpenStreetMap",`https://api.maptiler.com/maps/openstreetmap/style.json?key=${Jn}`],["Maptiler OS Open Zoomstack",`https://api.maptiler.com/maps/uk-openzoomstack-light/style.json?key=${Jn}`],["ESRI World Imagery",{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:256,attribution:"ESRI &copy; <a href='http://www.esri.com' target='_blank'>ESRI</a>",minzoom:0,maxzoom:18}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:Xs}]]);var Tv=M('<p><a href="https://nptscot.github.io/manual/#routenetwork" target="_blank"> </a></p>'),Iv=M("<option> </option>"),Rv=M("<select></select>"),Nv=M("<option> </option>"),Bv=M("<select></select>"),Fv=M("<option> </option>"),Ov=M("<select></select>"),jv=M("<option> </option>"),zv=M("<select></select>"),Dv=M("<label><!></label> <label><!></label> <label><!></label> <label><!></label>",1),Uv=M("<tr><th> </th><td> </td><td> </td><td> </td></tr>"),Gv=M("<tr><th> </th><td> </td><td> </td><td> </td></tr>"),Wv=M('<div style="max-width: 30vw; max-height: 60vh; overflow: auto;"><p><!></p> <p><!></p> <p><!></p> <details><summary> </summary> <p> </p> <table><tbody><tr><td></td><th> </th><th> </th><th> </th></tr><!></tbody></table> <p> </p> <table><tbody><tr><td></td><th> </th><th> </th><th> </th></tr><!></tbody></table></details></div>'),Hv=M("<!> <!>",1);function qv(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=Ae(!1),a=Ae("all"),s=Ae("bicycle_go_dutch"),l=Ae("fastest"),i=Ae("flow"),v=[["all","All"],["commute","Commute"],["primary","Primary School"],["secondary","Secondary"],["utility","Other everyday"]],f=[["bicycle","Baseline"],["bicycle_go_dutch","Go Dutch"],["bicycle_ebike","E-bike"]],b=[["fastest","Fast/Direct"],["quietest","Quiet/Indirect"]],m=[["none","None"],["flow","People cycling per day"],["quietness","Cycle friendliness"],["gradient","Gradient"]],C={colorScale:["#59ee19","#37a009","#FFC300","#C70039","#581845","#000000"],limits:[3,5,7,10,100]};function B(D){return["let","base",["+",.3,["/",3,["+",1,["^",2.718,["-",2.94,["*",D,.0021]]]]]],["interpolate",["linear"],["zoom"],12,["*",2.1,["var","base"]],14,["*",5.25,["var","base"]],15,["*",7.5,["var","base"]],16,["*",18,["var","base"]],18,["*",52.5,["var","base"]]]]}function T(D){return["step",D,"rgba(0,0,0,0)",1,"#9C9C9C",50,"#FFFF73",100,"#AFFF00",250,"#00FFFF",500,"#30B0FF",1e3,"#2E5FFF",2e3,"#0000FF",3e3,"#FF00C5"]}let $=u(()=>`${r(a)}_${r(l)}_${r(s)}`),P=u(()=>({none:"#304ce7",flow:T(["get",r($)]),quietness:["step",["get","quietness"],"#882255",25,"#CC6677",50,"#44AA99",75,"#117733",101,"#000000"],gradient:yr(["abs",["get","gradient"]],C.limits,C.colorScale)})[r(i)]);var y=Hv(),w=Z(y);{const D=z=>{var d=Tv(),g=c(d),p=c(g);Q(k=>U(p,k),[()=>r(t).t(188)]),_(z,d)},N=z=>{var d=Dv(),g=Z(d);{const E=L=>{var R=Rv();qt(R,21,()=>v,Jt,(G,J)=>{var H=u(()=>Dr(r(J),2));let X=()=>r(H)[0],le=()=>r(H)[1];var q=Iv(),ee=c(q),ue={};Q(()=>{U(ee,le()),ue!==(ue=X())&&(q.value=(q.__value=X())??"")}),_(G,q)}),vn(R,()=>r(a),G=>Y(a,G)),_(L,R)};var p=c(g);{let L=u(()=>[E]),R=u(()=>r(t).cx(230));be(p,{get t(){return r(L)},get x(){return r(R)}})}}var k=h(g,2);{const E=L=>{var R=Bv();qt(R,21,()=>f,Jt,(G,J)=>{var H=u(()=>Dr(r(J),2));let X=()=>r(H)[0],le=()=>r(H)[1];var q=Nv(),ee=c(q),ue={};Q(()=>{U(ee,le()),ue!==(ue=X())&&(q.value=(q.__value=X())??"")}),_(G,q)}),vn(R,()=>r(s),G=>Y(s,G)),_(L,R)};var x=c(k);{let L=u(()=>[E]),R=u(()=>r(t).cx(231));be(x,{get t(){return r(L)},get x(){return r(R)}})}}var A=h(k,2);{const E=L=>{var R=Ov();qt(R,21,()=>b,Jt,(G,J)=>{var H=u(()=>Dr(r(J),2));let X=()=>r(H)[0],le=()=>r(H)[1];var q=Fv(),ee=c(q),ue={};Q(()=>{U(ee,le()),ue!==(ue=X())&&(q.value=(q.__value=X())??"")}),_(G,q)}),vn(R,()=>r(l),G=>Y(l,G)),_(L,R)};var F=c(A);{let L=u(()=>[E]),R=u(()=>r(t).cx(232));be(F,{get t(){return r(L)},get x(){return r(R)}})}}var S=h(A,2);{const E=L=>{var R=zv();qt(R,21,()=>m,Jt,(G,J)=>{var H=u(()=>Dr(r(J),2));let X=()=>r(H)[0],le=()=>r(H)[1];var q=jv(),ee=c(q),ue={};Q(()=>{U(ee,le()),ue!==(ue=X())&&(q.value=(q.__value=X())??"")}),_(G,q)}),vn(R,()=>r(i),G=>Y(i,G)),_(L,R)};var I=c(S);{let L=u(()=>[E]),R=u(()=>r(t).cx(233));be(I,{get t(){return r(L)},get x(){return r(R)}})}}_(z,d)};let j=u(()=>r(t).t(229));Rr(w,{get label(){return r(j)},get show(){return r(o)},set show(z){Y(o,z,!0)},help:D,legend:N,$$slots:{help:!0,legend:!0}})}var O=h(w,2);{let D=u(()=>`pmtiles://${qr("cnt/layers/route_network.pmtiles")}`);va(O,{get url(){return r(D)},children:(N,j)=>{{let z=u(()=>He("context-route-network")),d=u(()=>({"line-color":r(P),"line-width":B(["get",r($)])})),g=u(()=>({visibility:r(o)?"visible":"none"}));gt(N,Ce(()=>r(z),{sourceLayer:"rnet",get paint(){return r(d)},get layout(){return r(g)},hoverCursor:"pointer",children:(p,k)=>{Bt(p,{openOn:"click",children:(A,F)=>{let S=()=>F?.().data;const I=u(()=>S().properties);var E=Wv(),L=c(E),R=c(L);{let Fe=u(()=>r(t).cx(234)),Le=u(()=>[r(I)[r($)].toLocaleString()]);be(R,{get x(){return r(Fe)},get a(){return r(Le)}})}var G=h(L,2),J=c(G);{let Fe=u(()=>r(t).cx(235)),Le=u(()=>[r(I).gradient]);be(J,{get x(){return r(Fe)},get a(){return r(Le)}})}var H=h(G,2),X=c(H);{let Fe=u(()=>r(t).cx(236)),Le=u(()=>[r(I).quietness]);be(X,{get x(){return r(Fe)},get a(){return r(Le)}})}var le=h(H,2),q=c(le),ee=c(q),ue=h(q,2),K=c(ue),V=h(ue,2),te=c(V),re=c(te),ie=h(c(re)),ne=c(ie),ae=h(ie),_e=c(ae),se=h(ae),fe=c(se),oe=h(re);qt(oe,17,()=>v,Jt,(Fe,Le)=>{var qe=u(()=>Dr(r(Le),2));let Oe=()=>r(qe)[0],Ze=()=>r(qe)[1];var Be=Uv(),We=c(Be),Je=c(We),tt=h(We),yt=c(tt),dt=h(tt),kt=c(dt),$t=h(dt),_t=c($t);Q((at,et,pt)=>{U(Je,Ze()),U(yt,at),U(kt,et),U(_t,pt)},[()=>r(I)[`${Oe()}_fastest_bicycle`].toLocaleString(),()=>r(I)[`${Oe()}_fastest_bicycle_go_dutch`].toLocaleString(),()=>r(I)[`${Oe()}_fastest_bicycle_ebike`].toLocaleString()]),_(Fe,Be)});var ye=h(V,2),he=c(ye),xe=h(ye,2),Se=c(xe),De=c(Se),ke=h(c(De)),Ee=c(ke),pe=h(ke),Ie=c(pe),Te=h(pe),me=c(Te),Me=h(De);qt(Me,17,()=>v,Jt,(Fe,Le)=>{var qe=u(()=>Dr(r(Le),2));let Oe=()=>r(qe)[0],Ze=()=>r(qe)[1];var Be=Gv(),We=c(Be),Je=c(We),tt=h(We),yt=c(tt),dt=h(tt),kt=c(dt),$t=h(dt),_t=c($t);Q((at,et,pt)=>{U(Je,Ze()),U(yt,at),U(kt,et),U(_t,pt)},[()=>r(I)[`${Oe()}_quietest_bicycle`].toLocaleString(),()=>r(I)[`${Oe()}_quietest_bicycle_go_dutch`].toLocaleString(),()=>r(I)[`${Oe()}_quietest_bicycle_ebike`].toLocaleString()]),_(Fe,Be)}),Q((Fe,Le,qe,Oe,Ze,Be,We,Je,tt)=>{U(ee,Fe),U(K,Le),U(ne,qe),U(_e,Oe),U(fe,Ze),U(he,Be),U(Ee,We),U(Ie,Je),U(me,tt)},[()=>r(t).t(237),()=>r(t).t(238),()=>r(t).t(239),()=>r(t).t(240),()=>r(t).t(241),()=>r(t).t(242),()=>r(t).t(239),()=>r(t).t(240),()=>r(t).t(241)]),_(A,E)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}_(n,y),Ne()}var Jv=M('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),Qv=M('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),Zv=M('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),Vv=M("<!> <!> <!>",1),Kv=M('<!> <!> <!> <div class="layer-group"> </div> <!> <!>',1);function Xv(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=Ae(!1),a=Ae(!1),s=Ae(!1),l={colorScale:["#27918d","#ffaa33","#440154"],limits:[0,2e3,4e3,1e4]},i={High:"mediumseagreen",Medium:"orange",Low:"red","Should not be used":"brown"},v={"Segregated Track (wide)":"#054d05","Off Road Cycleway":"#3a9120","Segregated Track (narrow)":"#87d668","Shared Footway":"#ffbf00","Painted Cycle Lane":"#7faedd"};var f=Kv(),b=Z(f);{const y=D=>{Yi(D,{get labelColors(){return v}})},w=D=>{var N=Jv(),j=c(N),z=c(j);Q(d=>U(z,d),[()=>r(t).t(188)]),_(D,N)};let O=u(()=>r(t).t(187));Rr(b,{get label(){return r(O)},get show(){return r(s)},set show(D){Y(s,D,!0)},legend:y,help:w,$$slots:{legend:!0,help:!0}})}var m=h(b,2);{const y=D=>{{let N=u(()=>Object.values(i)),j=u(()=>({buckets:Object.keys(i)}));br(D,{get colorScale(){return r(N)},get labels(){return r(j)},fullWidthBucketLegend:!0})}},w=D=>{var N=Qv(),j=c(N),z=c(j);Q(d=>U(z,d),[()=>r(t).t(188)]),_(D,N)};let O=u(()=>r(t).t(189));Rr(m,{get label(){return r(O)},get show(){return r(a)},set show(D){Y(a,D,!0)},legend:y,help:w,$$slots:{legend:!0,help:!0}})}var C=h(m,2);qv(C,{});var B=h(C,2),T=c(B),$=h(B,2);{const y=D=>{{let N=u(()=>({limits:l.limits}));br(D,{get colorScale(){return l.colorScale},get labels(){return r(N)}})}},w=D=>{var N=Zv(),j=c(N),z=c(j);Q(d=>U(z,d),[()=>r(t).t(188)]),_(D,N)};let O=u(()=>r(t).t(191));Rr($,{get label(){return r(O)},get show(){return r(o)},set show(D){Y(o,D,!0)},legend:y,help:w,$$slots:{legend:!0,help:!0}})}var P=h($,2);{let y=u(()=>`pmtiles://${qr("cnt/layers/cbd.pmtiles")}`);va(P,{get url(){return r(y)},children:(w,O)=>{var D=Vv(),N=Z(D);{let d=u(()=>He("context-traffic")),g=u(()=>["has",r(t).t(192)]),p=u(()=>({"line-color":pn(["get",r(t).t(192)],{"0 to 1999":l.colorScale[0],"2000 to 3999":l.colorScale[1],"4000+":l.colorScale[2]},"cyan"),"line-width":so(0)})),k=u(()=>({visibility:r(o)?"visible":"none"}));gt(N,Ce(()=>r(d),{sourceLayer:"cbd_layer",get filter(){return r(g)},get paint(){return r(p)},get layout(){return r(k)}}))}var j=h(N,2);{let d=u(()=>He("context-los")),g=u(()=>({"line-color":pn(["get",r(t).t(193)],i,"cyan"),"line-width":so(1)})),p=u(()=>({visibility:r(a)?"visible":"none"}));gt(j,Ce(()=>r(d),{sourceLayer:"cbd_layer",get paint(){return r(g)},get layout(){return r(p)}}))}var z=h(j,2);{let d=u(()=>He("context-existing-infra")),g=u(()=>["!=",["get",r(t).t(194)],r(t).t(195)]),p=u(()=>({"line-color":pn(["get",r(t).t(194)],v,"cyan"),"line-width":so(1)})),k=u(()=>({visibility:r(s)?"visible":"none"}));gt(z,Ce(()=>r(d),{sourceLayer:"cbd_layer",get filter(){return r(g)},get paint(){return r(p)},get layout(){return r(k)}}))}_(w,D)},$$slots:{default:!0}})}Q(y=>U(T,y),[()=>r(t).t(190)]),_(n,f),Ne()}var Yv=M('<a href="https://www.data.gov.uk/dataset/9a6f9d86-9698-4a5d-a2c8-89f3b212c52c/scottish-school-roll-and-locations" target="_blank"> </a>'),eg=M('<a href="https://data.spatialhub.scot/dataset/gp_practices-is" target="_blank"> </a>'),tg=M('<a href="https://data.spatialhub.scot/dataset/nhs_hospitals-is" target="_blank"> </a>'),rg=M('<a href="https://www.openstreetmap.org/about" target="_blank"> </a>'),ng=M("<p><!></p>"),og=M("<!> <!>",1);function ag(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=Ae(!1),i={School:"#7fc97f",GP:"#beaed4",Hospital:"#fdc086",Grocery:"#386cb0",CommunityCenter:"#ffff99",Recreation:"#f0027f"};var v=og(),f=Z(v);{const C=$=>{Yi($,{get labelColors(){return i},swatchClass:"circle"})},B=$=>{var P=ng();{const w=(j,z=Pe)=>{var d=Yv(),g=c(d);Q(p=>U(g,p),[()=>r(s).tx(z())]),_(j,d)},O=(j,z=Pe)=>{var d=eg(),g=c(d);Q(p=>U(g,p),[()=>r(s).tx(z())]),_(j,d)},D=(j,z=Pe)=>{var d=tg(),g=c(d);Q(p=>U(g,p),[()=>r(s).tx(z())]),_(j,d)},N=(j,z=Pe)=>{var d=rg(),g=c(d);Q(p=>U(g,p),[()=>r(s).tx(z())]),_(j,d)};var y=c(P);{let j=u(()=>[w,O,D,N]),z=u(()=>r(s).cx(208));be(y,{get t(){return r(j)},get x(){return r(z)}})}}_($,P)};let T=u(()=>r(s).t(207));Rr(f,{get label(){return r(T)},get show(){return r(l)},set show($){Y(l,$,!0)},legend:C,help:B,$$slots:{legend:!0,help:!0}})}var b=h(f,2);{var m=C=>{{let B=u(()=>t().getPOIs());st(C,{get data(){return r(B)},generateId:!0,children:(T,$)=>{{let P=u(()=>He("context-pois")),y=u(()=>({"circle-color":pn(["get","kind"],i,"black"),"circle-radius":10,"circle-stroke-color":"black","circle-stroke-width":1,"circle-opacity":.8})),w=u(()=>({visibility:r(l)?"visible":"none"}));Ln(T,Ce(()=>r(P),{get paint(){return r(y)},get layout(){return r(w)},children:(O,D)=>{Bt(O,{openOn:"hover",children:(j,z)=>{let d=()=>z?.().data;const g=u(()=>d().properties);var p=jt();Q(()=>U(p,r(g).name||`unnamed ${r(g).kind}`)),_(j,p)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}};ve(b,C=>{t()&&C(m)})}_(n,v),Ne(),a()}var ig=M('<!> <div style="display: flex; justify-content: space-between;"><span> </span> <span> </span></div>',1),sg=M('<a href="https://www.data.gov.uk/dataset/1102bf85-ed49-440a-b211-da87e8d752eb/scottish-index-of-multiple-deprivation-simd-2020" target="_blank"> </a>'),lg=M("<p><!></p>"),ug=M('<!> <div style="display: flex; justify-content: space-between;"><span> </span> <span> </span> <span> </span></div>',1),cg=M('<a href="https://www.data.gov.uk/dataset/1102bf85-ed49-440a-b211-da87e8d752eb/scottish-index-of-multiple-deprivation-simd-2020" target="_blank"> </a>'),dg=M("<p><!></p>"),fg=M('<!> <div style="display: flex; justify-content: space-between;"><span style="text-align: center; width: 100%"> </span></div>',1),vg=M("<p> </p>"),gg=M("<p><!></p>"),_g=M("<p><!></p>"),pg=M("<p><!></p>"),hg=M("<!> <!> <!> <!>",1),mg=M("<!> <!> <!> <!>",1);function bg(n,e){Re(e,!0);const t=()=>we(po,"$metricBuckets",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=Ae(!1),i=Ae(!1),v=Ae(!1);var f=mg(),b=Z(f);{const T=y=>{var w=ig(),O=Z(w);{let g=u(()=>Zo.toReversed()),p=u(()=>({buckets:hl(Xo).toReversed()}));br(O,{get colorScale(){return r(g)},get labels(){return r(p)}})}var D=h(O,2),N=c(D),j=c(N),z=h(N,2),d=c(z);Q((g,p)=>{U(j,g),U(d,p)},[()=>r(s).t(210),()=>r(s).t(211)]),_(y,w)},$=y=>{var w=lg();{const D=(N,j=Pe)=>{var z=sg(),d=c(z);Q(g=>U(d,g),[()=>r(s).tx(j())]),_(N,z)};var O=c(w);{let N=u(()=>[D]),j=u(()=>r(s).cx(212));be(O,{get t(){return r(N)},get x(){return r(j)}})}}_(y,w)};let P=u(()=>r(s).t(209));Rr(b,{get label(){return r(P)},onChange:()=>{r(l)&&(Y(i,!1),Y(v,!1))},get show(){return r(l)},set show(y){Y(l,y,!0)},legend:T,help:$,$$slots:{legend:!0,help:!0}})}var m=h(b,2);{const T=y=>{var w=ug(),O=Z(w);{let k=u(()=>({limits:t().population_density}));br(O,{get colorScale(){return Qo},get labels(){return r(k)}})}var D=h(O,2),N=c(D),j=c(N),z=h(N,2),d=c(z),g=h(z,2),p=c(g);Q((k,x,A)=>{U(j,k),U(d,x),U(p,A)},[()=>r(s).t(214),()=>r(s).t(215),()=>r(s).t(216)]),_(y,w)},$=y=>{var w=dg();{const D=(N,j=Pe)=>{var z=cg(),d=c(z);Q(g=>U(d,g),[()=>r(s).tx(j())]),_(N,z)};var O=c(w);{let N=u(()=>[D]),j=u(()=>r(s).cx(217));be(O,{get t(){return r(N)},get x(){return r(j)}})}}_(y,w)};let P=u(()=>r(s).t(213));Rr(m,{get label(){return r(P)},onChange:()=>{r(i)&&(Y(l,!1),Y(v,!1))},get show(){return r(i)},set show(y){Y(i,y,!0)},legend:T,help:$,$$slots:{legend:!0,help:!0}})}var C=h(m,2);{const T=y=>{var w=fg(),O=Z(w);{let z=u(()=>Vo.toReversed()),d=u(()=>({limits:Ko.toReversed().map(g=>`${g}%`)}));br(O,{get colorScale(){return r(z)},get labels(){return r(d)}})}var D=h(O,2),N=c(D),j=c(N);Q(z=>U(j,z),[()=>r(s).t(219)]),_(y,w)},$=y=>{var w=vg(),O=c(w);Q(D=>U(O,D),[()=>r(s).t(220)]),_(y,w)};let P=u(()=>r(s).t(218));Rr(C,{get label(){return r(P)},onChange:()=>{r(v)&&(Y(l,!1),Y(i,!1))},get show(){return r(v)},set show(y){Y(v,y,!0)},legend:T,help:$,$$slots:{legend:!0,help:!0}})}var B=h(C,2);{let T=u(()=>`pmtiles://${qr("cnt/layers/population.pmtiles")}`);va(B,{get url(){return r(T)},children:($,P)=>{var y=hg(),w=Z(y);{let j=u(()=>He("context-simd")),z=u(()=>({"fill-color":yr(["get","imd_percentile"],Xo,Zo),"fill-opacity":xt(.7,.9)})),d=u(()=>({visibility:r(l)?"visible":"none"}));ur(w,Ce(()=>r(j),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(z)},get layout(){return r(d)},children:(g,p)=>{Bt(g,{openOn:"hover",children:(x,A)=>{let F=()=>A?.().data;const S=u(()=>F().properties);var I=gg(),E=c(I);{let L=u(()=>r(s).cx(221)),R=u(()=>[r(S).id,r(S).population.toLocaleString(),r(S).imd_rank,r(S).imd_percentile]);be(E,{get x(){return r(L)},get a(){return r(R)}})}_(x,I)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var O=h(w,2);{let j=u(()=>He("context-population-car-ownership")),z=u(()=>({"fill-color":yr(["*",100,["/",["get","households_with_cars_or_vans"],["get","total_households"]]],Ko,Vo),"fill-opacity":xt(.7,.9)})),d=u(()=>({visibility:r(v)?"visible":"none"}));ur(O,Ce(()=>r(j),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(z)},get layout(){return r(d)},children:(g,p)=>{Bt(g,{openOn:"hover",children:(x,A)=>{let F=()=>A?.().data;const S=u(()=>F().properties);var I=_g(),E=c(I);{let L=u(()=>r(s).cx(222)),R=u(()=>[r(S).id,Di(r(S).households_with_cars_or_vans,r(S).total_households),r(S).total_households.toLocaleString()]);be(E,{get x(){return r(L)},get a(){return r(R)}})}_(x,I)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var D=h(O,2);{let j=u(()=>He("context-population-density")),z=u(()=>({"fill-color":yr(["/",["get","population"],["/",["get","area"],1e6]],t().population_density,Qo),"fill-opacity":xt(.7,.9)})),d=u(()=>({visibility:r(i)?"visible":"none"}));ur(D,Ce(()=>r(j),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(z)},get layout(){return r(d)},children:(g,p)=>{Bt(g,{openOn:"hover",children:(x,A)=>{let F=()=>A?.().data;const S=u(()=>F().properties);var I=pg(),E=c(I);{let L=u(()=>r(s).cx(223)),R=u(()=>[r(S).id,r(S).population.toLocaleString(),Math.round(r(S).population/(r(S).area/1e6)).toLocaleString()]);be(E,{get x(){return r(L)},get a(){return r(R)}})}_(x,I)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var N=h(D,2);{let j=u(()=>He("context-population-outline")),z=u(()=>({visibility:r(l)||r(i)||r(v)?"visible":"none"}));gt(N,Ce(()=>r(j),{sourceLayer:"population",paint:{"line-color":"black","line-width":1},get layout(){return r(z)}}))}_($,y)},$$slots:{default:!0}})}_(n,f),Ne(),a()}var yg=M("<img/>"),Ag=M('<div style="display: flex; gap: 8px; align-items: center;"><!></div>'),wg=M('<a href="https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation" target="_blank"> </a>'),xg=M("<p><!></p>"),$g=M("<p> </p>"),kg=M("<!> <!>",1);function Sg(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=Ae(!1);var a=kg(),s=Z(a);{const i=b=>{var m=Ag();{const B=T=>{var $=yg();Q(P=>{Ue($,"src",Ml),Ue($,"alt",P)},[()=>r(t).t(225)]),_(T,$)};var C=c(m);{let T=u(()=>[B]),$=u(()=>r(t).cx(226));be(C,{get t(){return r(T)},get x(){return r($)}})}}_(b,m)},v=b=>{var m=xg();{const B=(T,$=Pe)=>{var P=wg(),y=c(P);Q(w=>U(y,w),[()=>r(t).tx($())]),_(T,P)};var C=c(m);{let T=u(()=>[B]),$=u(()=>r(t).cx(227));be(C,{get t(){return r(T)},get x(){return r($)}})}}_(b,m)};let f=u(()=>r(t).t(224));Rr(s,{get label(){return r(f)},get show(){return r(o)},set show(b){Y(o,b,!0)},legend:i,help:v,$$slots:{legend:!0,help:!0}})}var l=h(s,2);{let i=u(()=>qr("cnt/layers/railways.geojson"));st(l,{get data(){return r(i)},generateId:!0,children:(v,f)=>{{let b=u(()=>He("context-railway-stations")),m=u(()=>({"icon-image":"national_rail","icon-size":1,"icon-allow-overlap":!0,visibility:r(o)?"visible":"none"}));fo(v,Ce(()=>r(b),{get layout(){return r(m)},children:(C,B)=>{Bt(C,{openOn:"hover",children:($,P)=>{let y=()=>P?.().data;var w=$g(),O=c(w);Q(D=>U(O,D),[()=>y().properties.name??r(t).t(228)]),_($,w)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}_(n,a),Ne()}var Eg=M('<a href="https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data" target="_blank"> </a>'),Lg=M('<a href="https://www.gov.uk/guidance/road-accident-and-safety-statistics-guidance" target="_blank"> </a>'),Cg=M('<a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" target="_blank"> </a>'),Mg=M("<p><!></p> <ul><li> </li> <li> </li> <li> </li> <li> </li> <li><!></li></ul> <p> </p> <p><!></p>",1),Pg=M('<input type="checkbox" class="svelte-1pznq80"/>'),Tg=M('<input type="checkbox" class="svelte-1pznq80"/>'),Ig=M('<input type="number" class="svelte-1pznq80"/>'),Rg=M('<input type="number" class="svelte-1pznq80"/>'),Ng=M('<fieldset style="display: flex; gap: 3em;" class="svelte-1pznq80"><label><!></label> <label><!></label></fieldset> <fieldset class="year-filter svelte-1pznq80"><label><!></label> <label><!></label></fieldset> <!>',1),Bg=M("<b> </b>"),Fg=M("<b> </b>"),Og=M("<b> </b>"),jg=M("<b> </b>"),zg=M("<p><!></p>"),Dg=M("<b> </b>"),Ug=M("<p><!></p>"),Gg=M("<p><!></p> <p><!></p> <p><!></p> <!> <!> <p> </p>",1),Wg=M("<!> <!>",1),Hg=M("<!> <!>",1);function qg(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=Ae(!1),a=bt({pedestrians:!0,cyclists:!0,minYear:2017,maxYear:2023});function s(w){let O=["any"];return a.pedestrians&&O.push(["get","pedestrian"]),a.cyclists&&O.push(["get","cyclist"]),["all",[">=",["get","year"],a.minYear],["<=",["get","year"],a.maxYear],O]}function l(w){let O=[];return w.pedestrian&&O.push("pedestrian"),w.cyclist&&O.push("cyclist"),O.join(", ")}function i(w){window.open(`https://www.cyclestreets.net/collisions/reports/${w.features[0].properties.accident_index}`,"_blank")}let v={1:"Crossing on pedestrian crossing facility",2:"Crossing in zig-zag approach lines",3:"Crossing in zig-zag exit lines",4:"Crossing elsewhere within 50m. of pedestrian crossing",5:"In carriageway, crossing elsewhere",6:"On footway or verge",7:"On refuge, central island or central reservation",8:"In centre of carriageway - not on refuge, island or central reservation",9:"In carriageway, not crossing"},f={1:"Crossing from driver's nearside",2:"Crossing from nearside - masked by parked or stationary vehicle",3:"Crossing from driver's offside",4:"Crossing from offside - masked by parked or stationary vehicle",5:"In carriageway, stationary - not crossing (standing or playing)",6:"In carriageway, stationary - not crossing (standing or playing - masked by parked or stationary vehicle)",7:"Walking along in carriageway, facing traffic",8:"Walking along in carriageway, back to traffic"},b={1:"Fatal",2:"Serious",3:"Slight"},m="#080C54",C="#1F9EB7",B="#CDE594",T={Slight:B,Serious:C,Fatal:m};var $=Hg(),P=Z($);{const w=N=>{var j=Mg(),z=Z(j);{const le=(q,ee=Pe)=>{var ue=Eg(),K=c(ue);Q(V=>U(K,V),[()=>r(t).tx(ee())]),_(q,ue)};var d=c(z);{let q=u(()=>[le]),ee=u(()=>r(t).cx(244));be(d,{get t(){return r(q)},get x(){return r(ee)}})}}var g=h(z,2),p=c(g),k=c(p),x=h(p,2),A=c(x),F=h(x,2),S=c(F),I=h(F,2),E=c(I),L=h(I,2);{const le=(q,ee=Pe)=>{var ue=Lg(),K=c(ue);Q(V=>U(K,V),[()=>r(t).tx(ee())]),_(q,ue)};var R=c(L);{let q=u(()=>[le]),ee=u(()=>r(t).cx(249));be(R,{get t(){return r(q)},get x(){return r(ee)}})}}var G=h(g,2),J=c(G),H=h(G,2);{const le=(q,ee=Pe)=>{var ue=Cg(),K=c(ue);Q(V=>U(K,V),[()=>r(t).tx(ee())]),_(q,ue)};var X=c(H);{let q=u(()=>[le]),ee=u(()=>r(t).cx(251));be(X,{get t(){return r(q)},get x(){return r(ee)}})}}Q((le,q,ee,ue,K)=>{U(k,le),U(A,q),U(S,ee),U(E,ue),U(J,K)},[()=>r(t).t(245),()=>r(t).t(246),()=>r(t).t(247),()=>r(t).t(248),()=>r(t).t(250)]),_(N,j)},O=N=>{var j=Ng(),z=Z(j),d=c(z);{const L=R=>{var G=Pg();kn(G,()=>a.pedestrians,J=>a.pedestrians=J),_(R,G)};var g=c(d);{let R=u(()=>[L]),G=u(()=>r(t).cx(252));be(g,{get t(){return r(R)},get x(){return r(G)}})}}var p=h(d,2);{const L=R=>{var G=Tg();kn(G,()=>a.cyclists,J=>a.cyclists=J),_(R,G)};var k=c(p);{let R=u(()=>[L]),G=u(()=>r(t).cx(253));be(k,{get t(){return r(R)},get x(){return r(G)}})}}var x=h(z,2),A=c(x);{const L=R=>{var G=Ig();Ue(G,"min",2017),Ue(G,"max",2023),Yo(G,()=>a.minYear,J=>a.minYear=J),_(R,G)};var F=c(A);{let R=u(()=>[L]),G=u(()=>r(t).cx(254));be(F,{get t(){return r(R)},get x(){return r(G)}})}}var S=h(A,2);{const L=R=>{var G=Rg();Ue(G,"min",2017),Ue(G,"max",2023),Yo(G,()=>a.maxYear,J=>a.maxYear=J),_(R,G)};var I=c(S);{let R=u(()=>[L]),G=u(()=>r(t).cx(255));be(I,{get t(){return r(R)},get x(){return r(G)}})}}var E=h(x,2);Yi(E,{get labelColors(){return T},swatchClass:"circle",itemsPerRow:3}),_(N,j)};let D=u(()=>r(t).t(243));Rr(P,{get label(){return r(D)},get show(){return r(o)},set show(N){Y(o,N,!0)},help:w,legend:O,$$slots:{help:!0,legend:!0}})}var y=h(P,2);{let w=u(()=>`pmtiles://${qr("cnt/layers/stats19.pmtiles")}`);va(y,{get url(){return r(w)},children:(O,D)=>{var N=Wg(),j=Z(N);{let d=u(()=>He("context-stats19-heatmap")),g=u(()=>s()),p=u(()=>({visibility:r(o)?"visible":"none"}));Yc(j,Ce(()=>r(d),{sourceLayer:"stats19",maxzoom:13,get filter(){return r(g)},get layout(){return r(p)},paint:{"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,15]}}))}var z=h(j,2);{let d=u(()=>He("context-stats19-points")),g=u(()=>({"circle-color":yr(["get","severity"],[1,2,3],[m,C,B]),"circle-opacity":.9,"circle-radius":13,"circle-stroke-color":"black","circle-stroke-width":.1})),p=u(()=>s()),k=u(()=>({visibility:r(o)?"visible":"none"}));Ln(z,Ce(()=>r(d),{sourceLayer:"stats19",minzoom:13,get paint(){return r(g)},get filter(){return r(p)},get layout(){return r(k)},hoverCursor:"pointer",onclick:i,children:(x,A)=>{Bt(x,{openOn:"click",children:(S,I)=>{let E=()=>I?.().data;const L=u(()=>E().properties);var R=Gg(),G=Z(R);{const ie=ne=>{var ae=Bg(),_e=c(ae);Q(()=>U(_e,r(L).year)),_(ne,ae)};var J=c(G);{let ne=u(()=>[ie]),ae=u(()=>r(t).cx(256));be(J,{get t(){return r(ne)},get x(){return r(ae)}})}}var H=h(G,2);{const ie=ne=>{var ae=Fg(),_e=c(ae);Q(()=>U(_e,b[r(L).severity])),_(ne,ae)};var X=c(H);{let ne=u(()=>[ie]),ae=u(()=>r(t).cx(257));be(X,{get t(){return r(ne)},get x(){return r(ae)}})}}var le=h(H,2);{const ie=ne=>{var ae=Og(),_e=c(ae);Q(se=>U(_e,se),[()=>l(r(L))]),_(ne,ae)};var q=c(le);{let ne=u(()=>[ie]),ae=u(()=>r(t).cx(258));be(q,{get t(){return r(ne)},get x(){return r(ae)}})}}var ee=h(le,2);{var ue=ie=>{var ne=zg();{const _e=se=>{var fe=jg(),oe=c(fe);Q(()=>U(oe,v[r(L).pedestrian_location])),_(se,fe)};var ae=c(ne);{let se=u(()=>[_e]),fe=u(()=>r(t).cx(259));be(ae,{get t(){return r(se)},get x(){return r(fe)}})}}_(ie,ne)};ve(ee,ie=>{r(L).pedestrian_location&&ie(ue)})}var K=h(ee,2);{var V=ie=>{var ne=Ug();{const _e=se=>{var fe=Dg(),oe=c(fe);Q(()=>U(oe,f[r(L).pedestrian_movement])),_(se,fe)};var ae=c(ne);{let se=u(()=>[_e]),fe=u(()=>r(t).cx(260));be(ae,{get t(){return r(se)},get x(){return r(fe)}})}}_(ie,ne)};ve(K,ie=>{r(L).pedestrian_movement&&ie(V)})}var te=h(K,2),re=c(te);Q(ie=>U(re,ie),[()=>r(t).t(261)]),_(S,R)},$$slots:{default:!0}})},$$slots:{default:!0}}))}_(O,N)},$$slots:{default:!0}})}_(n,$),Ne()}var Jg=(n,e)=>Y(e,!r(e)),Qg=M('<div class="layer-group"> </div> <!> <!> <!> <div class="layer-group"> </div> <!> <!> <div class="layer-group"> </div> <!>',1),Zg=M("<!> <!>",1),Vg=M('<div class="pico contextual-layers svelte-6ypeli"><button><div style="display: flex; gap: 12px; color: #333; align-items: center; justify-content: center;"><!> <!></div></button> <div class="contextual-layer-controls svelte-6ypeli"><!> <div class="context-control"><span style="font-size: 20px; margin-left: 8px; margin-top: 4px;"> </span> <select style="width: auto; font-size: 20px; margin: 8px; padding: 8px; text-overflow: ellipsis;"><option> </option><option> </option><option> </option><option> </option></select> <!> <!></div></div></div>');function Kg(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",i),o=()=>we(Ra,"$showExistingFiltersAndTRs",i),a=()=>we(Vr,"$appFocus",i),s=()=>we(yi,"$maptilerBasemap",i),l=()=>we(ea,"$devMode",i),[i,v]=lt(),f=u(()=>ut(ct("main")));let b=Ae(!1);Ci(n,{defaultStyling:!0,children:(m,C)=>{var B=Vg();let T;var $=c(B);$.__click=[Jg,b];var P=c($),y=c(P);Dc(y,{color:"#333"});var w=h(y,2);{var O=H=>{var X=jt();Q(le=>U(X,le),[()=>r(f).t(196)]),_(H,X)};ve(w,H=>{r(b)&&H(O)})}var D=h($,2);let N;var j=c(D);{var z=H=>{var X=Zg(),le=Z(X);{let ue=u(()=>r(f).t(197));Rr(le,{get label(){return r(ue)},get show(){return ta(),o()},set show(K){Ve(Ra,K)}})}var q=h(le,2);{var ee=ue=>{var K=Qg(),V=Z(K),te=c(V),re=h(V,2);bg(re,{});var ie=h(re,2);ag(ie,{});var ne=h(ie,2);qg(ne,{});var ae=h(ne,2),_e=c(ae),se=h(ae,2);Sg(se,{});var fe=h(se,2);zd(fe,{});var oe=h(fe,2),ye=c(oe),he=h(oe,2);Xv(he,{}),Q((xe,Se,De)=>{U(te,xe),U(_e,Se),U(ye,De)},[()=>r(f).t(198),()=>r(f).t(199),()=>r(f).t(200)]),_(ue,K)};ve(q,ue=>{a()=="cnt"&&ue(ee)})}_(H,X)};ve(j,H=>{t()&&H(z)})}var d=h(j,2),g=c(d),p=c(g),k=h(g,2),x=c(k),A=c(x);x.value=x.__value="dataviz";var F=h(x),S=c(F);F.value=F.__value="streets-v2";var I=h(F),E=c(I);I.value=I.__value="hybrid";var L=h(I),R=c(L);L.value=L.__value="uk-openzoomstack-light";var G=h(k,2);ml(G,{});var J=h(G,2);{let H=u(()=>r(f).t(206));Rr(J,{get label(){return r(H)},get show(){return ta(),l()},set show(X){Ve(ea,X)}})}Q((H,X,le,q,ee,ue,K,V)=>{T=dr(B,"display: flex; flex-direction: column; border-radius: 5px;",T,H),Et($,1,`show-layers-button icon-btn ${r(b)?"expanded":""}`,"svelte-6ypeli"),Ue($,"aria-label",X),N=dr(D,"flex-direction: column;",N,le),U(p,q),U(A,ee),U(S,ue),U(E,K),U(R,V)},[()=>({width:r(b)?"300px":"auto"}),()=>r(f).t(196),()=>({display:r(b)?"flex":"none"}),()=>r(f).t(201),()=>r(f).t(202),()=>r(f).t(203),()=>r(f).t(204),()=>r(f).t(205)]),vn(k,s,H=>Ve(yi,H)),_(m,B)},$$slots:{default:!0}}),Ne(),v()}er(["click"]);var Xg=M('<div class="flex-container svelte-eqsjzd"><div class="top svelte-eqsjzd"><!></div> <div class="content svelte-eqsjzd"><div class="left svelte-eqsjzd"><!></div> <div class="main svelte-eqsjzd"><!></div></div></div>');function Yg(n,e){Re(e,!0),Qe(()=>{Ho.value&&qa.value&&(Ho.value.innerHTML="",Ho.value.appendChild(qa.value))}),Qe(()=>{qo.value&&Ja.value&&(qo.value.innerHTML="",qo.value.appendChild(Ja.value))}),Qe(()=>{Jo.value&&Qa.value&&(Jo.value.innerHTML="",Jo.value.appendChild(Qa.value))});var t=Xg(),o=c(t),a=c(o);It(a,()=>e.top??Pe);var s=h(o,2),l=c(s),i=c(l);It(i,()=>e.left??Pe);var v=h(l,2),f=c(v);It(f,()=>e.main??Pe),_(n,t),Ne()}var e_=M("<div><!></div> <div><!></div> <div><!></div>",1);function Lr(n,e){Re(e,!0);var t=e_(),o=Z(t),a=c(o);It(a,()=>e.top??Pe),rn(o,f=>qa.value=f,()=>qa?.value);var s=h(o,2),l=c(s);It(l,()=>e.left??Pe),rn(s,f=>Ja.value=f,()=>Ja?.value);var i=h(s,2),v=c(i);It(v,()=>e.main??Pe),rn(i,f=>Qa.value=f,()=>Qa?.value),_(n,t),Ne()}let qa=bt({value:void 0}),Ja=bt({value:void 0}),Qa=bt({value:void 0}),Ho=bt({value:void 0}),qo=bt({value:void 0}),Jo=bt({value:void 0}),ge;function t_(n){const e=ge.__externref_table_alloc();return ge.__wbindgen_export_2.set(e,n),e}function Un(n,e){try{return n.apply(this,e)}catch(t){const o=t_(t);ge.__wbindgen_exn_store(o)}}const su=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&su.decode();let Fo=null;function uo(){return(Fo===null||Fo.byteLength===0)&&(Fo=new Uint8Array(ge.memory.buffer)),Fo}function St(n,e){return n=n>>>0,su.decode(uo().subarray(n,n+e))}let Yt=0;const Ia=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},r_=typeof Ia.encodeInto=="function"?function(n,e){return Ia.encodeInto(n,e)}:function(n,e){const t=Ia.encode(n);return e.set(t),{read:n.length,written:t.length}};function Sr(n,e,t){if(t===void 0){const i=Ia.encode(n),v=e(i.length,1)>>>0;return uo().subarray(v,v+i.length).set(i),Yt=i.length,v}let o=n.length,a=e(o,1)>>>0;const s=uo();let l=0;for(;l<o;l++){const i=n.charCodeAt(l);if(i>127)break;s[a+l]=i}if(l!==o){l!==0&&(n=n.slice(l)),a=t(a,o,o=l+n.length*3,1)>>>0;const i=uo().subarray(a+l,a+o),v=r_(n,i);l+=v.written,a=t(a,o,l,1)>>>0}return Yt=l,a}let qn=null;function Kr(){return(qn===null||qn.buffer.detached===!0||qn.buffer.detached===void 0&&qn.buffer!==ge.memory.buffer)&&(qn=new DataView(ge.memory.buffer)),qn}function ao(n){return n==null}function zi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const a=n.description;return a==null?"Symbol":`Symbol(${a})`}if(e=="function"){const a=n.name;return typeof a=="string"&&a.length>0?`Function(${a})`:"Function"}if(Array.isArray(n)){const a=n.length;let s="[";a>0&&(s+=zi(n[0]));for(let l=1;l<a;l++)s+=", "+zi(n[l]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let o;if(t&&t.length>1)o=t[1];else return toString.call(n);if(o=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:o}function Ys(n,e){const t=e(n.length*1,1)>>>0;return uo().set(n,t/1),Yt=n.length,t}function rt(n){const e=ge.__wbindgen_export_2.get(n);return ge.__externref_table_dealloc(n),e}let Oo=null;function n_(){return(Oo===null||Oo.byteLength===0)&&(Oo=new Float64Array(ge.memory.buffer)),Oo}function o_(n,e){return n=n>>>0,n_().subarray(n/8,n/8+e)}function a_(n,e){return n=n>>>0,uo().subarray(n/1,n/1+e)}let jo=null;function i_(){return(jo===null||jo.byteLength===0)&&(jo=new Uint32Array(ge.memory.buffer)),jo}function s_(n,e){const t=e(n.length*4,4)>>>0;return i_().set(n,t/4),Yt=n.length,t}const el=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>ge.__wbg_ltn_free(n>>>0,1));class l_{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,el.unregister(this),e}free(){const e=this.__destroy_into_raw();ge.__wbg_ltn_free(e,0)}constructor(e,t,o,a,s,l,i){const v=Ys(e,ge.__wbindgen_malloc),f=Yt,b=Ys(t,ge.__wbindgen_malloc),m=Yt,C=Sr(a,ge.__wbindgen_malloc,ge.__wbindgen_realloc),B=Yt;var T=ao(s)?0:Sr(s,ge.__wbindgen_malloc,ge.__wbindgen_realloc),$=Yt;const P=Sr(l,ge.__wbindgen_malloc,ge.__wbindgen_realloc),y=Yt,w=ge.ltn_new(v,f,b,m,o,C,B,T,$,P,y,i);if(w[2])throw rt(w[1]);return this.__wbg_ptr=w[0]>>>0,el.register(this,this.__wbg_ptr,this),this}getInvertedBoundary(){let e,t;try{const s=ge.ltn_getInvertedBoundary(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getBounds(){const e=ge.ltn_getBounds(this.__wbg_ptr);var t=o_(e[0],e[1]).slice();return ge.__wbindgen_free(e[0],e[1]*8,8),t}toRouteSnapper(){const e=ge.ltn_toRouteSnapper(this.__wbg_ptr);var t=a_(e[0],e[1]).slice();return ge.__wbindgen_free(e[0],e[1]*1,1),t}toRouteSnapperGj(){let e,t;try{const s=ge.ltn_toRouteSnapperGj(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderModalFilters(){let e,t;try{const s=ge.ltn_renderModalFilters(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderModalFiltersBeforeEdits(){let e,t;try{const s=ge.ltn_renderModalFiltersBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderTurnRestrictions(){let e,t;try{const s=ge.ltn_renderTurnRestrictions(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderTurnRestrictionsBeforeEdits(){let e,t;try{const s=ge.ltn_renderTurnRestrictionsBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderNeighbourhood(){let e,t;try{const s=ge.ltn_renderNeighbourhood(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderNeighbourhoodBeforeEdits(){let e,t;try{const s=ge.ltn_renderNeighbourhoodBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}generatedBoundaries(){let e,t;try{const s=ge.ltn_generatedBoundaries(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}generateMergedBoundary(e){let t,o;try{const l=ge.ltn_generateMergedBoundary(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,rt(l[2]);return t=a,o=s,St(a,s)}finally{ge.__wbindgen_free(t,o,1)}}extractWaypointsFromRing(e){let t,o;try{const l=ge.ltn_extractWaypointsFromRing(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,rt(l[2]);return t=a,o=s,St(a,s)}finally{ge.__wbindgen_free(t,o,1)}}setCurrentNeighbourhoodBoundary(e,t){const o=Sr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=Yt,s=ge.ltn_setCurrentNeighbourhoodBoundary(this.__wbg_ptr,o,a,t);if(s[1])throw rt(s[0])}deleteNeighbourhoodBoundary(e){const t=Sr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=Yt;ge.ltn_deleteNeighbourhoodBoundary(this.__wbg_ptr,t,o)}renameNeighbourhoodBoundary(e,t){const o=Sr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=Yt,s=Sr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),l=Yt;ge.ltn_renameNeighbourhoodBoundary(this.__wbg_ptr,o,a,s,l)}setCurrentNeighbourhood(e){const t=Sr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=Yt,a=ge.ltn_setCurrentNeighbourhood(this.__wbg_ptr,t,o);if(a[1])throw rt(a[0])}addModalFilter(e,t){const o=Sr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=Yt,s=ge.ltn_addModalFilter(this.__wbg_ptr,e,o,a);if(s[1])throw rt(s[0])}addManyModalFilters(e,t){const o=Sr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=Yt,s=ge.ltn_addManyModalFilters(this.__wbg_ptr,e,o,a);if(s[1])throw rt(s[0])}deleteModalFilter(e){ge.ltn_deleteModalFilter(this.__wbg_ptr,e)}addDiagonalFilter(e){const t=ge.ltn_addDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw rt(t[0])}rotateDiagonalFilter(e){const t=ge.ltn_rotateDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw rt(t[0])}deleteDiagonalFilter(e){const t=ge.ltn_deleteDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw rt(t[0])}addTurnRestriction(e,t){const o=ge.ltn_addTurnRestriction(this.__wbg_ptr,e,t);if(o[1])throw rt(o[0])}deleteTurnRestriction(e,t,o){const a=ge.ltn_deleteTurnRestriction(this.__wbg_ptr,e,t,o);if(a[1])throw rt(a[0])}getTurnRestrictionTargets(e){let t,o;try{const l=ge.ltn_getTurnRestrictionTargets(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,rt(l[2]);return t=a,o=s,St(a,s)}finally{ge.__wbindgen_free(t,o,1)}}toggleTravelFlow(e){ge.ltn_toggleTravelFlow(this.__wbg_ptr,e)}toggleMainRoad(e){const t=ge.ltn_toggleMainRoad(this.__wbg_ptr,e);if(t[1])throw rt(t[0])}setMainRoads(e,t){const o=s_(e,ge.__wbindgen_malloc),a=Yt,s=ge.ltn_setMainRoads(this.__wbg_ptr,o,a,t);if(s[1])throw rt(s[0])}eraseAllMainRoads(){const e=ge.ltn_eraseAllMainRoads(this.__wbg_ptr);if(e[1])throw rt(e[0])}undo(){const e=ge.ltn_undo(this.__wbg_ptr);if(e[1])throw rt(e[0])}redo(){const e=ge.ltn_redo(this.__wbg_ptr);if(e[1])throw rt(e[0])}getShortcutsCrossingRoad(e){let t,o;try{const l=ge.ltn_getShortcutsCrossingRoad(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,rt(l[2]);return t=a,o=s,St(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getAllShortcuts(){let e,t;try{const s=ge.ltn_getAllShortcuts(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getAllShortcutsBeforeEdits(){let e,t;try{const s=ge.ltn_getAllShortcutsBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}toSavefile(){let e,t;try{const s=ge.ltn_toSavefile(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}loadSavefile(e){const t=ge.ltn_loadSavefile(this.__wbg_ptr,e);if(t[1])throw rt(t[0])}changeProjectName(e){const t=Sr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=Yt;ge.ltn_changeProjectName(this.__wbg_ptr,t,o)}compareRoute(e,t,o,a,s){let l,i;try{const b=ge.ltn_compareRoute(this.__wbg_ptr,e,t,o,a,s);var v=b[0],f=b[1];if(b[3])throw v=0,f=0,rt(b[2]);return l=v,i=f,St(v,f)}finally{ge.__wbindgen_free(l,i,1)}}impactToOneDestination(e,t){let o,a;try{const i=ge.ltn_impactToOneDestination(this.__wbg_ptr,e,t);var s=i[0],l=i[1];if(i[3])throw s=0,l=0,rt(i[2]);return o=s,a=l,St(s,l)}finally{ge.__wbindgen_free(o,a,1)}}predictImpact(e){let t,o;try{const l=ge.ltn_predictImpact(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,rt(l[2]);return t=a,o=s,St(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getImpactsOnRoad(e,t){let o,a;try{const i=ge.ltn_getImpactsOnRoad(this.__wbg_ptr,e,t);var s=i[0],l=i[1];if(i[3])throw s=0,l=0,rt(i[2]);return o=s,a=l,St(s,l)}finally{ge.__wbindgen_free(o,a,1)}}getAllIntersections(){let e,t;try{const s=ge.ltn_getAllIntersections(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getMovements(e){let t,o;try{const l=ge.ltn_getMovements(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,rt(l[2]);return t=a,o=s,St(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getDemandModel(){let e,t;try{const s=ge.ltn_getDemandModel(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getPOIs(){let e,t;try{const s=ge.ltn_getPOIs(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getMetricBuckets(){let e,t;try{const s=ge.ltn_getMetricBuckets(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,rt(s[2]);return e=o,t=a,St(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getOsmTimestamp(){const e=ge.ltn_getOsmTimestamp(this.__wbg_ptr);return e[0]===0?void 0:e[1]}}async function u_(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(o){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function c_(){const n={};return n.wbg={},n.wbg.__wbg_buffer_0e2c274546535a84=function(e){return e.buffer},n.wbg.__wbg_call_3a8ceff4c9f12325=function(){return Un(function(e,t){return e.call(t)},arguments)},n.wbg.__wbg_debug_809501eb69aeeef4=function(e){console.debug(e)},n.wbg.__wbg_done_60e5165eca70220e=function(e){return e.done},n.wbg.__wbg_entries_85a648a6a5215287=function(e){return Object.entries(e)},n.wbg.__wbg_error_1c3d6d32fc1361cc=function(e){console.error(e)},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let o,a;try{o=e,a=t,console.error(St(e,t))}finally{ge.__wbindgen_free(o,a,1)}},n.wbg.__wbg_get_9c5338635800e15f=function(){return Un(function(e,t){return Reflect.get(e,t)},arguments)},n.wbg.__wbg_get_d749e505e6746136=function(e,t){return e[t>>>0]},n.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,t){return e[t]},n.wbg.__wbg_globalThis_d0fa1c7e1465604c=function(){return Un(function(){return globalThis.globalThis},arguments)},n.wbg.__wbg_global_23a7926f0ad701bc=function(){return Un(function(){return global.global},arguments)},n.wbg.__wbg_info_26a1a6efb20c9f43=function(e){console.info(e)},n.wbg.__wbg_instanceof_ArrayBuffer_c632aa9cfefb45b9=function(e){let t;try{t=e instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_instanceof_Map_212855790ec94f3b=function(e){let t;try{t=e instanceof Map}catch{t=!1}return t},n.wbg.__wbg_instanceof_Uint8Array_aa04d9da2a05b974=function(e){let t;try{t=e instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_isArray_b7133b5e9a258525=function(e){return Array.isArray(e)},n.wbg.__wbg_isSafeInteger_f6d409cd7a7eb81d=function(e){return Number.isSafeInteger(e)},n.wbg.__wbg_iterator_0210e004ec06fb30=function(){return Symbol.iterator},n.wbg.__wbg_length_bc129fab12fd2a9c=function(e){return e.length},n.wbg.__wbg_length_ee1bca74ed444cce=function(e){return e.length},n.wbg.__wbg_log_91785a95194156ea=function(e){console.log(e)},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_new_cf66b35fe5443282=function(e){return new Uint8Array(e)},n.wbg.__wbg_newnoargs_1143e0b74be16ea9=function(e,t){return new Function(St(e,t))},n.wbg.__wbg_next_4d092fa9da3ba108=function(e){return e.next},n.wbg.__wbg_next_7b79803d4b7a1b68=function(){return Un(function(e){return e.next()},arguments)},n.wbg.__wbg_now_882dd9fbc163f00d=function(e){return e.now()},n.wbg.__wbg_performance_686bdd9b0415bed6=function(e){return e.performance},n.wbg.__wbg_self_3a2c444cba620c12=function(){return Un(function(){return self.self},arguments)},n.wbg.__wbg_set_2611eb16b9ac5ca9=function(e,t,o){e.set(t,o>>>0)},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const o=t.stack,a=Sr(o,ge.__wbindgen_malloc,ge.__wbindgen_realloc),s=Yt;Kr().setInt32(e+4,s,!0),Kr().setInt32(e+0,a,!0)},n.wbg.__wbg_value_fdfbba27b1fcaf65=function(e){return e.value},n.wbg.__wbg_warn_8fc67512df65ef55=function(e){console.warn(e)},n.wbg.__wbg_window_a27f90073150a6bf=function(){return Un(function(){return window.window},arguments)},n.wbg.__wbindgen_bigint_from_i64=function(e){return e},n.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const o=t,a=typeof o=="bigint"?o:void 0;Kr().setBigInt64(e+8,ao(a)?BigInt(0):a,!0),Kr().setInt32(e+0,!ao(a),!0)},n.wbg.__wbindgen_boolean_get=function(e){const t=e;return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_debug_string=function(e,t){const o=zi(t),a=Sr(o,ge.__wbindgen_malloc,ge.__wbindgen_realloc),s=Yt;Kr().setInt32(e+4,s,!0),Kr().setInt32(e+0,a,!0)},n.wbg.__wbindgen_error_new=function(e,t){return new Error(St(e,t))},n.wbg.__wbindgen_in=function(e,t){return e in t},n.wbg.__wbindgen_init_externref_table=function(){const e=ge.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_is_bigint=function(e){return typeof e=="bigint"},n.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},n.wbg.__wbindgen_is_object=function(e){const t=e;return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return e===void 0},n.wbg.__wbindgen_jsval_eq=function(e,t){return e===t},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return e==t},n.wbg.__wbindgen_memory=function(){return ge.memory},n.wbg.__wbindgen_number_get=function(e,t){const o=t,a=typeof o=="number"?o:void 0;Kr().setFloat64(e+8,ao(a)?0:a,!0),Kr().setInt32(e+0,!ao(a),!0)},n.wbg.__wbindgen_string_get=function(e,t){const o=t,a=typeof o=="string"?o:void 0;var s=ao(a)?0:Sr(a,ge.__wbindgen_malloc,ge.__wbindgen_realloc),l=Yt;Kr().setInt32(e+4,l,!0),Kr().setInt32(e+0,s,!0)},n.wbg.__wbindgen_string_new=function(e,t){return St(e,t)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(St(e,t))},n}function d_(n,e){return ge=n.exports,lu.__wbindgen_wasm_module=e,qn=null,Oo=null,jo=null,Fo=null,ge.__wbindgen_start(),ge}async function lu(n){if(ge!==void 0)return ge;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/ltn/assets/backend_bg-Cg2-VYHk.wasm",import.meta.url));const e=c_();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:o}=await u_(await n,e);return d_(t,o)}const f_="/ltn/assets/streets-v2-style-CzuG29E5.json";function on(n,e){Re(e,!0);const[t,o]=lt(),a=u(()=>ut(ct("main")));function s(l){l.key==r(a).t(49)&&(l.stopPropagation(),Ve(wt,e.mode))}Vn("keydown",ua,s),ca(n,{onclick:()=>Ve(wt,e.mode),children:(l,i)=>{var v=jt();Q(f=>U(v,f),[()=>r(a).t(50)]),_(l,v)}}),Ne(),o()}let ei=En(null);function v_(n,e,t){let o=r(e).pop();Y(e,r(e),!0),o&&t(o)}var g_=M('<input type="checkbox"/>'),__=M("<span></span>"),p_=M("<b> </b>"),h_=M("<b> </b>"),m_=M("<b> </b>"),b_=M('<ul style="padding-right: 0; padding-left: 20px; margin: 0;"><li><!></li> <li><!></li> <li><!></li></ul>'),y_=M("<span></span> <!>",1),A_=M("<!> <!>",1),w_=M('<p> </p> <div style="display: flex; gap: 16px;"><label><!></label> <button class="secondary"><!></button></div> <!> <!> <!> <!> <!>',1);function uu(n,e){Re(e,!0);const t=()=>we(ei,"$routeTool",o),[o,a]=lt(),s=[],l=u(()=>ut(ct("main")));let i=W(e,"waypoints",15),v=W(e,"drawnShapeOut",15,void 0);function f(K,V){if(V.length<3)return JSON.parse(K.inner.calculateRoute(V));let te=JSON.parse(JSON.stringify(V));te.push(te[0]);let re=JSON.parse(K.inner.calculateRoute(te));return re.properties.waypoints.pop(),re.geometry.type=r(l).t(368),re.geometry.coordinates=[re.geometry.coordinates],re}cr(()=>{t()?.stop(),e.map.getCanvas().style.cursor="inherit"});let b=Ae("snap"),m=Ae(bt([])),C=Ae(bt([]));Qe(()=>{Y(C,z(t(),i(),r(P)),!0)});let B=Ae(null),T=Ae(!1),$=Ae(!1),P=Ae(!1);function y(){r(m).length==100&&r(m).shift(),Y(m,[...r(m),JSON.parse(JSON.stringify(i()))],!0)}function w(K){i().length>=3||(y(),i().push({point:K.lngLat.toArray(),snapped:r(b)=="snap"}),i(i()))}function O(K){Y(B,{point:K.lngLat.toArray(),snapped:r(b)=="snap"},!0)}function D(K){y(),i(i()[K].snapped=!i()[K].snapped,!0),i(i())}function N(K){y(),i().splice(K,1),i(i()),Y(T,!1)}function j(K,V,te,re){if(re||V.length>=3)return nr();try{if(K&&V.length>0&&te)return JSON.parse(K.inner.calculateRoute([V[V.length-1],te]))}catch{}return nr()}function z(K,V,te){if(te)return r(C);if(!K||V.length<3)return[];let re=[],ie=1,ne=JSON.parse(JSON.stringify(V));ne.push(ne[0]);for(let ae=0;ae<ne.length-1;ae++){let _e=JSON.parse(K.inner.getExtraNodes(ne[ae],ne[ae+1]));for(let[se,fe,oe]of _e)re.push({point:[se,fe],snapped:oe,insertIdx:ie});ie++}return re}function d(K){y(),i().splice(K.insertIdx,0,{point:K.point,snapped:K.snapped}),i(i()),Y(P,!0)}function g(K){i(i()[K.insertIdx].point=K.point,!0),i(i())}function p(){Y(P,!1)}function k(){y(),Y($,!0)}Qe(()=>{try{t()&&v(f(t(),i()))}catch(K){console.log("error drawing shape",K),v(void 0)}});let x=u(()=>j(t(),i(),r(B),r(T)||r($)));Qe(()=>{let K=i().length==0?"crosshair":"inherit";e.map.getCanvas().style.cursor=K});var A=w_(),F=Z(A),S=c(F),I=h(F,2),E=c(I);{const K=V=>{var te=g_();te.value=te.__value="snap",Q(()=>te.disabled=i().length>=3),Ai(s,[],te,()=>r(b),re=>Y(b,re)),_(V,te)};var L=c(E);{let V=u(()=>[K]),te=u(()=>r(l).cx(370));be(L,{get t(){return r(V)},get x(){return r(te)}})}}var R=h(E,2);R.__click=[v_,m,i];var G=c(R);{var J=K=>{var V=jt();Q(te=>U(V,te),[()=>r(l).t(371)]),_(K,V)},H=K=>{{let V=u(()=>r(l).cx(372)),te=u(()=>[r(m).length]);be(K,{get x(){return r(V)},get a(){return r(te)}})}};ve(G,K=>{r(m).length==0?K(J):K(H,!1)})}var X=h(I,2);fa(X,{onclick:w,onmousemove:O});var le=h(X,2);qt(le,17,()=>r(C),Jt,(K,V,te)=>{co(K,{draggable:!0,ondragstart:()=>d(r(V)),ondrag:()=>g(r(V)),ondragend:p,onclick:()=>{d(r(V)),Y(P,!1)},zIndex:0,get lngLat(){return r(V).point},set lngLat(re){r(V).point=re},children:(re,ie)=>{var ne=__();let ae;Q(_e=>ae=Et(ne,1,"dot svelte-29me5d",null,ae,_e),[()=>({"snapped-node":r(V).snapped,"free-node":!r(V).snapped,hide:r(P)})]),_(re,ne)},$$slots:{default:!0}})});var q=h(le,2);qt(q,17,i,Jt,(K,V,te)=>{co(K,{draggable:!0,onclick:()=>D(te),oncontextmenu:()=>N(te),onmouseenter:()=>Y(T,!0),onmouseleave:()=>Y(T,!1),ondragstart:k,ondragend:()=>Y($,!1),zIndex:1,get lngLat(){return r(V).point},set lngLat(re){r(V).point=re},children:(re,ie)=>{var ne=y_(),ae=Z(ne);let _e;ae.textContent=te+1;var se=h(ae,2);Bt(se,{openOn:"hover",popupClass:"edit-waypoint-popup",children:(oe,ye)=>{var he=b_(),xe=c(he);{const Ie=(Te,me=Pe)=>{var Me=p_(),Fe=c(Me);Q(Le=>U(Fe,Le),[()=>r(l).tx(me())]),_(Te,Me)};var Se=c(xe);{let Te=u(()=>[Ie]),me=u(()=>r(l).cx(182));be(Se,{get t(){return r(Te)},get x(){return r(me)}})}}var De=h(xe,2);{const Ie=(Te,me=Pe)=>{var Me=h_(),Fe=c(Me);Q(Le=>U(Fe,Le),[()=>r(l).tx(me())]),_(Te,Me)};var ke=c(De);{let Te=u(()=>[Ie]),me=u(()=>r(l).cx(373));be(ke,{get t(){return r(Te)},get x(){return r(me)}})}}var Ee=h(De,2);{const Ie=(Te,me=Pe)=>{var Me=m_(),Fe=c(Me);Q(Le=>U(Fe,Le),[()=>r(l).tx(me())]),_(Te,Me)};var pe=c(Ee);{let Te=u(()=>[Ie]),me=u(()=>r(l).cx(183));be(pe,{get t(){return r(Te)},get x(){return r(me)}})}}_(oe,he)},$$slots:{default:!0}}),Q(fe=>_e=Et(ae,1,"dot svelte-29me5d",null,_e,fe),[()=>({snapped:r(V).snapped})]),_(re,ne)},$$slots:{default:!0}})});var ee=h(q,2);{let K=u(()=>v()||nr());st(ee,{get data(){return r(K)},generateId:!0,children:(V,te)=>{var re=A_(),ie=Z(re);{let ae=u(()=>He("draw-area-lines"));gt(ie,Ce(()=>r(ae),{paint:{"line-color":"black","line-width":10}}))}var ne=h(ie,2);{let ae=u(()=>He("draw-area-area"));ur(ne,Ce(()=>r(ae),{paint:{"fill-color":"grey","fill-opacity":.5}}))}_(V,re)},$$slots:{default:!0}})}var ue=h(ee,2);st(ue,{get data(){return r(x)},children:(K,V)=>{{let te=u(()=>He("draw-area-lines-preview"));gt(K,Ce(()=>r(te),{paint:{"line-color":"black","line-width":3}}))}},$$slots:{default:!0}}),Q(K=>{U(S,K),R.disabled=r(m).length==0},[()=>r(l).t(369)]),_(n,A),Ne(),a()}er(["click"]);var x_=M('<div><div class="bucket-color svelte-4l5cu8"></div> <div class="bucket-indicator svelte-4l5cu8"><!></div></div>'),$_=M('<div class="colors svelte-4l5cu8"></div>');function Gn(n,e){function t(s,l){let i=0;for(let v of s.slice(1,-1)){if(l<v)break;i++}return i}let o=u(()=>t(e.limits,e.value));var a=$_();qt(a,21,()=>e.colorScale,Jt,(s,l,i)=>{var v=x_();let f;var b=c(v);let m;var C=h(b,2),B=c(C);Nc(B,{strokeWidth:"4px",size:"14px"}),Q((T,$)=>{f=Et(v,1,"bucket svelte-4l5cu8",null,f,T),m=dr(b,"",m,$)},[()=>({selected:i==r(o)}),()=>({background:r(l)})]),_(s,v)}),_(n,a)}var k_=M("<tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td> </td></tr>",1),S_=M('<table class="svelte-j2xl4e"><tbody><tr><th><!></th><td><!></td></tr><!></tbody></table>');function cu(n,e){Re(e,!0);const t=()=>we(Vr,"$appFocus",a),o=()=>we(po,"$metricBuckets",a),[a,s]=lt(),l=u(()=>ut(ct("main")));var i=S_(),v=c(i),f=c(v),b=c(f);{const P=y=>{Gn(y,{get colorScale(){return Ui},get limits(){return Ji},get value(){return e.neighbourhoodBoundary.properties.area_km2}})};var m=c(b);{let y=u(()=>[P]),w=u(()=>r(l).cx(107));be(m,{get t(){return r(y)},get x(){return r(w)}})}}var C=h(b),B=c(C);{let P=u(()=>r(l).cx(108)),y=u(()=>[e.neighbourhoodBoundary.properties.area_km2.toFixed(1)]);be(B,{get x(){return r(P)},get a(){return r(y)}})}var T=h(f);{var $=P=>{var y=k_(),w=Z(y),O=c(w);{const ie=ne=>{{let ae=u(()=>Zo.toReversed()),_e=u(()=>100-e.neighbourhoodBoundary.properties.simd);Gn(ne,{get colorScale(){return r(ae)},get limits(){return Xo},get value(){return r(_e)}})}};var D=c(O);{let ne=u(()=>[ie]),ae=u(()=>r(l).cx(109));be(D,{get t(){return r(ne)},get x(){return r(ae)}})}}var N=h(O),j=c(N);{let ie=u(()=>r(l).cx(110)),ne=u(()=>[1+Math.floor(e.neighbourhoodBoundary.properties.simd/20)]);be(j,{get x(){return r(ie)},get a(){return r(ne)}})}var z=h(w,2),d=c(z);{const ie=ne=>{{let ae=u(()=>e.neighbourhoodBoundary.properties.population/e.neighbourhoodBoundary.properties.area_km2);Gn(ne,{get colorScale(){return Qo},get limits(){return o().population_density},get value(){return r(ae)}})}};var g=c(d);{let ne=u(()=>[ie]),ae=u(()=>r(l).cx(111));be(g,{get t(){return r(ne)},get x(){return r(ae)}})}}var p=h(d),k=c(p);{let ie=u(()=>r(l).cx(112)),ne=u(()=>[Math.round(e.neighbourhoodBoundary.properties.population/e.neighbourhoodBoundary.properties.area_km2).toLocaleString()]);be(k,{get x(){return r(ie)},get a(){return r(ne)}})}var x=h(z,2),A=c(x);{const ie=ne=>{{let ae=u(()=>Vo.toReversed()),_e=u(()=>100*(1-e.neighbourhoodBoundary.properties.households_with_cars_or_vans/e.neighbourhoodBoundary.properties.total_households));Gn(ne,{get colorScale(){return r(ae)},get limits(){return Ko},get value(){return r(_e)}})}};var F=c(A);{let ne=u(()=>[ie]),ae=u(()=>r(l).cx(113));be(F,{get t(){return r(ne)},get x(){return r(ae)}})}}var S=h(A),I=c(S);{let ie=u(()=>r(l).cx(114)),ne=u(()=>[Di(e.neighbourhoodBoundary.properties.households_with_cars_or_vans,e.neighbourhoodBoundary.properties.total_households)]);be(I,{get x(){return r(ie)},get a(){return r(ne)}})}var E=h(x,2),L=c(E);{const ie=ne=>{{let ae=u(()=>e.neighbourhoodBoundary.properties.number_pois/e.neighbourhoodBoundary.properties.area_km2);Gn(ne,{get colorScale(){return Gi},get limits(){return o().poi_density},get value(){return r(ae)}})}};var R=c(L);{let ne=u(()=>[ie]),ae=u(()=>r(l).cx(115));be(R,{get t(){return r(ne)},get x(){return r(ae)}})}}var G=h(L),J=c(G);{let ie=u(()=>r(l).cx(116)),ne=u(()=>[(e.neighbourhoodBoundary.properties.number_pois/e.neighbourhoodBoundary.properties.area_km2).toFixed(1)]);be(J,{get x(){return r(ie)},get a(){return r(ne)}})}var H=h(E,2),X=c(H);{const ie=ne=>{{let ae=u(()=>e.neighbourhoodBoundary.properties.number_stats19_collisions/e.neighbourhoodBoundary.properties.area_km2);Gn(ne,{get colorScale(){return Wi},get limits(){return o().collision_density},get value(){return r(ae)}})}};var le=c(X);{let ne=u(()=>[ie]),ae=u(()=>r(l).cx(117));be(le,{get t(){return r(ne)},get x(){return r(ae)}})}}var q=h(X),ee=c(q);{let ie=u(()=>r(l).cx(116)),ne=u(()=>[(e.neighbourhoodBoundary.properties.number_stats19_collisions/e.neighbourhoodBoundary.properties.area_km2).toFixed(1)]);be(ee,{get x(){return r(ie)},get a(){return r(ne)}})}var ue=h(H,2),K=c(ue);{const ie=ne=>{Gn(ne,{get colorScale(){return qi},get limits(){return Hi},get value(){return e.neighbourhoodBoundary.properties.combined_score}})};var V=c(K);{let ne=u(()=>[ie]),ae=u(()=>r(l).cx(118));be(V,{get t(){return r(ne)},get x(){return r(ae)}})}}var te=h(K),re=c(te);Q(()=>U(re,`${e.neighbourhoodBoundary.properties.combined_score??""} / 5`)),_(P,y)};ve(T,P=>{t()=="cnt"&&P($)})}_(n,i),Ne(),s()}function du(n,e,t){let o=new Set(n.toSavefile().features.filter(a=>a.properties.kind=="boundary").map(a=>a.properties.name));for(;;){let a=window.prompt(e,t);if(a===null)return null;if(a=a.trim(),a==="")window.alert("Neighbourhood cannot be blank; please pick a name or cancel");else if(o.has(a))window.alert(`There is already a neighbourhood called ${a}; please pick another name`);else return a}}var E_=M('<!> <div class="sub-labels svelte-173u12u"><span></span> <span> </span> <span></span></div>',1),L_=M('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span> <span> </span></div>',1),C_=M('<!> <div style="display: flex; justify-content: space-between;"><span style="text-align: center; width: 100%"> </span></div>',1),M_=M('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span></div>',1),P_=M('<!> <div style="text-align: center;"> </div>',1),T_=M('<!> <div style="text-align: center;"> </div>',1),I_=M('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span></div> <br/> <p> </p>',1),R_=M('<div style="display: flex; gap: 16px; align-items: center; width: fit-content;"><label style="margin: 0; padding: 0;" for="prioritization-selection"> </label> <select id="prioritization-selection"><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option></select></div> <!>',1);function fu(n,e){Re(e,!0);const t=()=>we(Vr,"$appFocus",a),o=()=>we(po,"$metricBuckets",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=W(e,"selectedPrioritization",15);function v(){let E=new URL(window.location.href).searchParams.get("prioritisationMetric");E=="area"?i("area"):E=="population_density"?i("population_density"):E=="simd"?i("simd"):E=="stats19"?i("stats19"):E=="pois"?i("pois"):E=="car_ownership"?i("car_ownership"):E=="combined"&&i("combined")}t()=="cnt"?v():i("none"),Qe(()=>{const E=new URL(window.location.href);i()=="none"?E.searchParams.delete("prioritisationMetric"):E.searchParams.set("prioritisationMetric",i()),history.replaceState({},"",E)});var f=R_(),b=Z(f),m=c(b),C=c(m),B=h(m,2),T=c(B),$=c(T);T.value=T.__value="none";var P=h(T),y=c(P);P.value=P.__value="area";var w=h(P),O=c(w);w.value=w.__value="simd";var D=h(w),N=c(D);D.value=D.__value="population_density";var j=h(D),z=c(j);j.value=j.__value="car_ownership";var d=h(j),g=c(d);d.value=d.__value="pois";var p=h(d),k=c(p);p.value=p.__value="stats19";var x=h(p),A=c(x);x.value=x.__value="combined";var F=h(b,2);{var S=E=>{var L=E_(),R=Z(L);{let X=u(()=>({limits:Ji}));br(R,{get colorScale(){return Ui},get labels(){return r(X)}})}var G=h(R,2),J=h(c(G),2),H=c(J);Q(X=>U(H,X),[()=>r(l).t(267)]),_(E,L)},I=E=>{var L=$e(),R=Z(L);{var G=H=>{var X=L_(),le=Z(X);{let ie=u(()=>({limits:o().population_density}));br(le,{get colorScale(){return Qo},get labels(){return r(ie)}})}var q=h(le,2),ee=c(q),ue=c(ee),K=h(ee,2),V=c(K),te=h(K,2),re=c(te);Q((ie,ne,ae)=>{U(ue,ie),U(V,ne),U(re,ae)},[()=>r(l).t(214),()=>r(l).t(215),()=>r(l).t(216)]),_(H,X)},J=H=>{var X=$e(),le=Z(X);{var q=ue=>{var K=C_(),V=Z(K);{let ne=u(()=>Vo.toReversed()),ae=u(()=>({limits:Ko.toReversed().map(_e=>`${_e}%`)}));br(V,{get colorScale(){return r(ne)},get labels(){return r(ae)}})}var te=h(V,2),re=c(te),ie=c(re);Q(ne=>U(ie,ne),[()=>r(l).t(219)]),_(ue,K)},ee=ue=>{var K=$e(),V=Z(K);{var te=ie=>{var ne=M_(),ae=Z(ne);{let he=u(()=>Zo.toReversed()),xe=u(()=>({buckets:hl(Xo).toReversed()}));br(ae,{get colorScale(){return r(he)},get labels(){return r(xe)}})}var _e=h(ae,2),se=c(_e),fe=c(se),oe=h(se,2),ye=c(oe);Q((he,xe)=>{U(fe,he),U(ye,xe)},[()=>r(l).t(210),()=>r(l).t(211)]),_(ie,ne)},re=ie=>{var ne=$e(),ae=Z(ne);{var _e=fe=>{var oe=P_(),ye=Z(oe);{let Se=u(()=>({limits:o().collision_density}));br(ye,{get colorScale(){return Wi},get labels(){return r(Se)}})}var he=h(ye,2),xe=c(he);Q(Se=>U(xe,Se),[()=>r(l).t(268)]),_(fe,oe)},se=fe=>{var oe=$e(),ye=Z(oe);{var he=Se=>{var De=T_(),ke=Z(De);{let Ie=u(()=>({limits:o().poi_density}));br(ke,{get colorScale(){return Gi},get labels(){return r(Ie)}})}var Ee=h(ke,2),pe=c(Ee);Q(Ie=>U(pe,Ie),[()=>r(l).t(269)]),_(Se,De)},xe=Se=>{var De=$e(),ke=Z(De);{var Ee=pe=>{var Ie=I_(),Te=Z(Ie);{let Be=u(()=>({buckets:Hi}));br(Te,{get colorScale(){return qi},get labels(){return r(Be)}})}var me=h(Te,2),Me=c(me),Fe=c(Me),Le=h(Me,2),qe=c(Le),Oe=h(me,4),Ze=c(Oe);Q((Be,We,Je)=>{U(Fe,Be),U(qe,We),U(Ze,Je)},[()=>r(l).t(270),()=>r(l).t(271),()=>r(l).t(272)]),_(pe,Ie)};ve(ke,pe=>{i()=="combined"&&pe(Ee)},!0)}_(Se,De)};ve(ye,Se=>{i()=="pois"?Se(he):Se(xe,!1)},!0)}_(fe,oe)};ve(ae,fe=>{i()=="stats19"?fe(_e):fe(se,!1)},!0)}_(ie,ne)};ve(V,ie=>{i()=="simd"?ie(te):ie(re,!1)},!0)}_(ue,K)};ve(le,ue=>{i()=="car_ownership"?ue(q):ue(ee,!1)},!0)}_(H,X)};ve(R,H=>{i()=="population_density"?H(G):H(J,!1)},!0)}_(E,L)};ve(F,E=>{i()=="area"?E(S):E(I,!1)})}Q((E,L,R,G,J,H,X,le,q)=>{U(C,E),U($,L),U(y,R),U(O,G),U(N,J),U(z,H),U(g,X),U(k,le),U(A,q)},[()=>r(l).t(262),()=>r(l).t(263),()=>r(l).t(264),()=>r(l).t(209),()=>r(l).t(213),()=>r(l).t(218),()=>r(l).t(265),()=>r(l).t(243),()=>r(l).t(266)]),vn(B,i),_(n,f),Ne(),s()}function vu(n,e,t){return{none:n.none,area:yr(["get","area_km2"],Ji,Ui),car_ownership:yr(["*",100,["/",["get","households_with_cars_or_vans"],["get","total_households"]]],Ko,Vo),population_density:yr(["/",["get","population"],["get","area_km2"]],t.population_density,Qo),pois:yr(["/",["get","number_pois"],["get","area_km2"]],t.poi_density,Gi),simd:yr(["get","simd"],Xo,Zo),stats19:yr(["/",["get","number_stats19_collisions"],["get","area_km2"]],t.collision_density,Wi),combined:yr(["get","combined_score"],Hi,qi)}[e]}function N_(n,e){Qi("auto_boundaries.geojson",JSON.stringify(r(e),null,"  "))}function B_(n,e,t,o){Y(e,null),r(t).clear(),Y(t,r(t),!0),Y(o,[],!0)}var F_=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav>'),O_=M("<h3> </h3> <p> </p> <!>",1),j_=M("<p> </p>"),z_=(n,e)=>Y(e,"choose-area"),D_=M("<button><!></button>"),U_=(n,e)=>Y(e,"draw-area"),G_=M("<button><!></button>"),W_=M('<div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div> <div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div>',1),H_=M('<div><h3 class="svelte-1ly46ps"> </h3></div> <!> <div style="margin-top: 16px;"><h3 class="svelte-1ly46ps"> </h3> <p> </p></div>',1),q_=(n,e,t)=>e(r(t)),J_=M('<span style="text-align:center;"><!></span>'),Q_=M('<!> <!> <!> <hr/> <div><div class="tool-palette svelte-1ly46ps" style="display: flex; align-items: center; gap: 16px;"><!></div> <!> <div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div> <div style="display: flex; gap: 16px; justify-content: space-between; margin-bottom: 16px;"><button> </button> <button class="destructive" style="display: flex; gap: 8px; align-items: center;"><!></button></div> <h3> </h3> <div class="neighbourhood-boundary-summary svelte-1ly46ps"><!></div></div> <hr/> <button class="secondary"> </button>',1),Z_=M("<!> <!>",1),V_=M("<b> </b>"),K_=M("<b> </b>"),X_=M("<br/>"),Y_=M("<b> </b>"),ep=M("<br/>"),tp=M("<b> </b>"),rp=M("<br/>"),np=M("<b> </b>"),op=M("<br/>"),ap=M("<b> </b> <br/> ",1),ip=M("<!> <!>",1),sp=M("<!> <!>",1),lp=M("<!> <!>",1);function up(n,e){Re(e,!0);const t=()=>we(Vr,"$appFocus",f),o=()=>we(Rt,"$backend",f),a=()=>we(ho,"$projectStorage",f),s=()=>we(_n,"$currentProjectID",f),l=()=>we(wt,"$mode",f),i=()=>we(po,"$metricBuckets",f),v=()=>we(Zr,"$map",f),[f,b]=lt(),m=u(()=>ut(ct("main")));let C=Ae("Generating severance boundaries..."),B=Ae(bt(nr())),T=Ae("choose-area"),$=Ae(bt(t()=="cnt"?"combined":"none")),P=Ae(null),y=Ae(bt(new Map)),w=Ae(bt([])),O=Ae(void 0),D=u(()=>{if(r(O)&&r(O).geometry.coordinates[0].length>3){let F={type:"FeatureCollection",features:[r(O)]};try{return o().generateMergedBoundary(F)}catch(S){console.log(`error merging boundaries: ${S}`)}}return null}),N=u(()=>r(T)=="draw-area"?r(D):r(P));nn(async()=>{await Va(),Y(B,o().generatedBoundaries(),!0),Y(C,"")});function j(F){let S=F.features[0].id,I=r(B).features[S],E=new Map(r(y));if(E.has(S)?E.delete(S):E.set(S,I),E.size===0)Y(P,null),Y(y,E,!0);else if(E.size===1)Y(P,E.values().next().value,!0),Y(y,E,!0);else{let L={type:"FeatureCollection",features:Array.from(E.values())};try{Y(P,o().generateMergedBoundary(L),!0),Y(y,E,!0)}catch(R){console.log(`error merging boundaries: ${R}`),window.alert(`Sorry, the boundaries you selected cannot be merged.
Error: ${R}`)}}}function z(F){let S=a().nextAvailableNeighbourhoodName(s()),I=du(o(),r(m).t(15),S);if(I)try{const E={};r(T)=="draw-area"&&r(O)?.properties?.waypoints&&(E.waypoints=r(O).properties.waypoints);let L={type:"Feature",properties:E,geometry:F.geometry};o().setCurrentNeighbourhoodBoundary(I,L),Ve(io,I),ra(),Ve(wt,{mode:"neighbourhood"})}catch(E){window.alert(`Sorry, this boundary is invalid: ${E}`)}}function d(F){return vu({none:["match",["%",["id"],5],0,"blue",1,"yellow",2,"green",3,"purple",4,"orange","black"]},F,i())}function g(F){return{none:xt(.3,.5),area:xt(.7,.9),car_ownership:xt(.7,.9),population_density:xt(.7,.9),pois:xt(.7,.9),simd:xt(.7,.9),stats19:xt(.7,.9),combined:xt(.7,.9)}[F]}function p(F){F.key==r(m).t(16)&&r(N)&&z(r(N))}var k=lp();Vn("keydown",ua,p);var x=Z(k);vo(x,{get loading(){return r(C)}});var A=h(x,2);Lr(A,{top:E=>{var L=F_(),R=c(L),G=c(R),J=c(G);Xe(J,{mode:{mode:"title"}});var H=h(G,2),X=c(H);Xe(X,{mode:{mode:"pick-neighbourhood"}});var le=h(H,2),q=c(le);Q(ee=>U(q,ee),[()=>Ar(l().mode)]),_(E,L)},left:E=>{var L=Q_(),R=Z(L);on(R,{mode:{mode:"pick-neighbourhood"}});var G=h(R,2);{var J=me=>{var Me=O_(),Fe=Z(Me),Le=c(Fe),qe=h(Fe,2),Oe=c(qe),Ze=h(qe,2);fu(Ze,{get selectedPrioritization(){return r($)},set selectedPrioritization(Be){Y($,Be,!0)}}),Q((Be,We)=>{U(Le,Be),U(Oe,We)},[()=>r(m).t(17),()=>r(m).t(18)]),_(me,Me)};ve(G,me=>{t()=="cnt"&&me(J)})}var H=h(G,2);{var X=me=>{var Me=j_(),Fe=c(Me);Q(Le=>U(Fe,Le),[()=>r(m).t(19)]),_(me,Me)};ve(H,me=>{r($)=="none"&&me(X)})}var le=h(H,4),q=c(le);{const me=(Fe,Le=Pe)=>{var qe=D_();qe.__click=[z_,T];let Oe;{const Be=We=>{Il(We,{})};var Ze=c(qe);{let We=u(()=>[Be]);be(Ze,{get t(){return r(We)},get x(){return Le()},n:!0})}}Q(Be=>Oe=Et(qe,1,"",null,Oe,Be),[()=>({active:r(T)=="choose-area"})]),_(Fe,qe)},Me=(Fe,Le=Pe)=>{var qe=G_();qe.__click=[U_,T];let Oe;{const Be=We=>{Ki(We,{})};var Ze=c(qe);{let We=u(()=>[Be]);be(Ze,{get t(){return r(We)},get x(){return Le()},n:!0})}}Q(Be=>Oe=Et(qe,1,"",null,Oe,Be),[()=>({active:r(T)=="draw-area"})]),_(Fe,qe)};var ee=c(q);{let Fe=u(()=>[me,Me]),Le=u(()=>r(m).cx(20));be(ee,{get t(){return r(Fe)},get x(){return r(Le)}})}}var ue=h(q,2);{var K=me=>{var Me=W_(),Fe=Z(Me);let Le;var qe=c(Fe),Oe=c(qe),Ze=h(qe,2),Be=c(Ze),We=h(Fe,2);let Je;var tt=c(We),yt=c(tt),dt=h(tt,2),kt=c(dt);Q(($t,_t,at,et,pt,Mt)=>{Le=Et(Fe,1,"step svelte-1ly46ps",null,Le,$t),U(Oe,_t),U(Be,at),Je=Et(We,1,"step svelte-1ly46ps",null,Je,et),U(yt,pt),U(kt,Mt)},[()=>({active:!r(N),complete:r(N)}),()=>r(m).t(21),()=>r(m).t(22),()=>({active:r(N),complete:r(y).size>1}),()=>r(m).t(23),()=>r(m).t(24)]),_(me,Me)},V=me=>{var Me=$e(),Fe=Z(Me);{var Le=qe=>{var Oe=H_(),Ze=Z(Oe);let Be;var We=c(Ze),Je=c(We),tt=h(Ze,2);uu(tt,{get map(){return v()},get waypoints(){return r(w)},set waypoints(et){Y(w,et,!0)},get drawnShapeOut(){return r(O)},set drawnShapeOut(et){Y(O,et,!0)}});var yt=h(tt,2);let dt;var kt=c(yt),$t=c(kt),_t=h(kt,2),at=c(_t);Q((et,pt,Mt,Ct,ht)=>{Be=Et(Ze,1,"step svelte-1ly46ps",null,Be,et),U(Je,pt),dt=Et(yt,1,"step svelte-1ly46ps",null,dt,Mt),U($t,Ct),U(at,ht)},[()=>({active:!r(N),complete:r(N)}),()=>r(m).t(25),()=>({active:r(N),complete:r(y).size>1}),()=>r(m).t(26),()=>r(m).t(27)]),_(qe,Oe)};ve(Fe,qe=>{r(T)=="draw-area"&&qe(Le)},!0)}_(me,Me)};ve(ue,me=>{r(T)=="choose-area"?me(K):me(V,!1)})}var te=h(ue,2);let re;var ie=c(te),ne=c(ie),ae=h(ie,2),_e=c(ae),se=h(te,2),fe=c(se);fe.__click=[q_,z,N];var oe=c(fe),ye=h(fe,2);ye.__click=[B_,P,y,w];{const me=Me=>{Ya(Me,{})};var he=c(ye);{let Me=u(()=>[me]),Fe=u(()=>r(m).cx(31));be(he,{get t(){return r(Me)},get x(){return r(Fe)}})}}var xe=h(se,2),Se=c(xe),De=h(xe,2),ke=c(De);{var Ee=me=>{cu(me,{get neighbourhoodBoundary(){return r(N)}})},pe=me=>{var Me=J_(),Fe=c(Me);{var Le=Oe=>{var Ze=jt();Q(Be=>U(Ze,Be),[()=>r(m).t(33)]),_(Oe,Ze)},qe=Oe=>{var Ze=$e(),Be=Z(Ze);{var We=Je=>{var tt=$e(),yt=Z(tt);{var dt=$t=>{var _t=jt();Q(at=>U(_t,at),[()=>r(m).t(34)]),_($t,_t)},kt=$t=>{var _t=jt();Q(at=>U(_t,at),[()=>r(m).t(35)]),_($t,_t)};ve(yt,$t=>{r(w).length<3?$t(dt):$t(kt,!1)})}_(Je,tt)};ve(Be,Je=>{r(T)=="draw-area"&&Je(We)},!0)}_(Oe,Ze)};ve(Fe,Oe=>{r(T)=="choose-area"?Oe(Le):Oe(qe,!1)})}_(me,Me)};ve(ke,me=>{r(N)?me(Ee):me(pe,!1)})}var Ie=h(le,4);Ie.__click=[N_,B];var Te=c(Ie);Q((me,Me,Fe,Le,qe,Oe)=>{re=Et(te,1,"step svelte-1ly46ps",null,re,me),U(ne,Me),U(_e,Fe),fe.disabled=!r(N),U(oe,Le),ye.disabled=!(r(N)||r(T)=="draw-area"&&r(w).length>0),U(Se,qe),U(Te,Oe)},[()=>({active:r(N)}),()=>r(m).t(28),()=>r(m).t(29),()=>r(m).t(30),()=>r(m).t(32),()=>r(m).t(36)]),_(E,L)},main:E=>{var L=sp(),R=Z(L);{var G=X=>{{let le=u(()=>({type:r(m).t(37),features:[r(N)]}));st(X,{get data(){return r(le)},children:(q,ee)=>{var ue=Z_(),K=Z(ue);{let te=u(()=>He("neighbourhood-boundaries-selected-outline",!1));gt(K,Ce(()=>r(te),{paint:{"line-color":"black","line-width":4,"line-dasharray":[2,2]}}))}var V=h(K,2);{let te=u(()=>He("neighbourhood-boundaries-selected-outline-base",!1));gt(V,Ce(()=>r(te),{paint:{"line-color":"white","line-width":8}}))}_(q,ue)},$$slots:{default:!0}})}};ve(R,X=>{r(N)&&X(G)})}var J=h(R,2);{var H=X=>{st(X,{get data(){return r(B)},generateId:!0,children:(le,q)=>{var ee=ip(),ue=Z(ee);{let V=u(()=>He("neighbourhood-boundaries",!1)),te=u(()=>({"fill-color":d(r($)),"fill-opacity":g(r($))}));ur(ue,Ce(()=>r(V),{get paint(){return r(te)},manageHoverState:!0,hoverCursor:"pointer",onclick:j,children:(re,ie)=>{var ne=$e(),ae=Z(ne);{var _e=se=>{Bt(se,{openOn:"hover",children:(oe,ye)=>{let he=()=>ye?.().data;const xe=u(()=>he().properties);var Se=$e(),De=Z(Se);{var ke=pe=>{const Ie=(Te,me=Pe)=>{var Me=V_(),Fe=c(Me);Q(Le=>U(Fe,Le),[()=>r(m).tx(me())]),_(Te,Me)};{let Te=u(()=>[Ie]),me=u(()=>r(m).cx(38)),Me=u(()=>[r(xe).area_km2.toFixed(1)]);be(pe,{get t(){return r(Te)},get x(){return r(me)},get a(){return r(Me)}})}},Ee=pe=>{var Ie=$e(),Te=Z(Ie);{var me=Fe=>{const Le=(Oe,Ze=Pe)=>{var Be=K_(),We=c(Be);Q(Je=>U(We,Je),[()=>r(m).tx(Ze())]),_(Oe,Be)},qe=Oe=>{var Ze=X_();_(Oe,Ze)};{let Oe=u(()=>[Le,qe]),Ze=u(()=>r(m).cx(39)),Be=u(()=>[Di(r(xe).households_with_cars_or_vans,r(xe).total_households),r(xe).total_households.toLocaleString()]);be(Fe,{get t(){return r(Oe)},get x(){return r(Ze)},get a(){return r(Be)}})}},Me=Fe=>{var Le=$e(),qe=Z(Le);{var Oe=Be=>{const We=(tt,yt=Pe)=>{var dt=Y_(),kt=c(dt);Q($t=>U(kt,$t),[()=>r(m).tx(yt())]),_(tt,dt)},Je=tt=>{var yt=ep();_(tt,yt)};{let tt=u(()=>[We,Je]),yt=u(()=>r(m).cx(40)),dt=u(()=>[Math.round(r(xe).population/r(xe).area_km2).toLocaleString()]);be(Be,{get t(){return r(tt)},get x(){return r(yt)},get a(){return r(dt)}})}},Ze=Be=>{var We=$e(),Je=Z(We);{var tt=dt=>{const kt=(_t,at=Pe)=>{var et=tp(),pt=c(et);Q(Mt=>U(pt,Mt),[()=>r(m).tx(at())]),_(_t,et)},$t=_t=>{var at=rp();_(_t,at)};{let _t=u(()=>[kt,$t]),at=u(()=>r(m).cx(41)),et=u(()=>[(r(xe).number_stats19_collisions/r(xe).area_km2).toFixed(1)]);be(dt,{get t(){return r(_t)},get x(){return r(at)},get a(){return r(et)}})}},yt=dt=>{var kt=$e(),$t=Z(kt);{var _t=et=>{const pt=(Ct,ht=Pe)=>{var Gt=np(),Dt=c(Gt);Q(sr=>U(Dt,sr),[()=>r(m).tx(ht())]),_(Ct,Gt)},Mt=Ct=>{var ht=op();_(Ct,ht)};{let Ct=u(()=>[pt,Mt]),ht=u(()=>r(m).cx(42)),Gt=u(()=>[(r(xe).number_pois/r(xe).area_km2).toFixed(1)]);be(et,{get t(){return r(Ct)},get x(){return r(ht)},get a(){return r(Gt)}})}},at=et=>{var pt=$e(),Mt=Z(pt);{var Ct=ht=>{var Gt=ap(),Dt=Z(Gt),sr=c(Dt),an=h(Dt,3);Q(pr=>{U(sr,pr),U(an,` ${r(xe).combined_score??""}`)},[()=>r(m).t(43)]),_(ht,Gt)};ve(Mt,ht=>{r($)=="combined"&&ht(Ct)},!0)}_(et,pt)};ve($t,et=>{r($)=="pois"?et(_t):et(at,!1)},!0)}_(dt,kt)};ve(Je,dt=>{r($)=="stats19"?dt(tt):dt(yt,!1)},!0)}_(Be,We)};ve(qe,Be=>{r($)=="population_density"?Be(Oe):Be(Ze,!1)},!0)}_(Fe,Le)};ve(Te,Fe=>{r($)=="car_ownership"?Fe(me):Fe(Me,!1)},!0)}_(pe,Ie)};ve(De,pe=>{r($)=="none"||r($)=="area"?pe(ke):pe(Ee,!1)})}_(oe,Se)},$$slots:{default:!0}})};ve(ae,se=>{r($)!="simd"&&se(_e)})}_(re,ne)},$$slots:{default:!0}}))}var K=h(ue,2);{let V=u(()=>He("neighbourhood-boundaries-outline",!1));gt(K,Ce(()=>r(V),{paint:{"line-color":"black","line-width":1}}))}_(le,ee)},$$slots:{default:!0}})};ve(J,X=>{r(T)=="choose-area"&&X(H)})}_(E,L)},$$slots:{top:!0,left:!0,main:!0}}),_(n,k),Ne(),b()}er(["click"]);const cp="/ltn/assets/bus_gate_icon-uqLuLB7T.gif",dp="/ltn/assets/bus_gate-Dqp8PR-8.gif",fp="/ltn/assets/no_entry_icon-C0369Zpr.gif",vp="/ltn/assets/no_entry-t5FpsRr-.gif",gp="/ltn/assets/school_street_icon-Dc8MrJ0F.gif",_p="/ltn/assets/school_street-C6xhQwM-.gif",pp="/ltn/assets/walk_cycle_only_icon-Cx19XghM.gif",hp="/ltn/assets/walk_cycle_only-4uLhWa-f.gif";class Ot{filterType;label;description;imageUrl;iconUrl;constructor(e,t,o,a,s){this.filterType=e,this.label=t,this.description=o,this.imageUrl=a,this.iconUrl=s}get iconURL(){return this.iconUrl}get largeImageURL(){return this.imageUrl}static getFilter(e){switch(e){case"walk_cycle_only":return Ot.walkCycleOnly;case"no_entry":return Ot.noEntry;case"bus_gate":return Ot.busGate;case"school_street":return Ot.schoolStreet;default:console.assert(`unknown filter type: "${e}"`);return}}static walkCycleOnly=new Ot("walk_cycle_only","Walking/cycling only","A physical barrier that only allows people walking, cycling, and rolling to pass. Often planters or bollards. Larger vehicles cannot enter.",hp,pp);static noEntry=new Ot("no_entry","No entry","An alternative sign to indicate vehicles are not allowed to enter the street. Only people walking, cycling, and rolling may pass through.",vp,fp);static busGate=new Ot("bus_gate","Bus gate","A bus gate sign and traffic cameras are installed to allow buses, pedestrians, and cyclists to pass. There is no physical barrier.",dp,cp);static schoolStreet=new Ot("school_street","School street","A closure during school hours only. The barrier usually allows teachers and staff to access the school.",_p,gp);static allTypes=[Ot.walkCycleOnly,Ot.noEntry,Ot.busGate,Ot.schoolStreet]}var mp=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),bp=M('<input type="checkbox" role="switch"/>'),yp=M("<u> </u> <p><!></p> <p><!></p> <p><!></p>",1),Ap=M("<p> </p>"),wp=M("<!> <p><!></p> <label><!></label> <p><!></p> <!> <hr/> <!>",1),xp=M("<!> <!>",1);function $p(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",a),o=()=>we(wt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=Ae(bt(nr()));try{Y(i,t().getDemandModel(),!0)}catch{window.alert("No demand model for this area"),Ve(wt,{mode:"pick-neighbourhood"})}let v=Ae(!1),f=Ae(void 0);function b(w,O){if(w==null){let D=O?"sum_to":"sum_from",N=Math.max(...r(i).features.map(z=>z.properties[D])),j=m(N);return[j,yr(["get",D],j,ma)]}else{let D=O?"counts_to":"counts_from",N=[...r(i).features.map(d=>d.properties[D][w])],j=Math.max(...N),z=m(j);return[z,yr(["at",["id"],["literal",N]],z,ma)]}}function m(w){let O=ma.length+1;return Array.from(Array(O).keys()).map(D=>Math.round(w/(O-1)*D))}let C=u(()=>r(f)?r(f).id:null),B=u(()=>r(C)!=null?r(i).features[r(C)]:null),T=u(()=>b(r(C),r(v))),$=u(()=>Dr(r(T),2)),P=u(()=>r($)[0]),y=u(()=>r($)[1]);Lr(n,{top:N=>{var j=mp(),z=c(j),d=c(z),g=c(d);Xe(g,{mode:{mode:"title"}});var p=h(d,2),k=c(p);Xe(k,{mode:{mode:"pick-neighbourhood"}});var x=h(p,2),A=c(x);Xe(A,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var F=h(x,2),S=c(F);Q(I=>U(S,I),[()=>Ar(o().mode)]),_(N,j)},left:N=>{var j=wp(),z=Z(j);on(z,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var d=h(z,2),g=c(d);{let L=u(()=>r(l).cx(51)),R=u(()=>[r(i).features.length.toLocaleString()]);be(g,{get x(){return r(L)},get a(){return r(R)}})}var p=h(d,2);{const L=R=>{var G=bp();kn(G,()=>r(v),J=>Y(v,J)),_(R,G)};var k=c(p);{let R=u(()=>[L]),G=u(()=>r(l).cx(52));be(k,{get t(){return r(R)},get x(){return r(G)}})}}var x=h(p,2),A=c(x);{let L=u(()=>r(l).cx(53)),R=u(()=>[r(v)?"from":"to",r(C)==null?"each zone":"this zone"]);be(A,{get x(){return r(L)},get a(){return r(R)}})}var F=h(x,2);{let L=u(()=>({limits:r(P)}));br(F,{get colorScale(){return ma},get labels(){return r(L)}})}var S=h(F,4);{var I=L=>{var R=yp(),G=Z(R),J=c(G),H=h(G,2),X=c(H);{let K=u(()=>r(l).cx(54)),V=u(()=>[r(B).properties.sum_from.toLocaleString()]);be(X,{get x(){return r(K)},get a(){return r(V)}})}var le=h(H,2),q=c(le);{let K=u(()=>r(l).cx(55)),V=u(()=>[r(B).properties.sum_to.toLocaleString()]);be(q,{get x(){return r(K)},get a(){return r(V)}})}var ee=h(le,2),ue=c(ee);{let K=u(()=>r(l).cx(56)),V=u(()=>[r(B).properties.counts_from[r(C)]]);be(ue,{get x(){return r(K)},get a(){return r(V)}})}Q(()=>U(J,r(B).properties.name)),_(L,R)},E=L=>{var R=Ap(),G=c(R);Q(J=>U(G,J),[()=>r(l).t(57)]),_(L,R)};ve(S,L=>{r(B)&&r(C)!=null?L(I):L(E,!1)})}_(N,j)},main:N=>{st(N,{get data(){return r(i)},generateId:!0,children:(j,z)=>{var d=xp(),g=Z(d);{let k=u(()=>He("debug-demand-fill")),x=u(()=>({"fill-color":r(y),"fill-opacity":xt(.5,.1)}));ur(g,Ce(()=>r(k),{get paint(){return r(x)},manageHoverState:!0,get hovered(){return r(f)},set hovered(A){Y(f,A,!0)}}))}var p=h(g,2);{let k=u(()=>He("debug-demand-outline"));gt(p,Ce(()=>r(k),{paint:{"line-width":2,"line-color":"black"}}))}_(j,d)},$$slots:{default:!0}})},$$slots:{top:!0,left:!0,main:!0}}),Ne(),s()}var kp=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav>'),Sp=(n,e)=>Y(e,nr(),!0),Ep=M('<button class="secondary"> </button> <!>',1),Lp=M('<a target="_blank"> </a>'),Cp=M("<!> <p> </p> <!> <!>",1),Mp=M("<!> <!>",1),Pp=M("<!> <!>",1);function Tp(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",a),o=()=>we(wt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=Ae(null),v=Ae(bt(nr())),f=Ae(0);function b(m){Y(i,m.features[0].properties.osm,!0),Y(v,t().getMovements(m.features[0].id),!0),Y(f,0)}Lr(n,{top:T=>{var $=kp(),P=c($),y=c(P),w=c(y);Xe(w,{mode:{mode:"title"}});var O=h(y,2),D=c(O);Xe(D,{mode:{mode:"pick-neighbourhood"}});var N=h(O,2),j=c(N);Q(z=>U(j,z),[()=>Ar(o().mode)]),_(T,$)},left:T=>{var $=Cp(),P=Z($);on(P,{mode:{mode:"pick-neighbourhood"}});var y=h(P,2),w=c(y),O=h(y,2);{var D=z=>{var d=Ep(),g=Z(d);g.__click=[Sp,v];var p=c(g),k=h(g,2);Ka(k,{get list(){return r(v).features},get idx(){return r(f)},set idx(x){Y(f,x,!0)}}),Q(x=>U(p,x),[()=>r(l).t(59)]),_(z,d)};ve(O,z=>{r(v).features.length>0&&z(D)})}var N=h(O,2);{var j=z=>{var d=Lp(),g=c(d);Q(p=>{Ue(d,"href",r(i)),U(g,p)},[()=>r(l).t(60)]),_(z,d)};ve(N,z=>{r(i)&&z(j)})}Q(z=>U(w,z),[()=>r(l).t(58)]),_(T,$)},main:T=>{var $=Pp(),P=Z($);{let w=u(()=>t().getAllIntersections());st(P,{get data(){return r(w)},generateId:!0,children:(O,D)=>{{let N=u(()=>He("debug-intersections"));Ln(O,Ce(()=>r(N),{paint:{"circle-radius":15,"circle-color":["case",["get","has_turn_restrictions"],"purple","black"]},manageHoverState:!0,hoverCursor:"pointer",onclick:b}))}},$$slots:{default:!0}})}var y=h(P,2);st(y,{get data(){return r(v)},generateId:!0,children:(w,O)=>{var D=Mp(),N=Z(D);{let z=u(()=>He("debug-movements-outline"));gt(N,Ce(()=>r(z),{paint:{"line-width":2,"line-color":"red"}}))}var j=h(N,2);{let z=u(()=>He("debug-movements-fill")),d=u(()=>["==",["id"],r(f)]);ur(j,Ce(()=>r(z),{get filter(){return r(d)},paint:{"fill-color":"cyan"}}))}_(w,D)},$$slots:{default:!0}}),_(T,$)},$$slots:{top:!0,left:!0,main:!0}}),Ne(),s()}er(["click"]);var Ip=M("<!> <!>",1);function ga(n,e){Re(e,!0);const t=()=>we(Na,"$roadStyle",a),o=()=>we(wi,"$drawBorderEntries",a),[a,s]=lt();let l=W(e,"show",3,!0),i=W(e,"prefix",3,"");function v(T){return["interpolate",["linear"],["zoom"],14,.08*T,22,.7*T]}function f(T){return[0,-50*T]}function b(){return["interpolate",["linear"],["zoom"],14,1,22,.7]}var m=Ip(),C=Z(m);{let T=u(()=>He(i()+"cells")),$=u(()=>({visibility:!l()||t()=="cells"?"none":"visible"})),P=u(()=>({"fill-color":Za(),"fill-opacity":.5,"fill-outline-color":"hsla(0, 0%, 0%, 0.3)"}));ur(C,Ce(()=>r(T),{filter:["==",["get","kind"],"cell"],get layout(){return r($)},get paint(){return r(P)}}))}var B=h(C,2);{let T=u(()=>He(i()+"border-entries")),$=u(()=>({"icon-image":"border_entry_arrow","icon-rotate":["get","bearing_upon_entry"],"icon-allow-overlap":!0,"icon-size":v(1),"icon-offset":f(1),"symbol-sort-key":["get","bearing_upon_entry"],visibility:l()&&o()?"visible":"none"})),P=u(()=>({"icon-color":Za(),"icon-halo-color":"black","icon-opacity":b(),"icon-halo-width":v(1.5),"icon-halo-blur":0}));fo(B,Ce(()=>r(T),{filter:["==",["get","kind"],"border_entry"],get layout(){return r($)},get paint(){return r(P)},minzoom:13,interactive:!1}))}_(n,m),Ne(),s()}function ti(n,e){Re(e,!1),_c();{let t=_l(()=>He("neighbourhood-boundary"));ur(n,Ce(()=>r(t),{filter:["==",["get","kind"],"boundary"],paint:{"fill-color":"black","fill-opacity":.3}}))}Ne()}var Rp=M("<!> <!> <!> <!>",1);function _a(n,e){Re(e,!0);const t=()=>we(xi,"$thickRoadsForShortcuts",a),o=()=>we(Na,"$roadStyle",a),[a,s]=lt();let l=W(e,"interactive",3,!0),i=W(e,"linePopup",3,void 0),v=W(e,"onClickLine",3,(w,O)=>{}),f=W(e,"show",3,!0),b=W(e,"prefix",3,"");function m(w,O){return w=="cells"?Za():w=="edits"?xt(["case",["get","edited"],pc,"white"],Jr.mapFeature.hover.backgroundColor):w=="speeds"?yr(["get","speed_mph"],yl,bl):O<=2?xt("white","blue"):(console.assert(w=="shortcuts"),xt(["interpolate-hcl",["linear"],["get","shortcuts"],0,"white",1,"#F19A93",O,"#A32015"],Jr.mapFeature.hover.backgroundColor))}function C(w,O,D){return!w||O<=2?so(D):["interpolate",["linear"],["get","shortcuts"],0,5+D,O,25+D]}var B=Rp(),T=Z(B);{let w=u(()=>He(b()+"interior-roads-outlines")),O=u(()=>({"line-width":C(t(),e.maxShortcuts,1),"line-color":"black"})),D=u(()=>({visibility:f()?"visible":"none"}));gt(T,Ce(()=>r(w),{filter:["==",["get","kind"],"interior_road"],get paint(){return r(O)},get layout(){return r(D)},minzoom:13}))}var $=h(T,2);{let w=u(()=>He(b()+"interior-roads")),O=u(()=>({"line-width":C(t(),e.maxShortcuts,0),"line-color":m(o(),e.maxShortcuts),"line-opacity":xt(1,.5)})),D=u(()=>({"line-sort-key":["get","shortcuts"],visibility:f()?"visible":"none"})),N=u(()=>l()?"pointer":void 0);gt($,Ce(()=>r(w),{filter:["==",["get","kind"],"interior_road"],get paint(){return r(O)},get layout(){return r(D)},minzoom:13,onclick:j=>l()&&v()(j.features[0],j.event.lngLat),get manageHoverState(){return l()},get hoverCursor(){return r(N)},children:(j,z)=>{var d=$e(),g=Z(d);{var p=k=>{var x=$e(),A=Z(x);It(A,()=>i()??Pe),_(k,x)};ve(g,k=>{l()&&k(p)})}_(j,d)},$$slots:{default:!0}}))}var P=h($,2);{let w=u(()=>He(b()+"main-roads-outlines")),O=u(()=>({"line-width":C(t(),e.maxShortcuts,6),"line-color":"black"})),D=u(()=>({visibility:f()?"visible":"none"}));gt(P,Ce(()=>r(w),{filter:["==",["get","kind"],"main_road"],get paint(){return r(O)},get layout(){return r(D)},minzoom:13}))}var y=h(P,2);{let w=u(()=>He(b()+"main-roads")),O=u(()=>({"line-width":C(t(),e.maxShortcuts,4),"line-color":xt("gray",Jr.mapFeature.hover.backgroundColor),"line-opacity":xt(1,.5)})),D=u(()=>({"line-sort-key":["get","shortcuts"],visibility:f()?"visible":"none"})),N=u(()=>l()?"pointer":void 0);gt(y,Ce(()=>r(w),{filter:["==",["get","kind"],"main_road"],get paint(){return r(O)},get layout(){return r(D)},minzoom:13,onclick:j=>l()&&v()(j.features[0],j.event.lngLat),get manageHoverState(){return l()},get hoverCursor(){return r(N)},children:(j,z)=>{var d=$e(),g=Z(d);{var p=k=>{var x=$e(),A=Z(x);It(A,()=>i()??Pe),_(k,x)};ve(g,k=>{l()&&k(p)})}_(j,d)},$$slots:{default:!0}}))}_(n,B),Ne(),s()}var Np=M("<!> <!>",1);function Bp(n,e){Re(e,!0);const t=()=>we(Kt,"$mutationCounter",s),o=()=>we(Rt,"$backend",s),a=()=>we(Ra,"$showExistingFiltersAndTRs",s),[s,l]=lt();let i=W(e,"children",3,void 0),v=W(e,"turnRestrictionGj",3,null),f=W(e,"show",3,!0),b=W(e,"prefix",3,""),m=W(e,"onClickTurnRestriction",3,()=>{}),C=Ae(void 0),B=u(()=>r(C)==null?nr():{type:"FeatureCollection",features:[{type:"Feature",geometry:JSON.parse(r(C).properties.from_geometry),properties:{}},{type:"Feature",geometry:JSON.parse(r(C).properties.to_geometry),properties:{}}]}),T=u(()=>t()>0&&v()==null?o().renderTurnRestrictions():nr());var $=Np(),P=Z($);{let w=u(()=>v()||r(T));st(P,{get data(){return r(w)},generateId:!0,children:(O,D)=>{{let N=u(()=>He(b()+"turn-restrictions")),j=u(()=>a()?void 0:["get","edited"]),z=u(()=>({"icon-image":["concat","no_",["get","kind"],"_turn"],"icon-rotate":["get","icon_angle"],"icon-allow-overlap":!0,"icon-size":.05,visibility:f()?"visible":"none"}));fo(O,Ce(()=>r(N),{minzoom:13,get filter(){return r(j)},get layout(){return r(z)},paint:{"icon-opacity":["case",["get","edited"],1,.5]},get onclick(){return m()},get hovered(){return r(C)},set hovered(d){Y(C,d,!0)},children:(d,g)=>{var p=$e(),k=Z(p);It(k,()=>i()??Pe),_(d,p)},$$slots:{default:!0}}))}},$$slots:{default:!0}})}var y=h(P,2);st(y,{get data(){return r(B)},children:(w,O)=>{{let D=u(()=>He(b()+"turn-restrictions-debug-arrows")),N=u(()=>({visibility:f()?"visible":"none"}));gt(w,Ce(()=>r(D),{interactive:!1,paint:{"line-width":4,"line-color":"red"},get layout(){return r(N)}}))}},$$slots:{default:!0}}),_(n,$),Ne(),l()}var Fp=M("<!> <!>",1),Op=M("<!> <!>",1);function An(n,e){Re(e,!0);const t=()=>we(Kt,"$mutationCounter",s),o=()=>we(Rt,"$backend",s),a=()=>we(Ra,"$showExistingFiltersAndTRs",s),[s,l]=lt();let i=W(e,"modalFilterGj",3,null),v=W(e,"turnRestrictionGj",3,null),f=W(e,"onClickModalFilter",3,()=>{}),b=W(e,"onClickTurnRestriction",3,()=>{}),m=W(e,"modalFilterPopup",3,void 0),C=W(e,"turnRestrictionPopup",3,void 0),B=W(e,"show",3,!0),T=W(e,"prefix",3,""),$=13,P=u(()=>t()>0&&i()==null?o().renderModalFilters():nr());var y=Op(),w=Z(y);{let D=u(()=>i()||r(P));st(w,{get data(){return r(D)},generateId:!0,children:(N,j)=>{var z=Fp(),d=Z(z);{let p=u(()=>He(T()+"modal-filters")),k=u(()=>["all",["!=",["get","filter_kind"],"diagonal_filter"],a()?["literal",!0]:["get","edited"]]),x=u(()=>({"icon-image":["get","filter_kind"],"icon-rotate":["get","angle"],"icon-allow-overlap":!0,"icon-size":.1,visibility:B()?"visible":"none"}));fo(d,Ce(()=>r(p),{get interactive(){return e.interactive},get filter(){return r(k)},minzoom:$,get layout(){return r(x)},paint:{"icon-opacity":["case",["get","edited"],1,.5]},get onclick(){return f()},children:(A,F)=>{var S=$e(),I=Z(S);It(I,()=>m()??Pe),_(A,S)},$$slots:{default:!0}}))}var g=h(d,2);{let p=u(()=>He(T()+"intersection-filters")),k=u(()=>({"icon-image":"diagonal_filter","icon-rotate":["get","angle",["get","filter"]],"icon-allow-overlap":!0,"icon-size":.07,visibility:B()?"visible":"none"}));fo(g,Ce(()=>r(p),{filter:["==",["get","filter_kind"],"diagonal_filter"],minzoom:$,get layout(){return r(k)},interactive:!1}))}_(N,z)},$$slots:{default:!0}})}var O=h(w,2);Bp(O,{get show(){return B()},get prefix(){return T()},get turnRestrictionGj(){return v()},get onClickTurnRestriction(){return b()},children:(D,N)=>{var j=$e(),z=Z(j);It(z,()=>C()??Pe),_(D,j)},$$slots:{default:!0}}),_(n,y),Ne(),l()}function pa(n,e){Re(e,!0);let t=W(e,"show",3,!0),o=W(e,"prefix",3,"");{let a=u(()=>He(o()+"one-ways")),s=u(()=>({"icon-image":"oneway_arrow","icon-size":1,"symbol-placement":"line","symbol-spacing":50,"icon-allow-overlap":!0,"icon-rotate":["case",["==",["get","travel_flow"],"forwards"],0,180],visibility:t()?"visible":"none"}));fo(n,Ce(()=>r(a),{filter:["all",["in",["get","kind"],["literal",["interior_road","main_road"]]],["!=",["get","travel_flow"],"both"]],get layout(){return r(s)},paint:{"icon-opacity":["case",["get","travel_flow_edited"],1,.5]},minzoom:13,interactive:!1}))}Ne()}function Za(){return["match",["get","cell_color"],"disconnected","red","pedestrianized","#dddde8",["let","index",["%",["to-number",["get","cell_color"]],10],["match",["var","index"],0,"#8dd3c7",1,"#ffffb3",2,"#bebada",3,"#80b1d3",4,"#fdb462",5,"#b3de69",6,"#fccde5",7,"#bc80bd",8,"#ccebc5",9,"#ffed6f","blue"]]]}var jp=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),zp=(n,e)=>Y(e,null),Dp=M('<button class="close-btn svelte-ouxims">Ⓧ</button>'),Up=M("<!> <h5> </h5> <!>",1),Gp=M("<p> </p>"),Wp=M('<!> <h4> </h4> <p> </p> <div style="display: flex; align-items: start; justify-content: space-between;"><h4> </h4> <!></div> <!>',1),Hp=M("<!> <!> <!> <!> <!>",1),qp=M("<!> <!>",1),Jp=M("<!> <!> <!> <!>",1);function Qp(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",a),o=()=>we(wt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=t().renderNeighbourhood(),v=Ae(null);function f(b){let m=b.features[0],C=t().getMovements(m.properties.intersection_id);Y(v,{feature:m,movements:C,movementIdx:0},!0)}Lr(n,{top:B=>{var T=jp(),$=c(T),P=c($),y=c(P);Xe(y,{mode:{mode:"title"}});var w=h(P,2),O=c(w);Xe(O,{mode:{mode:"pick-neighbourhood"}});var D=h(w,2),N=c(D);Xe(N,{mode:{mode:"neighbourhood"}});var j=h(D,2),z=c(j);Q(d=>U(z,d),[()=>Ar(o().mode)]),_(B,T)},left:B=>{var T=Wp(),$=Z(T);on($,{mode:{mode:"neighbourhood"}});var P=h($,2),y=c(P),w=h(P,2),O=c(w),D=h(w,2),N=c(D),j=c(N),z=h(N,2);{var d=x=>{var A=Dp();A.__click=[zp,v],_(x,A)};ve(z,x=>{r(v)&&x(d)})}var g=h(D,2);{var p=x=>{var A=Up(),F=Z(A);to(F,{get properties(){return r(v).feature.properties}});var S=h(F,2),I=c(S),E=h(S,2);Ka(E,{get list(){return r(v).movements.features},get idx(){return r(v).movementIdx},set idx(L){r(v).movementIdx=L}}),Q(L=>U(I,L),[()=>r(l).t(64)]),_(x,A)},k=x=>{var A=Gp(),F=c(A);Q(S=>U(F,S),[()=>r(l).t(65)]),_(x,A)};ve(g,x=>{r(v)?x(p):x(k,!1)})}Q((x,A,F)=>{U(y,x),U(O,A),U(j,F)},[()=>r(l).t(61),()=>r(l).t(62),()=>r(l).t(63)]),_(B,T)},main:B=>{var T=Jp(),$=Z(T);st($,{get data(){return i},generateId:!0,children:(D,N)=>{var j=Hp(),z=Z(j);ti(z,{});var d=h(z,2);ga(d,{});var g=h(d,2);pa(g,{});var p=h(g,2);{let x=u(()=>He("debug-borders"));Ln(p,Ce(()=>r(x),{filter:["==",["get","kind"],"border_intersection"],paint:{"circle-radius":15,"circle-color":"green"},children:(A,F)=>{Bt(A,{openOn:"hover",children:(I,E)=>{let L=()=>E?.().data;to(I,{get properties(){return L().properties}})},$$slots:{default:!0}})},$$slots:{default:!0}}))}var k=h(p,2);_a(k,{interactive:!0,onClickLine:(A,F)=>window.open(A.properties.way,"_blank"),get maxShortcuts(){return i.maxShortcuts},linePopup:A=>{Bt(A,{openOn:"hover",children:(S,I)=>{let E=()=>I?.().data;to(S,{get properties(){return E().properties}})},$$slots:{default:!0}})},$$slots:{linePopup:!0}}),_(D,j)},$$slots:{default:!0}});var P=h($,2);An(P,{interactive:!0,modalFilterPopup:j=>{Bt(j,{openOn:"hover",children:(d,g)=>{let p=()=>g?.().data;to(d,{get properties(){return p().properties}})},$$slots:{default:!0}})},turnRestrictionPopup:j=>{Bt(j,{openOn:"hover",children:(d,g)=>{let p=()=>g?.().data;to(d,{get properties(){return p().properties}})},$$slots:{default:!0}})},$$slots:{modalFilterPopup:!0,turnRestrictionPopup:!0}});var y=h(P,2);{let D=u(()=>t().getAllIntersections());st(y,{get data(){return r(D)},generateId:!0,children:(N,j)=>{{let z=u(()=>He("debug-intersections")),d=u(()=>({"circle-radius":Al(30),"circle-color":Jr.mapFeature.hover.backgroundColor,"circle-stroke-color":Jr.mapFeature.hover.backgroundColor,"circle-stroke-opacity":.8,"circle-stroke-width":xt(0,3),"circle-opacity":["case",["==",["get","intersection_id"],r(v)?.feature?.properties?.intersection_id??-1],.3,xt(0,.5)]}));Ln(N,Ce(()=>r(z),{get paint(){return r(d)},manageHoverState:!0,hoverCursor:"pointer",onclick:f,children:(g,p)=>{Bt(g,{openOn:"hover",children:(x,A)=>{let F=()=>A?.().data;to(x,{get properties(){return F().properties}})},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}var w=h(y,2);{var O=D=>{st(D,{get data(){return r(v).movements},generateId:!0,children:(N,j)=>{var z=qp(),d=Z(z);{let p=u(()=>He("debug-movements-outline"));gt(d,Ce(()=>r(p),{paint:{"line-width":2,"line-color":"red"}}))}var g=h(d,2);{let p=u(()=>He("debug-movements-fill")),k=u(()=>["==",["id"],r(v).movementIdx]);ur(g,Ce(()=>r(p),{get filter(){return r(k)},paint:{"fill-color":"cyan"}}))}_(N,z)},$$slots:{default:!0}})};ve(w,D=>{r(v)&&D(O)})}_(B,T)},$$slots:{top:!0,left:!0,main:!0}}),Ne(),s()}er(["click"]);const Zp="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='lucide%20lucide-eraser-icon%20lucide-eraser'%20version='1.1'%20id='svg3'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs3'%20/%3e%3cpath%20d='m7%2021-4.3-4.3c-1-1-1-2.5%200-3.4l9.6-9.6c1-1%202.5-1%203.4%200l5.6%205.6c1%201%201%202.5%200%203.4L13%2021'%20id='path1'%20/%3e%3cpath%20d='M22%2021H7'%20id='path2'%20/%3e%3cpath%20d='m5%2011%209%209'%20id='path3'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.0194348;fill-opacity:1'%20d='M%2010.210757,14.752002%206.459622,11.000548%209.8160254,7.6426783%20C%2012.367029,5.0905596%2013.239386,4.2512757%2013.451467,4.1450647%20c%200.349597,-0.1750803%200.789698,-0.1876196%201.091224,-0.031091%200.115256,0.059832%201.582424,1.4856537%203.265247,3.1732297%203.019567,3.0280936%203.057066,3.0684746%203.149916,3.3920116%200.07937,0.276581%200.08343,0.372957%200.02609,0.620542%20-0.06661,0.287624%20-0.13239,0.357763%20-3.515539,3.748403%20-1.896214,1.900412%20-3.460904,3.455295%20-3.477088,3.455295%20-0.01619,0%20-1.717438,-1.688155%20-3.780562,-3.751453%20z'%20id='path4'%20/%3e%3cpath%20style='fill:%23ffffff;fill-opacity:1;stroke:%23ff533e;stroke-width:0.0194348'%20d='M%205.321794,17.868809%20C%204.1705931,16.713048%203.1848808,15.680805%203.131322,15.574936%203.077763,15.469067%203.0207033,15.236442%203.004522,15.057992%202.959692,14.563595%203.080751,14.37604%204.1030807,13.356012%20l%200.8902675,-0.888263%203.7509032,3.751221%203.7509036,3.751222%20H%209.9550205%207.4148864%20Z'%20id='path5'%20/%3e%3c/svg%3e",Vp="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='lucide%20lucide-paintbrush-icon%20lucide-paintbrush'%20version='1.1'%20id='svg3'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs3'%20/%3e%3cpath%20d='m14.622%2017.897-10.68-2.913'%20id='path1'%20/%3e%3cpath%20d='M18.376%202.622a1%201%200%201%201%203.002%203.002L17.36%209.643a.5.5%200%200%200%200%20.707l.944.944a2.41%202.41%200%200%201%200%203.408l-.944.944a.5.5%200%200%201-.707%200L8.354%207.348a.5.5%200%200%201%200-.707l.944-.944a2.41%202.41%200%200%201%203.408%200l.944.944a.5.5%200%200%200%20.707%200z'%20id='path2'%20/%3e%3cpath%20d='M9%208c-1.804%202.71-3.97%203.46-6.583%203.948a.507.507%200%200%200-.302.819l7.32%208.883a1%201%200%200%200%201.185.204C12.735%2020.405%2016%2016.792%2016%2015'%20id='path3'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.00941713'%20d='M%2013.216364,10.769138%209.4441913,6.9961356%209.8268793,6.6205315%20C%2010.053748,6.3978626%2010.26605,6.2149074%2010.348288,6.1711993%20c%200.393818,-0.2093087%200.914655,-0.2092623%201.30798,1.172e-4%200.09062,0.048241%200.356713,0.2875083%200.767422,0.6900596%200.345786,0.338918%200.691198,0.6557984%200.767583,0.7041789%200.216015,0.1368197%200.430512,0.2013581%200.722288,0.2173241%200.316089,0.017296%200.499892,-0.017578%200.768527,-0.1458202%200.194182,-0.092699%200.283143,-0.1774989%202.37486,-2.2637553%202.357603,-2.3514493%202.273297,-2.2768061%202.645598,-2.3423855%200.33614,-0.05921%200.694848,0.059949%200.950717,0.3158186%200.253238,0.2532377%200.374946,0.6150471%200.31719,0.9429318%20-0.0673,0.3820937%200.01738,0.2862242%20-2.343684,2.6533839%20-2.086365,2.0917555%20-2.171127,2.1806742%20-2.263828,2.3748599%20-0.127718,0.2675385%20-0.162966,0.4524174%20-0.14652,0.7685267%200.01524,0.292912%200.09451,0.540519%200.242982,0.758947%200.04844,0.07126%200.360914,0.406322%200.694399,0.744591%200.41818,0.424179%200.627762,0.657447%200.675382,0.751709%200.212723,0.421072%200.212671,0.891705%20-1.46e-4,1.312073%20-0.04338,0.08569%20-0.207187,0.276887%20-0.439097,0.512528%20-0.203448,0.20672%20-0.376992,0.375854%20-0.385655,0.375854%20-0.0087,0%20-1.713228,-1.697851%20-3.787922,-3.773003%20z'%20id='path4'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.00941713;fill-opacity:1'%20d='M%209.349188,15.407794%204.525255,14.090285%203.9850003,13.435502%203.4447455,12.780718%203.9569969,12.649282%20C%206.0202821,12.119873%207.4294884,11.334333%208.7020764,10.004212%208.8652116,9.8337017%209.0246733,9.6590433%209.0564355,9.6160824%20l%200.05775,-0.078111%202.9032955,2.9031996%202.903295,2.9032%20-0.06256,0.166083%20c%20-0.122687,0.325724%20-0.617409,1.223308%20-0.670589,1.216662%20-0.008,-9.97e-4%20-2.18528,-0.594692%20-4.8384428,-1.319322%20z'%20id='path5'%20/%3e%3cpath%20style='fill:%23000000;fill-opacity:1;stroke:%23000000;stroke-width:0.00941713;stroke-opacity:1'%20d='M%208.4622824,18.869673%20C%207.5370363,17.746854%206.7832695,16.824931%206.7872451,16.820955%20c%200.00525,-0.0052%205.8629439,1.583356%206.0455299,1.639545%200.04062,0.0125%20-1.405633,1.450684%20-1.775827,1.765924%20-0.389041,0.331289%20-0.845683,0.684738%20-0.884654,0.684738%20-0.01526,0%20-0.7847654,-0.91867%20-1.7100116,-2.041489%20z'%20id='path6'%20/%3e%3c/svg%3e",tl="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='200'%20height='200'%20viewBox='0%200%20208%20208'%20version='1.1'%20id='svg4'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs4'%20/%3e%3cg%20id='g2'%20transform='translate(-0.5,-587.21484)'%20style='display:inline'%3e%3cpath%20fill='none'%20stroke-width='10'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke='%231476c6'%20stroke-opacity='1'%20stroke-miterlimit='4'%20d='m%201026.4453,2047.8516%20c%20564.1016,0%201021.4063,-457.3047%201021.4063,-1021.4063%20C%202047.8516,462.34375%201590.5469,5%201026.4453,5%20462.30469,5%205,462.34375%205,1026.4453%205,1590.5469%20462.30469,2047.8516%201026.4453,2047.8516%20Z%20m%200,0'%20transform='matrix(0.1,0,0,-0.1,0,792)'%20id='path2'%20/%3e%3c/g%3e%3cpath%20fill-rule='nonzero'%20fill='%231476c6'%20fill-opacity='1'%20d='m%20102.14453,4.207026%20c%2054.08594,0%2097.93359,43.84766%2097.93359,97.933604%200,54.08984%20-43.84765,97.9375%20-97.93359,97.9375%20-54.089842,0%20-97.937499,-43.84766%20-97.937499,-97.9375%200,-54.085944%2043.847657,-97.933604%2097.937499,-97.933604'%20id='path3'%20style='display:inline'%20/%3e%3cpath%20fill-rule='nonzero'%20fill='%23ffffff'%20fill-opacity='1'%20d='M%20185.51172,115.58985%20H%2069.265625%20l%2027.648437,27.65234%20H%2056.015625%20L%2014.816406,102.04297%2056.015625,60.843746%20H%2096.914062%20L%2069.265625,88.492186%20H%20185.51172%20v%2027.097664'%20id='path4'%20style='display:inline'%20/%3e%3c/svg%3e",Kp="/ltn/assets/traffic_1-MHHbc4qO.svg";function gn(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Xp(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function Yp(n){return n.type==="Feature"?n.geometry:n}function gu(n,e,t={}){if(t.final===!0)return eh(n,e);const o=gn(n),a=gn(e),s=Ir(o[0]),l=Ir(a[0]),i=Ir(o[1]),v=Ir(a[1]),f=Math.sin(l-s)*Math.cos(v),b=Math.cos(i)*Math.sin(v)-Math.sin(i)*Math.cos(v)*Math.cos(l-s);return oa(Math.atan2(f,b))}function eh(n,e){let t=gu(e,n);return t=(t+180)%360,t}function th(n,e,t,o={}){const a=gn(n),s=Ir(a[0]),l=Ir(a[1]),i=Ir(t),v=Ud(e,o.units),f=Math.asin(Math.sin(l)*Math.cos(v)+Math.cos(l)*Math.sin(v)*Math.cos(i)),b=s+Math.atan2(Math.sin(i)*Math.sin(v)*Math.cos(l),Math.cos(v)-Math.sin(l)*Math.sin(f)),m=oa(b),C=oa(f);return Qn([m,C],o.properties)}function fn(n,e,t={}){var o=gn(n),a=gn(e),s=Ir(a[1]-o[1]),l=Ir(a[0]-o[0]),i=Ir(o[1]),v=Ir(a[1]),f=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(i)*Math.cos(v);return Dd(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),t.units)}var rh=fn;function nh(n,e,t={}){const a=Yp(n).coordinates;let s=0;for(let l=0;l<a.length&&!(e>=s&&l===a.length-1);l++)if(s>=e){const i=e-s;if(i){const v=gu(a[l],a[l-1])-180;return th(a[l],i,v,t)}else return Qn(a[l])}else s+=fn(a[l],a[l+1],t);return Qn(a[a.length-1])}var oh=nh;function ah(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=u(b),a=50,s=100,l=.01,i=bt(m()),v=u(B),f=setInterval(T,s);cr(()=>clearInterval(f));function b(){return e.paths.features.map($=>1/$.properties.directness).reduce(($,P)=>$+P,0)}function m(){return e.paths.features.length==0?[]:Array.from({length:a},C)}function C(){let $=Math.random()*r(o),P=0;for(let[y,w]of e.paths.features.entries())if(P+=1/w.properties.directness,$<P)return{idx:y,distance:0};throw new Error(`didnt pick dot, totalDirectness is ${r(o)}`)}function B(){return{type:r(t).t(37),features:i.map(({idx:$,distance:P})=>oh(e.paths.features[$],P,{units:"kilometers"}))}}function T(){for(let[$,P]of i.entries())P.distance+=l,P.distance>=e.paths.features[P.idx].properties.length_meters/1e3&&(i[$]=C())}st(n,{get data(){return r(v)},children:($,P)=>{{let y=u(()=>He("animate-shortcuts"));Ln($,Ce(()=>r(y),{paint:{"circle-radius":10,"circle-color":"purple","circle-stroke-color":"black","circle-stroke-width":1}}))}},$$slots:{default:!0}}),Ne()}class ih{feature;constructor(e){this.feature=e}get intersectionId(){return this.feature.properties.intersection_id}get filter(){return this.feature.properties.filter}get filterAngle(){return this.feature.properties.filter?.angle}get hasRotatedFilter(){return this.feature.properties.filter?.is_rotated??!1}}const _i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAALRQTFRFR3BMemc7uV08rWA9gmc9wlw9+1M8/1c6XGw7rWA8yFs9Tm47d2g8RXA7lmM8N3I6bGo7g2Y8u108wl097lY9vV08pmE9pGE8IHY7/3YajWU8hWc811o+nmI87VU7L3M73Fo+K3Q62Fs+s189kWQ8gGc7iGU8e2g7x1pAC3k6////X6d+H4RKTJ1vjcCjEHg6F3c6HnY6+Pv6NJBbWaR5FX5C4vDoHINIQZZlfbiWmMaszuTYcGgFiwAAACl0Uk5TAMN7grBaDAXjiU7r0O+f9dvJdmUgbZSi/AKouC+zGPg3+yV8wbuzwESr5F6DAAAFwklEQVR42u3ax1rbQACF0STGvRsXMJieMqTICqS//3tlkS8LgpNgSZsZnf8R7hysgp49kyRJkiRJkqQ0mzdn141HvVhctGyTese95clkmIddZZedwXp2ZqR0u1oOLsO/y/qvFm1LJdnpqh+e0nZwjUB6tZZPO/5fBJoGS6zeIAt7NF65IUyq7jDsVza9sFoytVdHYe86PcOlcv6bbShQ341AIq0KnX8IQ78BSbTMQ8E6p9aLv+Y4FG7qWSD6rjrFzz9kKwPG3iaUaew2IPYLwHkpAGHqrXDcTcudf8gXNoz6B+CyJIAwPbZixJ2UPf9w5HVQxM37pQGEtRnjrVv+/EPHu4B4e1kBgO2hHWOt1akAQBgZMtZ6eRUAnhsy1hpVnH+YeBCMtVElAMZzS0baQRXnn+X+H1Df10AeA6LudSUAwsySkfa8GgAvLAmAABAAAkAACADFDuDL+4d9/QRAnQC8/Xj7R5/vAKgPgHePzv/29gcA9QFwf7ujTwDUBsDbXQDeAQAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAAAAAAAAAAAAAAAAAAAAAfne/C8AXAGoD4G7H+X8OANQGQPj+6Pw/3gNQIwDh/YeHfbsLANQJwD4BAICi7HU1AGaWjLSXlZx/dmjJSDuoBEDes2SkjSoBMD61ZKR1KwHQaVsy0g63VQAYGDLWzvpVAFgbstYvAjJPgfG2rABAf27HaLsYlwdwYsZ4Oy5/Ddi6AsTcrPRzwKRlxYhrD8reAnaNGHXXuR8AdwHFO1qYMPLeDMsAuDFg9HWPSlwAruwX/0VgkxU9/2HTfAnUuil4/ufXxkuis2mx8/cEmIyAmwJXgXHDcOlcBTZ73wl2fAmYVI39Pg3YTn0Hllinm8s9/vy7PgNLr8X0ideB/trjf5pvBA5P/n8hyCcjx59u8+6ryflfHwny4WDU9OOfeO2LRXe0Xh/80Xq0bDTPzCNJkiRJkqQk+wnTOFu90krtLAAAAABJRU5ErkJggg==";var sh=M('<div class="icon"> </div>'),lh=M('<img style="transform: rotate(45deg);" class="svelte-1geomdd"/>'),uh=M('<div style="font-size: 200%; padding-bottom: 4px;" class="icon"> </div>'),ch=M('<img style="transform: rotate(45deg);" class="svelte-1geomdd"/>'),dh=M('<div style="font-size: 200%; margin-top: -12px;" class="icon"> </div>'),fh=M('<img style="transform: rotate(135deg);" class="svelte-1geomdd"/>'),vh=M('<div style="display: flex; align-items: center;"><!></div>');function gh(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));var o=vh(),a=c(o);{var s=i=>{var v=$e(),f=Z(v);{var b=C=>{const B=($,P=Pe)=>{var y=sh(),w=c(y);Q(O=>U(w,O),[()=>r(t).tx(P())]),_($,y)},T=$=>{var P=lh();Q(y=>{Ue(P,"src",_i),Ue(P,"alt",y)},[()=>r(t).t(176)]),_($,P)};{let $=u(()=>[B,T]),P=u(()=>r(t).cx(177));be(C,{get t(){return r($)},get x(){return r(P)}})}},m=C=>{const B=($,P=Pe)=>{var y=uh(),w=c(y);Q(O=>U(w,O),[()=>r(t).tx(P())]),_($,y)},T=$=>{var P=ch();Q(y=>{Ue(P,"src",_i),Ue(P,"alt",y)},[()=>r(t).t(178)]),_($,P)};{let $=u(()=>[B,T]),P=u(()=>r(t).cx(179));be(C,{get t(){return r($)},get x(){return r(P)}})}};ve(f,C=>{e.intersection.hasRotatedFilter?C(b):C(m,!1)})}_(i,v)},l=i=>{const v=(b,m=Pe)=>{var C=dh(),B=c(C);Q(T=>U(B,T),[()=>r(t).tx(m())]),_(b,C)},f=b=>{var m=fh();Q(C=>{Ue(m,"src",_i),Ue(m,"alt",C)},[()=>r(t).t(180)]),_(b,m)};{let b=u(()=>[v,f]),m=u(()=>r(t).cx(181));be(i,{get t(){return r(b)},get x(){return r(m)}})}};ve(a,i=>{e.intersection.filter?i(s):i(l,!1)})}_(n,o),Ne()}function _h(n,e){Re(e,!0);let t=W(e,"onClickIntersection",3,i=>{}),o=W(e,"interactive",3,!1),a=W(e,"show",3,!0);function s(i){let v=e.neighbourhood.features[i];return new ih(v)}function l(i){return s(i[0].id)}{let i=u(()=>He("editable-intersections")),v=u(()=>({"circle-radius":Al(30),"circle-color":Jr.mapFeature.hover.backgroundColor,"circle-opacity":xt(0,.5),"circle-stroke-color":Jr.mapFeature.hover.backgroundColor,"circle-stroke-opacity":.8,"circle-stroke-width":xt(0,3)})),f=u(()=>({visibility:a()?"visible":"none"}));Ln(n,Ce(()=>r(i),{filter:["==",["get","kind"],"editable_intersection"],get paint(){return r(v)},get layout(){return r(f)},minzoom:13,get interactive(){return o()},manageHoverState:!0,hoverCursor:"pointer",onclick:b=>t()(l(b.features)),children:(b,m)=>{Bt(b,{openOn:"hover",children:(B,T)=>{let $=()=>T?.().features;{let P=u(()=>l($()));gh(B,{get intersection(){return r(P)}})}},$$slots:{default:!0}})},$$slots:{default:!0}}))}Ne()}var ph=(n,e,t)=>Ve(Zi,r(t).filterType),hh=M('<button class="outline" style="width: 100%"><img width="80"/> <br/> </button>'),mh=(n,e)=>e(!1),bh=M('<article style="max-height: 80vh; max-width: 80vw; overflow: auto"><h3> </h3> <table><tbody><tr><td></td><td><img height="300"/> <p> </p></td></tr></tbody></table> <center><button> </button></center></article>');function yh(n,e){Re(e,!0);const t=()=>we(Zi,"$currentFilterType",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=W(e,"show",15),i=u(()=>Ot.allTypes.find(v=>v.filterType==t()));wl(n,{get show(){return l()},set show(v){l(v)},children:(v,f)=>{var b=bh(),m=c(b),C=c(m),B=h(m,2),T=c(B),$=c(T),P=c($);qt(P,21,()=>Ot.allTypes,Jt,(d,g)=>{var p=hh();p.__click=[ph,t,g];var k=c(p),x=h(k,3);Q(()=>{p.disabled=t()==r(g).filterType,Ue(k,"src",r(g).iconURL),Ue(k,"alt",r(g).label),U(x,` ${r(g).label??""}`)}),_(d,p)});var y=h(P),w=c(y),O=h(w,2),D=c(O),N=h(B,2),j=c(N);j.__click=[mh,l];var z=c(j);Q((d,g)=>{U(C,d),Ue(w,"src",r(i).largeImageURL),Ue(w,"alt",r(i).label),U(D,r(i).description),U(z,g)},[()=>r(s).t(174),()=>r(s).t(175)]),_(v,b)},$$slots:{default:!0}}),Ne(),a()}er(["click"]);function Ah(n,e){Re(e,!0);const t=u(()=>ut(ct("main")));let o=Ae(null);e.map.on("dragstart",a),e.map.on("mousemove",s),e.map.on("mouseup",l),cr(()=>{e.map.dragPan.enable(),e.map.off("dragstart",a),e.map.off("mousemove",s),e.map.off("mouseup",l)});function a(){e.map.dragPan.disable(),Y(o,{type:r(t).t(376),properties:{},geometry:{type:r(t).t(377),coordinates:[]}},!0)}function s(i){if(r(o)){let v=i.lngLat.toArray(),f=r(o).geometry.coordinates.at(-1);if(f&&rh(f,v)*1e3<.5)return;r(o).geometry.coordinates.push(v)}}function l(){!r(o)||r(o).geometry.coordinates.length==0?e.onDone(null):e.onDone(r(o)),Y(o,null),e.map.dragPan.enable()}{let i=u(()=>r(o)||nr());st(n,{get data(){return r(i)},children:(v,f)=>{{let b=u(()=>He("freehand-line"));gt(v,Ce(()=>r(b),{paint:{"line-width":5,"line-color":"red"}}))}},$$slots:{default:!0}})}Ne()}var wh=M("<p><!></p>"),xh=M("<p><!></p>"),$h=M("<!> <!> <!>",1),kh=M("<!> <!>",1);function Sh(n,e){Re(e,!0);const t=()=>we($i,"$showBeforeEdits",a),o=()=>we(Rt,"$backend",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i="before-edits-",v=Ae(null),f=Ae(null),b=Ae(null);Qe(()=>{t()&&r(v)==null&&(Y(v,o().renderNeighbourhoodBeforeEdits(),!0),Y(f,o().renderModalFiltersBeforeEdits(),!0),Y(b,o().renderTurnRestrictionsBeforeEdits(),!0))});var m=kh(),C=Z(m);{var B=P=>{st(P,{get data(){return r(v)},generateId:!0,children:(y,w)=>{var O=$h(),D=Z(O);ga(D,{get show(){return t()},prefix:i});var N=h(D,2);pa(N,{get show(){return t()},prefix:i});var j=h(N,2);_a(j,{get show(){return t()},prefix:i,interactive:!0,get maxShortcuts(){return r(v).maxShortcuts},linePopup:d=>{Bt(d,{openOn:"hover",children:(p,k)=>{let x=()=>k?.().data;const A=u(()=>x().properties);var F=$e(),S=Z(F);{var I=L=>{var R=wh(),G=c(R);{let J=u(()=>r(l).cx(374)),H=u(()=>[r(A).shortcuts,r(A).name??"unnamed road",Math.round(r(A).speed_mph)]);be(G,{get x(){return r(J)},get a(){return r(H)}})}_(L,R)},E=L=>{var R=$e(),G=Z(R);{var J=H=>{var X=xh(),le=c(X);{let q=u(()=>r(l).cx(375)),ee=u(()=>[r(A).name??"unnamed road",Math.round(r(A).speed_mph)]);be(le,{get x(){return r(q)},get a(){return r(ee)}})}_(H,X)};ve(G,H=>{r(A).kind=="main_road"&&H(J)},!0)}_(L,R)};ve(S,L=>{r(A).kind=="interior_road"?L(I):L(E,!1)})}_(p,F)},$$slots:{default:!0}})},$$slots:{linePopup:!0}}),_(y,O)},$$slots:{default:!0}})};ve(C,P=>{r(v)&&P(B)})}var T=h(C,2);{var $=P=>{An(P,{prefix:i,get show(){return t()},interactive:!1,get modalFilterGj(){return r(f)},get turnRestrictionGj(){return r(b)}})};ve(T,P=>{r(f)&&r(b)&&P($)})}_(n,m),Ne(),s()}var Eh=M("<span></span>"),Lh=M("<b> </b>"),Ch=M("<b> </b>"),Mh=M("<b> </b>"),Ph=M("<li><!></li>"),Th=M('<ul style="padding-right: 0; padding-left: 20px; margin: 0;"><li><!></li> <li><!></li> <!></ul>'),Ih=M("<span></span> <!>",1),Rh=M("<!> <!> <!> <!> <!>",1);function Nh(n,e){Re(e,!0);const t=()=>we(ei,"$routeTool",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=W(e,"waypoints",15);cr(()=>{l([]),t()?.stop(),e.map.getCanvas().style.cursor="inherit"});let i=!0,v=Ae(bt([]));Qe(()=>{Y(v,w(t(),l(),r(C)),!0)});let f=Ae(null),b=Ae(!1),m=Ae(!1),C=Ae(!1);function B(E){l().push({point:E.lngLat.toArray(),snapped:i}),l(l())}function T(E){Y(f,{point:E.lngLat.toArray(),snapped:i},!0)}function $(E){l().splice(E,1),l(l()),Y(b,!1)}function P(E,L){try{if(E)return JSON.parse(E.inner.calculateRoute(L))}catch{}return null}function y(E,L,R,G){if(G)return nr();try{if(E&&L.length>0&&R)return JSON.parse(E.inner.calculateRoute([L[L.length-1],R]))}catch{}return nr()}function w(E,L,R){if(R)return r(v);if(!E)return[];let G=[],J=1;for(let H=0;H<L.length-1;H++){let X=JSON.parse(E.inner.getExtraNodes(L[H],L[H+1]));for(let[le,q,ee]of X)G.push({point:[le,q],snapped:ee,insertIdx:J});J++}return G}function O(E){l().splice(E.insertIdx,0,{point:E.point,snapped:E.snapped}),l(l()),Y(C,!0)}function D(E){l(l()[E.insertIdx].point=E.point,!0),l(l())}function N(){Y(C,!1)}function j(){Y(m,!0)}function z(E){E.key==r(s).t(49)&&e.cancel(),E.key==r(s).t(16)&&l().length>1&&g()}function d(E){l().length>1&&E==l().length-1&&g()}function g(){let E=P(t(),l());E?(e.finish(E.properties.full_path.map(L=>L.snapped)),l([])):e.cancel()}let p=u(()=>y(t(),l(),r(f),r(b)||r(m)));Qe(()=>{let E=l().length==0?"crosshair":"inherit";e.map.getCanvas().style.cursor=E});var k=Rh();Vn("keydown",ua,z);var x=Z(k);fa(x,{onclick:B,onmousemove:T});var A=h(x,2);qt(A,17,()=>r(v),Jt,(E,L,R)=>{co(E,{draggable:!0,ondragstart:()=>O(r(L)),ondrag:()=>D(r(L)),ondragend:N,zIndex:0,get lngLat(){return r(L).point},set lngLat(G){r(L).point=G},children:(G,J)=>{var H=Eh();let X;Q(le=>X=Et(H,1,"dot svelte-1i3xsfo",null,X,le),[()=>({"snapped-node":r(L).snapped,"free-node":!r(L).snapped,hide:r(C)})]),_(G,H)},$$slots:{default:!0}})});var F=h(A,2);qt(F,17,l,Jt,(E,L,R)=>{co(E,{draggable:!0,onclick:()=>d(R),oncontextmenu:()=>$(R),onmouseenter:()=>Y(b,!0),onmouseleave:()=>Y(b,!1),ondragstart:j,ondragend:()=>Y(m,!1),zIndex:1,get lngLat(){return r(L).point},set lngLat(G){r(L).point=G},children:(G,J)=>{var H=Ih(),X=Z(H);let le;X.textContent=R+1;var q=h(X,2);Bt(q,{openOn:"hover",popupClass:"waypoint-popup",children:(ee,ue)=>{var K=Th(),V=c(K);{const _e=(se,fe=Pe)=>{var oe=Lh(),ye=c(oe);Q(he=>U(ye,he),[()=>r(s).tx(fe())]),_(se,oe)};var te=c(V);{let se=u(()=>[_e]),fe=u(()=>r(s).cx(182));be(te,{get t(){return r(se)},get x(){return r(fe)}})}}var re=h(V,2);{const _e=(se,fe=Pe)=>{var oe=Ch(),ye=c(oe);Q(he=>U(ye,he),[()=>r(s).tx(fe())]),_(se,oe)};var ie=c(re);{let se=u(()=>[_e]),fe=u(()=>r(s).cx(183));be(ie,{get t(){return r(se)},get x(){return r(fe)}})}}var ne=h(re,2);{var ae=_e=>{var se=Ph();{const oe=(ye,he=Pe)=>{var xe=Mh(),Se=c(xe);Q(De=>U(Se,De),[()=>r(s).tx(he())]),_(ye,xe)};var fe=c(se);{let ye=u(()=>[oe]),he=u(()=>r(s).cx(184));be(fe,{get t(){return r(ye)},get x(){return r(he)}})}}_(_e,se)};ve(ne,_e=>{l().length>1&&R==l().length-1&&_e(ae)})}_(ee,K)},$$slots:{default:!0}}),Q(ee=>le=Et(X,1,"dot svelte-1i3xsfo",null,le,ee),[()=>({snapped:r(L).snapped})]),_(G,H)},$$slots:{default:!0}})});var S=h(F,2);{let E=u(()=>P(t(),l())||nr());st(S,{get data(){return r(E)},generateId:!0,children:(L,R)=>{{let G=u(()=>He("draw-route-lines"));gt(L,Ce(()=>r(G),{paint:{"line-color":"purple","line-width":10}}))}},$$slots:{default:!0}})}var I=h(S,2);st(I,{get data(){return r(p)},children:(E,L)=>{{let R=u(()=>He("draw-route-preview"));gt(E,Ce(()=>r(R),{paint:{"line-color":"black","line-width":3}}))}},$$slots:{default:!0}}),_(n,k),Ne(),a()}function Bh(n,e,t){e().eraseAllMainRoads(),lr(Kt,t())}var Fh=M("<li><!></li>"),Oh=M('<div style="display: flex; justify-content: space-between;"><nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav> <nav><ul><li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li> <!></ul></nav></div>'),jh=M('<input type="checkbox" role="switch"/>'),zh=(n,e)=>Y(e,{kind:"filter",freehand:!1},!0),Dh=(n,e)=>Y(e,{kind:"oneway"},!0),Uh=(n,e,t)=>Y(e,t(),!0),Gh=(n,e)=>Y(e,{kind:"main-roads",tool:"toggle",waypoints:[]},!0),Wh=(n,e)=>Y(e,!0),Hh=M('<h3> </h3> <p> </p> <!> <div style="display: flex; gap: 8px; align-items: leading; flex-direction: column; width: fit-content;"><button class="outline"> </button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button></div>',1),qh=M("<h3> </h3> <p> </p>",1),Jh=M("<h3> </h3> <p> </p>",1),Qh=M("<i> </i>"),Zh=M('<a href="https://openstreetmap.org/about" target="_blank"> </a>'),Vh=(n,e)=>{Y(e,{kind:"main-roads",tool:"toggle",waypoints:[]},!0)},Kh=(n,e)=>{Y(e,{kind:"main-roads",tool:"snap-route-main",waypoints:[]},!0)},Xh=(n,e)=>{Y(e,{kind:"main-roads",tool:"snap-route-erase",waypoints:[]},!0)},Yh=M('<h3> </h3> <p><!></p> <p> </p> <div class="classification-buttons svelte-1i6ad5a" style="display: flex; flex-direction: column; gap: 8px; justify-content: left;"><button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button></div>',1),e0=M("<mark> </mark>"),t0=M('<input type="checkbox"/>'),r0=M('<span class="footnote-ref svelte-1i6ad5a"> </span>'),n0=M('<input type="checkbox"/>'),o0=M('<span class="footnote-ref svelte-1i6ad5a"> </span>'),a0=M('<input type="checkbox"/>'),i0=M('<span class="footnote-ref svelte-1i6ad5a"> </span>'),s0=M('<div style="display: flex; justify-content: space-between; align-items: center"><h2> </h2> <label><!></label></div> <div><div class="tool-palette" style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 6px;"><div style="height: 50px; display: flex; justify-content: left; gap: 6px;"><button><img/></button> <button><div style="height: 100%; width: 100%; position: relative;"><img style="position: absolute; width: 60%; height: 60%; top: -1px; left: -1px;"/> <img style="position: absolute; width: 60%; height: 60%; bottom: -1px; right: -1px; transform: rotate(180deg);"/></div></button> <button><img/></button> <button><img/></button></div> <div style="height: 50px; display: flex; justify-content: right; gap: 6px;"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button></div></div> <div style="min-height: 200px; padding-bottom: 16px; border-bottom: solid var(--pico-muted-border-color) 1px;"><!></div> <!></div> <h2> </h2> <label><!></label> <label><!></label> <label><!></label> <label style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;"><span style="text-wrap: nowrap;"> </span> <select style="margin: 0; padding: 8px; width: auto;"><option> </option><option> </option><option> </option><option> </option></select></label> <!> <h2> </h2> <!>',1),l0=M("<p><!></p>"),u0=M("<p><!></p>"),c0=M('<img width="20"/>'),d0=M("<div><!></div>"),f0=M("<p> </p>"),v0=M("<p> </p>"),g0=M("<p> </p>"),_0=M("<!> <!>",1),p0=M("<!> <!> <!> <!> <!>",1),h0=M('<img width="20"/>'),m0=M("<div><!></div>"),b0=M("<!> <!> <!> <!> <!> <!> <!>",1);function y0(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",B),o=()=>we(Zr,"$map",B),a=()=>we(Kt,"$mutationCounter",B),s=()=>we(Zi,"$currentFilterType",B),l=()=>we($i,"$showBeforeEdits",B),i=()=>we(cs,"$animateShortcuts",B),v=()=>we(wt,"$mode",B),f=()=>we(ea,"$devMode",B),b=()=>we(wi,"$drawBorderEntries",B),m=()=>we(xi,"$thickRoadsForShortcuts",B),C=()=>we(Na,"$roadStyle",B),[B,T]=lt(),$=u(()=>ut(ct("main")));function P(){return{kind:"turn_restriction",from_road_id:null,from_road_name:"",possible_targets:nr()}}let y=Ae(bt({kind:"filter",freehand:!1})),w=Ae(!1),O=Ae(bt(t().renderNeighbourhood())),D=u(()=>r(O).features.find(q=>q.properties.kind=="boundary")),N=Ae(bt(nr())),j=Ae(0);nn(()=>{xl()}),cr(()=>{o().doubleClickZoom.enable()});function z(q){Y(O,t().renderNeighbourhood(),!0),ra()}function d(q,ee){a()==r(j)||!ee||(Y(N,t().getAllShortcuts(),!0),Y(j,a(),!0))}function g(q,ee){r(y).kind=="filter"?(t().addModalFilter(ee,s()),lr(Kt,a())):r(y).kind=="oneway"?(t().toggleTravelFlow(q.properties.road),lr(Kt,a())):r(y).kind=="main-roads"&&r(y).tool=="toggle"?(t().toggleMainRoad(q.properties.road),lr(Kt,a())):r(y).kind=="turn_restriction"&&(r(y).from_road_id=q.properties.road,r(y).from_road_name=q.properties.name||"unnamed road",r(y).possible_targets=t().getTurnRestrictionTargets(q.properties.road))}function p(q){r(y).kind=="turn_restriction"&&(o().queryRenderedFeatures(q.point,{layers:["interior-roads","turn-restriction-targets"]}).length>0||Y(y,P(),!0))}function k(q){if(r(y).kind=="turn_restriction"&&r(y).from_road_id!=null){let ee=q.features[0].properties.road;t().addTurnRestriction(r(y).from_road_id,ee),lr(Kt,a())}Y(y,P(),!0)}function x(q){let ee=q.features[0];t().deleteModalFilter(ee.properties.road),lr(Kt,a())}function A(q){let ee=q.features[0];t().deleteTurnRestriction(ee.properties.intersection,ee.properties.from_road,ee.properties.to_road),lr(Kt,a())}function F(q){if(r(y).kind!="filter"){console.assert(!1,`this shouldn't happen - intersections should only be clickable when in 'filter' mode, not ${r(y).kind}`);return}q.hasRotatedFilter?(t().deleteDiagonalFilter(q),lr(Kt,a())):q.filter?(t().rotateDiagonalFilter(q),lr(Kt,a())):(t().addDiagonalFilter(q),lr(Kt,a()))}function S(q){return!!(q.kind=="filter"&&q.freehand||q.kind=="main-roads"&&q.tool!="toggle"&&q.waypoints.length>0||q.kind=="turn_restriction"&&q.from_road_id!=null)}function I(q){l()||q.target.tagName!=r($).t(378)&&(S(r(y))||(q.ctrlKey&&q.key=="z"&&E(),q.ctrlKey&&q.key=="y"&&L(),q.key=="1"&&Y(y,{kind:"filter",freehand:!1},!0),q.key=="2"&&Y(y,{kind:"oneway"},!0),q.key=="3"&&Y(y,P(),!0),q.key=="4"&&Y(y,{kind:"main-roads",tool:"toggle",waypoints:[]},!0)))}function E(){t().undo(),lr(Kt,a())}function L(){t().redo(),lr(Kt,a())}function R(q){q&&(t().addManyModalFilters(q,s()),lr(Kt,a())),Y(y,{kind:"filter",freehand:!1},!0)}function G(q){let ee=r(y).kind=="main-roads"&&r(y).tool=="snap-route-main";t().setMainRoads(q,ee),lr(Kt,a())}let J="Shortcuts are routes from one main road to another, which cut through the neighborhood's interior.",H="Cells are the colored area reachable without travelling along a main road.",X={left:Sl,right:Li,straight:El,u_left_to_right:Cl,u_right_to_left:Ll};Qe(()=>{r(y).kind=="oneway"||r(y).kind=="main-roads"?o().doubleClickZoom.disable():o().doubleClickZoom.enable()}),Qe(()=>{r(y).kind=="filter"&&r(y).freehand?o().getCanvas().style.cursor=`url(${Vp}) 8 22, cell`:r(y).kind=="main-roads"&&r(y).tool=="snap-route-erase"?o().getCanvas().style.cursor=`url(${Zp}) 8 22, cell`:o().getCanvas().style.cursor=""}),Qe(()=>{z(a())}),Qe(()=>{d(a(),i())});let le=u(()=>r(O).features.filter(q=>q.properties.kind=="cell"&&q.properties.cell_color=="disconnected").length);Vn("keydown",ua,I),Lr(n,{top:K=>{var V=Oh(),te=c(V),re=c(te),ie=c(re),ne=c(ie);Xe(ne,{mode:{mode:"title"}});var ae=h(ie,2),_e=c(ae);Xe(_e,{mode:{mode:"pick-neighbourhood"}});var se=h(ae,2),fe=c(se),oe=h(te,2),ye=c(oe),he=c(ye),xe=c(he);Xe(xe,{mode:{mode:"view-shortcuts"}});var Se=h(he,2),De=c(Se);Xe(De,{mode:{mode:"route",prevMode:"neighbourhood"}});var ke=h(Se,2),Ee=c(ke);Xe(Ee,{mode:{mode:"predict-impact",prevMode:"neighbourhood"}});var pe=h(ke,2),Ie=c(pe);Xe(Ie,{mode:{mode:"impact-one-destination"}});var Te=h(pe,2),me=c(Te);{let Le=u(()=>({mode:"set-boundary",name:r(D).properties.name,existing:r(D)}));Xe(me,{get mode(){return r(Le)}})}var Me=h(Te,2);{var Fe=Le=>{var qe=Fh(),Oe=c(qe);Xe(Oe,{mode:{mode:"debug-neighbourhood"},children:(Ze,Be)=>{var We=jt();Q(Je=>U(We,Je),[()=>r($).t(379)]),_(Ze,We)},$$slots:{default:!0}}),_(Le,qe)};ve(Me,Le=>{f()&&Le(Fe)})}Q(Le=>U(fe,Le),[()=>Ar(v().mode)]),_(K,V)},left:K=>{var V=s0(),te=Z(V),re=c(te),ie=c(re),ne=h(re,2);{const it=vt=>{var Ge=jh();Q(Ke=>Ge.disabled=Ke,[()=>S(r(y))]),kn(Ge,l,Ke=>Ve($i,Ke)),_(vt,Ge)};var ae=c(ne);{let vt=u(()=>[it]),Ge=u(()=>r($).cx(381));be(ae,{get t(){return r(vt)},get x(){return r(Ge)}})}}var _e=h(te,2);let se;var fe=c(_e),oe=c(fe),ye=c(oe);ye.__click=[zh,y];let he;var xe=c(ye),Se=h(ye,2);Se.__click=[Dh,y];let De;var ke=c(Se),Ee=c(ke),pe=h(Ee,2),Ie=h(Se,2);Ie.__click=[Uh,y,P];let Te;var me=c(Ie),Me=h(Ie,2);Me.__click=[Gh,y];let Fe;var Le=c(Me),qe=h(oe,2),Oe=c(qe);Oe.__click=E;var Ze=c(Oe);Hc(Ze,{});var Be=h(Oe,2);Be.__click=L;var We=c(Be);Gc(We,{});var Je=h(fe,2),tt=c(Je);{var yt=it=>{var vt=Hh(),Ge=Z(vt),Ke=c(Ge),nt=h(Ge,2),Zt=c(nt),Pt=h(nt,2);yh(Pt,{get show(){return r(w)},set show(Nr){Y(w,Nr,!0)}});var hr=h(Pt,2),mr=c(hr);mr.__click=[Wh,w];var ln=c(mr),tr=h(mr,2);tr.__click=function(...Nr){(r(y).freehand?()=>Y(y,{kind:"filter",freehand:!1},!0):()=>Y(y,{kind:"filter",freehand:!0},!0))?.apply(this,Nr)};let ir;var Tt=c(tr),wn=c(Tt);Uc(wn,{});var un=h(wn,2),xn=c(un);Q((Nr,Bn,Yn,mo,eo,bo)=>{U(Ke,Nr),U(Zt,Bn),U(ln,Yn),Ue(tr,"data-tippy-content",mo),ir=Et(tr,1,"",null,ir,eo),U(xn,bo)},[()=>r($).t(394),()=>r($).t(395),()=>r($).t(396),()=>r($).t(397),()=>({active:r(y).freehand,outline:!r(y).freehand}),()=>r($).t(398)]),_(it,vt)},dt=it=>{var vt=$e(),Ge=Z(vt);{var Ke=Zt=>{var Pt=qh(),hr=Z(Pt),mr=c(hr),ln=h(hr,2),tr=c(ln);Q((ir,Tt)=>{U(mr,ir),U(tr,Tt)},[()=>r($).t(399),()=>r($).t(400)]),_(Zt,Pt)},nt=Zt=>{var Pt=$e(),hr=Z(Pt);{var mr=tr=>{var ir=Jh(),Tt=Z(ir),wn=c(Tt),un=h(Tt,2),xn=c(un);Q((Nr,Bn)=>{U(wn,Nr),U(xn,Bn)},[()=>r($).t(387),()=>r($).t(401)]),_(tr,ir)},ln=tr=>{var ir=$e(),Tt=Z(ir);{var wn=un=>{var xn=Yh(),Nr=Z(xn),Bn=c(Nr),Yn=h(Nr,2);{const ai=(On,jn=Pe)=>{var zn=Qh(),wo=c(zn);Q(xo=>U(wo,xo),[()=>r($).tx(jn())]),_(On,zn)},ii=(On,jn=Pe)=>{var zn=Zh(),wo=c(zn);Q(xo=>U(wo,xo),[()=>r($).tx(jn())]),_(On,zn)};var mo=c(Yn);{let On=u(()=>[ai,ii]),jn=u(()=>r($).cx(403));be(mo,{get t(){return r(On)},get x(){return r(jn)}})}}var eo=h(Yn,2),bo=c(eo),ni=h(eo,2),Fn=c(ni);Fn.__click=[Vh,y];let ha;var wu=c(Fn),ns=c(wu);Il(ns,{});var xu=h(ns,2),$u=c(xu),yo=h(Fn,2);yo.__click=[Kh,y];let os;var ku=c(yo),as=c(ku);Wc(as,{});var Su=h(as,2),Eu=c(Su),Ao=h(yo,2);Ao.__click=[Xh,y];let is;var Lu=c(Ao),ss=c(Lu);Fc(ss,{});var Cu=h(ss,2),Mu=c(Cu),oi=h(Ao,2);oi.__click=[Bh,t,a],Et(oi,1,"",null,{},{outline:!0});var Pu=c(oi),ls=c(Pu);Ya(ls,{});var Tu=h(ls,2),Iu=c(Tu);Q((ai,ii,On,jn,zn,wo,xo,Ru,Nu,Bu,Fu,Ou)=>{U(Bn,ai),U(bo,ii),Ue(Fn,"data-tippy-content",On),ha=Et(Fn,1,"",null,ha,jn),U($u,zn),Ue(yo,"data-tippy-content",wo),os=Et(yo,1,"",null,os,xo),U(Eu,Ru),Ue(Ao,"data-tippy-content",Nu),is=Et(Ao,1,"",null,is,Bu),U(Mu,Fu),U(Iu,Ou)},[()=>r($).t(402),()=>r($).t(404),()=>r($).t(405),()=>({active:r(y).tool=="toggle",outline:r(y).tool!="toggle"}),()=>r($).t(406),()=>r($).t(407),()=>({active:r(y).tool=="snap-route-main",outline:r(y).tool!="snap-route-main"}),()=>r($).t(408),()=>r($).t(407),()=>({active:r(y).tool=="snap-route-erase",outline:r(y).tool!="snap-route-erase"}),()=>r($).t(409),()=>r($).t(410)]),_(un,xn)};ve(Tt,un=>{r(y).kind=="main-roads"&&un(wn)},!0)}_(tr,ir)};ve(hr,tr=>{r(y).kind=="turn_restriction"?tr(mr):tr(ln,!1)},!0)}_(Zt,Pt)};ve(Ge,Zt=>{r(y).kind=="oneway"?Zt(Ke):Zt(nt,!1)},!0)}_(it,vt)};ve(tt,it=>{r(y).kind=="filter"?it(yt):it(dt,!1)})}var kt=h(Je,2);{var $t=it=>{var vt=e0(),Ge=c(vt);Q(Ke=>U(Ge,Ke),[()=>r($).t(411)]),_(it,vt)};ve(kt,it=>{r(le)>0&&it($t)})}var _t=h(_e,2),at=c(_t),et=h(_t,2);{const it=Ge=>{var Ke=t0();kn(Ke,i,nt=>Ve(cs,nt)),_(Ge,Ke)},vt=(Ge,Ke=Pe)=>{var nt=r0();Ue(nt,"data-tippy-content",J);var Zt=c(nt);Q(Pt=>U(Zt,Pt),[()=>r($).tx(Ke())]),_(Ge,nt)};var pt=c(et);{let Ge=u(()=>[it,vt]),Ke=u(()=>r($).cx(413));be(pt,{get t(){return r(Ge)},get x(){return r(Ke)}})}}var Mt=h(et,2);{const it=Ge=>{var Ke=n0();kn(Ke,b,nt=>Ve(wi,nt)),_(Ge,Ke)},vt=(Ge,Ke=Pe)=>{var nt=o0();Ue(nt,"data-tippy-content",H);var Zt=c(nt);Q(Pt=>U(Zt,Pt),[()=>r($).tx(Ke())]),_(Ge,nt)};var Ct=c(Mt);{let Ge=u(()=>[it,vt]),Ke=u(()=>r($).cx(414));be(Ct,{get t(){return r(Ge)},get x(){return r(Ke)}})}}var ht=h(Mt,2);{const it=Ge=>{var Ke=a0();kn(Ke,m,nt=>Ve(xi,nt)),_(Ge,Ke)},vt=(Ge,Ke=Pe)=>{var nt=i0();Ue(nt,"data-tippy-content",J);var Zt=c(nt);Q(Pt=>U(Zt,Pt),[()=>r($).tx(Ke())]),_(Ge,nt)};var Gt=c(ht);{let Ge=u(()=>[it,vt]),Ke=u(()=>r($).cx(415));be(Gt,{get t(){return r(Ge)},get x(){return r(Ke)}})}}var Dt=h(ht,2),sr=c(Dt),an=c(sr),pr=h(sr,2),wr=c(pr),xr=c(wr);wr.value=wr.__value="shortcuts";var Cr=h(wr),sn=c(Cr);Cr.value=Cr.__value="cells";var Gr=h(Cr),Nn=c(Gr);Gr.value=Gr.__value="edits";var $r=h(Gr),Xn=c($r);$r.value=$r.__value="speeds";var ce=h(Dt,2);{var At=it=>{{let vt=u(()=>({limits:yl}));br(it,{get colorScale(){return bl},get labels(){return r(vt)}})}};ve(ce,it=>{C()=="speeds"&&it(At)})}var Qt=h(ce,2),Wt=c(Qt),ar=h(Qt,2);cu(ar,{get neighbourhoodBoundary(){return r(D)}}),Q((it,vt,Ge,Ke,nt,Zt,Pt,hr,mr,ln,tr,ir,Tt,wn,un,xn,Nr,Bn,Yn,mo,eo,bo,ni,Fn,ha)=>{U(ie,it),se=Et(_e,1,"svelte-1i6ad5a",null,se,vt),he=Et(ye,1,"icon-btn",null,he,Ge),Ue(ye,"data-tippy-content",Ke),Ue(xe,"src",nt),Ue(xe,"alt",Zt),De=Et(Se,1,"icon-btn",null,De,Pt),Ue(Se,"data-tippy-content",hr),Ue(Ee,"src",tl),Ue(Ee,"alt",mr),Ue(pe,"src",tl),Ue(pe,"alt",ln),Te=Et(Ie,1,"icon-btn",null,Te,tr),Ue(Ie,"data-tippy-content",ir),Ue(me,"src",Li),Ue(me,"alt",Tt),Fe=Et(Me,1,"icon-btn",null,Fe,wn),Ue(Me,"data-tippy-content",un),Ue(Le,"src",Kp),Ue(Le,"alt",xn),Oe.disabled=r(O).undo_length==0,Ue(Oe,"data-tippy-content",Nr),Be.disabled=r(O).redo_length==0,Ue(Be,"data-tippy-content",Bn),U(at,Yn),U(an,mo),U(xr,eo),U(sn,bo),U(Nn,ni),U(Xn,Fn),U(Wt,ha)},[()=>r($).t(380),()=>({"edits-disabled":l()}),()=>({active:r(y).kind=="filter"}),()=>r($).t(382),()=>Ot.getFilter(s()).iconURL,()=>r($).t(383),()=>({active:r(y).kind=="oneway"}),()=>r($).t(384),()=>r($).t(385),()=>r($).t(385),()=>({active:r(y).kind=="turn_restriction"}),()=>r($).t(386),()=>r($).t(387),()=>({active:r(y).kind=="main-roads"}),()=>r($).t(388),()=>r($).t(389),()=>r(O).undo_length==0?r($).t(390):r($).t(391,[r(O).undo_length]),()=>r(O).redo_length==0?r($).t(392):r($).t(393,[r(O).redo_length]),()=>r($).t(412),()=>r($).t(416),()=>r($).t(417),()=>r($).t(418),()=>r($).t(419),()=>r($).t(420),()=>r($).t(421)]),vn(pr,C,it=>Ve(Na,it)),_(K,V)},main:K=>{var V=b0(),te=Z(V);fa(te,{onclick:p});var re=h(te,2);Sh(re,{});var ie=h(re,2);st(ie,{get data(){return r(O)},generateId:!0,children:(xe,Se)=>{var De=p0(),ke=Z(De);ti(ke,{});var Ee=h(ke,2);{let me=u(()=>!l());ga(Ee,{get show(){return r(me)}})}var pe=h(Ee,2);{let me=u(()=>!l());pa(pe,{get show(){return r(me)}})}var Ie=h(pe,2);{const me=Le=>{Bt(Le,{openOn:"hover",children:(Oe,Ze)=>{let Be=()=>Ze?.().data;const We=u(()=>Be().properties);var Je=_0(),tt=Z(Je);{var yt=at=>{var et=l0(),pt=c(et);{let Mt=u(()=>r($).cx(374)),Ct=u(()=>[r(We).shortcuts,r(We).name??"unnamed road",Math.round(r(We).speed_mph)]);be(pt,{get x(){return r(Mt)},get a(){return r(Ct)}})}_(at,et)},dt=at=>{var et=$e(),pt=Z(et);{var Mt=Ct=>{var ht=u0(),Gt=c(ht);{let Dt=u(()=>r($).cx(375)),sr=u(()=>[r(We).name??"unnamed road",Math.round(r(We).speed_mph)]);be(Gt,{get x(){return r(Dt)},get a(){return r(sr)}})}_(Ct,ht)};ve(pt,Ct=>{r(We).kind=="main_road"&&Ct(Mt)},!0)}_(at,et)};ve(tt,at=>{r(We).kind=="interior_road"?at(yt):at(dt,!1)})}var kt=h(tt,2);{var $t=at=>{var et=d0();{const Mt=Ct=>{var ht=c0();Q((Gt,Dt)=>{Ue(ht,"src",Gt),Ue(ht,"alt",Dt)},[()=>Ot.getFilter(s()).iconURL,()=>r($).t(394)]),_(Ct,ht)};var pt=c(et);{let Ct=u(()=>[Mt]),ht=u(()=>r($).cx(422));be(pt,{get t(){return r(Ct)},get x(){return r(ht)}})}}_(at,et)},_t=at=>{var et=$e(),pt=Z(et);{var Mt=ht=>{var Gt=f0(),Dt=c(Gt);Q(sr=>U(Dt,sr),[()=>r($).t(423)]),_(ht,Gt)},Ct=ht=>{var Gt=$e(),Dt=Z(Gt);{var sr=pr=>{var wr=v0(),xr=c(wr);Q(Cr=>U(xr,Cr),[()=>r($).t(424)]),_(pr,wr)},an=pr=>{var wr=$e(),xr=Z(wr);{var Cr=sn=>{var Gr=g0(),Nn=c(Gr);Q($r=>U(Nn,$r),[()=>r($).t(425)]),_(sn,Gr)};ve(xr,sn=>{r(y).kind=="turn_restriction"&&sn(Cr)},!0)}_(pr,wr)};ve(Dt,pr=>{r(y).kind=="main-roads"&&r(y).tool=="toggle"?pr(sr):pr(an,!1)},!0)}_(ht,Gt)};ve(pt,ht=>{r(y).kind=="oneway"?ht(Mt):ht(Ct,!1)},!0)}_(at,et)};ve(kt,at=>{r(y).kind=="filter"?at($t):at(_t,!1)})}_(Oe,Je)},$$slots:{default:!0}})};let Me=u(()=>!l()),Fe=u(()=>r(y).kind=="filter"&&!r(y).freehand||r(y).kind=="oneway"||r(y).kind=="main-roads"&&r(y).tool=="toggle"||r(y).kind=="turn_restriction"&&r(y).from_road_id==null);_a(Ie,{get show(){return r(Me)},get interactive(){return r(Fe)},onClickLine:g,get maxShortcuts(){return r(O).maxShortcuts},linePopup:me,$$slots:{linePopup:!0}})}var Te=h(Ie,2);{let me=u(()=>!l()),Me=u(()=>r(y).kind=="filter");_h(Te,{get show(){return r(me)},get interactive(){return r(Me)},get neighbourhood(){return r(O)},onClickIntersection:F})}_(xe,De)},$$slots:{default:!0}});var ne=h(ie,2);{var ae=xe=>{ah(xe,{get paths(){return r(N)}})};ve(ne,xe=>{i()&&a()==r(j)&&xe(ae)})}var _e=h(ne,2);{const xe=Ee=>{Bt(Ee,{openOn:"hover",children:(pe,Ie)=>{var Te=jt();Q(me=>U(Te,me),[()=>r($).t(426)]),_(pe,Te)},$$slots:{default:!0}})},Se=Ee=>{Bt(Ee,{openOn:"hover",children:(pe,Ie)=>{var Te=jt();Q(me=>U(Te,me),[()=>r($).t(427)]),_(pe,Te)},$$slots:{default:!0}})};let De=u(()=>!l()),ke=u(()=>r(y).kind=="filter");An(_e,{get show(){return r(De)},onClickModalFilter:x,onClickTurnRestriction:A,get interactive(){return r(ke)},modalFilterPopup:xe,turnRestrictionPopup:Se,$$slots:{modalFilterPopup:!0,turnRestrictionPopup:!0}})}var se=h(_e,2);{var fe=xe=>{Ah(xe,{get map(){return o()},onDone:R})},oe=xe=>{var Se=$e(),De=Z(Se);{var ke=Ee=>{Nh(Ee,{get map(){return o()},finish:G,cancel:()=>Y(y,{kind:"main-roads",tool:"toggle",waypoints:[]},!0),get waypoints(){return r(y).waypoints},set waypoints(pe){r(y).waypoints=pe}})};ve(De,Ee=>{r(y).kind=="main-roads"&&r(y).tool!="toggle"&&Ee(ke)},!0)}_(xe,Se)};ve(se,xe=>{r(y).kind=="filter"&&r(y).freehand?xe(fe):xe(oe,!1)})}var ye=h(se,2);{var he=xe=>{{let Se=u(()=>r(y).possible_targets||nr());st(xe,{get data(){return r(Se)},generateId:!0,children:(De,ke)=>{{let Ee=u(()=>He("turn-restriction-targets")),pe=u(()=>({"line-color":"yellow","line-opacity":xt(.5,1),"line-width":so(1)}));gt(De,Ce(()=>r(Ee),{manageHoverState:!0,get paint(){return r(pe)},onclick:k,children:(Ie,Te)=>{Bt(Ie,{openOn:"hover",children:(Me,Fe)=>{let Le=()=>Fe?.().data;const qe=u(()=>Le().properties);var Oe=m0();{const Be=We=>{var Je=h0();Q(tt=>{Ue(Je,"src",X[r(qe).kind]),Ue(Je,"alt",tt)},[()=>r($).t(428)]),_(We,Je)};var Ze=c(Oe);{let We=u(()=>[Be]),Je=u(()=>r($).cx(429)),tt=u(()=>[r(y).kind=="turn_restriction"?r(y).from_road_name:"???",r(qe).name||"unnamed road"]);be(Ze,{get t(){return r(We)},get x(){return r(Je)},get a(){return r(tt)}})}}_(Me,Oe)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}};ve(ye,xe=>{r(y).kind=="turn_restriction"&&xe(he)})}_(K,V)},$$slots:{top:!0,left:!0,main:!0}}),Ne(),T()}er(["click"]);var A0=M("<li><!></li>"),w0=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li><!></li> <li> </li></ul></nav>'),x0=M("<span> </span>"),$0=M("<span> </span>"),k0=M("<p><!></p> <i> </i>",1),S0=M("<i> </i>"),E0=M("<p><!></p>"),L0=M("<i> </i>"),C0=M("<p><!></p>"),M0=M("<!> <!> <!> <!>",1),P0=M("<!> <p><!></p> <!>",1),T0=M("<!> <!> <!>",1),I0=M("<!> <!>",1),R0=M("<!> <!>",1);function N0(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",s),o=()=>we(Vi,"$fastSample",s),a=()=>we(wt,"$mode",s),[s,l]=lt(),i=u(()=>ut(ct("main")));let v=bt(e.road.properties);v.kind="focus";let f=Ae(bt([])),b=Ae(0),m=Ae("Finding changes to this road");nn(async()=>{await Va(),Y(f,t().getImpactsOnRoad(v.id,o()),!0),Y(m,""),r(f).length==0&&(window.alert("No routes over this road change. (This is a bug in progress of being fixed.)"),Ve(wt,{mode:"predict-impact",prevMode:e.prevPrevMode}))});function C(w){return{type:"FeatureCollection",features:[r(f)[w].before,r(f)[w].after,e.road].filter(O=>O!=null)}}function B(w){return r(f)[w].before!=null?zo(r(f)[w].before.geometry.coordinates[0]):zo(r(f)[w].after.geometry.coordinates[0])}function T(w){let O=r(f)[w].before!=null?r(f)[w].before.geometry.coordinates:r(f)[w].after.geometry.coordinates;return zo(O[O.length-1])}var $=R0(),P=Z($);vo(P,{get loading(){return r(m)}});var y=h(P,2);Lr(y,{top:N=>{var j=w0(),z=c(j),d=c(z),g=c(d);Xe(g,{mode:{mode:"title"}});var p=h(d,2),k=c(p);Xe(k,{mode:{mode:"pick-neighbourhood"}});var x=h(p,2);{var A=L=>{var R=A0(),G=c(R);Xe(G,{mode:{mode:"neighbourhood"}}),_(L,R)};ve(x,L=>{e.prevPrevMode=="neighbourhood"&&L(A)})}var F=h(x,2),S=c(F);{let L=u(()=>({mode:"predict-impact",prevMode:e.prevPrevMode}));Xe(S,{get mode(){return r(L)}})}var I=h(F,2),E=c(I);Q(L=>U(E,L),[()=>Ar(a().mode)]),_(N,j)},left:N=>{var j=P0(),z=Z(j);{let x=u(()=>({mode:"predict-impact",prevMode:e.prevPrevMode}));on(z,{get mode(){return r(x)}})}var d=h(z,2);{const x=(F,S=Pe)=>{var I=x0();dr(I,"",{},{color:"red"});var E=c(I);Q(L=>U(E,L),[()=>r(i).tx(S())]),_(F,I)},A=(F,S=Pe)=>{var I=$0();dr(I,"",{},{color:"blue"});var E=c(I);Q(L=>U(E,L),[()=>r(i).tx(S())]),_(F,I)};var g=c(d);{let F=u(()=>[x,A]),S=u(()=>r(i).cx(66)),I=u(()=>[v.before.toLocaleString(),v.after.toLocaleString(),Math.round(100*v.after/v.before)]);be(g,{get t(){return r(F)},get x(){return r(S)},get a(){return r(I)}})}}var p=h(d,2);{var k=x=>{var A=M0(),F=Z(A);Ka(F,{get list(){return r(f)},get idx(){return r(b)},set idx(J){Y(b,J,!0)}});var S=h(F,2);{var I=J=>{var H=k0(),X=Z(H),le=c(X);{let ue=u(()=>r(i).cx(67)),K=u(()=>[r(f)[r(b)].count.toLocaleString()]);be(le,{get x(){return r(ue)},get a(){return r(K)}})}var q=h(X,2),ee=c(q);Q(ue=>U(ee,ue),[()=>r(i).t(68)]),_(J,H)};ve(S,J=>{r(f)[r(b)].count>1&&J(I)})}var E=h(S,2);{var L=J=>{var H=E0();dr(H,"",{},{color:"red"});{const le=(q,ee=Pe)=>{var ue=S0(),K=c(ue);Q(V=>U(K,V),[()=>r(i).tx(ee())]),_(q,ue)};var X=c(H);{let q=u(()=>[le]),ee=u(()=>r(i).cx(69));be(X,{get t(){return r(q)},get x(){return r(ee)}})}}_(J,H)};ve(E,J=>{r(f)[r(b)].before==null&&J(L)})}var R=h(E,2);{var G=J=>{var H=C0();dr(H,"",{},{color:"blue"});{const le=(q,ee=Pe)=>{var ue=L0(),K=c(ue);Q(V=>U(K,V),[()=>r(i).tx(ee())]),_(q,ue)};var X=c(H);{let q=u(()=>[le]),ee=u(()=>r(i).cx(70));be(X,{get t(){return r(q)},get x(){return r(ee)}})}}_(J,H)};ve(R,J=>{r(f)[r(b)].after==null&&J(G)})}_(x,A)};ve(p,x=>{r(f).length>0&&x(k)})}_(N,j)},main:N=>{var j=I0(),z=Z(j);{var d=p=>{var k=T0(),x=Z(k);{let S=u(()=>C(r(b)));st(x,{get data(){return r(S)},children:(I,E)=>{{let L=u(()=>He("predict-impact")),R=u(()=>({"line-width":pn(["get","kind"],{focus:8},5),"line-color":pn(["get","kind"],{focus:"black",before:"red",after:"blue"},"cyan"),"line-opacity":pn(["get","kind"],{focus:1},.5)}));gt(I,Ce(()=>r(L),{get paint(){return r(R)}}))}},$$slots:{default:!0}})}var A=h(x,2);{let S=u(()=>B(r(b)));Kn(A,{get lngLat(){return r(S)},children:(I,E)=>{var L=jt();Q(R=>U(L,R),[()=>r(i).t(71)]),_(I,L)},$$slots:{default:!0}})}var F=h(A,2);{let S=u(()=>T(r(b)));Kn(F,{get lngLat(){return r(S)},children:(I,E)=>{var L=jt();Q(R=>U(L,R),[()=>r(i).t(72)]),_(I,L)},$$slots:{default:!0}})}_(p,k)};ve(z,p=>{r(f).length>0&&p(d)})}var g=h(z,2);An(g,{interactive:!1}),_(N,j)},$$slots:{top:!0,left:!0,main:!0}}),_(n,$),Ne(),l()}var B0=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),F0=M("<p> </p>"),O0=M("<i> </i>"),j0=M("<p><!></p>"),z0=M("<p> </p>"),D0=M("<p> </p>"),U0=M("<i> </i>"),G0=M("<p><!></p>"),W0=M("<p> </p>"),H0=M("<!> <p> </p> <u> </u> <!> <u> </u> <!>",1),q0=M("<p><!></p>"),J0=M("<!> <!> <!> <!> <!>",1),Q0=M("<!> <!>",1);function Z0(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",s),o=()=>we(ba,"$oneDestination",s),a=()=>we(wt,"$mode",s),[s,l]=lt(),i=u(()=>ut(ct("main")));let v=t().renderNeighbourhood(),f=Ae(void 0);nn(()=>{setTimeout(()=>{o()&&ki(ba)},10)});function b(D){return D?t().compareRoute(new bi.LngLat(D.properties.pt1_x,D.properties.pt1_y),o(),1):nr()}function m(D){Ve(Ea,new bi.LngLat(D.properties.pt1_x,D.properties.pt1_y)),Ve(La,o()),Ve(wt,{mode:"route",prevMode:"impact-one-destination"})}function C(D){Ve(ba,D.lngLat)}let B=u(()=>t().impactToOneDestination(o())),T=u(()=>b(r(f))),$=u(()=>r(T).features.find(D=>D.properties.kind=="before")),P=u(()=>r(T).features.find(D=>D.properties.kind=="after"));var y=Q0(),w=Z(y);fa(w,{oncontextmenu:C});var O=h(w,2);Lr(O,{top:z=>{var d=B0(),g=c(d),p=c(g),k=c(p);Xe(k,{mode:{mode:"title"}});var x=h(p,2),A=c(x);Xe(A,{mode:{mode:"pick-neighbourhood"}});var F=h(x,2),S=c(F);Xe(S,{mode:{mode:"neighbourhood"}});var I=h(F,2),E=c(I);Q(L=>U(E,L),[()=>Ar(a().mode)]),_(z,d)},left:z=>{var d=H0(),g=Z(d);on(g,{mode:{mode:"neighbourhood"}});var p=h(g,2),k=c(p),x=h(p,2);dr(x,"",{},{color:"red"});var A=c(x),F=h(x,2);{var S=H=>{var X=F0(),le=c(X);Q((q,ee)=>U(le,`${q??""}, ${ee??""}`),[()=>Ba(r($).properties.distance),()=>Fa(r($).properties.time)]),_(H,X)},I=H=>{var X=$e(),le=Z(X);{var q=ue=>{var K=j0();{const te=(re,ie=Pe)=>{var ne=O0(),ae=c(ne);Q(_e=>U(ae,_e),[()=>r(i).tx(ie())]),_(re,ne)};var V=c(K);{let re=u(()=>[te]),ie=u(()=>r(i).cx(75));be(V,{get t(){return r(re)},get x(){return r(ie)}})}}_(ue,K)},ee=ue=>{var K=z0(),V=c(K);Q(te=>U(V,te),[()=>r(i).t(76)]),_(ue,K)};ve(le,ue=>{r(P)?ue(q):ue(ee,!1)},!0)}_(H,X)};ve(F,H=>{r($)?H(S):H(I,!1)})}var E=h(F,2);dr(E,"",{},{color:"blue"});var L=c(E),R=h(E,2);{var G=H=>{var X=D0(),le=c(X);Q((q,ee)=>U(le,`${q??""}, ${ee??""}`),[()=>Ba(r(P).properties.distance),()=>Fa(r(P).properties.time)]),_(H,X)},J=H=>{var X=$e(),le=Z(X);{var q=ue=>{var K=G0();{const te=(re,ie=Pe)=>{var ne=U0(),ae=c(ne);Q(_e=>U(ae,_e),[()=>r(i).tx(ie())]),_(re,ne)};var V=c(K);{let re=u(()=>[te]),ie=u(()=>r(i).cx(75));be(V,{get t(){return r(re)},get x(){return r(ie)}})}}_(ue,K)},ee=ue=>{var K=W0(),V=c(K);Q(te=>U(V,te),[()=>r(i).t(76)]),_(ue,K)};ve(le,ue=>{r($)?ue(q):ue(ee,!1)},!0)}_(H,X)};ve(R,H=>{r(P)?H(G):H(J,!1)})}Q((H,X,le)=>{U(k,H),U(A,X),U(L,le)},[()=>r(i).t(73),()=>r(i).t(74),()=>r(i).t(77)]),_(z,d)},main:z=>{var d=J0(),g=Z(d);st(g,{get data(){return v},generateId:!0,children:(F,S)=>{{let I=u(()=>He("cells")),E=u(()=>({"fill-color":Za(),"fill-opacity":.6}));ur(F,Ce(()=>r(I),{filter:["==",["get","kind"],"cell"],get paint(){return r(E)}}))}},$$slots:{default:!0}});var p=h(g,2);st(p,{get data(){return r(B)},generateId:!0,children:(F,S)=>{{let I=u(()=>He("interior-roads")),E=u(()=>({"line-color":["interpolate-hcl",["linear"],["/",["get","time_after"],["get","time_before"]],1,"white",Math.max(r(B).highest_time_ratio,1.1),"red"],"line-width":5}));gt(F,Ce(()=>r(I),{get paint(){return r(E)},manageHoverState:!0,onclick:L=>m(L.features[0]),get hovered(){return r(f)},set hovered(L){Y(f,L,!0)},children:(L,R)=>{Bt(L,{openOn:"hover",children:(J,H)=>{let X=()=>H?.().data;const le=u(()=>X().properties);var q=q0(),ee=c(q);{let ue=u(()=>r(i).cx(78)),K=u(()=>[(r(le).time_after/r(le).time_before).toFixed(1)]);be(ee,{get x(){return r(ue)},get a(){return r(K)}})}_(J,q)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}});var k=h(p,2);st(k,{get data(){return r(T)},children:(F,S)=>{{let I=u(()=>He("compare-route")),E=u(()=>({"line-width":10,"line-color":pn(["get","kind"],{before:"red",after:"blue"},"red")}));gt(F,Ce(()=>r(I),{interactive:!1,get paint(){return r(E)}}))}},$$slots:{default:!0}});var x=h(k,2);An(x,{interactive:!1});var A=h(x,2);Kn(A,{draggable:!0,get lngLat(){return ta(),o()},set lngLat(F){Ve(ba,F)},children:(F,S)=>{var I=jt();Q(E=>U(I,E),[()=>r(i).t(79)]),_(F,I)},$$slots:{default:!0}}),_(z,d)},$$slots:{top:!0,left:!0,main:!0}}),_(n,y),Ne(),l()}function V0(n,e){Qi("debug_route_snapper.geojson",e().toRouteSnapperGj())}var K0=(n,e)=>$l(e()),X0=(n,e)=>e(),Y0=M("<li><!></li>"),e1=M('<details class="dropdown" style="display: inline-block; margin-top: 8px"><summary role="button" class="contrast outline"><!> <span style="margin-left: 2px;"> </span></summary> <ul></ul></details>'),t1=M('<a href="mailto:dabreegster@gmail.com"> </a>'),r1=M("<p><!></p>"),n1=M('<div style="display: flex"><i><!></i> <!></div>'),o1=M('<button class="secondary"> </button>'),a1=M('<h2><!></h2> <div style="display: flex; gap: 8px"><button class="outline" style="margin-right: 8px;"><div style="display: flex; align-items: center; gap: 8px; color: black;"><!> <span style="margin-right: 2px;"> </span></div></button> <button class="outline" style="margin-right: 8px;"><div style="display: flex; align-items: center; gap: 8px; color: black;"><!> <span style="margin-right: 2px;"> </span></div></button></div> <!> <p><!></p> <p><!></p> <p><!></p> <!> <!>',1);function i1(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",v),o=()=>we(ho,"$projectStorage",v),a=()=>we(pl,"$currentProject",v),s=()=>we(_n,"$currentProjectID",v),l=()=>we(Kt,"$mutationCounter",v),i=()=>we(ea,"$devMode",v),[v,f]=lt(),b=u(()=>ut(ct("main")));let m=Ae(!1),C=t().getOsmTimestamp();function B(V){for(let[te,re]of o().studyAreaProjects())if(te==a().study_area_name)return re.filter(ie=>ie.projectID!=V);return[]}function T(){let V=a().project_name,te=window.prompt(r(b).t(127,[V]),o().nextAvailableProjectName(V));if(te)try{let re=o().copyProject(s(),te);Ve(_n,re),t().changeProjectName(te);let ie=new URL(window.location.href);ie.searchParams.set("project",re),window.history.replaceState(null,"",ie.toString()),window.alert(`Done, you are now working on project ${te}`)}catch(re){window.alert(`Couldn't copy project: ${re}`)}}function $(V){Y(m,!1);let te=o().project(V);t().loadSavefile(te),Ve(_n,V),lr(Kt,l());let re=new URL(window.location.href);re.searchParams.set("project",V),window.history.replaceState(null,"",re.toString())}function P(V){let te=0,re=0,ie=0;for(let ne of V.features)ne.properties.kind=="modal_filter"?te++:ne.properties.kind=="deleted_existing_modal_filter"?re++:ne.properties.kind=="travel_flow"&&ie++;return{modalFilters:te,deletedModalFilters:re,travelFlows:ie}}let y=u(()=>P(e.projectGj)),w=u(()=>B(s()));var O=a1(),D=Z(O),N=c(D);{let V=u(()=>r(b).cx(128)),te=u(()=>[a().project_name]);be(N,{get x(){return r(V)},get a(){return r(te)}})}var j=h(D,2),z=c(j);z.__click=[K0,s];var d=c(z),g=c(d);Tl(g,{});var p=h(g,2),k=c(p),x=h(z,2);x.__click=[X0,T];var A=c(x),F=c(A);Pl(F,{});var S=h(F,2),I=c(S),E=h(j,2);{var L=V=>{var te=e1(),re=c(te),ie=c(re);Oc(ie,{});var ne=h(ie,2),ae=c(ne),_e=h(re,2);qt(_e,21,()=>r(w),Jt,(se,fe)=>{var oe=Y0(),ye=c(oe);ca(ye,{onclick:()=>$(r(fe).projectID),children:(he,xe)=>{var Se=jt();Q(()=>U(Se,r(fe).projectName)),_(he,Se)}}),_(se,oe)}),Q(se=>U(ae,se),[()=>r(b).t(133)]),Cc("open","toggle",te,se=>Y(m,se),()=>r(m)),_(V,te)};ve(E,V=>{a().study_area_name&&r(w).length>0&&V(L)})}var R=h(E,2),G=c(R);{let V=u(()=>r(b).cx(134)),te=u(()=>[r(y).modalFilters]);be(G,{get x(){return r(V)},get a(){return r(te)}})}var J=h(R,2),H=c(J);{let V=u(()=>r(b).cx(135)),te=u(()=>[r(y).deletedModalFilters]);be(H,{get x(){return r(V)},get a(){return r(te)}})}var X=h(J,2),le=c(X);{let V=u(()=>r(b).cx(136)),te=u(()=>[r(y).travelFlows]);be(le,{get x(){return r(V)},get a(){return r(te)}})}var q=h(X,2);{var ee=V=>{var te=n1(),re=c(te),ie=c(re);{let ae=u(()=>r(b).cx(137)),_e=u(()=>[C.toDateString()]);be(ie,{get x(){return r(ae)},get a(){return r(_e)}})}var ne=h(re,2);Do(ne,{children:(ae,_e)=>{var se=r1();{const oe=(ye,he=Pe)=>{var xe=t1(),Se=c(xe);Q(De=>U(Se,De),[()=>r(b).tx(he())]),_(ye,xe)};var fe=c(se);{let ye=u(()=>[oe]),he=u(()=>r(b).cx(138));be(fe,{get t(){return r(ye)},get x(){return r(he)}})}}_(ae,se)},$$slots:{default:!0}}),_(V,te)};ve(q,V=>{C&&V(ee)})}var ue=h(q,2);{var K=V=>{var te=o1();te.__click=[V0,t];var re=c(te);Q(ie=>U(re,ie),[()=>r(b).t(139)]),_(V,te)};ve(ue,V=>{i()&&V(K)})}Q((V,te,re,ie)=>{Ue(z,"title",V),U(k,te),Ue(x,"title",re),U(I,ie)},[()=>r(b).t(129),()=>r(b).t(130),()=>r(b).t(131),()=>r(b).t(132)]),_(n,O),Ne(),f()}er(["click"]);var s1=M("<li><!></li>"),l1=M('<div style="display: flex; justify-content: space-between;"><nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li></ul></nav> <nav><ul><li><!></li> <li><!></li> <!></ul></nav></div>'),u1=(n,e,t)=>e(t()),c1=(n,e,t)=>e(t()),d1=M('<li><h3><!></h3> <span class="actions"><button class="outline icon-btn"><!></button> <button class="icon-btn destructive"><!></button></span></li>'),f1=M("<h3> </h3> <p> </p> <!> <hr/>",1),v1=M('<h2> </h2> <ul class="navigable-list"><!> <li><!></li></ul> <!> <!>',1),g1=M("<b> </b>"),_1=M("<b> </b>"),p1=M("<b> </b>"),h1=M("<h2> </h2> <!>",1),m1=M("<!> <!> <!> <!>",1),b1=M("<!> <!>",1);function y1(n,e){Re(e,!0);const t=()=>we(Kt,"$mutationCounter",f),o=()=>we(Rt,"$backend",f),a=()=>we(wt,"$mode",f),s=()=>we(Vr,"$appFocus",f),l=()=>we(po,"$metricBuckets",f),i=()=>we(_n,"$currentProjectID",f),v=()=>we(ea,"$devMode",f),[f,b]=lt(),m=u(()=>ut(ct("main")));let C=u(()=>t()>0?o().toSavefile():nr()),B=u(()=>({type:"FeatureCollection",features:r(C).features.filter(j=>j.properties.kind=="boundary")}));Qe(()=>{r(B).features.length==0&&Ve(wt,{mode:"add-neighbourhood"})});let T=Ae(bt(s()=="cnt"?"combined":"none")),$=Ae(null),P=Ae(void 0);Ve(io,void 0);function y(j){o().setCurrentNeighbourhood(j),Ve(io,j),Ve(wt,{mode:"neighbourhood"})}function w(j){window.confirm(r(m).t(140,[j]))&&(o().deleteNeighbourhoodBoundary(j),console.assert(!io),ra(),lr(Kt,t()))}function O(j){let z=du(o(),r(m).t(141,[j]),j);z&&(o().renameNeighbourhoodBoundary(j,z),Ve(io,z),ra(),lr(Kt,t()))}function D(j){let z=Jr.mapFeature.hover.backgroundColor,d=vu({none:z},j,l());return["case",["==",["feature-state","highlight"],"yes"],z,d]}function N(j){let z=.7;return{none:["case",["==",["feature-state","highlight"],"yes"],z,xt(.3,z)],area:xt(.7,.9),population_density:xt(.7,.9),simd:xt(.7,.9),stats19:xt(.7,.9),pois:xt(.7,.9),car_ownership:xt(.7,.9),combined:xt(.7,.9)}[j]}Lr(n,{top:g=>{var p=l1(),k=c(p),x=c(k),A=c(x),F=c(A);Xe(F,{mode:{mode:"title"}});var S=h(A,2),I=c(S);Xa(I,i,q=>{var ee=jt();Q(ue=>U(ee,ue),[()=>Ar(a().mode)]),_(q,ee)});var E=h(k,2),L=c(E),R=c(L),G=c(R);Xe(G,{mode:{mode:"route",prevMode:"pick-neighbourhood"}});var J=h(R,2),H=c(J);Xe(H,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var X=h(J,2);{var le=q=>{var ee=s1(),ue=c(ee);Xe(ue,{mode:{mode:"debug-intersections"}}),_(q,ee)};ve(X,q=>{v()&&q(le)})}_(g,p)},left:g=>{var p=v1(),k=Z(p),x=c(k),A=h(k,2),F=c(A);qt(F,17,()=>r(B).features,Jt,(G,J)=>{let H=()=>r(J).properties.name;var X=d1();let le;var q=c(X),ee=c(q);ca(ee,{onclick:()=>y(H()),children:(ie,ne)=>{var ae=jt();Q(()=>U(ae,H())),_(ie,ae)}});var ue=h(q,2),K=c(ue);K.__click=[u1,O,H];var V=c(K);Ki(V,{color:"black"});var te=h(K,2);te.__click=[c1,w,H];var re=c(te);Ya(re,{color:"white"}),Q((ie,ne,ae)=>{le=Et(X,1,"actionable-cell svelte-j2ux5u",null,le,ie),Ue(K,"title",ne),Ue(te,"title",ae)},[()=>({highlighted:r(P)?.properties.name==H()||r($)==H()}),()=>r(m).t(143),()=>r(m).t(144)]),Vn("mouseenter",X,()=>Y($,H(),!0)),Vn("mouseleave",X,()=>Y($,null)),_(G,X)});var S=h(F,2),I=c(S);{const G=J=>{Bc(J,{})};Xe(I,{mode:{mode:"add-neighbourhood"},_w_snippet_0:G,children:(J,H)=>{{let X=u(()=>[G]),le=u(()=>r(m).cx(145));be(J,{get t(){return r(X)},get x(){return r(le)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}var E=h(A,2);{var L=G=>{var J=f1(),H=Z(J),X=c(H),le=h(H,2),q=c(le),ee=h(le,2);fu(ee,{get selectedPrioritization(){return r(T)},set selectedPrioritization(ue){Y(T,ue,!0)}}),Q((ue,K)=>{U(X,ue),U(q,K)},[()=>r(m).t(17),()=>r(m).t(146)]),_(G,J)};ve(E,G=>{s()=="cnt"&&G(L)})}var R=h(E,2);i1(R,{get projectGj(){return r(C)}}),Q(G=>U(x,G),[()=>r(m).t(142)]),_(g,p)},main:g=>{var p=b1(),k=Z(p);st(k,{get data(){return r(B)},promoteId:"name",children:(A,F)=>{var S=m1(),I=Z(S);{let G=u(()=>r($)?[{name:r($),highlight:"yes"}]:[]);ed(I,{get data(){return r(G)},idCol:"name"})}var E=h(I,2);{let G=u(()=>He("neighbourhood-boundaries-selected-outline",!1));gt(E,Ce({filter:["==",["get","kind"],"boundary"]},()=>r(G),{manageHoverState:!1,paint:{"line-color":"black","line-width":4,"line-dasharray":[2,2]}}))}var L=h(E,2);{let G=u(()=>He("neighbourhood-boundaries-selected-outline-base",!1));gt(L,Ce({filter:["==",["get","kind"],"boundary"]},()=>r(G),{manageHoverState:!1,paint:{"line-color":"white","line-width":8,"line-opacity":.7}}))}var R=h(L,2);{let G=u(()=>He("neighbourhood-boundaries",!1)),J=u(()=>({"fill-color":D(r(T)),"fill-opacity":N(r(T))}));ur(R,Ce(()=>r(G),{filter:["==",["get","kind"],"boundary"],get paint(){return r(J)},manageHoverState:!0,hoverCursor:"pointer",onclick:H=>y(H.features[0].properties.name),get hovered(){return r(P)},set hovered(H){Y(P,H,!0)},children:(H,X)=>{Bt(H,{openOn:"hover",children:(q,ee)=>{let ue=()=>ee?.().data;const K=u(()=>ue().properties);var V=h1(),te=Z(V),re=c(te),ie=h(te,2);{var ne=_e=>{const se=(fe,oe=Pe)=>{var ye=g1(),he=c(ye);Q(xe=>U(he,xe),[()=>r(m).tx(oe())]),_(fe,ye)};{let fe=u(()=>[se]),oe=u(()=>r(m).cx(147)),ye=u(()=>[Math.round(r(K).population/r(K).area_km2).toLocaleString()]);be(_e,{get t(){return r(fe)},get x(){return r(oe)},get a(){return r(ye)}})}},ae=_e=>{var se=$e(),fe=Z(se);{var oe=he=>{const xe=(Se,De=Pe)=>{var ke=_1(),Ee=c(ke);Q(pe=>U(Ee,pe),[()=>r(m).tx(De())]),_(Se,ke)};{let Se=u(()=>[xe]),De=u(()=>r(m).cx(148)),ke=u(()=>[(r(K).number_stats19_collisions/r(K).area_km2).toFixed(1)]);be(he,{get t(){return r(Se)},get x(){return r(De)},get a(){return r(ke)}})}},ye=he=>{var xe=$e(),Se=Z(xe);{var De=ke=>{const Ee=(pe,Ie=Pe)=>{var Te=p1(),me=c(Te);Q(Me=>U(me,Me),[()=>r(m).tx(Ie())]),_(pe,Te)};{let pe=u(()=>[Ee]),Ie=u(()=>r(m).cx(149)),Te=u(()=>[(r(K).number_pois/r(K).area_km2).toFixed(1)]);be(ke,{get t(){return r(pe)},get x(){return r(Ie)},get a(){return r(Te)}})}};ve(Se,ke=>{r(T)=="pois"&&ke(De)},!0)}_(he,xe)};ve(fe,he=>{r(T)=="stats19"?he(oe):he(ye,!1)},!0)}_(_e,se)};ve(ie,_e=>{r(T)=="population_density"?_e(ne):_e(ae,!1)})}Q(()=>U(re,r(K).name)),_(q,V)},$$slots:{default:!0}})},$$slots:{default:!0}}))}_(A,S)},$$slots:{default:!0}});var x=h(k,2);An(x,{interactive:!1}),_(g,p)},$$slots:{top:!0,left:!0,main:!0}}),Ne(),b()}er(["click"]);function rl(n,e,t){Ve(Vi,r(t)=="fast")}var A1=M("<li><!></li>"),w1=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li> </li></ul></nav>'),x1=M('<a href="https://nptscot.github.io/data/" target="_blank"> </a>'),$1=M("<p><!></p>"),k1=M("<span> </span> <!>",1),S1=M('<a href="https://www.nomisweb.co.uk/sources/census_2021_od" target="_blank"> </a>'),E1=M('<a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/methodologies/userguidetocensus2021origindestinationdataenglandandwales" target="_blank"> </a>'),L1=M("<p><!></p>"),C1=M("<span> </span> <!>",1),M1=M("<b> </b>"),P1=M('<a href="mailto:dabreegster@gmail.com"> </a>'),T1=M("<p><!></p>"),I1=M("<b> </b> <!>",1),R1=M('<input type="radio"/>'),N1=M('<input type="radio"/>'),B1=M('<input type="number"/>'),F1=M('<!> <p><!></p> <div style="display: flex"><!></div> <hr/> <fieldset><label><!></label> <label><!></label></fieldset> <p> </p> <label><!></label> <!>',1),O1=M("<p><!></p> <p> </p>",1),j1=M("<!> <!>",1),z1=M("<!> <!> <!>",1),D1=M("<!> <!>",1);function U1(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",i),o=()=>we(wt,"$mode",i),a=()=>we(Vi,"$fastSample",i),s=()=>we(Vr,"$appFocus",i),l=()=>we(ds,"$minImpactCount",i),[i,v]=lt(),f=[],b=u(()=>ut(ct("main")));let m=["#1a9641","#a6d96a","white","#fdae61","#d7191c"],C=Ae(""),B=Ae(bt({type:"FeatureCollection",features:[],max_count:1})),T=t().toSavefile(),$=3,P=10;function y(z){Ve(wt,{mode:"impact-detail",road:z,prevPrevMode:e.prevMode})}async function w(z){Y(C,r(b).t(80),!0),await Va(),Y(B,t().predictImpact(z),!0),Y(C,"")}Qe(()=>{w(a())});let O=Ae(bt(a()?"fast":"accurate"));var D=D1(),N=Z(D);vo(N,{get loading(){return r(C)}});var j=h(N,2);Lr(j,{top:p=>{var k=w1(),x=c(k),A=c(x),F=c(A);Xe(F,{mode:{mode:"title"}});var S=h(A,2),I=c(S);Xe(I,{mode:{mode:"pick-neighbourhood"}});var E=h(S,2);{var L=J=>{var H=A1(),X=c(H);Xe(X,{mode:{mode:"neighbourhood"}}),_(J,H)};ve(E,J=>{e.prevMode=="neighbourhood"&&J(L)})}var R=h(E,2),G=c(R);Q(J=>U(G,J),[()=>Ar(o().mode)]),_(p,k)},left:p=>{var k=F1(),x=Z(k);{let V=u(()=>({mode:e.prevMode}));on(x,{get mode(){return r(V)}})}var A=h(x,2);{const V=(te,re=Pe)=>{Xe(te,{mode:{mode:"debug-demand"},children:(ie,ne)=>{var ae=jt();Q(_e=>U(ae,_e),[()=>r(b).tx(re())]),_(ie,ae)},$$slots:{default:!0}})};var F=c(A);{let te=u(()=>[V]),re=u(()=>r(b).cx(81));be(F,{get t(){return r(te)},get x(){return r(re)}})}}var S=h(A,2),I=c(S);{var E=V=>{var te=k1(),re=Z(te),ie=c(re),ne=h(re,2);Do(ne,{children:(ae,_e)=>{var se=$1();{const oe=(ye,he=Pe)=>{var xe=x1(),Se=c(xe);Q(De=>U(Se,De),[()=>r(b).tx(he())]),_(ye,xe)};var fe=c(se);{let ye=u(()=>[oe]),he=u(()=>r(b).cx(83));be(fe,{get t(){return r(ye)},get x(){return r(he)}})}}_(ae,se)},$$slots:{default:!0}}),Q(ae=>U(ie,ae),[()=>r(b).t(82)]),_(V,te)},L=V=>{var te=$e(),re=Z(te);{var ie=ae=>{var _e=C1(),se=Z(_e),fe=c(se),oe=h(se,2);Do(oe,{children:(ye,he)=>{var xe=L1();{const De=(Ee,pe=Pe)=>{var Ie=S1(),Te=c(Ie);Q(me=>U(Te,me),[()=>r(b).tx(pe())]),_(Ee,Ie)},ke=(Ee,pe=Pe)=>{var Ie=E1(),Te=c(Ie);Q(me=>U(Te,me),[()=>r(b).tx(pe())]),_(Ee,Ie)};var Se=c(xe);{let Ee=u(()=>[De,ke]),pe=u(()=>r(b).cx(85));be(Se,{get t(){return r(Ee)},get x(){return r(pe)}})}}_(ye,xe)},$$slots:{default:!0}}),Q(ye=>U(fe,ye),[()=>r(b).t(84)]),_(ae,_e)},ne=ae=>{var _e=I1(),se=Z(_e),fe=c(se),oe=h(se,2);Do(oe,{children:(ye,he)=>{var xe=T1();{const De=(Ee,pe=Pe)=>{var Ie=M1(),Te=c(Ie);Q(me=>U(Te,me),[()=>r(b).tx(pe())]),_(Ee,Ie)},ke=(Ee,pe=Pe)=>{var Ie=P1(),Te=c(Ie);Q(me=>U(Te,me),[()=>r(b).tx(pe())]),_(Ee,Ie)};var Se=c(xe);{let Ee=u(()=>[De,ke]),pe=u(()=>r(b).cx(87));be(Se,{get t(){return r(Ee)},get x(){return r(pe)}})}}_(ye,xe)},$$slots:{default:!0}}),Q(ye=>U(fe,ye),[()=>r(b).t(86)]),_(ae,_e)};ve(re,ae=>{s()=="england"?ae(ie):ae(ne,!1)},!0)}_(V,te)};ve(I,V=>{s()=="cnt"?V(E):V(L,!1)})}var R=h(S,4),G=c(R);{const V=te=>{var re=R1();re.__change=[rl,a,O],re.value=re.__value="fast",Ai(f,[],re,()=>r(O),ie=>Y(O,ie)),_(te,re)};var J=c(G);{let te=u(()=>[V]),re=u(()=>r(b).cx(88));be(J,{get t(){return r(te)},get x(){return r(re)}})}}var H=h(G,2);{const V=te=>{var re=N1();re.__change=[rl,a,O],re.value=re.__value="accurate",Ai(f,[],re,()=>r(O),ie=>Y(O,ie)),_(te,re)};var X=c(H);{let te=u(()=>[V]),re=u(()=>r(b).cx(89));be(X,{get t(){return r(te)},get x(){return r(re)}})}}var le=h(R,2),q=c(le),ee=h(le,2);{const V=te=>{var re=B1();Ue(re,"min",0),Yo(re,l,ie=>Ve(ds,ie)),_(te,re)};var ue=c(ee);{let te=u(()=>[V]),re=u(()=>r(b).cx(91));be(ue,{get t(){return r(te)},get x(){return r(re)}})}}var K=h(ee,2);br(K,{get colorScale(){return m},labels:{limits:["0%","50%","same","150%","200%"]}}),Q(V=>U(q,V),[()=>r(b).t(90)]),_(p,k)},main:p=>{var k=z1(),x=Z(k);st(x,{get data(){return T},children:(S,I)=>{{let E=u(()=>He("neighbourhood-boundaries",!1));ur(S,Ce(()=>r(E),{filter:["==",["get","kind"],"boundary"],paint:{"fill-color":"grey","fill-opacity":.5}}))}},$$slots:{default:!0}});var A=h(x,2);st(A,{get data(){return r(B)},generateId:!0,children:(S,I)=>{var E=j1(),L=Z(E);{let G=u(()=>He("predict-impact-outline")),J=u(()=>[">=",["max",["get","before"],["get","after"]],l()]),H=u(()=>({"line-width":["interpolate",["linear"],["get","after"],0,1.5*$,r(B).max_count,1.5*P],"line-color":"black"}));gt(L,Ce(()=>r(G),{get filter(){return r(J)},get paint(){return r(H)}}))}var R=h(L,2);{let G=u(()=>He("predict-impact")),J=u(()=>[">=",["max",["get","before"],["get","after"]],l()]),H=u(()=>({"line-width":["interpolate",["linear"],["get","after"],0,$,r(B).max_count,P],"line-color":["let","ratio",["*",100,["/",["get","after"],["get","before"]]],["interpolate-hcl",["linear"],["var","ratio"],0,m[0],50,m[1],100,m[2],150,m[3],200,m[4]]]}));gt(R,Ce(()=>r(G),{get filter(){return r(J)},get paint(){return r(H)},manageHoverState:!0,hoverCursor:"pointer",onclick:X=>y(X.features[0]),children:(X,le)=>{Bt(X,{openOn:"hover",children:(ee,ue)=>{let K=()=>ue?.().data;const V=u(()=>K().properties);var te=O1(),re=Z(te),ie=c(re);{let _e=u(()=>r(b).cx(92)),se=u(()=>[r(V).before.toLocaleString(),r(V).after.toLocaleString()]);be(ie,{get x(){return r(_e)},get a(){return r(se)}})}var ne=h(re,2),ae=c(ne);Q(_e=>U(ae,`${_e??""}%`),[()=>Math.round(100*r(V).after/r(V).before)]),_(ee,te)},$$slots:{default:!0}})},$$slots:{default:!0}}))}_(S,E)},$$slots:{default:!0}});var F=h(A,2);An(F,{interactive:!1}),_(p,k)},$$slots:{top:!0,left:!0,main:!0}}),_(n,D),Ne(),v()}er(["change"]);var G1=M("<li><!></li>"),W1=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li> </li></ul></nav>'),H1=M("<p> </p>"),q1=M("<i> </i>"),J1=M("<p><!></p>"),Q1=M("<p> </p>"),Z1=M("<i> </i>"),V1=M("<p><!></p>"),K1=M('<input type="range" min="1.0" max="5.0" step="0.1"/>'),X1=M("<!> <p> </p> <u> </u> <!> <u> </u> <!> <label><!></label> <i> </i>",1),Y1=M("<!> <!> <!> <!>",1),em=M("<!> <!> <!> <!> <!>",1);function tm(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",i),o=()=>we(Ea,"$routePtA",i),a=()=>we(La,"$routePtB",i),s=()=>we(fs,"$mainRoadPenalty",i),l=()=>we(wt,"$mode",i),[i,v]=lt(),f=u(()=>ut(ct("main")));let b=e.prevMode=="neighbourhood"?t().renderNeighbourhood():null,m=u(()=>t().compareRoute(o(),a(),s())),C=u(()=>r(m).features.find(T=>T.properties.kind=="before")),B=u(()=>r(m).features.find(T=>T.properties.kind=="after"));nn(()=>{setTimeout(()=>{ki(Ea),ki(La)},10)}),Lr(n,{top:y=>{var w=W1(),O=c(w),D=c(O),N=c(D);Xe(N,{mode:{mode:"title"}});var j=h(D,2),z=c(j);Xe(z,{mode:{mode:"pick-neighbourhood"}});var d=h(j,2);{var g=x=>{var A=G1(),F=c(A);Xe(F,{mode:{mode:"neighbourhood"}}),_(x,A)};ve(d,x=>{e.prevMode=="neighbourhood"&&x(g)})}var p=h(d,2),k=c(p);Q(x=>U(k,x),[()=>Ar(l().mode)]),_(y,w)},left:y=>{var w=X1(),O=Z(w);{let G=u(()=>({mode:e.prevMode}));on(O,{get mode(){return r(G)}})}var D=h(O,2),N=c(D),j=h(D,2);dr(j,"",{},{color:"red"});var z=c(j),d=h(j,2);{var g=G=>{var J=H1(),H=c(J);Q((X,le)=>U(H,`${X??""}, ${le??""}`),[()=>Ba(r(C).properties.distance),()=>Fa(r(C).properties.time)]),_(G,J)},p=G=>{var J=J1();{const X=(le,q=Pe)=>{var ee=q1(),ue=c(ee);Q(K=>U(ue,K),[()=>r(f).tx(q())]),_(le,ee)};var H=c(J);{let le=u(()=>[X]),q=u(()=>r(f).cx(75));be(H,{get t(){return r(le)},get x(){return r(q)}})}}_(G,J)};ve(d,G=>{r(C)?G(g):G(p,!1)})}var k=h(d,2);dr(k,"",{},{color:"blue"});var x=c(k),A=h(k,2);{var F=G=>{var J=Q1(),H=c(J);Q((X,le)=>U(H,`${X??""}, ${le??""}`),[()=>Ba(r(B).properties.distance),()=>Fa(r(B).properties.time)]),_(G,J)},S=G=>{var J=V1();{const X=(le,q=Pe)=>{var ee=Z1(),ue=c(ee);Q(K=>U(ue,K),[()=>r(f).tx(q())]),_(le,ee)};var H=c(J);{let le=u(()=>[X]),q=u(()=>r(f).cx(75));be(H,{get t(){return r(le)},get x(){return r(q)}})}}_(G,J)};ve(A,G=>{r(B)?G(F):G(S,!1)})}var I=h(A,2);{const G=J=>{var H=K1();Yo(H,s,X=>Ve(fs,X)),_(J,H)};var E=c(I);{let J=u(()=>[G]),H=u(()=>r(f).cx(94)),X=u(()=>[s()]);be(E,{get t(){return r(J)},get x(){return r(H)},get a(){return r(X)}})}}var L=h(I,2),R=c(L);Q((G,J,H,X)=>{U(N,G),U(z,J),U(x,H),U(R,X)},[()=>r(f).t(93),()=>r(f).t(74),()=>r(f).t(77),()=>r(f).t(95)]),_(y,w)},main:y=>{var w=em(),O=Z(w);{var D=g=>{st(g,{get data(){return b},generateId:!0,children:(p,k)=>{var x=Y1(),A=Z(x);ti(A,{});var F=h(A,2);ga(F,{});var S=h(F,2);pa(S,{});var I=h(S,2);_a(I,{interactive:!1,get maxShortcuts(){return b.maxShortcuts}}),_(p,x)},$$slots:{default:!0}})};ve(O,g=>{e.prevMode=="neighbourhood"&&g(D)})}var N=h(O,2);An(N,{interactive:!1});var j=h(N,2);st(j,{get data(){return r(m)},children:(g,p)=>{{let k=u(()=>He("compare-route")),x=u(()=>({"line-width":10,"line-color":pn(["get","kind"],{before:"red",after:"blue"},"red")}));gt(g,Ce(()=>r(k),{get paint(){return r(x)}}))}},$$slots:{default:!0}});var z=h(j,2);Kn(z,{draggable:!0,get lngLat(){return ta(),o()},set lngLat(g){Ve(Ea,g)},children:(g,p)=>{var k=jt();Q(x=>U(k,x),[()=>r(f).t(71)]),_(g,k)},$$slots:{default:!0}});var d=h(z,2);Kn(d,{draggable:!0,get lngLat(){return ta(),a()},set lngLat(g){Ve(La,g)},children:(g,p)=>{var k=jt();Q(x=>U(k,x),[()=>r(f).t(72)]),_(g,k)},$$slots:{default:!0}}),_(y,w)},$$slots:{top:!0,left:!0,main:!0}}),Ne(),v()}function rm(n,e,t,o,a,s){if(r(e))try{t().setCurrentNeighbourhoodBoundary(o.name,r(e)),ra(),Ve(wt,{mode:"neighbourhood"})}catch(l){window.alert(`Sorry, this boundary is invalid: ${l}`),s()}}var nm=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),om=M('<!> <h1> </h1> <!> <div style="display: flex; gap: 16px;"><button> </button> <button class="secondary"> </button></div>',1);function am(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",s),o=()=>we(wt,"$mode",s),a=()=>we(Zr,"$map",s),[s,l]=lt(),i=u(()=>ut(ct("main")));let v=Ae(bt([])),f=Ae(void 0),b=e.existing.properties.waypoints;if(!b){let C={type:"LineString",coordinates:e.existing.geometry.coordinates[1]};b=t().extractWaypointsFromRing(C)}Y(v,b.map(C=>({point:[C.lon,C.lat],snapped:C.snapped})),!0);function m(){Ve(wt,{mode:"neighbourhood"})}Lr(n,{top:T=>{var $=nm(),P=c($),y=c(P),w=c(y);Xe(w,{mode:{mode:"title"}});var O=h(y,2),D=c(O);Xe(D,{mode:{mode:"pick-neighbourhood"}});var N=h(O,2),j=c(N);Xe(j,{mode:{mode:"neighbourhood"}});var z=h(N,2),d=c(z);Q(g=>U(d,g),[()=>Ar(o().mode)]),_(T,$)},left:T=>{var $=om(),P=Z($);on(P,{mode:{mode:"neighbourhood"}});var y=h(P,2),w=c(y),O=h(y,2);uu(O,{get map(){return a()},get waypoints(){return r(v)},set waypoints(g){Y(v,g,!0)},get drawnShapeOut(){return r(f)},set drawnShapeOut(g){Y(f,g,!0)}});var D=h(O,2),N=c(D);N.__click=[rm,f,t,e,o,m];var j=c(N),z=h(N,2);z.__click=m;var d=c(z);Q((g,p,k)=>{U(w,g),N.disabled=r(v).length<3,U(j,p),U(d,k)},[()=>r(i).t(96),()=>r(i).t(97),()=>r(i).t(98)]),_(T,$)},$$slots:{top:!0,left:!0}}),Ne(),l()}er(["click"]);function im(n,e){var t,o,a,s,l,i,v,f,b,m,C=0,B=n.type==="FeatureCollection",T=n.type==="Feature",$=B?n.features.length:1;for(t=0;t<$;t++){for(i=B?n.features[t].geometry:T?n.geometry:n,f=B?n.features[t].properties:T?n.properties:{},b=B?n.features[t].bbox:T?n.bbox:void 0,m=B?n.features[t].id:T?n.id:void 0,v=i?i.type==="GeometryCollection":!1,l=v?i.geometries.length:1,a=0;a<l;a++){if(s=v?i.geometries[a]:i,s===null){if(e(null,C,f,b,m)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,C,f,b,m)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(e(s.geometries[o],C,f,b,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}C++}}function sm(n,e){im(n,function(t,o,a,s,l){var i=t===null?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return e(Pi(t,a,{bbox:s,id:l}),o,0)===!1?!1:void 0}var v;switch(i){case"MultiPoint":v="Point";break;case"MultiLineString":v="LineString";break;case"MultiPolygon":v="Polygon";break}for(var f=0;f<t.coordinates.length;f++){var b=t.coordinates[f],m={type:v,coordinates:b};if(e(Pi(m,a),o,f)===!1)return!1}})}var lm=Object.defineProperty,um=Object.defineProperties,cm=Object.getOwnPropertyDescriptors,nl=Object.getOwnPropertySymbols,dm=Object.prototype.hasOwnProperty,fm=Object.prototype.propertyIsEnumerable,ol=(n,e,t)=>e in n?lm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,al=(n,e)=>{for(var t in e||(e={}))dm.call(e,t)&&ol(n,t,e[t]);if(nl)for(var t of nl(e))fm.call(e,t)&&ol(n,t,e[t]);return n},il=(n,e)=>um(n,cm(e));function vm(n,e,t={}){if(!n||!e)throw new Error("lines and pt are required arguments");const o=gn(e);let a=Qn([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),s=0;return sm(n,function(l,i,v){const f=Xp(l);for(let b=0;b<f.length-1;b++){const m=Qn(f[b]);m.properties.dist=fn(e,m,t);const C=gn(m),B=Qn(f[b+1]);B.properties.dist=fn(e,B,t);const T=gn(B),$=fn(m,B,t);let P,y;C[0]===o[0]&&C[1]===o[1]?[P,,y]=[C,void 0,!1]:T[0]===o[0]&&T[1]===o[1]?[P,,y]=[T,void 0,!0]:[P,,y]=pm(m.geometry.coordinates,B.geometry.coordinates,gn(e));let w;P&&(w=Qn(P,{dist:fn(e,P,t),multiFeatureIndex:v,location:s+fn(m,P,t)})),w&&w.properties.dist<a.properties.dist&&(a=il(al({},w),{properties:il(al({},w.properties),{index:y?b+1:b})})),s+=$}}),a}function gm(n,e){const[t,o,a]=n,[s,l,i]=e;return t*s+o*l+a*i}function _m(n,e){const[t,o,a]=n,[s,l,i]=e;return[o*i-a*l,a*s-t*i,t*l-o*s]}function sl(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2))}function Wn(n,e){const t=gm(n,e)/(sl(n)*sl(e));return Math.acos(Math.min(Math.max(t,-1),1))}function pi(n){const e=Ir(n[1]),t=Ir(n[0]);return[Math.cos(e)*Math.cos(t),Math.cos(e)*Math.sin(t),Math.sin(e)]}function Hn(n){const[e,t,o]=n,a=oa(Math.asin(o));return[oa(Math.atan2(t,e)),a]}function pm(n,e,t){const o=pi(n),a=pi(e),s=pi(t),[l,i,v]=s,[f,b,m]=_m(o,a),C=b*v-m*i,B=m*l-f*v,T=f*i-b*l,$=T*b-B*m,P=C*m-T*f,y=B*f-C*b,w=1/Math.sqrt(Math.pow($,2)+Math.pow(P,2)+Math.pow(y,2)),O=[$*w,P*w,y*w],D=[-1*$*w,-1*P*w,-1*y*w],N=Wn(o,a),j=Wn(o,O),z=Wn(a,O),d=Wn(o,D),g=Wn(a,D);let p;return j<d&&j<g||z<d&&z<g?p=O:p=D,Wn(o,p)>N||Wn(a,p)>N?fn(Hn(p),Hn(o))<=fn(Hn(p),Hn(a))?[Hn(o),!0,!1]:[Hn(a),!1,!0]:[Hn(p),!1,!1]}var hm=vm;const mm=["==",["geometry-type"],"Polygon"],bm=["==",["geometry-type"],"LineString"],ym=["==",["geometry-type"],"Point"];function _u(){return{type:"FeatureCollection",features:[]}}function hi(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:pu(n)}}}function pu(n){return[Math.round(n[0]*1e7)/1e7,Math.round(n[1]*1e7)/1e7]}const hu=En(_u()),mu=En(0),Am=100;class wm{map;active;eventListenersSuccess;eventListenersUpdated;eventListenersFailure;points;cursor;hover;dragFrom;previousStates;constructor(e){this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}onMouseMove=e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,o=this.dragFrom[1]-e.lngLat.lat;for(let a of this.points)a[0]-=t,a[1]-=o}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}};onClick=e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(ll(this.points).forEach((o,a)=>{t.push([a+1,hm(o,this.cursor).properties.dist])}),t.sort((o,a)=>o[1]-a[1]),t.length>0){let o=t[0][0];this.points.splice(o,0,this.cursor.geometry.coordinates),this.hover=o}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))};onDoubleClick=e=>{this.active&&(e.preventDefault(),this.cursor=hi(e.lngLat.toArray()),this.onClick(e),this.finish())};onMouseDown=e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())};onMouseUp=()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())};onKeypress=e=>{if(!this.active)return;let t=e.target.tagName;t=="INPUT"||t=="TEXTAREA"||(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())};onKeyDown=e=>{if(!this.active)return;let t=e.target.tagName;t=="INPUT"||t=="TEXTAREA"||e.key=="Escape"&&(e.stopPropagation(),this.cancel())};addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e=_u();this.points.forEach((a,s)=>{let l=hi(a);l.properties.hover=this.hover==s,l.properties.idx=s,e.features.push(l)}),e.features=e.features.concat(ll(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),hu.set(e);let o="crosshair";this.hover!=null&&(o=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=o,mu.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=hi(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(pu),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>Am&&this.previousStates.shift()}}function ll(n){let e=[];for(let t=0;t<n.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[t],n[t+1]]},properties:{}});return n.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[n.length-1],n[0]]},properties:{}}),e}var xm=(n,e)=>e.polygonTool.finish(),$m=(n,e)=>e.polygonTool.cancel(),km=(n,e)=>e.polygonTool.undo(),Sm=M('<div style="display: flex; justify-content: space-between;"><button>Finish</button> <button>Cancel</button> <button><!></button></div> <ul><li><b>Click</b> the map to add a vertex</li> <li><b>Click</b> a vertex to delete it</li> <li><b>Drag</b> a vertex or the polygon to move it</li> <li>Press <b>Control+Z</b> to undo your last change</li> <li>Press <b>Enter</b> or <b>double click</b> to finish</li> <li>Press <b>Escape</b> to cancel</li></ul>',1);function Em(n,e){Re(e,!0);const t=()=>we(mu,"$undoLength",o),[o,a]=lt();var s=Sm(),l=Z(s),i=c(l);i.__click=[xm,e];var v=h(i,2);v.__click=[$m,e];var f=h(v,2);f.__click=[km,e];var b=c(f);{var m=B=>{var T=jt("Undo");_(B,T)},C=B=>{var T=jt();Q(()=>U(T,`Undo (${t()??""})`)),_(B,T)};ve(b,B=>{t()==0?B(m):B(C,!1)})}Q(()=>f.disabled=t()==0),_(n,s),Ne(),a()}er(["click"]);var Lm=M("<!> <!> <!>",1);function Cm(n){const e=()=>we(hu,"$polygonToolGj",t),[t,o]=lt();st(n,{get data(){return e()},children:(a,s)=>{var l=Lm(),i=Z(l);ur(i,{id:"edit-polygon-fill",get filter(){return mm},paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}});var v=h(i,2);gt(v,{id:"edit-polygon-lines",get filter(){return bm},paint:{"line-color":"black","line-width":8,"line-opacity":.5}});var f=h(v,2);Ln(f,{id:"edit-polygon-vertices",get filter(){return ym},paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}),_(a,l)},$$slots:{default:!0}}),o()}async function Mm(n,e,t,o){if(e.map){if(e.map.getZoom()<13){e.onerror?.("Zoom in more to import");return}await t(o())}}function Pm(n,e,t,o){e.map&&(Y(t,new wm(e.map),!0),r(t).startNew(),r(t).addEventListenerSuccess(async a=>{Y(t,null),await o(a)}),r(t).addEventListenerFailure(()=>{Y(t,null)}))}var Tm=M('<button class="btn btn-primary" type="button">Import current view</button> <p class="fst-italic my-3">or...</p> <button class="btn btn-primary" type="button">Draw an area to import on the map</button>',1),Im=M("<!> <!>",1);function Rm(n,e){Re(e,!0);let t=Ae(null),o=Ae(!1);async function a(C){try{e.onloading?.("Loading from Overpass");let T=await(await fetch(bu(C))).text();r(o)&&Qi("osm.xml",T),e.gotXml?.(T,C)}catch(B){e.onerror?.(B.toString())}}function s(C){return[C.lng,C.lat]}function l(){let C=e.map.getBounds();return{type:"Feature",properties:{},geometry:{coordinates:[[s(C.getSouthWest()),s(C.getNorthWest()),s(C.getNorthEast()),s(C.getSouthEast()),s(C.getSouthWest())]],type:"Polygon"}}}var i=Im(),v=Z(i);{var f=C=>{Em(C,{get polygonTool(){return r(t)}})},b=C=>{var B=Tm(),T=Z(B);T.__click=[Mm,e,a,l];var $=h(T,4);$.__click=[Pm,e,t,a],_(C,B)};ve(v,C=>{r(t)?C(f):C(b,!1)})}var m=h(v,2);dd(m,{get checked(){return r(o)},set checked(C){Y(o,C,!0)},children:(C,B)=>{var T=jt("Save a copy of the osm.xml after importing");_(C,T)},$$slots:{default:!0}}),_(n,i),Ne()}er(["click"]);function bu(n){let e='poly:"';if(n.geometry.type=="Polygon")for(let[o,a]of n.geometry.coordinates[0])e+=`${a} ${o} `;else if(n.geometry.type=="MultiPolygon")for(let[o,a]of n.geometry.coordinates[0][0])e+=`${a} ${o} `;else throw new Error("overpassQueryForPolygon needs a Polygon or MultiPolygon");return e=e.slice(0,-1)+'"',`https://overpass-api.de/api/interpreter?data=${`(nwr(${e}); node(w)->.x; <;); out meta;`}`}class yu{inner;constructor(e,t,o,a,s,l,i){this.inner=new l_(e||new Uint8Array,t||new Uint8Array,o,a,s,l,i)}getInvertedBoundary(){return JSON.parse(this.inner.getInvertedBoundary())}getBounds(){return Array.from(this.inner.getBounds())}toRouteSnapper(){return this.inner.toRouteSnapper()}toRouteSnapperGj(){return this.inner.toRouteSnapperGj()}renderModalFilters(){return JSON.parse(this.inner.renderModalFilters())}renderModalFiltersBeforeEdits(){return JSON.parse(this.inner.renderModalFiltersBeforeEdits())}renderTurnRestrictions(){return JSON.parse(this.inner.renderTurnRestrictions())}renderTurnRestrictionsBeforeEdits(){return JSON.parse(this.inner.renderTurnRestrictionsBeforeEdits())}renderNeighbourhood(){let e=JSON.parse(this.inner.renderNeighbourhood());return e.maxShortcuts=Math.max(...e.features.map(t=>t.properties.kind=="interior_road"?t.properties.shortcuts:0))??0,e}renderNeighbourhoodBeforeEdits(){let e=JSON.parse(this.inner.renderNeighbourhoodBeforeEdits());return e.maxShortcuts=Math.max(...e.features.map(t=>t.properties.kind=="interior_road"?t.properties.shortcuts:0))??0,e}generatedBoundaries(){return JSON.parse(this.inner.generatedBoundaries())}generateMergedBoundary(e){let t=this.inner.generateMergedBoundary(e);return JSON.parse(t)}setCurrentNeighbourhoodBoundary(e,t){this.inner.setCurrentNeighbourhoodBoundary(e,t)}extractWaypointsFromRing(e){let t=this.inner.extractWaypointsFromRing(e);return JSON.parse(t)}deleteNeighbourhoodBoundary(e){this.inner.deleteNeighbourhoodBoundary(e)}renameNeighbourhoodBoundary(e,t){this.inner.renameNeighbourhoodBoundary(e,t)}setCurrentNeighbourhood(e){this.inner.setCurrentNeighbourhood(e)}addModalFilter(e,t){this.inner.addModalFilter(e,t)}addManyModalFilters(e,t){this.inner.addManyModalFilters(e,t)}deleteModalFilter(e){this.inner.deleteModalFilter(e)}addDiagonalFilter(e){this.inner.addDiagonalFilter(e.intersectionId)}rotateDiagonalFilter(e){this.inner.rotateDiagonalFilter(e.intersectionId)}deleteDiagonalFilter(e){this.inner.deleteDiagonalFilter(e.intersectionId)}toggleTravelFlow(e){this.inner.toggleTravelFlow(e)}toggleMainRoad(e){this.inner.toggleMainRoad(e)}setMainRoads(e,t){this.inner.setMainRoads(new Uint32Array(e),t)}addTurnRestriction(e,t){this.inner.addTurnRestriction(e,t)}deleteTurnRestriction(e,t,o){this.inner.deleteTurnRestriction(e,t,o)}getTurnRestrictionTargets(e){return JSON.parse(this.inner.getTurnRestrictionTargets(e))}undo(){this.inner.undo()}redo(){this.inner.redo()}getShortcutsCrossingRoad(e){return JSON.parse(this.inner.getShortcutsCrossingRoad(e))}getAllShortcuts(){return JSON.parse(this.inner.getAllShortcuts())}getAllShortcutsBeforeEdits(){return JSON.parse(this.inner.getAllShortcutsBeforeEdits())}toSavefile(){return JSON.parse(this.inner.toSavefile())}loadSavefile(e){this.inner.loadSavefile(e)}changeProjectName(e){this.inner.changeProjectName(e)}compareRoute(e,t,o){return JSON.parse(this.inner.compareRoute(e.lng,e.lat,t.lng,t.lat,o))}impactToOneDestination(e){return JSON.parse(this.inner.impactToOneDestination(e.lng,e.lat))}predictImpact(e){return JSON.parse(this.inner.predictImpact(e))}getImpactsOnRoad(e,t){return JSON.parse(this.inner.getImpactsOnRoad(e,t)).map(o=>{let[a,s,l]=o;return{count:a,before:s,after:l}})}getAllIntersections(){return JSON.parse(this.inner.getAllIntersections())}getMovements(e){return JSON.parse(this.inner.getMovements(e))}getDemandModel(){let e=JSON.parse(this.inner.getDemandModel());for(let t of e.features)t.properties.sum_from=vs(t.properties.counts_from),t.properties.sum_to=vs(t.properties.counts_to);return e}getPOIs(){return JSON.parse(this.inner.getPOIs())}getMetricBuckets(){try{return JSON.parse(this.inner.getMetricBuckets())}catch{return null}}eraseAllMainRoads(){this.inner.eraseAllMainRoads()}getOsmTimestamp(){let e=this.inner.getOsmTimestamp();return e?new Date(1e3*Number(e)):null}}let go=En(""),_o=En(null);async function ri(n){let e=Hr(ho).project(n);try{console.time("get input files");let{osmBuffer:t,boundary:o,mapModelBuffer:a}=await Nm(e);console.timeEnd("get input files"),go.set("Download finished, setting up project"),_o.set(100),await Va(),console.time("load"),Rt.set(new yu(a?new Uint8Array(a):void 0,t?new Uint8Array(t):void 0,o,e.app_focus,e.study_area_name,e.project_name,e.db_schema_version)),Hr(Rt).loadSavefile(e),_n.set(n),console.timeEnd("load"),Au(n)}catch(t){window.alert(`Couldn't open project: ${t}`),_n.set(void 0)}go.set(""),_o.set(null)}async function Nm(n){if(n.app_focus=="cnt")return{mapModelBuffer:await mi(qr(`cnt/maps_v3/${n.study_area_name}.bin.gz`))};if(n.app_focus=="england")return{mapModelBuffer:await mi(qr(`england/maps_v3/${n.study_area_name}.bin.gz`))};if(n.study_area_name){let e=await mi(qr(`severance_pbfs/v2/${n.study_area_name}.osm.pbf`)),o=await(await Si(qr(`boundaries/${n.study_area_name}.geojson`))).json();return{osmBuffer:e,boundary:o}}else{go.set("Grabbing OSM data from Overpass"),_o.set(100);let e=n.features.find(a=>a.properties.kind=="study_area_boundary");return{osmBuffer:await(await Si(bu(e))).arrayBuffer(),boundary:e}}}async function mi(n){return console.log(`Grabbing ${n}`),go.set(`Downloading ${n}`),await hc(n,e=>_o.set(e))}function Au(n){ei.set(new Ed(Hr(Zr),Hr(Rt).toRouteSnapper(),En(nr()),En(!0),En(0))),Hr(Zr).fitBounds(Hr(Rt).getBounds(),{duration:500});let e=Hr(Rt).getMetricBuckets();e&&po.set(e);let t=new URL(window.location.href);t.searchParams.set("project",n),window.history.replaceState(null,"",t.toString())}var Bm=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li> </li></ul></nav>'),Fm=M('<input type="text"/>'),Om=(n,e)=>e(),jm=M("<option> </option>"),zm=M("<optgroup></optgroup>"),Dm=M("<select><option></option><!></select>"),Um=M("<label><!></label> <i> </i> <div><!></div>",1),Gm=M("<div><label><!></label></div> <!>",1),Wm=M("<!> <!> <!>",1);function Hm(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",f),o=()=>we(Vr,"$appFocus",f),a=()=>we(ho,"$projectStorage",f),s=()=>we(wt,"$mode",f),l=()=>we(go,"$loadingMessage",f),i=()=>we(_o,"$loadingProgress",f),v=()=>we(Zr,"$map",f),[f,b]=lt(),m=u(()=>ut(ct("main")));let C=Ae(""),B=Ae(null),T=Ae(bt([])),$=Ae("");nn(async()=>{let d=await Si(qr("severance_pbfs/areas.json"));Y(T,await d.json(),!0)});async function P(d,g){Y($,r(m).t(160),!0);try{let p;Ve(Rt,new yu(void 0,new TextEncoder().encode(d),g,o(),p,r(C),a().dbSchemaVersion));const k=a().createProject(t().toSavefile());Ve(_n,k),Au(k),Ve(wt,{mode:"add-neighbourhood"})}catch(p){window.alert(`Couldn't import from Overpass: ${p}`)}Y($,"")}async function y(){if(!r(B))return;let d;try{d=a().createEmptyProject(r(C),r(B))}catch(g){Y(B,null),window.alert(`Couldn't create project: ${g}`);return}await ri(d),Ve(wt,{mode:"add-neighbourhood"})}var w={loadExample:y},O=Wm(),D=Z(O);vo(D,{get loading(){return r($)},progress:100});var N=h(D,2);vo(N,{get loading(){return l()},get progress(){return i()}});var j=h(N,2);Lr(j,{top:k=>{var x=Bm(),A=c(x),F=c(A),S=c(F);Xe(S,{mode:{mode:"title"}});var I=h(F,2),E=c(I);Q(L=>U(E,L),[()=>Ar(s().mode)]),_(k,x)},left:k=>{var x=Gm(),A=Z(x),F=c(A);{const L=R=>{var G=Fm();Yo(G,()=>r(C),J=>Y(C,J)),_(R,G)};var S=c(F);{let R=u(()=>[L]),G=u(()=>r(m).cx(161));be(S,{get t(){return r(R)},get x(){return r(G)}})}}var I=h(A,2);{var E=L=>{var R=Um(),G=Z(R);{const ee=ue=>{var K=Dm();K.__change=[Om,y];var V=c(K);V.value=V.__value="";var te=h(V);qt(te,17,()=>r(T),Jt,(re,ie)=>{var ne=u(()=>Dr(r(ie),2));let ae=()=>r(ne)[0],_e=()=>r(ne)[1];var se=zm();qt(se,21,_e,Jt,(fe,oe)=>{var ye=u(()=>Dr(r(oe),2));let he=()=>r(ye)[0],xe=()=>r(ye)[1];var Se=jm(),De=c(Se),ke={};Q(()=>{U(De,xe()),ke!==(ke=he())&&(Se.value=(Se.__value=he())??"")}),_(fe,Se)}),Q(()=>Ue(se,"label",ae())),_(re,se)}),vn(K,()=>r(B),re=>Y(B,re)),_(ue,K)};var J=c(G);{let ue=u(()=>[ee]),K=u(()=>r(m).cx(162));be(J,{get t(){return r(ue)},get x(){return r(K)}})}}var H=h(G,2),X=c(H),le=h(H,2),q=c(le);Rm(q,{get map(){return v()},gotXml:P,onloading:ee=>Y($,ee,!0),onerror:ee=>window.alert(ee)}),Q(ee=>U(X,ee),[()=>r(m).t(163)]),_(L,R)};ve(I,L=>{r(C)&&L(E)})}_(k,x)},main:k=>{Cm(k)},$$slots:{top:!0,left:!0,main:!0}}),_(n,O);var z=Ne(w);return b(),z}er(["change"]);const qm="/ltn/assets/boundaries-BnmDCWUr.geojson",Jm="/ltn/assets/boundaries-Ddt_iXWy.geojson";var Qm=()=>window.location.href=".",Zm=()=>window.location.href="cnt.html",Vm=()=>window.location.href="england.html",Km=M('<a href="mailto:dabreegster@gmail.com"> </a>'),Xm=M("<p><!></p>"),Ym=M('<span style="display: flex; flex-direction: row; height: 80%; gap: 4px"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><span class="fi fi-gb-sct"></span></button> <button class="outline icon-btn"><span class="fi fi-gb-eng"></span></button> <!></span>');function e2(n,e){Re(e,!0);const t=()=>we(Vr,"$appFocus",o),[o,a]=lt(),s=u(()=>ut(ct("main")));nn(xl);var l=Ym(),i=c(l);i.__click=[Qm];var v=c(i);jc(v,{color:"black"});var f=h(i,2);f.__click=[Zm];var b=h(f,2);b.__click=[Vm];var m=h(b,2);Do(m,{children:(C,B)=>{var T=Xm();{const P=(y,w=Pe)=>{var O=Km(),D=c(O);Q(N=>U(D,N),[()=>r(s).tx(w())]),_(y,O)};var $=c(T);{let y=u(()=>[P]),w=u(()=>r(s).cx(153));be($,{get t(){return r(y)},get x(){return r(w)}})}}_(C,T)},$$slots:{default:!0}}),Q((C,B,T,$,P)=>{Ue(i,"data-tippy-content",C),i.disabled=t()=="global",Ue(f,"data-tippy-content",B),Ue(f,"aria-label",T),f.disabled=t()=="cnt",Ue(b,"data-tippy-content",$),Ue(b,"aria-label",P),b.disabled=t()=="england"},[()=>r(s).t(150),()=>r(s).t(151),()=>r(s).t(151),()=>r(s).t(152),()=>r(s).t(152)]),_(n,l),Ne(),a()}er(["click"]);function t2(n,e,t,o){r(e)&&t(r(o).t(154,[r(e)]))}var r2=M("<option> </option>"),n2=M("<p><!></p>"),o2=M("<!> <!>",1),a2=M('<p> </p> <select style="width: 90%"><option></option><!></select> <!>',1);function ul(n,e){Re(e,!0);const t=()=>we(ho,"$projectStorage",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=Ae(bt({type:"FeatureCollection",features:[]})),i=Ae(bt([])),v=Ae("");nn(async()=>{let w=await fetch(e.boundariesUrl);Y(l,await w.json(),!0);for(let O of r(l).features)r(i).push(O.properties.name);r(i).sort(),Y(i,r(i),!0)});function f(w){let O=w.features[0].properties;b(`${O.kind}_${O.name}`)}async function b(w){let O,D=!1;for(;!D;){let N=O||t().nextAvailableProjectName(Ei(w));if(O=window.prompt(`Please pick a project name to create in ${Ei(w)}`,N),O===null)return;if(O=O.trim(),O===""){window.alert("Project name cannot be blank; Please pick a name or cancel.");continue}try{let j=t().createEmptyProject(O,w);await ri(j),Ve(wt,{mode:"add-neighbourhood"}),D=!0}catch(j){window.alert(j)}}}var m=a2(),C=Z(m),B=c(C),T=h(C,2);T.__change=[t2,v,b,s];var $=c(T);$.value=$.__value="";var P=h($);qt(P,17,()=>r(i),Jt,(w,O)=>{var D=r2(),N=c(D),j={};Q(()=>{U(N,r(O)),j!==(j=r(O))&&(D.value=(D.__value=r(O))??"")}),_(w,D)});var y=h(T,2);st(y,{get data(){return r(l)},generateId:!0,children:(w,O)=>{var D=o2(),N=Z(D);{let z=u(()=>({"fill-color":Jr.mapFeature.hover.backgroundColor,"fill-outline-color":Jr.mapFeature.hover.backgroundColor,"fill-opacity":xt(0,.5)})),d=u(()=>r(s).t(156));ur(N,{get paint(){return r(z)},get beforeId(){return r(d)},manageHoverState:!0,hoverCursor:"pointer",onclick:f,children:(g,p)=>{Bt(g,{openOn:"hover",children:(x,A)=>{let F=()=>A?.().data;var S=n2(),I=c(S);{let E=u(()=>r(s).cx(157)),L=u(()=>[F().properties.name]);be(I,{get x(){return r(E)},get a(){return r(L)}})}_(x,S)},$$slots:{default:!0}})},$$slots:{default:!0}})}var j=h(N,2);{let z=u(()=>({"line-color":Jr.mapFeature.hover.backgroundColor,"line-width":2.5})),d=u(()=>r(s).t(156));gt(j,{get paint(){return r(z)},get beforeId(){return r(d)},manageHoverState:!1})}_(w,D)},$$slots:{default:!0}}),Q(w=>U(B,w),[()=>r(s).t(155)]),vn(T,()=>r(v),w=>Y(v,w)),_(n,m),Ne(),a()}er(["change"]);var i2=M('<label style="margin-top: 16px;"><strong> </strong> <input type="file"/></label>');function s2(n,e){Re(e,!0);const[t,o]=lt(),a=u(()=>ut(ct("main")));let s=Ae(void 0);async function l(m){let C=r(s).files[0].name,B=await r(s).files[0].text(),T=JSON.parse(B),$,P,y;T.app_focus&&(console.assert(T.app_focus=="global"||T.app_focus=="cnt"||T.app_focus=="england"),$=T.app_focus),T.study_area_name&&(P=T.study_area_name),T.project_name&&(y=T.project_name),(!T.app_focus||!T.project_name)&&(T.study_area_name&&T.study_area_name.startsWith(r(a).t(158))?($="cnt",y=gs(_s(C,`ltn_cnt_${T.study_area_name}_`),".geojson")):($="global",y=gs(_s(C,"ltn_"),".geojson"))),y=y,$=$;let w=mc.projectStorage($);y=w.nextAvailableProjectName(y),T.project_name=y,T.app_focus=$,T.study_area_name=P;let O=w.createProject(T);await ri(O),Ve(wt,{mode:"pick-neighbourhood"})}var i=i2(),v=c(i),f=c(v),b=h(v,2);b.__change=l,rn(b,m=>Y(s,m),()=>r(s)),Q(m=>U(f,m),[()=>r(a).t(159)]),_(n,i),Ne(),o()}er(["change"]);var l2=M('<nav aria-label="breadcrumb"><ul><li class="svelte-eliuer"> </li></ul></nav>'),u2=M("<h1> </h1>"),c2=M('<div style="display: flex; justify-content: space-between; align-items: center"><h1> </h1> <!></div>'),d2=(n,e)=>$l(e()),f2=(n,e,t,o)=>e(t(),o()),v2=(n,e,t,o)=>e(t(),o()),g2=(n,e,t,o)=>e(t(),o()),_2=M('<li class="actionable-cell svelte-eliuer"><h3 class="project-name svelte-eliuer"><!></h3> <span class="actions"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button> <button class="icon-btn destructive"><!></button></span></li>'),p2=M('<h3 class="study-area-name svelte-eliuer"> </h3> <ul class="navigable-list"></ul>',1),h2=M('<h2> </h2> <div class="project-list svelte-eliuer"></div>',1),m2=(n,e)=>Ve(wt,{mode:"new-project"}),b2=M("<button> </button>"),y2=M('<!> <a target="_blank"> </a> <!> <!> <h2> </h2> <!> <!>',1),A2=M("<p> </p>"),w2=M("<!> <!>",1);function x2(n,e){Re(e,!0);const t=()=>we(ps,"$firstTimeLoadProjectFromURL",f),o=()=>we(Zr,"$map",f),a=()=>we(Vr,"$appFocus",f),s=()=>we(ho,"$projectStorage",f),l=()=>we(wt,"$mode",f),i=()=>we(go,"$loadingMessage",f),v=()=>we(_o,"$loadingProgress",f),[f,b]=lt(),m=u(()=>ut(ct("main")));if(Ve(Rt,null),Ve(ei,null),Ve(_n,void 0),t()){let j=new URLSearchParams(window.location.search).get("project");j&&B(j),Ve(ps,!1)}else{let N=new URL(window.location.href);N.searchParams.delete("project"),window.history.replaceState(null,"",N.toString())}if(o()&&!t()){let N=[-180,-90,180,90];a()=="cnt"?N=[-8.943,54.631,-.901,59.489]:a()=="england"&&(N=[-5.96,49.89,2.31,55.94]),o().fitBounds(N,{duration:500})}let C=Ae(bt(s().studyAreaProjects()));function B(N){let j=N;try{y(j)}catch{console.error(`Error trying to fetch project from URL: ${j}`)}}function T(N,j){window.confirm(r(m).t(164,[j]))&&(s().removeProject(N),Y(C,s().studyAreaProjects(),!0))}function $(N,j){let z=window.prompt(r(m).t(165,[j]),j);if(z){try{s().renameProject(N,z)}catch(d){window.alert(`Couldn't rename project: ${d}`)}Y(C,s().studyAreaProjects(),!0)}}function P(N,j){let z=window.prompt(r(m).t(127,[j]),s().nextAvailableProjectName(j));if(z){try{s().copyProject(N,z)}catch(d){window.alert(`Couldn't copy project: ${d}`)}Y(C,s().studyAreaProjects(),!0)}}async function y(N){await ri(N),Ve(wt,{mode:"pick-neighbourhood"})}var w=w2(),O=Z(w);vo(O,{get loading(){return i()},get progress(){return v()}});var D=h(O,2);Lr(D,{top:z=>{var d=l2(),g=c(d),p=c(g),k=c(p);Q(x=>U(k,x),[()=>Ar(l().mode)]),_(z,d)},left:z=>{var d=$e(),g=Z(d);{var p=x=>{var A=y2(),F=Z(A);{var S=K=>{var V=u2(),te=c(V);Q(re=>U(te,re),[()=>r(m).t(44)]),_(K,V)},I=K=>{var V=c2(),te=c(V),re=c(te),ie=h(te,2);e2(ie,{}),Q(ne=>U(re,ne),[()=>r(m).t(166)]),_(K,V)};ve(F,K=>{a()=="cnt"?K(S):K(I,!1)})}var E=h(F,2),L=c(E),R=h(E,2);ml(R,{});var G=h(R,2);{var J=K=>{var V=h2(),te=Z(V),re=c(te),ie=h(te,2);qt(ie,21,()=>r(C),Jt,(ne,ae)=>{var _e=u(()=>Dr(r(ae),2));let se=()=>r(_e)[0],fe=()=>r(_e)[1];var oe=p2(),ye=Z(oe),he=c(ye),xe=h(ye,2);qt(xe,21,fe,Jt,(Se,De)=>{let ke=()=>r(De).projectID,Ee=()=>r(De).projectName;var pe=_2(),Ie=c(pe),Te=c(Ie);ca(Te,{onclick:()=>y(ke()),children:(Je,tt)=>{var yt=jt();Q(()=>U(yt,Ee())),_(Je,yt)}});var me=h(Ie,2),Me=c(me);Me.__click=[d2,ke];var Fe=c(Me);Tl(Fe,{color:"black"});var Le=h(Me,2);Le.__click=[f2,$,ke,Ee];var qe=c(Le);Ki(qe,{color:"black"});var Oe=h(Le,2);Oe.__click=[v2,P,ke,Ee];var Ze=c(Oe);Pl(Ze,{color:"black"});var Be=h(Oe,2);Be.__click=[g2,T,ke,Ee];var We=c(Be);Ya(We,{color:"white"}),Q((Je,tt,yt,dt)=>{Ue(Me,"title",Je),Ue(Le,"title",tt),Ue(Oe,"title",yt),Ue(Be,"title",dt)},[()=>r(m).t(129),()=>r(m).t(169),()=>r(m).t(132),()=>r(m).t(170)]),_(Se,pe)}),Q(Se=>U(he,Se),[()=>Ei(se())]),_(ne,oe)}),Q(ne=>U(re,ne),[()=>r(m).t(168)]),_(K,V)};ve(G,K=>{r(C).length>0&&K(J)})}var H=h(G,2),X=c(H),le=h(H,2);{var q=K=>{var V=b2();V.__click=[m2,l];var te=c(V);Q(re=>U(te,re),[()=>r(m).t(172)]),_(K,V)},ee=K=>{var V=$e(),te=Z(V);{var re=ne=>{ul(ne,{get boundariesUrl(){return qm}})},ie=ne=>{var ae=$e(),_e=Z(ae);{var se=fe=>{ul(fe,{get boundariesUrl(){return Jm}})};ve(_e,fe=>{a()=="england"&&fe(se)},!0)}_(ne,ae)};ve(te,ne=>{a()=="cnt"?ne(re):ne(ie,!1)},!0)}_(K,V)};ve(le,K=>{a()=="global"?K(q):K(ee,!1)})}var ue=h(le,2);s2(ue,{}),Q((K,V,te)=>{Ue(E,"href",K),U(L,V),U(X,te)},[()=>`user_guide.html?lang=${kl()}`,()=>r(m).t(167),()=>r(m).t(171)]),_(x,A)},k=x=>{var A=A2(),F=c(A);Q(S=>U(F,S),[()=>r(m).t(173)]),_(x,A)};ve(g,x=>{o()&&e.wasmReady?x(p):x(k,!1)})}_(z,d)},$$slots:{top:!0,left:!0}}),_(n,w),Ne(),b()}er(["click"]);var $2=M('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),k2=M("<p> </p>"),S2=(n,e)=>Y(e,{state:"neutral"},!0),E2=M("<b><!></b>"),L2=M("<p> </p> <button> </button> <!> <p><!></p>",1),C2=M("<!> <!>",1),M2=M("<p><!></p>"),P2=M("<p><!></p>"),T2=M("<!> <!> <!> <!>",1),I2=M("<!> <!> <!> <!>",1),R2=M("<!> <!> <!>",1);function N2(n,e){Re(e,!0);const t=()=>we(Rt,"$backend",a),o=()=>we(wt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=t().renderNeighbourhood(),v=Ae(bt({state:"neutral"}));function f(b,m){if(r(v).state!="neutral")return;let C=t().getShortcutsCrossingRoad(b.properties.id);if(C.features.length==0){window.alert(r(l).t(99));return}Y(v,{state:"chose-road",roadGj:b,gj:C,shortcutIndex:0},!0)}Lr(n,{top:B=>{var T=$2(),$=c(T),P=c($),y=c(P);Xe(y,{mode:{mode:"title"}});var w=h(P,2),O=c(w);Xe(O,{mode:{mode:"pick-neighbourhood"}});var D=h(w,2),N=c(D);Xe(N,{mode:{mode:"neighbourhood"}});var j=h(D,2),z=c(j);Q(d=>U(z,d),[()=>Ar(o().mode)]),_(B,T)},left:B=>{var T=C2(),$=Z(T);on($,{mode:{mode:"neighbourhood"}});var P=h($,2);{var y=O=>{var D=k2(),N=c(D);Q(j=>U(N,j),[()=>r(l).t(100)]),_(O,D)},w=O=>{var D=$e(),N=Z(D);{var j=z=>{var d=L2(),g=Z(d),p=c(g),k=h(g,2);k.__click=[S2,v];var x=c(k),A=h(k,2);Ka(A,{get list(){return r(v).gj.features},get idx(){return r(v).shortcutIndex},set idx(I){r(v).shortcutIndex=I}});var F=h(A,2);{const I=(E,L=Pe)=>{var R=E2(),G=c(R);{let J=u(()=>[r(v).gj.features[r(v).shortcutIndex].properties.directness.toFixed(1)]);be(G,{get x(){return L()},n:!0,get a(){return r(J)}})}_(E,R)};var S=c(F);{let E=u(()=>[I]),L=u(()=>r(l).cx(103));be(S,{get t(){return r(E)},get x(){return r(L)}})}}Q((I,E)=>{U(p,I),U(x,E)},[()=>r(l).t(101),()=>r(l).t(102)]),_(z,d)};ve(N,z=>{r(v).state=="chose-road"&&z(j)},!0)}_(O,D)};ve(P,O=>{r(v).state=="neutral"?O(y):O(w,!1)})}_(B,T)},main:B=>{var T=R2(),$=Z(T);st($,{get data(){return i},generateId:!0,children:(O,D)=>{var N=T2(),j=Z(N);ti(j,{});var z=h(j,2);ga(z,{});var d=h(z,2);pa(d,{});var g=h(d,2);{const p=x=>{var A=$e(),F=Z(A);{var S=I=>{Bt(I,{openOn:"hover",children:(L,R)=>{let G=()=>R?.().data;const J=u(()=>G().properties);var H=$e(),X=Z(H);{var le=ee=>{var ue=M2(),K=c(ue);{let V=u(()=>r(l).cx(104)),te=u(()=>[r(J).shortcuts,r(J).name??"unnamed road"]);be(K,{get x(){return r(V)},get a(){return r(te)}})}_(ee,ue)},q=ee=>{var ue=$e(),K=Z(ue);{var V=te=>{var re=P2(),ie=c(re);{let ne=u(()=>r(l).cx(105)),ae=u(()=>[r(J).name??"unnamed road"]);be(ie,{get x(){return r(ne)},get a(){return r(ae)}})}_(te,re)};ve(K,te=>{r(J).kind=="main_road"&&te(V)},!0)}_(ee,ue)};ve(X,ee=>{r(J).kind=="interior_road"?ee(le):ee(q,!1)})}_(L,H)},$$slots:{default:!0}})};ve(F,I=>{r(v).state=="neutral"&&I(S)})}_(x,A)};let k=u(()=>r(v).state=="neutral");_a(g,{onClickLine:f,get interactive(){return r(k)},get maxShortcuts(){return i.maxShortcuts},linePopup:p,$$slots:{linePopup:!0}})}_(O,N)},$$slots:{default:!0}});var P=h($,2);{var y=O=>{var D=I2(),N=Z(D);st(N,{get data(){return r(v).gj.features[r(v).shortcutIndex]},children:(g,p)=>{{let k=u(()=>He("shortcuts"));gt(g,Ce(()=>r(k),{paint:{"line-width":10,"line-color":"cyan"}}))}},$$slots:{default:!0}});var j=h(N,2);st(j,{get data(){return r(v).roadGj},children:(g,p)=>{{let k=u(()=>He("shortcuts-focus"));gt(g,Ce(()=>r(k),{paint:{"line-width":5,"line-color":"blue"}}))}},$$slots:{default:!0}});var z=h(j,2);{let g=u(()=>zo(r(v).gj.features[r(v).shortcutIndex].geometry.coordinates[0]));Kn(z,{get lngLat(){return r(g)},children:(p,k)=>{var x=jt();Q(A=>U(x,A),[()=>r(l).t(71)]),_(p,x)},$$slots:{default:!0}})}var d=h(z,2);{let g=u(()=>zo(r(v).gj.features[r(v).shortcutIndex].geometry.coordinates[r(v).gj.features[r(v).shortcutIndex].geometry.coordinates.length-1]));Kn(d,{get lngLat(){return r(g)},children:(p,k)=>{var x=jt();Q(A=>U(x,A),[()=>r(l).t(72)]),_(p,x)},$$slots:{default:!0}})}_(O,D)};ve(P,O=>{r(v).state=="chose-road"&&O(y)})}var w=h(P,2);An(w,{interactive:!1}),_(B,T)},$$slots:{top:!0,left:!0,main:!0}}),Ne(),s()}er(["click"]);var B2=M('<link rel="icon" type="image/x-icon"/>'),F2=M("<h1> </h1>"),O2=M("<h1> </h1>"),j2=M('<article style="max-height: 80vh; max-width: 80vw; overflow: auto"><!> <!></article>'),z2=(n,e)=>Y(e,!0),D2=()=>window.open(`user_guide.html?lang=${kl()}`,"_blank"),U2=M('<div class="pico" style="display: flex; align-items: center; gap: 8px;"><button class="outline"><img style="height: 32px;"/></button> <div style="width: 100%"></div> <button class="icon-btn"><!></button></div>'),G2=M('<div class="pico"><div></div></div>'),W2=M('<div class="ltn-map-btn zoom-to-fit-btn"><!></div>'),H2=M("<!> <!>",1),q2=M("<!> <!>",1),J2=M("<!> <!> <!> <!> <!> <div></div> <!> <!> <!> <!>",1),Q2=M('<div style="position: relative; width: 100%; height: 100%;"><!></div>'),Z2=M('<div class="pico"><!></div> <div><!></div>',1);function K2(n,e){Re(e,!0);const t=()=>we(Zr,"$mapStore",v),o=()=>we(Rt,"$backend",v),a=()=>we(yi,"$maptilerBasemap",v),s=()=>we(Sc,"$locale",v),l=()=>we(Vr,"$appFocusStore",v),i=()=>we(wt,"$mode",v),[v,f]=lt(),b=u(()=>ut(ct("main")));Vr.set(e.appFocus);let m=Ae(!1);nn(async()=>{await lu(),await jl(),Y(m,!0);try{(await fetch("/severance_pbfs/areas.json")).ok&&(Ve(yc,!0),console.log("Using local asset files"))}catch{}});let C=Ae(void 0),B=Ae(!1);function T(j){t().fitBounds(o().getBounds(),{animate:j})}let $=Ae(bt(Date.now()));function P(){r(C)&&Date.now()-r($)>500&&(Bd(),Y($,Date.now(),!0))}let y=Ae(void 0);e.appFocus=="cnt"&&Y(y,[-8.943,54.631,-.901,59.489],!0);let w=u(()=>a()=="streets-v2"?f_:`https://api.maptiler.com/maps/${a()}/style.json?key=${Ec}`),O=Ae(!1);Qe(()=>{r(C)&&(r(C).keyboard.disableRotation(),r(C).dragRotate.disable(),r(C).touchZoomRotate.disableRotation(),Zr.set(r(C)))});var D=$e();Lc(j=>{var z=B2();Q(()=>Ue(z,"href",Tc)),_(j,z)});var N=Z(D);bc(N,()=>xc(s()),null,j=>{var z=Z2(),d=Z(z),g=c(d);wl(g,{get show(){return r(O)},set show(x){Y(O,x,!0)},children:(x,A)=>{var F=j2(),S=c(F);{var I=R=>{var G=F2(),J=c(G);Q(H=>U(J,H),[()=>r(b).t(44)]),_(R,G)},E=R=>{var G=O2(),J=c(G);Q(H=>U(J,H),[()=>r(b).t(45)]),_(R,G)};ve(S,R=>{e.appFocus=="cnt"?R(I):R(E,!1)})}var L=h(S,2);Ac(L,{}),_(x,F)},$$slots:{default:!0}});var p=h(d,2),k=c(p);Yg(k,{top:S=>{var I=U2(),E=c(I);E.__click=[z2,O];var L=c(E),R=h(E,2);rn(R,H=>Ho.value=H,()=>Ho?.value);var G=h(R,2);G.__click=[D2];var J=c(G);wc(J,{color:"black"}),Q((H,X)=>{Ue(L,"src",Rc),Ue(L,"alt",H),Ue(G,"title",X)},[()=>r(b).t(46),()=>r(b).t(47)]),_(S,I)},left:S=>{var I=G2(),E=c(I);rn(E,L=>qo.value=L,()=>qo?.value),_(S,I)},main:S=>{var I=Q2(),E=c(I);{let L=u(()=>[{id:Ot.walkCycleOnly.filterType,url:Ot.walkCycleOnly.iconURL},{id:Ot.noEntry.filterType,url:Ot.noEntry.iconURL},{id:Ot.busGate.filterType,url:Ot.busGate.iconURL},{id:Ot.schoolStreet.filterType,url:Ot.schoolStreet.iconURL},{id:"diagonal_filter",url:Ic},{id:"no_straight_turn",url:El},{id:"no_left_turn",url:Sl},{id:"no_right_turn",url:Li},{id:"no_u_left_to_right_turn",url:Cl},{id:"no_u_right_to_left_turn",url:Ll},{id:"oneway_arrow",url:Pc},{id:"border_entry_arrow",url:Mc,options:{sdf:!0}},{id:"national_rail",url:Ml}]);ld(E,{get style(){return r(w)},hash:!0,get bounds(){return r(y)},maxZoom:19,onerror:R=>{console.log(R.error)},get images(){return r(L)},get map(){return r(C)},set map(R){Y(C,R,!0)},get loaded(){return r(B)},set loaded(R){Y(B,R,!0)},children:(R,G)=>{var J=J2(),H=Z(J);Bl(H,{showCompass:!1});var X=h(H,2);fa(X,{onstyledata:P});var le=h(X,2);{var q=se=>{var fe=H2(),oe=Z(fe);Ci(oe,{position:"top-left",children:(he,xe)=>{ms(he,{children:(Se,De)=>{{let ke=u(()=>r(b).t(48));$c(Se,{get title(){return r(ke)},onclick:()=>T(!0),children:(Ee,pe)=>{var Ie=W2(),Te=c(Ie);zc(Te,{}),_(Ee,Ie)},$$slots:{default:!0}})}},$$slots:{default:!0}})},$$slots:{default:!0}});var ye=h(oe,2);Ci(ye,{position:"top-left",children:(he,xe)=>{ms(he,{children:(Se,De)=>{kc(Se,{get map(){return t()},get maptilerBasemap(){return a()}})},$$slots:{default:!0}})},$$slots:{default:!0}}),_(se,fe)};ve(le,se=>{o()&&se(q)})}var ee=h(le,2);Pv(ee,{get map(){return r(C)},get loaded(){return r(B)}});var ue=h(ee,2);Fl(ue,{});var K=h(ue,2);rn(K,se=>Jo.value=se,()=>Jo?.value);var V=h(K,2);{var te=se=>{x2(se,{get wasmReady(){return r(m)}})},re=se=>{var fe=$e(),oe=Z(fe);{var ye=he=>{Hm(he,{})};ve(oe,he=>{i().mode=="new-project"&&he(ye)},!0)}_(se,fe)};ve(V,se=>{i().mode=="title"?se(te):se(re,!1)})}var ie=h(V,2);Kg(ie,{});var ne=h(ie,2);{var ae=se=>{var fe=q2(),oe=Z(fe);{let Se=u(()=>o().getInvertedBoundary());st(oe,{get data(){return r(Se)},children:(De,ke)=>{{let Ee=u(()=>He("boundary"));ur(De,Ce(()=>r(Ee),{paint:{"fill-color":"black","fill-opacity":.3}}))}},$$slots:{default:!0}})}var ye=h(oe,2);{var he=Se=>{y1(Se,{})},xe=Se=>{var De=$e(),ke=Z(De);{var Ee=Ie=>{am(Ie,{get name(){return i().name},get existing(){return i().existing}})},pe=Ie=>{var Te=$e(),me=Z(Te);{var Me=Le=>{up(Le,{})},Fe=Le=>{var qe=$e(),Oe=Z(qe);{var Ze=We=>{y0(We,{})},Be=We=>{var Je=$e(),tt=Z(Je);{var yt=kt=>{N2(kt,{})},dt=kt=>{var $t=$e(),_t=Z($t);{var at=pt=>{Z0(pt,{})},et=pt=>{var Mt=$e(),Ct=Z(Mt);{var ht=Dt=>{tm(Dt,{get prevMode(){return i().prevMode}})},Gt=Dt=>{var sr=$e(),an=Z(sr);{var pr=xr=>{U1(xr,{get prevMode(){return i().prevMode}})},wr=xr=>{var Cr=$e(),sn=Z(Cr);{var Gr=$r=>{N0($r,{get road(){return i().road},get prevPrevMode(){return i().prevPrevMode}})},Nn=$r=>{var Xn=$e(),ce=Z(Xn);{var At=Wt=>{Qp(Wt,{})},Qt=Wt=>{var ar=$e(),it=Z(ar);{var vt=Ke=>{Tp(Ke,{})},Ge=Ke=>{var nt=$e(),Zt=Z(nt);{var Pt=hr=>{$p(hr,{})};ve(Zt,hr=>{i().mode=="debug-demand"&&hr(Pt)},!0)}_(Ke,nt)};ve(it,Ke=>{i().mode=="debug-intersections"?Ke(vt):Ke(Ge,!1)},!0)}_(Wt,ar)};ve(ce,Wt=>{i().mode=="debug-neighbourhood"?Wt(At):Wt(Qt,!1)},!0)}_($r,Xn)};ve(sn,$r=>{i().mode=="impact-detail"?$r(Gr):$r(Nn,!1)},!0)}_(xr,Cr)};ve(an,xr=>{i().mode=="predict-impact"?xr(pr):xr(wr,!1)},!0)}_(Dt,sr)};ve(Ct,Dt=>{i().mode=="route"?Dt(ht):Dt(Gt,!1)},!0)}_(pt,Mt)};ve(_t,pt=>{i().mode=="impact-one-destination"?pt(at):pt(et,!1)},!0)}_(kt,$t)};ve(tt,kt=>{i().mode=="view-shortcuts"?kt(yt):kt(dt,!1)},!0)}_(We,Je)};ve(Oe,We=>{i().mode=="neighbourhood"?We(Ze):We(Be,!1)},!0)}_(Le,qe)};ve(me,Le=>{i().mode=="add-neighbourhood"?Le(Me):Le(Fe,!1)},!0)}_(Ie,Te)};ve(ke,Ie=>{i().mode=="set-boundary"?Ie(Ee):Ie(pe,!1)},!0)}_(Se,De)};ve(ye,Se=>{i().mode=="pick-neighbourhood"?Se(he):Se(xe,!1)})}_(se,fe)};ve(ne,se=>{o()&&se(ae)})}var _e=h(ne,2);Ld(_e),_(R,J)},$$slots:{default:!0}})}_(S,I)},$$slots:{top:!0,left:!0,main:!0}}),Q(()=>Et(p,1,`app-focus-${l()??""}`)),_(j,z)}),_(n,D),Ne(),f()}er(["click"]);export{K2 as A};
