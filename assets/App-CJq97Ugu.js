import{c as $l,b as kl,H as Yu,i as ec,n as tc,s as rc,a as nc,d as oc,e as ac,U as ic,p as sc,r as lc,t as uc,l as pr,I as hr,f as Ie,g as $e,h as V,j as mr,k as _,o as we,u as As,q as cc,v as r,w as K,x as Lo,y as Ne,z as W,A as Sl,B as dc,C as dr,D as Je,E as u,F as ve,G as Be,J as On,K as Qr,L as Tt,M as Pe,N as P,O as vn,P as Z,Q as c,R as St,S as El,T as Cr,V as fc,W as Ll,X as vc,Y as gc,Z as _c,_ as ht,$ as pc,a0 as ro,a1 as hc,a2 as mc,a3 as _a,a4 as h,a5 as bc,a6 as yc,a7 as Ac,a8 as wc,a9 as xc,aa as gn,ab as $c,ac as kc,ad as un,ae as Zt,af as U,ag as Vt,ah as qr,ai as gr,aj as Cl,ak as lt,al as ye,am as Sc,an as _o,ao as Ec,ap as Yr,aq as co,ar as Ml,as as pa,at as Qe,au as yt,av as rn,aw as Br,ax as fo,ay as pe,az as en,aA as ut,aB as ct,aC as Lc,aD as Li,aE as rr,aF as An,aG as Rt,aH as Ut,aI as Xi,aJ as yo,aK as ea,aL as ta,aM as Pl,aN as ra,aO as na,aP as oa,aQ as ze,aR as aa,aS as Il,aT as ia,aU as ja,aV as Ci,aW as nn,aX as sa,aY as za,aZ as Rn,a_ as Mi,a$ as Yi,b0 as es,b1 as ts,b2 as rs,b3 as ns,b4 as os,b5 as ni,b6 as la,b7 as as,b8 as Ao,b9 as xn,ba as xa,bb as oi,bc as Da,bd as Pi,be as Cc,bf as Ii,bg as Jr,bh as ws,bi as Ti,bj as Tl,bk as Rl,bl as Qt,bm as Nl,bn as Bl,bo as is,bp as Ri,bq as Ua,br as Fl,bs as xs,bt as sr,bu as $s,bv as ss,bw as Ho,bx as Ni,by as $a,bz as Ga,bA as Wa,bB as Ia,bC as Ta,bD as Ol,bE as qo,bF as ks,bG as Ss,bH as Es,bI as Bi,bJ as Mc,bK as Fi,bL as Ls,bM as Cs,bN as Pc,bO as Ic,bP as Ms,bQ as jl,bR as Tc,bS as Rc,bT as Nc,bU as Bc,bV as Fc,bW as Oc,bX as jc,bY as zc,bZ as Dc}from"./pico.conditional.jade.min-BbNMhajb.js";function Uc(n){var e;e=document.head.appendChild($l());try{kl(()=>n(e),Yu)}finally{}}function ai(n,e,t){var o=n,a=ic,s,l,i=null,f=ec()?tc:rc;function v(){s&&sc(s),i!==null&&(i.lastChild.remove(),o.before(i),i=null),s=l}kl(()=>{if(f(a,a=e())){var b=o,m=ac();m&&(i=document.createDocumentFragment(),i.append(b=$l())),l=nc(()=>t(b)),m?oc.add_callback(v):v()}})}function Gc(n,e,t,o,a){var s=()=>{o(t[n])};t.addEventListener(e,s),a?lc(()=>{t[n]=a()}):s(),(t===document.body||t===window||t===document)&&uc(()=>{t.removeEventListener(e,s)})}const Wc="/ltn/assets/arrow-big-up-DKeSc1KD.png",Hc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAk0lEQVRIS+3U0Q2AIAwEUNjMUXQydRJH0zZB0wjGuwJfSsKfuWfO1hg6n9g5P3wPWKTSXe6EVstUNEjoloIVghAG0OxR7swgLEAjHoBCvACM1AAQUgJ0DL0nm67WwJom7XrBlhVl4arUAHYniuE1ABTuBeBwD0CFs4D92T12fp9v9iPrnJ8LBu0KC0Ch9qEfeK3sAPceHxk8hJ17AAAAAElFTkSuQmCC",qc="/ltn/assets/favicon-DMAVMD4u.ico",Jc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAALRQTFRFR3BMemc7uV08rWA9gmc9wlw9+1M8/1c6XGw7rWA8yFs9Tm47d2g8RXA7lmM8N3I6bGo7g2Y8u108wl097lY9vV08pmE9pGE8IHY7/3YajWU8hWc811o+nmI87VU7L3M73Fo+K3Q62Fs+s189kWQ8gGc7iGU8e2g7x1pAC3k6////X6d+H4RKTJ1vjcCjEHg6F3c6HnY6+Pv6NJBbWaR5FX5C4vDoHINIQZZlfbiWmMaszuTYcGgFiwAAACl0Uk5TAMN7grBaDAXjiU7r0O+f9dvJdmUgbZSi/AKouC+zGPg3+yV8wbuzwESr5F6DAAAFwklEQVR42u3ax1rbQACF0STGvRsXMJieMqTICqS//3tlkS8LgpNgSZsZnf8R7hysgp49kyRJkiRJkqQ0mzdn141HvVhctGyTese95clkmIddZZedwXp2ZqR0u1oOLsO/y/qvFm1LJdnpqh+e0nZwjUB6tZZPO/5fBJoGS6zeIAt7NF65IUyq7jDsVza9sFoytVdHYe86PcOlcv6bbShQ341AIq0KnX8IQ78BSbTMQ8E6p9aLv+Y4FG7qWSD6rjrFzz9kKwPG3iaUaew2IPYLwHkpAGHqrXDcTcudf8gXNoz6B+CyJIAwPbZixJ2UPf9w5HVQxM37pQGEtRnjrVv+/EPHu4B4e1kBgO2hHWOt1akAQBgZMtZ6eRUAnhsy1hpVnH+YeBCMtVElAMZzS0baQRXnn+X+H1Df10AeA6LudSUAwsySkfa8GgAvLAmAABAAAkAACADFDuDL+4d9/QRAnQC8/Xj7R5/vAKgPgHePzv/29gcA9QFwf7ujTwDUBsDbXQDeAQAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAAAAAAAAAAAAAAAAAAAAAfne/C8AXAGoD4G7H+X8OANQGQPj+6Pw/3gNQIwDh/YeHfbsLANQJwD4BAICi7HU1AGaWjLSXlZx/dmjJSDuoBEDes2SkjSoBMD61ZKR1KwHQaVsy0g63VQAYGDLWzvpVAFgbstYvAjJPgfG2rABAf27HaLsYlwdwYsZ4Oy5/Ddi6AsTcrPRzwKRlxYhrD8reAnaNGHXXuR8AdwHFO1qYMPLeDMsAuDFg9HWPSlwAruwX/0VgkxU9/2HTfAnUuil4/ufXxkuis2mx8/cEmIyAmwJXgXHDcOlcBTZ73wl2fAmYVI39Pg3YTn0Hllinm8s9/vy7PgNLr8X0ideB/trjf5pvBA5P/n8hyCcjx59u8+6ryflfHwny4WDU9OOfeO2LRXe0Xh/80Xq0bDTPzCNJkiRJkqQk+wnTOFu90krtLAAAAABJRU5ErkJggg==",zl="/ltn/assets/no_left_turn-Xpmw1_3C.png",Oi="/ltn/assets/no_right_turn-CZwHVCpW.png",Dl="/ltn/assets/no_straight_turn-BWpcWQch.png",Ul="/ltn/assets/no_u_left_to_right_turn-C4sWYlhS.png",Gl="/ltn/assets/no_u_right_to_left_turn-ClrJyulH.png",Qc="/ltn/assets/logo-3MjkCCFo.svg",Wl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC";function Zc(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m5 12 7-7 7 7"}],["path",{d:"M12 19V5"}]];hr(n,Ie({name:"arrow-up"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Vc(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M8 12h8"}],["path",{d:"M12 8v8"}]];hr(n,Ie({name:"circle-plus"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Hl(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];hr(n,Ie({name:"copy"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Kc(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21"}],["path",{d:"m5.082 11.09 8.828 8.828"}]];hr(n,Ie({name:"eraser"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function ql(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M12 18v-6"}],["path",{d:"m9 15 3 3 3-3"}]];hr(n,Ie({name:"file-down"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Xc(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"}]];hr(n,Ie({name:"folder-open"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Yc(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}],["path",{d:"M2 12h20"}]];hr(n,Ie({name:"globe"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function ed(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];hr(n,Ie({name:"house"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function td(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];hr(n,Ie({name:"layers"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function rd(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m14.622 17.897-10.68-2.913"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15"}]];hr(n,Ie({name:"paintbrush"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function ls(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]];hr(n,Ie({name:"pencil"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function Jl(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M22 14a8 8 0 0 1-8 8"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"}]];hr(n,Ie({name:"pointer"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function nd(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21 7v6h-6"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"}]];hr(n,Ie({name:"redo"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function od(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"6",cy:"19",r:"3"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}],["circle",{cx:"18",cy:"5",r:"3"}]];hr(n,Ie({name:"route"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function ii(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];hr(n,Ie({name:"trash-2"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}function ad(n,e){const t=pr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M3 7v6h6"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"}]];hr(n,Ie({name:"undo"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=V(l);mr(i,e,"default",{}),_(a,l)},$$slots:{default:!0}}))}class id extends Map{#e=new Map;#t=we(0);#r=we(0);#a=As||-1;constructor(e){if(super(),e){for(var[t,o]of e)super.set(t,o);this.#r.v=super.size}}#n(e){return As===this.#a?we(e):cc(e)}has(e){var t=this.#e,o=t.get(e);if(o===void 0){var a=super.get(e);if(a!==void 0)o=this.#n(0),t.set(e,o);else return r(this.#t),!1}return r(o),!0}forEach(e,t){this.#o(),super.forEach(e,t)}get(e){var t=this.#e,o=t.get(e);if(o===void 0){var a=super.get(e);if(a!==void 0)o=this.#n(0),t.set(e,o);else{r(this.#t);return}}return r(o),super.get(e)}set(e,t){var o=this.#e,a=o.get(e),s=super.get(e),l=super.set(e,t),i=this.#t;if(a===void 0)a=this.#n(0),o.set(e,a),K(this.#r,super.size),Lo(i);else if(s!==t){Lo(a);var f=i.reactions===null?null:new Set(i.reactions),v=f===null||!a.reactions?.every(b=>f.has(b));v&&Lo(i)}return l}delete(e){var t=this.#e,o=t.get(e),a=super.delete(e);return o!==void 0&&(t.delete(e),K(this.#r,super.size),K(o,-1),Lo(this.#t)),a}clear(){if(super.size!==0){super.clear();var e=this.#e;K(this.#r,0);for(var t of e.values())K(t,-1);Lo(this.#t),e.clear()}}#o(){r(this.#t);var e=this.#e;if(this.#r.v!==e.size){for(var t of super.keys())if(!e.has(t)){var o=this.#n(0);e.set(t,o)}}for([,o]of this.#e)r(o)}keys(){return r(this.#t),super.keys()}values(){return this.#o(),super.values()}entries(){return this.#o(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return r(this.#r),super.size}}function ua(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>t!=null))}function Ps(n){let e;return t=>{if(t)for(let o in t){let a=e?.[o],s=t[o];a!==s&&n(o,s,a)}else if(e)for(let o in e)n(o,void 0,e[o]);e=t}}function sd(n,...e){let t=[n];for(let o of e)if(o)Array.isArray(o)&&o[0]===n?t.push(...o.slice(1)):t.push(o);else continue;if(t.length!==1)return t.length===2?t[1]:t}function ld(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function bt(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}function ha(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("layer")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"paint",3,void 0),f=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),b=W(e,"applyToClusters",3,void 0),m=W(e,"requireSource",3,!0),C=W(e,"minzoom",3,void 0),j=W(e,"maxzoom",3,void 0),T=W(e,"manageHoverState",3,!1),M=W(e,"hovered",15),I=W(e,"interactive",3,!0),A=W(e,"hoverCursor",3,void 0),x=W(e,"eventsIfTopMost",3,!1),L=W(e,"children",3,void 0),D=W(e,"onclick",3,void 0),R=W(e,"ondblclick",3,void 0),O=W(e,"oncontextmenu",3,void 0),z=W(e,"onmouseenter",3,void 0),d=W(e,"onmousemove",3,void 0),g=W(e,"onmouseleave",3,void 0);const p=Sl(),$=u(Qr),w=u(()=>r($).loaded),{layer:y}=dc(),F=u(Qr),k=u(()=>r(F).map),N=u(()=>r(F).eventTopMost),S=u(()=>r(F).layerInfo),E=u(()=>r(F).minzoom),B=u(()=>r(F).maxzoom);dr(()=>{y.value&&(r(S).delete(y.value),r(k).removeLayer(y.value))});let G;function Q(fe){if(!I()||!y.value||!r(k)||x()&&r(N)(fe)!==y.value)return;let se=fe.features??[],Ae=se[0]?.properties?.cluster_id,me={event:fe,map:r(k),clusterId:Ae,layer:y.value,source:r(re),features:se};switch(fe.type){case"click":D()?.(me);break;case"dblclick":R()?.(me);break;case"contextmenu":O()?.(me);break}}function q(fe){if(!I()||!y.value||x()&&r(N)(fe)!==y.value)return;A()&&(r(k).getCanvas().style.cursor=A());let se=fe.features??[];M(se[0]??void 0);let Ae=se[0]?.properties?.cluster_id,me={event:fe,map:r(k),clusterId:Ae,layer:y.value,source:r(re),features:se};z()?.(me)}function X(fe){if(!I())return;if(x()&&r(N)(fe)!==y.value){M(void 0),T()&&G!==void 0&&(r(k).setFeatureState({source:r(re),sourceLayer:a(),id:G},{hover:!1}),G=void 0);return}A()&&(r(k).getCanvas().style.cursor=A());let se=fe.features??[],Ae=se[0]?.properties?.cluster_id,me=se[0]?.id;me!==G&&(T()&&(G!==void 0&&r(k).setFeatureState({source:r(re),id:G,sourceLayer:a()},{hover:!1}),r(k).setFeatureState({source:r(re),id:me,sourceLayer:a()},{hover:!0})),G=me,M(se[0]??void 0)),d()?.({event:fe,map:r(k),clusterId:Ae,layer:y.value,source:r(re),features:se})}function ue(fe){if(!(!I()||!y.value||!r(k))){if(A()&&(r(k).getCanvas().style.cursor=""),M(void 0),T()&&G!==void 0){const se={source:r(re),id:G,sourceLayer:a()};r(k).setFeatureState(se,{hover:!1}),G=void 0}g()?.({map:r(k),layer:y.value,source:r(re)})}}let te=we(!0);function ne(fe){r(k).off("click",fe,Q),r(k).off("dblclick",fe,Q),r(k).off("contextmenu",fe,Q),r(k).off("mouseenter",fe,q),r(k).off("mousemove",fe,X),r(k).off("mouseleave",fe,ue)}dr(()=>{y.value&&ne(y.value)});let oe=u(()=>ld(b())),H=u(()=>sd("all",r(oe),v())),J=u(()=>C()??r(E)),ee=u(()=>j()??r(B)),re=u(()=>o()||p?.value);Je(()=>{if(y.value!==t()&&r(w)&&(r(re)||!m())){y.value&&(ne(y.value),r(S).delete(y.value));let fe=s();if(!s()&&l()){let se=r(k).getStyle().layers,Ae=typeof l()=="function"?l():ke=>ke.type===l(),me=se?.find(Ae);me&&(fe=me.id)}y.value=t(),r(k).addLayer(ua({id:y.value,type:e.type,source:r(re),"source-layer":a(),filter:r(H),paint:i(),layout:f(),minzoom:r(J),maxzoom:r(ee)}),fe),K(te,!0),r(k).on("click",y.value,Q),r(k).on("dblclick",y.value,Q),r(k).on("contextmenu",y.value,Q),r(k).on("mouseenter",y.value,q),r(k).on("mousemove",y.value,X),r(k).on("mouseleave",y.value,ue)}}),Je(()=>{y.value&&r(S).set(y.value,{interactive:I()})});let ae=u(()=>y.value?Ps((fe,se)=>{r(k).style._loaded?r(k).setPaintProperty(y.value,fe,se):r(k).once("styledata",()=>r(k).setPaintProperty(y.value,fe,se))}):void 0),Y=u(()=>y.value?Ps((fe,se)=>{r(k).style._loaded?r(k).setLayoutProperty(y.value,fe,se):r(k).once("styledata",()=>r(k).setLayoutProperty(y.value,fe,se))}):void 0);Je(()=>{r(ae)?.(i())}),Je(()=>{r(Y)?.(f())}),Je(()=>{y.value&&r(k).setLayerZoomRange(y.value,r(J),r(ee))}),Je(()=>{y.value&&(r(te)?K(te,!1):r(k).setFilter(y.value,r(H)))});var ie=$e(),_e=V(ie);{var le=fe=>{var se=$e(),Ae=V(se);ai(Ae,()=>y.value,me=>{var ke=$e(),Se=V(ke);Tt(Se,()=>L()??Pe),_(me,ke)}),_(fe,se)};ve(_e,fe=>{y.value&&fe(le)})}_(n,ie),Be()}function Nn(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("circle")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"applyToClusters",3,void 0),b=W(e,"minzoom",3,void 0),m=W(e,"maxzoom",3,void 0),C=W(e,"hoverCursor",3,void 0),j=W(e,"manageHoverState",3,!1),T=W(e,"hovered",15),M=W(e,"eventsIfTopMost",3,!1),I=W(e,"interactive",3,!0),A=W(e,"children",3,void 0),x=W(e,"onclick",3,void 0),L=W(e,"ondblclick",3,void 0),D=W(e,"oncontextmenu",3,void 0),R=W(e,"onmouseenter",3,void 0),O=W(e,"onmousemove",3,void 0),z=W(e,"onmouseleave",3,void 0);ha(n,{get id(){return t()},type:"circle",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get applyToClusters(){return v()},get minzoom(){return b()},get maxzoom(){return m()},get hoverCursor(){return C()},get manageHoverState(){return j()},get eventsIfTopMost(){return M()},get interactive(){return I()},get onclick(){return x()},get ondblclick(){return L()},get oncontextmenu(){return D()},get onmouseenter(){return R()},get onmousemove(){return O()},get onmouseleave(){return z()},get hovered(){return T()},set hovered(d){T(d)},children:(d,g)=>{var p=$e(),$=V(p);Tt($,()=>A()??Pe),_(d,p)},$$slots:{default:!0}}),Be()}var ud=P("<div><!></div>");function ji(n,e){Ne(e,!0);let t=W(e,"defaultStyling",3,!0),o=W(e,"position",3,"top-right"),a=W(e,"class",3,void 0);const s=u(Qr),l=u(()=>r(s).map);let i=we(void 0),f={onAdd(){return r(i)},onRemove(){r(i)?.parentNode?.removeChild(r(i))}};Je(()=>{r(i)&&r(l).addControl(f,o())}),dr(()=>{r(l).removeControl(f)});var v=ud();let b;var m=c(v);Tt(m,()=>e.children??Pe),vn(v,C=>K(i,C),()=>r(i)),Z(C=>b=St(v,1,El(a()),null,b,C),[()=>({"maplibregl-ctrl":t()})]),_(n,v),Be()}var cd=P("<div><!></div>");function Is(n,e){let t=W(e,"class",3,"");var o=cd(),a=c(o);Tt(a,()=>e.children??Pe),Z(()=>St(o,1,`maplibregl-ctrl-group ${t()??""}`)),_(n,o)}function cr(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("fill")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"hoverCursor",3,void 0),C=W(e,"manageHoverState",3,!1),j=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),M=W(e,"interactive",3,!0),I=W(e,"onclick",3,void 0),A=W(e,"ondblclick",3,void 0),x=W(e,"oncontextmenu",3,void 0),L=W(e,"onmouseenter",3,void 0),D=W(e,"onmousemove",3,void 0),R=W(e,"onmouseleave",3,void 0);ha(n,{get id(){return t()},type:"fill",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get minzoom(){return v()},get maxzoom(){return b()},get hoverCursor(){return m()},get manageHoverState(){return C()},get eventsIfTopMost(){return T()},get interactive(){return M()},get onclick(){return I()},get ondblclick(){return A()},get oncontextmenu(){return x()},get onmouseenter(){return L()},get onmousemove(){return D()},get onmouseleave(){return R()},get hovered(){return j()},set hovered(O){j(O)},children:(O,z)=>{var d=$e(),g=V(d);Tt(g,()=>e.children??Pe),_(O,d)},$$slots:{default:!0}}),Be()}function dd(n,e){Ne(e,!0);const t=u(Qr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"container",3,void 0),i=we(void 0),f=u(()=>typeof l()=="string"?document.querySelector(l())??void 0:l());Je(()=>{r(i)||(r(f)?K(i,new Cr.FullscreenControl({container:r(f)}),!0):K(i,new Cr.FullscreenControl,!0),r(o).addControl(r(i),s()))}),dr(()=>{r(a)&&r(i)&&r(o).removeControl(r(i))}),Be()}function Ql(n,e,t,o,a){let s=!1;n.getSource(e)&&(s=!0,n.removeSource(e));const l=()=>{o(e)&&(n.addSource(e,t),a())};if(s){const i=()=>{e&&(n.getSource(e)?setTimeout(i,1):l())};i()}else l()}function Zl(n,e,t){fc().then(()=>{if(!n.loaded())return;n.getSource(e)===t&&n.removeSource(e)})}function it(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("geojson")),o=W(e,"generateId",3,!1),a=W(e,"promoteId",3,void 0),s=W(e,"filter",3,void 0),l=W(e,"lineMetrics",3,void 0),i=W(e,"cluster",3,void 0),f=W(e,"maxzoom",3,void 0),v=W(e,"attribution",3,void 0),b=W(e,"buffer",3,void 0),m=W(e,"tolerance",3,void 0);const C=u(Qr),j=u(()=>r(C).map),T=u(()=>r(C).loaded),{source:M}=Ll();let I=we(void 0),A=we(!0);Je(()=>{r(j)&&r(T)&&M.value!==t()&&(M.value=t(),Ql(r(j),M.value,ua({type:"geojson",data:e.data,filter:s(),lineMetrics:l(),generateId:o(),promoteId:a(),cluster:!!i(),clusterMinPoints:i()?.minPoints,clusterMaxZoom:i()?.maxZoom,clusterRadius:i()?.radius,clusterProperties:i()?.properties,maxzoom:f(),attribution:v(),buffer:b(),tolerance:m()}),R=>r(j)&&R===M.value,()=>{M.value&&(K(I,r(j).getSource(M.value),!0),K(A,!0))}),r(I))}),Je(()=>{r(I)&&(r(A)?K(A,!1):r(I).setData(e.data))}),Je(()=>{r(j).on("style.load",()=>{K(I,r(j).getSource(t()),!0)})}),Je(()=>{r(I)?.setClusterOptions(ua({cluster:!!i(),clusterMaxZoom:i()?.maxZoom,clusterRadius:i()?.radius}))}),dr(()=>{M.value&&r(I)&&r(j)&&(Zl(r(j),M.value,r(I)),M.value=void 0,K(I,void 0))});var x=$e(),L=V(x);{var D=R=>{var O=$e(),z=V(O);ai(z,()=>M.value,d=>{var g=$e(),p=V(g);Tt(p,()=>e.children??Pe),_(d,g)}),_(R,O)};ve(L,R=>{M.value&&R(D)})}_(n,x),Be()}function fd(n,e){Ne(e,!0);const t=u(Qr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"positionOptions",3,void 0),i=W(e,"fitBoundsOptions",3,void 0),f=W(e,"trackUserLocation",3,!1),v=W(e,"showAccuracyCircle",3,!0),b=W(e,"showUserLocation",3,!0),m=W(e,"control",15);Je(()=>{r(o)&&!m()&&(m(new Cr.GeolocateControl({positionOptions:l(),fitBoundsOptions:i(),trackUserLocation:f(),showAccuracyCircle:v(),showUserLocation:b()})),r(o).addControl(m(),s()))}),dr(()=>{r(a)&&m()&&r(o).removeControl(m())}),Be()}function vd(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("heatmap")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"hoverCursor",3,void 0),C=W(e,"manageHoverState",3,!1),j=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),M=W(e,"interactive",3,!0),I=W(e,"onclick",3,void 0),A=W(e,"ondblclick",3,void 0),x=W(e,"oncontextmenu",3,void 0),L=W(e,"onmouseenter",3,void 0),D=W(e,"onmousemove",3,void 0),R=W(e,"onmouseleave",3,void 0);ha(n,{get id(){return t()},type:"heatmap",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get minzoom(){return v()},get maxzoom(){return b()},get hoverCursor(){return m()},get manageHoverState(){return C()},get eventsIfTopMost(){return T()},get interactive(){return M()},get onclick(){return I()},get ondblclick(){return A()},get oncontextmenu(){return x()},get onmouseenter(){return L()},get onmousemove(){return D()},get onmouseleave(){return R()},get hovered(){return j()},set hovered(O){j(O)},children:(O,z)=>{var d=$e(),g=V(d);Tt(g,()=>e.children??Pe),_(O,d)},$$slots:{default:!0}}),Be()}function gd(n,e){Ne(e,!0);let t=W(e,"sourceLayer",3,void 0),o=new Set;const a=u(Qr),s=u(()=>r(a).map),l=Sl();Je(()=>{if(e.data&&r(s)&&l?.value){let i=new Set;for(const f of e.data){const v=f[e.idCol];if(!v)continue;o.delete(v),i.add(v);const b={id:v,source:l.value,sourceLayer:t()},m=r(s).getFeatureState(b);let C=!1;for(const j of Object.keys(f))if(m[j]!==f[j]){C=!0;break}C&&r(s).setFeatureState(b,f)}for(const f of o){const v={id:f,source:l.value,sourceLayer:t()},b=r(s).getFeatureState(v);for(const m of Object.keys(b))r(s).removeFeatureState(v,m)}o=i}}),Be()}function gt(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("line")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"hoverCursor",3,void 0),C=W(e,"manageHoverState",3,!1),j=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),M=W(e,"interactive",3,!0),I=W(e,"children",3,void 0),A=W(e,"onclick",3,void 0),x=W(e,"ondblclick",3,void 0),L=W(e,"oncontextmenu",3,void 0),D=W(e,"onmouseenter",3,void 0),R=W(e,"onmousemove",3,void 0),O=W(e,"onmouseleave",3,void 0);ha(n,{get id(){return t()},type:"line",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get minzoom(){return v()},get maxzoom(){return b()},get hoverCursor(){return m()},get manageHoverState(){return C()},get eventsIfTopMost(){return T()},get interactive(){return M()},get onclick(){return A()},get ondblclick(){return x()},get oncontextmenu(){return L()},get onmouseenter(){return D()},get onmousemove(){return R()},get onmouseleave(){return O()},get hovered(){return j()},set hovered(z){j(z)},children:(z,d)=>{var g=$e(),p=V(g);Tt(p,()=>I()??Pe),_(z,g)},$$slots:{default:!0}}),Be()}function ma(n,e){Ne(e,!0);let t=W(e,"layer",3,void 0),o=vc(e,["$$slots","$$events","$$legacy","layer"]);const a=u(Qr),s=u(()=>r(a).map);function l(b){return o["on"+b]}function i(b){l(b.type)?.(b)}const f=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],v=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend","pitch","rotate","wheel","data","styledata","idle"];Je(()=>{if(r(s))if(t())for(const b of f)l(b)&&r(s).on(b,t(),i);else for(const b of v)l(b)&&r(s).on(b,i)}),dr(()=>{if(r(s))if(t())for(const b of f)l(b)&&r(s).off(b,t(),i);else for(const b of v)l(b)&&r(s).off(b,i)}),Be()}function _d(n){let e=n.getCenter(),t=Math.round(n.getZoom()*100)/100,o=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,o),s=Math.round(e.lat*a)/a,l=Math.round(e.lng*a)/a,i=`${t}/${s}/${l}`,f=n.getBearing(),v=n.getPitch();return(f||v)&&(i+=`/${Math.round(f*10)/10}`),v&&(i+=`/${Math.round(v)}`),`#${i}`}function pd(n){const e=n.replace("#","").split("/").map(parseFloat);return e.some(isNaN)?[]:e}var Co=us;function us(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?Ts(n,e):{}.toString.call(n)=="[object Set]"?Ts(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?md(n,e):hd(n,e)}function hd(n,e){return n.toString()===e.toString()}function Ts(n,e){var t=n.length;if(t!=e.length)return!1;for(var o=0;o<t;o++)if(!us(n[o],e[o]))return!1;return!0}function md(n,e){var t=Object.keys(n),o=t.length;if(o!=Object.keys(e).length)return!1;for(var a=0;a<o;a++){var s=t[a];if(!(e.hasOwnProperty(s)&&us(n[s],e[s])))return!1}return!0}function Vl(n,e){Ne(e,!0);const t=u(Qr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"showCompass",3,!0),i=W(e,"showZoom",3,!0),f=W(e,"visualizePitch",3,!1),v=we(void 0);Je(()=>{r(o)&&!r(v)&&(K(v,new Cr.NavigationControl({showCompass:l(),showZoom:i(),visualizePitch:f()}),!0),r(o).addControl(r(v),s()))}),dr(()=>{r(a)&&r(v)&&r(o).removeControl(r(v))}),Be()}function Kl(n,e){Ne(e,!0);const t=u(Qr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"bottom-left"),l=W(e,"maxWidth",3,void 0),i=W(e,"unit",3,"metric"),f=we(void 0);Je(()=>{r(o)&&!r(f)&&(K(f,new Cr.ScaleControl({maxWidth:l(),unit:i()}),!0),r(o).addControl(r(f),s()))}),dr(()=>{r(a)&&r(f)&&r(o).removeControl(r(f))}),Be()}var bd=P("<!> <!> <!> <!>",1),yd=P("<!> <!>",1),Ad=P('<div data-testid="map-container"><!></div>');function wd(n,e){Ne(e,!0);let t=W(e,"map",15,void 0),o=W(e,"mapContainer",15,void 0),a=W(e,"class",3,void 0),s=W(e,"diffStyleUpdates",3,!1),l=W(e,"center",15,void 0),i=W(e,"zoom",15,void 0),f=W(e,"pitch",15,0),v=W(e,"bearing",15,0),b=W(e,"bearingSnap",3,7),m=W(e,"bounds",15,void 0),C=W(e,"fitBoundsOptions",19,()=>({})),j=W(e,"hash",3,!1),T=W(e,"projection",3,void 0),M=W(e,"updateHash",3,se=>{window.history.replaceState(window.history.state,"",se)}),I=W(e,"loaded",15,!1),A=W(e,"minZoom",3,0),x=W(e,"maxZoom",3,22),L=W(e,"minPitch",3,0),D=W(e,"maxPitch",3,60),R=W(e,"renderWorldCopies",3,void 0),O=W(e,"dragPan",3,void 0),z=W(e,"dragRotate",3,void 0),d=W(e,"pitchWithRotate",3,void 0),g=W(e,"antialias",3,void 0),p=W(e,"zoomOnDoubleClick",3,!0),$=W(e,"locale",3,void 0),w=W(e,"interactive",3,!0),y=W(e,"attributionControl",3,void 0),F=W(e,"cooperativeGestures",3,!1),k=W(e,"preserveDrawingBuffer",3,!1),N=W(e,"maxBounds",3,void 0),S=W(e,"images",19,()=>[]),E=W(e,"standardControls",3,!1),B=W(e,"filterLayers",3,void 0),G=W(e,"transformRequest",3,void 0),Q=u(()=>typeof E()=="boolean"?void 0:E());const q=gc();_c(new mc(void 0));let X=we(ht(new Set));async function ue(se,Ae=!1){if(t()&&!(!t()?.loaded()&&!Ae))if("url"in se){r(X).add(se.id);try{let me=await t().loadImage(se.url);t().addImage(se.id,me.data,se.options),q.loadedImages.add(se.id)}catch(me){e.onerror?e.onerror({error:me}):console.error(me)}finally{r(X).delete(se.id)}}else t().addImage(se.id,se.data,se.options),q.loadedImages.add(se.id)}Je(()=>{if(I()&&t()?.loaded())for(let se of S())!q.loadedImages.has(se.id)&&!r(X).has(se.id)&&!t().hasImage(se.id)&&ue(se)});let te=u(()=>S().every(se=>q.loadedImages.has(se.id))),ne=we(void 0),oe=we(void 0),H=we(void 0),J=we(void 0);function ee(se){e.onerror?e.onerror(se):se.error.name!=="AbortError"&&console.error(se.error)}function re(se){return Y(),t(q.map=new Cr.Map(ua({container:se,style:e.style,locale:$(),center:l(),zoom:i(),pitch:f(),bearing:v(),bearingSnap:b(),minZoom:A(),maxZoom:x(),minPitch:L(),maxPitch:D(),renderWorldCopies:R(),dragPan:O(),dragRotate:z(),pitchWithRotate:d(),antialias:g(),interactive:w(),preserveDrawingBuffer:k(),maxBounds:N(),bounds:m(),attributionControl:y(),transformRequest:G(),cooperativeGestures:F()}))),t().on("load",Ae=>{Ae.target.getContainer().setAttribute("data-testid","map"),Ae.target.getCanvas().setAttribute("data-testid","map-canvas"),e.onload&&e.onload(t()),q.loaded=!0,I(!0)}),t().on("error",ee),e.onmovestart&&t().on("movestart",e.onmovestart),t().on("moveend",Ae=>{if(l(Ae.target.getCenter()),i(Ae.target.getZoom()),f(Ae.target.getPitch()),v(Ae.target.getBearing()),m(bc(Ae.target.getBounds(),m())),e.onmoveend?.(Ae),j()){let me=new URL(window.location.href.replace(/(#.+)?$/,_d(Ae.target)));M()(me)}}),e.onclick&&t().on("click",e.onclick),e.ondblclick&&t().on("dblclick",e.ondblclick),e.oncontextmenu&&t().on("contextmenu",e.oncontextmenu),e.onmousemove&&t().on("mousemove",e.onmousemove),e.onzoomstart&&t().on("zoomstart",e.onzoomstart),e.onzoom&&t().on("zoom",e.onzoom),e.onzoomend&&t().on("zoomend",e.onzoomend),e.onpitch&&t().on("pitch",e.onpitch),e.onrotate&&t().on("rotate",e.onrotate),e.onwheel&&t().on("wheel",e.onwheel),e.ondata&&t().on("data",e.ondata),e.onidle&&t().on("idle",e.onidle),t().on("style.load",Ae=>{if(t()){T()&&t().setProjection(T()),q.loaded=!0,I(!0);const me=t().getStyle();if(K(ne,me.layers.map(ke=>ke.id),!0),K(oe,Object.keys(me.sources),!0),r(J))for(const[ke,Se]of Object.entries(r(J)))t().addSource(ke,Se);if(r(H))for(const ke of r(H))t().addLayer(ke);for(const ke of S())ue(ke,!0);e.onstyleload?.(Ae)}}),t().on("styledata",Ae=>{if(t()&&B()){const me=t().getStyle().layers;if(me)for(let ke of me)B()(ke)||t().setLayoutProperty(ke.id,"visibility","none")}e.onstyledata?.(Ae)}),{destroy(){I(!1),q.loaded=!1,t()?.remove()}}}let ae=we(ht(e.style));Je(()=>{if(t()&&!Co(e.style,r(ae))){const se=t().getStyle();if(r(ne)&&K(H,se.layers.filter(Ae=>!r(ne).includes(Ae.id)),!0),r(oe)){const Ae=Object.keys(se.sources).filter(me=>!r(oe).includes(me));K(J,{},!0);for(const me of Ae)r(J)[me]=se.sources[me]}K(ae,e.style,!0),t().setStyle(e.style,{diff:s()}),q.loadedImages.clear(),K(X,new Set,!0)}}),Je(()=>{if(t()){let se={};l()!=null&&!Co(l(),t().getCenter())&&(se.center=l()),i()!=null&&!Co(i(),t().getZoom())&&(se.zoom=i()),v()!=null&&!Co(v(),t().getBearing())&&(se.bearing=v()),f()!=null&&!Co(f(),t().getPitch())&&(se.pitch=f()),Object.keys(se).length&&t().easeTo(se)}}),Je(()=>{T()&&I()&&t()?.setProjection(T())}),Je(()=>{if(m()){const{equal:se,bounds:Ae}=pc(m(),t()?.getBounds());se||t()?.fitBounds(Ae,C())}}),Je(()=>{p()?t()?.doubleClickZoom.enable():t()?.doubleClickZoom.disable()});function Y(){if(j()){let se=pd(window.location.hash);se.length>=3&&(i(se[0]),l([se[2],se[1]])),se.length==5&&(v(se[3]),f(se[4]))}}var ie=Ad();ro("hashchange",_a,Y);let _e;var le=c(ie);{var fe=se=>{var Ae=yd(),me=V(Ae);{var ke=We=>{var xe=bd(),Le=V(xe);Vl(Le,{get position(){return r(Q)}});var he=h(Le,2);{let be=u(()=>({...C(),maxZoom:12}));fd(he,{get position(){return r(Q)},get fitBoundsOptions(){return r(be)}})}var Re=h(he,2);dd(Re,{get position(){return r(Q)}});var Ce=h(Re,2);Kl(Ce,{get position(){return r(Q)}}),_(We,xe)};ve(me,We=>{E()&&We(ke)})}var Se=h(me,2);Tt(Se,()=>e.children??Pe,()=>({map:t(),loaded:I(),loadedImages:q.loadedImages,allImagesLoaded:r(te)})),_(se,Ae)};ve(le,se=>{t()&&se(fe)})}vn(ie,se=>o(se),()=>o()),hc(ie,se=>re?.(se)),Z(se=>_e=St(ie,1,El(a()),"svelte-xbukvd",_e,se),[()=>({"expand-map":!a()})]),_(n,ie),Be()}var xd=P('<div class="sv-popup"><!></div>');function Bt(n,e){Ne(e,!0);let t=W(e,"closeButton",3,void 0),o=W(e,"closeOnClickOutside",3,!0),a=W(e,"closeOnClickInside",3,!1),s=W(e,"closeOnMove",3,!1),l=W(e,"openOn",3,"click"),i=W(e,"openIfTopMost",3,!0),f=W(e,"focusAfterOpen",3,!0),v=W(e,"anchor",3,void 0),b=W(e,"offset",3,void 0),m=W(e,"popupClass",3,void 0),C=W(e,"maxWidth",3,void 0),j=W(e,"lngLat",15,void 0),T=W(e,"html",3,void 0),M=W(e,"open",15,!1),I=W(e,"onopen",3,void 0),A=W(e,"onclose",3,void 0),x=W(e,"onhover",3,void 0),L=yc();const D=u(Qr),R=u(()=>r(D).map),O=u(()=>r(D).eventTopMost),z=u(()=>r(D).markerClickManager),d=u(()=>r(D).loaded),g=Ac(),p=wc(),$=xc(),w=["click","dblclick","contextmenu"];let y=we(void 0),F=we(!1),k=we(void 0);function N(){if(!r(y))return;let le=r(y).getElement();!le||le===r(k)||(K(k,le,!0),l()==="hover"&&(r(k).style.pointerEvents="none"),r(k).addEventListener("mouseenter",()=>{K(F,!0)},{passive:!0}),r(k).addEventListener("mouseleave",()=>{K(F,!1)},{passive:!0}),r(k).addEventListener("click",()=>{a()&&M(!1)},{passive:!0}))}gn(()=>{if(r(R))return r(R).on("click",H),r(R).on("contextmenu",H),r(z).add(J),typeof $?.value=="string"&&(r(R).on("click",$.value,q),r(R).on("dblclick",$.value,q),r(R).on("contextmenu",$.value,q),r(R).on("mousemove",$.value,oe),r(R).on("mouseleave",$.value,ne),r(R).on("touchstart",$.value,ue),r(R).on("touchend",$.value,te)),()=>{r(d)&&(r(y)?.remove(),r(R).off("click",H),r(R).off("contextmenu",H),r(z).remove(J),$?.value instanceof Cr.Marker?$.value.getPopup()===r(y)&&$.value.setPopup(void 0):typeof $?.value=="string"&&(r(R).off("click",$.value,q),r(R).off("dblclick",$.value,q),r(R).off("contextmenu",$.value,q),r(R).off("mousemove",$.value,oe),r(R).off("mouseleave",$.value,ne),r(R).off("touchstart",$.value,ue),r(R).off("touchend",$.value,te)))}});function S(){if(e.canOpen&&!e.canOpen(r(B))){M(!1);return}M(!0)}function E(le){return i()?!("marker"in le)&&!$c(le)&&r(O)(le)!==g?.value:!1}let B=we(void 0),G=we("normal");function Q(le){"layerType"in le&&le.layerType==="deckgl"?(j(le.coordinate),K(B,le.object?[le.object]:void 0,!0)):(j(le.lngLat),K(B,le.features??[],!0))}function q(le){le.type!==l()||E(le)||(Q(le),setTimeout(S))}let X;function ue(le){X=le.point}function te(le){if(!X||l()!=="hover")return;let fe=X.dist(le.point);X=void 0,fe<3&&(j(le.lngLat),K(B,le.features??[],!0),r(y)?.isOpen()?K(G,"justOpened"):(K(G,"opening"),S()))}function ne(le){l()!=="hover"||X||r(G)!=="normal"||(M(!1),K(B,void 0))}function oe(le){if(!(l()!=="hover"||X||r(G)!=="normal")){if(E(le)){M(!1),K(B,void 0);return}K(B,le.features??[],!0),j(le.lngLat),S()}}function H(le){if(r(G)==="justOpened"){K(G,"normal");return}if(!o())return;let fe=[r(k),$?.value instanceof Cr.Marker?$.value?.getElement():void 0];M()&&r(y)?.isOpen()&&!fe.some(se=>se?.contains(le.originalEvent.target))&&(le.type==="contextmenu"&&l()==="contextmenu"||le.type!=="contextmenu")&&M(!1)}function J(le){o()&&M()&&r(y)?.isOpen()&&le.marker!==$?.value&&M(!1)}dr(()=>{r(d)&&r(y)?.isOpen()&&r(y).remove()});let ee=we(void 0),re=u(()=>t()??(!o()&&!a()));Je(()=>{if(!r(y)){let le=m()?`${m()} sv-maplibregl-popup`:"sv-maplibregl-popup";K(y,new Cr.Popup({closeButton:r(re),closeOnClick:!1,closeOnMove:s(),focusAfterOpen:f(),maxWidth:C(),className:le,anchor:v(),offset:b()}),!0),K(k,r(y).getElement(),!0),r(y).on("open",()=>{S(),M()&&(N(),I()?.(r(y)))}),r(y).on("close",()=>{M(!1),A()?.(r(y))}),x()&&r(y).on("hover",()=>{x()?.(r(y))})}}),Je(()=>{r(y)&&$?.value instanceof Cr.Marker&&(l()==="click"?$.value.setPopup(r(y)):$.value.getPopup()===r(y)&&$.value.setPopup(void 0))}),Je(()=>{w.includes(l())&&p.value?.type===l()&&(q(p.value),p.value=void 0)});let ae=u(()=>l()==="hover"&&(p.value?.type==="mousemove"||p.value?.type==="mouseenter"));Je(()=>{l()==="hover"&&p&&(r(ae)&&p.value&&Q(p.value),r(ae)||r(F)?S():M(!1))}),Je(()=>{r(ee)?r(y)?.setDOMContent(r(ee)):T()&&r(y)?.setHTML(T())}),Je(()=>{let le=j()??L?.value??void 0;le&&r(y)?.setLngLat(le)}),Je(()=>{if(r(R)&&r(y)){let le=r(y).isOpen();M()&&!le?(r(y).addTo(r(R)),r(G)==="opening"&&K(G,"justOpened")):!M()&&le&&r(y).remove()}});var Y=$e(),ie=V(Y);{var _e=le=>{var fe=xd(),se=c(fe);{var Ae=me=>{var ke=$e(),Se=V(ke);Tt(Se,()=>e.children??Pe,()=>({features:r(B),data:r(B)?.[0]??void 0,map:r(R),close:()=>M(!1),isOpen:M()})),_(me,ke)};ve(se,me=>{(r(B)?.length||$?.value instanceof Cr.Marker||!$&&M())&&me(Ae)})}vn(fe,me=>K(ee,me),()=>r(ee)),_(le,fe)};ve(ie,le=>{e.children&&le(_e)})}_(n,Y),Be()}function po(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("symbol")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"paint",3,void 0),f=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),b=W(e,"applyToClusters",3,void 0),m=W(e,"minzoom",3,void 0),C=W(e,"maxzoom",3,void 0),j=W(e,"hoverCursor",3,void 0),T=W(e,"manageHoverState",3,!1),M=W(e,"hovered",15),I=W(e,"eventsIfTopMost",3,!1),A=W(e,"interactive",3,!0),x=W(e,"children",3,void 0),L=W(e,"onclick",3,void 0),D=W(e,"ondblclick",3,void 0),R=W(e,"oncontextmenu",3,void 0),O=W(e,"onmouseenter",3,void 0),z=W(e,"onmousemove",3,void 0),d=W(e,"onmouseleave",3,void 0);ha(n,{get id(){return t()},type:"symbol",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return i()},get layout(){return f()},get filter(){return v()},get applyToClusters(){return b()},get minzoom(){return m()},get maxzoom(){return C()},get hoverCursor(){return j()},get manageHoverState(){return T()},get eventsIfTopMost(){return I()},get interactive(){return A()},get onclick(){return L()},get ondblclick(){return D()},get oncontextmenu(){return R()},get onmouseenter(){return O()},get onmousemove(){return z()},get onmouseleave(){return d()},get hovered(){return M()},set hovered(g){M(g)},children:(g,p)=>{var $=$e(),w=V($);Tt(w,()=>x()??Pe),_(g,$)},$$slots:{default:!0}}),Be()}function ba(n,e){Ne(e,!0);let t=W(e,"id",19,()=>On("vector")),o=W(e,"url",3,void 0),a=W(e,"tiles",3,void 0),s=W(e,"promoteId",3,void 0),l=W(e,"bounds",3,void 0),i=W(e,"scheme",3,void 0),f=W(e,"attribution",3,void 0),v=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),m=W(e,"volatile",3,void 0);if(o()&&o().includes("pmtiles://")&&!Object.hasOwn(Cr.config.REGISTERED_PROTOCOLS,"pmtiles")){let D=new kc;Cr.addProtocol("pmtiles",D.tile)}const C=u(Qr),j=u(()=>r(C).map),T=u(()=>r(C).loaded),{source:M}=Ll();let I=we(void 0);Je(()=>{r(j)&&r(T)&&M.value!==t()&&(M.value=t(),Ql(r(j),M.value,ua({type:"vector",url:o(),tiles:a(),promoteId:s(),bounds:l(),scheme:i(),attribution:f(),minzoom:v(),maxzoom:b(),volatile:m()}),D=>r(j)&&D===M.value,()=>{M.value&&K(I,r(j).getSource(M.value),!0)}))}),Je(()=>{r(j).on("style.load",()=>{K(I,r(j).getSource(t()),!0)})}),dr(()=>{M.value&&r(j)&&(Zl(r(j),M.value,r(I)),M.value=void 0,K(I,void 0))});var A=$e(),x=V(A);{var L=D=>{var R=$e(),O=V(R);ai(O,()=>M.value,z=>{var d=$e(),g=V(d);Tt(g,()=>e.children??Pe),_(z,d)}),_(D,R)};ve(x,D=>{M.value&&D(L)})}_(n,A),Be()}var $d=P('<div class="form-check"><label class="form-check-label"><input class="form-check-input" type="checkbox"/> <!></label></div>');function kd(n,e){Ne(e,!0);let t=W(e,"checked",15);var o=$d(),a=c(o),s=c(a),l=h(s,2);Tt(l,()=>e.children??Pe),un(s,t),_(n,o),Be()}var Sd=P("<tr><td> </td><td> </td></tr>"),Ed=P('<table class="svelte-7qv069"><tbody></tbody></table>');function io(n,e){var t=Ed(),o=c(t);Zt(o,21,()=>Object.entries(e.properties),Vt,(a,s)=>{var l=u(()=>qr(r(s),2));let i=()=>r(l)[0],f=()=>r(l)[1];var v=Sd(),b=c(v),m=c(b),C=h(b),j=c(C);Z(()=>{U(m,i()),U(j,f())}),_(a,v)}),_(n,t)}var Ld=P('<div style="display: flex; align-items: center; gap: 6px;"><span></span> </div>'),Cd=P("<div></div>");function cs(n,e){let t=W(e,"swatchClass",3,"rectangle"),o=W(e,"itemsPerRow",3,2),a=u(()=>`${100/o()}%`);var s=Cd();Zt(s,21,()=>Object.entries(e.labelColors),Vt,(l,i)=>{var f=u(()=>qr(r(i),2));let v=()=>r(f)[0],b=()=>r(f)[1];var m=Ld(),C=c(m);let j;var T=h(C);Z(M=>{St(C,1,`color-swatch ${t()??""}`,"svelte-kgsne0"),j=gr(C,"",j,M),U(T,` ${v()??""}`)},[()=>({background:b()})]),_(l,m)}),Z(()=>gr(s,`display: grid; grid-template-columns: repeat(auto-fill, calc(${r(a)??""} - 10px)); gap: 10px;`)),_(n,s)}var Md=P('<span class="bucket svelte-1twtizg">&nbsp;</span>'),Pd=P('<span class="svelte-1twtizg"> </span>'),Id=P('<div><div class="colors svelte-1twtizg"></div> <div class="labels svelte-1twtizg"></div></div>');function Ar(n,e){Ne(e,!0);let t=W(e,"decimalPlaces",3,0),o=W(e,"fullWidthBucketLegend",3,!1);function a(v,b){return("limits"in v?v.limits:v.buckets).map(C=>typeof C=="number"?b>0?C.toFixed(b):C.toLocaleString():C)}var s=Id();let l;var i=c(s);Zt(i,21,()=>e.colorScale,Vt,(v,b)=>{var m=Md();Z(()=>gr(m,`background: ${r(b)??""};`)),_(v,m)});var f=h(i,2);Zt(f,21,()=>a(e.labels,t()),Vt,(v,b)=>{var m=Pd(),C=c(m);Z(()=>U(C,r(b))),_(v,m)}),Z(v=>l=St(s,1,"svelte-1twtizg",null,l,v),[()=>({"full-width-bucket-legend":o(),bucketed:e.labels.hasOwnProperty("buckets"),limits:e.labels.hasOwnProperty("limits")})]),_(n,s),Be()}let Oe;const Xl=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Xl.decode();let Ro=null;function Jo(){return(Ro===null||Ro.byteLength===0)&&(Ro=new Uint8Array(Oe.memory.buffer)),Ro}function Hr(n,e){return n=n>>>0,Xl.decode(Jo().subarray(n,n+e))}const bn=new Array(128).fill(void 0);bn.push(void 0,null,!0,!1);let Qo=bn.length;function Xt(n){Qo===bn.length&&bn.push(bn.length+1);const e=Qo;return Qo=bn[e],bn[e]=n,e}function ot(n){return bn[n]}function Td(n){n<132||(bn[n]=Qo,Qo=n)}function lo(n){const e=ot(n);return Td(n),e}function gi(n){return n==null}let No=null;function Rd(){return(No===null||No.byteLength===0)&&(No=new Float64Array(Oe.memory.buffer)),No}let Bo=null;function ft(){return(Bo===null||Bo.byteLength===0)&&(Bo=new Int32Array(Oe.memory.buffer)),Bo}let Tn=0;const Ra=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},Nd=typeof Ra.encodeInto=="function"?function(n,e){return Ra.encodeInto(n,e)}:function(n,e){const t=Ra.encode(n);return e.set(t),{read:n.length,written:t.length}};function ka(n,e,t){if(t===void 0){const i=Ra.encode(n),f=e(i.length,1)>>>0;return Jo().subarray(f,f+i.length).set(i),Tn=i.length,f}let o=n.length,a=e(o,1)>>>0;const s=Jo();let l=0;for(;l<o;l++){const i=n.charCodeAt(l);if(i>127)break;s[a+l]=i}if(l!==o){l!==0&&(n=n.slice(l)),a=t(a,o,o=l+n.length*3,1)>>>0;const i=Jo().subarray(a+l,a+o),f=Nd(n,i);l+=f.written}return Tn=l,a}function zi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const a=n.description;return a==null?"Symbol":`Symbol(${a})`}if(e=="function"){const a=n.name;return typeof a=="string"&&a.length>0?`Function(${a})`:"Function"}if(Array.isArray(n)){const a=n.length;let s="[";a>0&&(s+=zi(n[0]));for(let l=1;l<a;l++)s+=", "+zi(n[l]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let o;if(t.length>1)o=t[1];else return toString.call(n);if(o=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:o}function Bd(n,e){const t=e(n.length*1,1)>>>0;return Jo().set(n,t/1),Tn=n.length,t}function _i(n,e){try{return n.apply(this,e)}catch(t){Oe.__wbindgen_exn_store(Xt(t))}}class Ha{static __wrap(e){e=e>>>0;const t=Object.create(Ha.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();Oe.__wbg_jsroutesnapper_free(e)}constructor(e){try{const s=Oe.__wbindgen_add_to_stack_pointer(-16),l=Bd(e,Oe.__wbindgen_malloc),i=Tn;Oe.jsroutesnapper_new(s,l,i);var t=ft()[s/4+0],o=ft()[s/4+1],a=ft()[s/4+2];if(a)throw lo(o);return Ha.__wrap(t)}finally{Oe.__wbindgen_add_to_stack_pointer(16)}}setRouteConfig(e){Oe.jsroutesnapper_setRouteConfig(this.__wbg_ptr,Xt(e))}setAreaMode(){Oe.jsroutesnapper_setAreaMode(this.__wbg_ptr)}getConfig(){let e,t;try{const s=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_getConfig(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,Hr(o,a)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(e,t,1)}}toFinalFeature(){try{const o=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_toFinalFeature(o,this.__wbg_ptr);var e=ft()[o/4+0],t=ft()[o/4+1];let a;return e!==0&&(a=Hr(e,t).slice(),Oe.__wbindgen_free(e,t*1)),a}finally{Oe.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){let e,t;try{const s=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_renderGeojson(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,Hr(o,a)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(e,t,1)}}toggleSnapMode(){Oe.jsroutesnapper_toggleSnapMode(this.__wbg_ptr)}onMouseMove(e,t,o){return Oe.jsroutesnapper_onMouseMove(this.__wbg_ptr,e,t,o)!==0}onClick(){Oe.jsroutesnapper_onClick(this.__wbg_ptr)}onDragStart(){return Oe.jsroutesnapper_onDragStart(this.__wbg_ptr)!==0}onMouseUp(){return Oe.jsroutesnapper_onMouseUp(this.__wbg_ptr)!==0}clearState(){Oe.jsroutesnapper_clearState(this.__wbg_ptr)}editExisting(e){try{const a=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_editExisting(a,this.__wbg_ptr,Xt(e));var t=ft()[a/4+0],o=ft()[a/4+1];if(o)throw lo(t)}finally{Oe.__wbindgen_add_to_stack_pointer(16)}}debugRenderGraph(){let e,t;try{const s=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_debugRenderGraph(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,Hr(o,a)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(e,t,1)}}debugSnappableNodes(){let e,t;try{const s=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_debugSnappableNodes(s,this.__wbg_ptr);var o=ft()[s/4+0],a=ft()[s/4+1];return e=o,t=a,Hr(o,a)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(e,t,1)}}routeNameForWaypoints(e){let t,o;try{const b=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_routeNameForWaypoints(b,this.__wbg_ptr,Xt(e));var a=ft()[b/4+0],s=ft()[b/4+1],l=ft()[b/4+2],i=ft()[b/4+3],f=a,v=s;if(i)throw f=0,v=0,lo(l);return t=f,o=v,Hr(f,v)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(t,o,1)}}addSnappedWaypoint(e,t){Oe.jsroutesnapper_addSnappedWaypoint(this.__wbg_ptr,e,t)}undo(){Oe.jsroutesnapper_undo(this.__wbg_ptr)}calculateRoute(e){let t,o;try{const b=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_calculateRoute(b,this.__wbg_ptr,Xt(e));var a=ft()[b/4+0],s=ft()[b/4+1],l=ft()[b/4+2],i=ft()[b/4+3],f=a,v=s;if(i)throw f=0,v=0,lo(l);return t=f,o=v,Hr(f,v)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(t,o,1)}}getExtraNodes(e,t){let o,a;try{const m=Oe.__wbindgen_add_to_stack_pointer(-16);Oe.jsroutesnapper_getExtraNodes(m,this.__wbg_ptr,Xt(e),Xt(t));var s=ft()[m/4+0],l=ft()[m/4+1],i=ft()[m/4+2],f=ft()[m/4+3],v=s,b=l;if(f)throw v=0,b=0,lo(i);return o=v,a=b,Hr(v,b)}finally{Oe.__wbindgen_add_to_stack_pointer(16),Oe.__wbindgen_free(o,a,1)}}}async function Fd(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(o){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function Od(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const o=Hr(e,t);return Xt(o)},n.wbg.__wbindgen_object_drop_ref=function(e){lo(e)},n.wbg.__wbindgen_error_new=function(e,t){const o=new Error(Hr(e,t));return Xt(o)},n.wbg.__wbindgen_number_get=function(e,t){const o=ot(t),a=typeof o=="number"?o:void 0;Rd()[e/8+1]=gi(a)?0:a,ft()[e/4+0]=!gi(a)},n.wbg.__wbindgen_is_object=function(e){const t=ot(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return ot(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return ot(e)in ot(t)},n.wbg.__wbindgen_boolean_get=function(e){const t=ot(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return ot(e)==ot(t)},n.wbg.__wbindgen_string_get=function(e,t){const o=ot(t),a=typeof o=="string"?o:void 0;var s=gi(a)?0:ka(a,Oe.__wbindgen_malloc,Oe.__wbindgen_realloc),l=Tn;ft()[e/4+1]=l,ft()[e/4+0]=s},n.wbg.__wbg_String_4370c5505c674d30=function(e,t){const o=String(ot(t)),a=ka(o,Oe.__wbindgen_malloc,Oe.__wbindgen_realloc),s=Tn;ft()[e/4+1]=s,ft()[e/4+0]=a},n.wbg.__wbindgen_object_clone_ref=function(e){const t=ot(e);return Xt(t)},n.wbg.__wbg_getwithrefkey_d1f0d12f1f1b63ea=function(e,t){const o=ot(e)[ot(t)];return Xt(o)},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return Xt(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const o=ot(t).stack,a=ka(o,Oe.__wbindgen_malloc,Oe.__wbindgen_realloc),s=Tn;ft()[e/4+1]=s,ft()[e/4+0]=a},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let o,a;try{o=e,a=t,console.error(Hr(e,t))}finally{Oe.__wbindgen_free(o,a,1)}},n.wbg.__wbg_debug_9a6b3243fbbebb61=function(e){console.debug(ot(e))},n.wbg.__wbg_error_788ae33f81d3b84b=function(e){console.error(ot(e))},n.wbg.__wbg_info_2e30e8204b29d91d=function(e){console.info(ot(e))},n.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(ot(e))},n.wbg.__wbg_warn_d60e832f9882c1b2=function(e){console.warn(ot(e))},n.wbg.__wbg_get_44be0491f933a435=function(e,t){const o=ot(e)[t>>>0];return Xt(o)},n.wbg.__wbg_length_fff51ee6522a1a18=function(e){return ot(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof ot(e)=="function"},n.wbg.__wbg_next_526fc47e980da008=function(e){const t=ot(e).next;return Xt(t)},n.wbg.__wbg_next_ddb3312ca1c4e32a=function(){return _i(function(e){const t=ot(e).next();return Xt(t)},arguments)},n.wbg.__wbg_done_5c1f01fb660d73b5=function(e){return ot(e).done},n.wbg.__wbg_value_1695675138684bd5=function(e){const t=ot(e).value;return Xt(t)},n.wbg.__wbg_iterator_97f0c81209c6c35a=function(){return Xt(Symbol.iterator)},n.wbg.__wbg_get_97b561fb56f034b5=function(){return _i(function(e,t){const o=Reflect.get(ot(e),ot(t));return Xt(o)},arguments)},n.wbg.__wbg_call_cb65541d95d71282=function(){return _i(function(e,t){const o=ot(e).call(ot(t));return Xt(o)},arguments)},n.wbg.__wbg_isArray_4c24b343cb13cfb1=function(e){return Array.isArray(ot(e))},n.wbg.__wbg_instanceof_ArrayBuffer_39ac22089b74fddb=function(e){let t;try{t=ot(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_085ec1f694018c4f=function(e){const t=ot(e).buffer;return Xt(t)},n.wbg.__wbg_new_8125e318e6245eed=function(e){const t=new Uint8Array(ot(e));return Xt(t)},n.wbg.__wbg_set_5cf90238115182c3=function(e,t,o){ot(e).set(ot(t),o>>>0)},n.wbg.__wbg_length_72e2208bbc0efc61=function(e){return ot(e).length},n.wbg.__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4=function(e){let t;try{t=ot(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbindgen_debug_string=function(e,t){const o=zi(ot(t)),a=ka(o,Oe.__wbindgen_malloc,Oe.__wbindgen_realloc),s=Tn;ft()[e/4+1]=s,ft()[e/4+0]=a},n.wbg.__wbindgen_throw=function(e,t){throw new Error(Hr(e,t))},n.wbg.__wbindgen_memory=function(){const e=Oe.memory;return Xt(e)},n}function jd(n,e){return Oe=n.exports,Yl.__wbindgen_wasm_module=e,No=null,Bo=null,Ro=null,Oe}async function Yl(n){if(Oe!==void 0)return Oe;typeof n>"u"&&(n=new URL("/ltn/assets/route_snapper_bg-CaN5p6v7.wasm",import.meta.url));const e=Od();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:o}=await Fd(await n,e);return jd(t,o)}const zd=30;class Dd{constructor(e,t,o,a,s){this.onMouseMove=l=>{if(!this.active)return;const i=[l.point.x-zd,l.point.y],f=this.map.unproject(l.point).distanceTo(this.map.unproject(i));this.inner.onMouseMove(l.lngLat.lng,l.lngLat.lat,f)&&(this.redraw(),this.dataUpdated())},this.onClick=()=>{this.active&&(this.inner.onClick(),this.redraw(),this.dataUpdated())},this.onDoubleClick=l=>{this.active&&(l.preventDefault(),this.inner.onClick(),this.finish())},this.onDragStart=()=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()},this.onMouseUp=()=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()},this.onKeyDown=l=>{if(!this.active)return;let i=l.target.tagName;i=="INPUT"||i=="TEXTAREA"||l.key=="Escape"&&(l.stopPropagation(),this.cancel())},this.onKeyPress=l=>{if(!this.active)return;let i=l.target.tagName;i=="INPUT"||i=="TEXTAREA"||(l.key=="Enter"?(l.stopPropagation(),this.finish()):l.key=="s"||l.key=="S"?(l.stopPropagation(),this.inner.toggleSnapMode(),this.redraw()):l.key=="z"&&l.ctrlKey&&this.undo())},this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new Ha(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.routeToolGj=o,this.snapMode=a,this.undoLength=s,this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("dragstart",this.onDragStart),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keypress",this.onKeyPress)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("dragstart",this.onDragStart),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keypress",this.onKeyPress)}startRoute(){this.active||(this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}startArea(){this.active||(this.inner.setAreaMode(),this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}stop(){this.active=!1,this.inner.clearState(),this.redraw(),this.map.boxZoom.enable(),this.map.doubleClickZoom.enable()}editExistingRoute(e){this.active&&window.alert("Bug: editExistingRoute called when tool is already active"),e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.startRoute(),this.inner.editExisting(e.properties.waypoints),this.redraw()}editExistingArea(e){this.active&&window.alert("Bug: editExistingArea called when tool is already active"),e.properties.waypoints||window.alert("Bug: editExistingArea called for a polygon not produced by the route-snapper"),this.startArea(),this.inner.editExisting(e.properties.waypoints),this.redraw()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}isActive(){return this.active}finish(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersSuccess)t(JSON.parse(e));else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){this.inner.clearState(),this.finish()}setRouteConfig(e){this.inner.setRouteConfig(e),this.redraw()}addSnappedWaypoint(e){this.inner.addSnappedWaypoint(e[0],e[1]),this.redraw()}undo(){this.inner.undo(),this.redraw()}toggleSnapMode(){this.inner.toggleSnapMode(),this.redraw()}redraw(){let e=JSON.parse(this.inner.renderGeojson());this.routeToolGj.set(e),this.map.getCanvas().style.cursor=e.cursor,this.snapMode.set(e.snap_mode),this.undoLength.set(e.undo_length)}dataUpdated(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersUpdated)t(JSON.parse(e))}}function Ud(n){const e=()=>ye(Sc,"$interactiveMapLayersEnabled",t),[t,o]=lt();let a={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]}};it(n,{get data(){return a},children:(s,l)=>{{let i=Cl(()=>({visibility:e()?"none":"visible"}));cr(s,{paint:{"fill-color":"black","fill-opacity":0},get layout(){return r(i)}})}},$$slots:{default:!0}}),o()}var Gd=P('<span class="dot svelte-1j0tfn0"><!></span>'),Wd=P('<span class="dot svelte-1j0tfn0"><!></span>');function no(n,e){Ne(e,!0);let t=W(e,"lngLat",15),o=W(e,"draggable",3,!1);var a=$e(),s=V(a);{var l=f=>{_o(f,{draggable:!0,get lngLat(){return t()},set lngLat(v){t(v)},children:(v,b)=>{var m=Gd(),C=c(m);Tt(C,()=>e.children),_(v,m)},$$slots:{default:!0}})},i=f=>{_o(f,{get lngLat(){return t()},children:(v,b)=>{var m=Wd(),C=c(m);Tt(C,()=>e.children),_(v,m)},$$slots:{default:!0}})};ve(s,f=>{o()?f(l):f(i,!1)})}_(n,a),Be()}var Hd=P("<progress></progress>"),qd=P('<progress max="100"></progress>'),Jd=P("<div><!></div>"),Qd=P('<div class="cover svelte-1lcxh3p"><div class="background svelte-1lcxh3p"> <!></div></div>');function ho(n,e){Ne(e,!0);let t=W(e,"progress",3,null),o=we(void 0),a=we(void 0);Je(()=>{if(e.loading&&!r(o))K(o,Date.now(),!0),K(a,e.loading,!0);else if(!e.loading&&r(o)){const f=Date.now()-r(o);console.log(`Loading "${r(a)}" took ${f}ms`),K(o,void 0)}});var s=$e(),l=V(s);{var i=f=>{var v=Qd(),b=c(v),m=c(b),C=h(m);{var j=T=>{var M=Jd(),I=c(M);{var A=L=>{var D=Hd();gr(D,"",{},{width:"100%"}),_(L,D)},x=L=>{var D=qd();gr(D,"",{},{width:"100%"}),Z(()=>Ec(D,t())),_(L,D)};ve(I,L=>{t()==100?L(A):L(x,!1)})}_(T,M)};ve(C,T=>{t()!=null&&T(j)})}Z(()=>U(m,`${e.loading??""} `)),_(f,v)};ve(l,f=>{e.loading&&f(i)})}_(n,s),Be()}function wr(n){switch(n){case"title":return"Choose project";case"new-project":return"New project";case"pick-neighbourhood":return Yr(Ml)?.project_name||"Pick neighbourhood";case"set-boundary":return"Adjust boundary";case"add-neighbourhood":return"Add a neighbourhood";case"neighbourhood":return Yr(co)||"Editing";case"view-shortcuts":return"Shortcuts";case"impact-one-destination":return"Impact on one destination";case"route":return"Route";case"predict-impact":return"Predict impact";case"impact-detail":return"Impact detail";case"debug-intersections":return"Debug intersections";case"debug-neighbourhood":return"Debug neighbourhood";case"debug-demand":return"Explore origin/destination demand data"}}var Zd=P('<span class="page-title svelte-tym4cg"> </span>');function et(n,e){Ne(e,!0);const[t,o]=lt();let a=W(e,"children",3,void 0);pa(n,{onclick:()=>Qe(yt,e.mode),children:(s,l)=>{var i=$e(),f=V(i);{var v=m=>{var C=$e(),j=V(C);Tt(j,a),_(m,C)},b=m=>{var C=Zd(),j=c(C);Z(T=>U(j,T),[()=>wr(e.mode.mode)]),_(m,C)};ve(f,m=>{a()?m(v):m(b,!1)})}_(s,i)}}),Be(),o()}function Ge(n,e=!0){return{id:n,beforeId:eu(n),eventsIfTopMost:e}}function eu(n){let e=Yr(rn);if(!e){console.warn(`getBeforeId(${n}) called before map is ready. Z-ordering may be incorrect.`);return}let t,o=!1;for(let a=qa.length-1;a>=0;a--){let s=qa[a];if(s==n){o=!0;break}e.getLayer(s)&&(t=s)}if(!o)throw new Error(`Layer ID ${n} not defined in layerZorder`);return t}let pi=n=>n,hi=n=>n;const qa=[pi(hi("Background")),"neighbourhood-boundaries",pi("Ferry line"),"neighbourhood-boundaries-outline","neighbourhood-boundaries-selected-outline-base","neighbourhood-boundaries-selected-outline","debug-borders","debug-filters","cells","before-edits-cells","interior-roads-outlines","before-edits-interior-roads-outlines","interior-roads","before-edits-interior-roads","main-roads-outlines","before-edits-main-roads-outlines","main-roads","before-edits-main-roads","turn-restriction-targets","debug-intersections","debug-movements-outline","debug-movements-fill","debug-editable-intersections","editable-intersections","intersection-filters","before-edits-intersection-filters","border-entries","before-edits-border-entries","compare-route","shortcuts","shortcuts-focus","predict-impact-outline","predict-impact",hi("Building"),"draw-area-lines","draw-area-area","draw-area-lines-preview","draw-route-lines","draw-route-preview","debug-demand-fill","debug-demand-outline","one-ways","before-edits-one-ways","context-population-car-ownership","context-simd","context-population-density","context-population-outline","context-traffic","context-los","context-existing-infra","context-route-network","context-bus-routes","context-pois","context-railway-stations","context-stats19-heatmap","context-stats19-points",hi("Road labels"),pi("road_label"),"animate-shortcuts","modal-filters","before-edits-modal-filters","turn-restrictions","before-edits-turn-restrictions","turn-restrictions-debug-arrows","before-edits-turn-restrictions-debug-arrows","boundary","neighbourhood-boundary","freehand-line","edit-polygon-fill","edit-polygon-lines","edit-polygon-vertices"];function Vd(){let n=Yr(rn);if(!n)return;let e=["Background","Ferry line","Building","Road labels","road_label"];for(let t=qa.length-1;t>=0;t--){let o=qa[t];if(e.includes(o)||!n.getLayer(o))continue;let a=eu(o);a&&n.moveLayer(o,a)}}var Kd=P('<a href="https://wiki.openstreetmap.org/wiki/Tag:route%3Dbus" target="_blank"> </a>'),Xd=P("<p><!></p>"),Yd=P("<!> <!>",1);function ef(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=we(!1);var a=Yd(),s=V(a);{const i=v=>{var b=Xd();{const C=(j,T=Pe)=>{var M=Kd(),I=c(M);Z(A=>U(I,A),[()=>r(t).tx(T())]),_(j,M)};var m=c(b);{let j=u(()=>[C]),T=u(()=>r(t).cx(186));pe(m,{get t(){return r(j)},get x(){return r(T)}})}}_(v,b)};let f=u(()=>r(t).t(185));Br(s,{get label(){return r(f)},get show(){return r(o)},set show(v){K(o,v,!0)},help:i,$$slots:{help:!0}})}var l=h(s,2);{let i=u(()=>`pmtiles://${en("cnt/layers/bus_routes.pmtiles")}`);ba(l,{get url(){return r(i)},children:(f,v)=>{{let b=u(()=>Ge("context-bus-routes")),m=u(()=>({"line-color":"blue","line-width":fo(0)})),C=u(()=>({visibility:r(o)?"visible":"none"}));gt(f,Ie(()=>r(b),{sourceLayer:"bus_routes",get paint(){return r(m)},get layout(){return r(C)}}))}},$$slots:{default:!0}})}_(n,a),Be()}var Ir=63710088e-1,tu={centimeters:Ir*100,centimetres:Ir*100,degrees:360/(2*Math.PI),feet:Ir*3.28084,inches:Ir*39.37,kilometers:Ir/1e3,kilometres:Ir/1e3,meters:Ir,metres:Ir,miles:Ir/1609.344,millimeters:Ir*1e3,millimetres:Ir*1e3,nauticalmiles:Ir/1852,radians:1,yards:Ir*1.0936};function Di(n,e,t={}){const o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=e||{},o.geometry=n,o}function eo(n,e,t={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Rs(n[0])||!Rs(n[1]))throw new Error("coordinates must contain numbers");return Di({type:"Point",coordinates:n},e,t)}function tf(n,e="kilometers"){const t=tu[e];if(!t)throw new Error(e+" units is invalid");return n*t}function rf(n,e="kilometers"){const t=tu[e];if(!t)throw new Error(e+" units is invalid");return n/t}function ca(n){return n%(2*Math.PI)*180/Math.PI}function Nr(n){return n%360*Math.PI/180}function Rs(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}var nf=Object.defineProperty,ru=n=>{throw TypeError(n)},of=(n,e,t)=>e in n?nf(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,je=(n,e,t)=>of(n,typeof e!="symbol"?e+"":e,t),nu=(n,e,t)=>e.has(n)||ru("Cannot "+t),er=(n,e,t)=>(nu(n,e,"read from private field"),e.get(n)),mi=(n,e,t)=>e.has(n)?ru("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Sa=(n,e,t,o)=>(nu(n,e,"write to private field"),e.set(n,t),t);function Gt(){}function af(n,e){for(const t in e)n[t]=e[t];return n}function ou(n){return n()}function Ns(){return Object.create(null)}function Ln(n){n.forEach(ou)}function au(n){return typeof n=="function"}function jn(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ea;function _r(n,e){return n===e?!0:(Ea||(Ea=document.createElement("a")),Ea.href=e,n===Ea.href)}function sf(n){return Object.keys(n).length===0}function lf(n,e,t,o){if(n){const a=iu(n,e,t,o);return n[0](a)}}function iu(n,e,t,o){return n[1]&&o?af(t.ctx.slice(),n[1](o(e))):t.ctx}function uf(n,e,t,o){return n[2],e.dirty}function cf(n,e,t,o,a,s){if(a){const l=iu(e,t,o,s);n.p(l,a)}}function df(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let o=0;o<t;o++)e[o]=-1;return e}return-1}function Ja(n){return n??""}function pt(n,e){n.appendChild(e)}function Ft(n,e,t){n.insertBefore(e,t||null)}function Nt(n){n.parentNode&&n.parentNode.removeChild(n)}function Ct(n){return document.createElement(n)}function tn(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Bn(n){return document.createTextNode(n)}function Rr(){return Bn(" ")}function ff(){return Bn("")}function ar(n,e,t,o){return n.addEventListener(e,t,o),()=>n.removeEventListener(e,t,o)}function vf(n){return function(e){return e.preventDefault(),n.call(this,e)}}function de(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function gf(n){return Array.from(n.childNodes)}function da(n,e){e=""+e,n.data!==e&&(n.data=e)}function Bs(n,e){n.value=e??""}function dn(n,e,t){n.classList.toggle(e,!!t)}function _f(n,e,{bubbles:t=!1,cancelable:o=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:o})}let fa;function Zo(n){fa=n}function su(){if(!fa)throw new Error("Function called outside component initialization");return fa}function pf(n){su().$$.on_destroy.push(n)}function lu(){const n=su();return(e,t,{cancelable:o=!1}={})=>{const a=n.$$.callbacks[e];if(a){const s=_f(e,t,{cancelable:o});return a.slice().forEach(l=>{l.call(n,s)}),!s.defaultPrevented}return!0}}function hf(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(o=>o.call(this,e))}const uo=[],Ui=[];let vo=[];const Fs=[],mf=Promise.resolve();let Gi=!1;function bf(){Gi||(Gi=!0,mf.then(uu))}function Wi(n){vo.push(n)}const bi=new Set;let so=0;function uu(){if(so!==0)return;const n=fa;do{try{for(;so<uo.length;){const e=uo[so];so++,Zo(e),yf(e.$$)}}catch(e){throw uo.length=0,so=0,e}for(Zo(null),uo.length=0,so=0;Ui.length;)Ui.pop()();for(let e=0;e<vo.length;e+=1){const t=vo[e];bi.has(t)||(bi.add(t),t())}vo.length=0}while(uo.length);for(;Fs.length;)Fs.pop()();Gi=!1,bi.clear(),Zo(n)}function yf(n){if(n.fragment!==null){n.update(),Ln(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Wi)}}function Af(n){const e=[],t=[];vo.forEach(o=>n.indexOf(o)===-1?e.push(o):t.push(o)),t.forEach(o=>o()),vo=e}const Na=new Set;let to;function Fo(){to={r:0,c:[],p:to}}function Oo(){to.r||Ln(to.c),to=to.p}function Ht(n,e){n&&n.i&&(Na.delete(n),n.i(e))}function nr(n,e,t,o){if(n&&n.o){if(Na.has(n))return;Na.add(n),to.c.push(()=>{Na.delete(n),o&&(t&&n.d(1),o())}),n.o(e)}else o&&o()}function Os(n){return n?.length!==void 0?n:Array.from(n)}function wf(n,e){nr(n,1,1,()=>{e.delete(n.key)})}function xf(n,e,t,o,a,s,l,i,f,v,b,m){let C=n.length,j=s.length,T=C;const M={};for(;T--;)M[n[T].key]=T;const I=[],A=new Map,x=new Map,L=[];for(T=j;T--;){const z=m(a,s,T),d=t(z);let g=l.get(d);g?L.push(()=>g.p(z,e)):(g=v(d,z),g.c()),A.set(d,I[T]=g),d in M&&x.set(d,Math.abs(T-M[d]))}const D=new Set,R=new Set;function O(z){Ht(z,1),z.m(i,b),l.set(z.key,z),b=z.first,j--}for(;C&&j;){const z=I[j-1],d=n[C-1],g=z.key,p=d.key;z===d?(b=z.first,C--,j--):A.has(p)?!l.has(g)||D.has(g)?O(z):R.has(p)?C--:x.get(g)>x.get(p)?(R.add(g),O(z)):(D.add(p),C--):(f(d,l),C--)}for(;C--;){const z=n[C];A.has(z.key)||f(z,l)}for(;j;)O(I[j-1]);return Ln(L),I}function Fn(n){n&&n.c()}function kn(n,e,t){const{fragment:o,after_update:a}=n.$$;o&&o.m(e,t),Wi(()=>{const s=n.$$.on_mount.map(ou).filter(au);n.$$.on_destroy?n.$$.on_destroy.push(...s):Ln(s),n.$$.on_mount=[]}),a.forEach(Wi)}function Sn(n,e){const t=n.$$;t.fragment!==null&&(Af(t.after_update),Ln(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function $f(n,e){n.$$.dirty[0]===-1&&(uo.push(n),bf(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function zn(n,e,t,o,a,s,l=null,i=[-1]){const f=fa;Zo(n);const v=n.$$={fragment:null,ctx:[],props:s,update:Gt,not_equal:a,bound:Ns(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Ns(),dirty:i,skip_bound:!1,root:e.target||f.$$.root};l&&l(v.root);let b=!1;if(v.ctx=t?t(n,e.props||{},(m,C,...j)=>{const T=j.length?j[0]:C;return v.ctx&&a(v.ctx[m],v.ctx[m]=T)&&(!v.skip_bound&&v.bound[m]&&v.bound[m](T),b&&$f(n,m)),C}):[],v.update(),b=!0,Ln(v.before_update),v.fragment=o?o(v.ctx):!1,e.target){if(e.hydrate){const m=gf(e.target);v.fragment&&v.fragment.l(m),m.forEach(Nt)}else v.fragment&&v.fragment.c();e.intro&&Ht(n.$$.fragment),kn(n,e.target,e.anchor),uu()}Zo(f)}class Dn{constructor(){je(this,"$$"),je(this,"$$set")}$destroy(){Sn(this,1),this.$destroy=Gt}$on(e,t){if(!au(t))return Gt;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{const a=o.indexOf(t);a!==-1&&o.splice(a,1)}}$set(e){this.$$set&&!sf(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const kf="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(kf);function Sf(n){let e,t;return{c(){e=tn("svg"),t=tn("path"),de(t,"d","M13.12.706a.982.982 0 0 0-1.391 0L6.907 5.517 2.087.696a.982.982 0 1 0-1.391 1.39l4.821 4.821L.696 11.73a.982.982 0 1 0 1.39 1.39l4.821-4.821 4.822 4.821a.982.982 0 1 0 1.39-1.39L8.298 6.908l4.821-4.822a.988.988 0 0 0 0-1.38Z"),de(e,"viewBox","0 0 14 14"),de(e,"width","13"),de(e,"height","13"),de(e,"class","svelte-en2qvf")},m(o,a){Ft(o,e,a),pt(e,t)},p:Gt,i:Gt,o:Gt,d(o){o&&Nt(e)}}}class cu extends Dn{constructor(e){super(),zn(this,e,null,Sf,jn,{})}}function Ef(n){let e,t;return{c(){e=tn("svg"),t=tn("path"),de(t,"d","M15 0C6.705 0 0 6.705 0 15C0 23.295 6.705 30 15 30C23.295 30 30 23.295 30 15C30 6.705 23.295 0 15 0ZM22.5 20.385L20.385 22.5L15 17.115L9.615 22.5L7.5 20.385L12.885 15L7.5 9.615L9.615 7.5L15 12.885L20.385 7.5L22.5 9.615L17.115 15L22.5 20.385Z"),de(e,"viewBox","0 0 30 30"),de(e,"fill","none"),de(e,"xmlns","http://www.w3.org/2000/svg"),de(e,"class","svelte-d2loi5")},m(o,a){Ft(o,e,a),pt(e,t)},p:Gt,i:Gt,o:Gt,d(o){o&&Nt(e)}}}class du extends Dn{constructor(e){super(),zn(this,e,null,Ef,jn,{})}}function Lf(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"area.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"area.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Cf(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"reverse.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"reverse.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Mf(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"poi.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"poi.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Pf(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"postal_code.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"postal_code.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function If(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"street.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"street.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Tf(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"road.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"road.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Rf(n){let e,t;return{c(){e=Ct("img"),_r(e.src,t=n[3]+"housenumber.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!_r(e.src,t=o[3]+"housenumber.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function Nf(n){let e,t,o,a;return{c(){e=Ct("img"),_r(e.src,t=n[5])||de(e,"src",t),de(e,"alt",n[4]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(s,l){Ft(s,e,l),o||(a=ar(e,"error",n[14]),o=!0)},p(s,l){l&32&&!_r(e.src,t=s[5])&&de(e,"src",t),l&16&&de(e,"alt",s[4]),l&128&&de(e,"title",s[7])},d(s){s&&Nt(e),o=!1,a()}}}function Bf(n){let e,t;return{c(){e=Ct("div"),de(e,"class","sprite-icon svelte-w9y5n9"),de(e,"style",t=`
        width: ${n[6].width/Dr}px;
        height: ${n[6].height/Dr}px;
        background-image: url(${n[3]}sprite${Hi}.png);
        background-position: -${n[6].x/Dr}px -${n[6].y/Dr}px;
        background-size: ${cn.width/Dr}px ${cn.height/Dr}px;
      `),de(e,"title",n[7])},m(o,a){Ft(o,e,a)},p(o,a){a&72&&t!==(t=`
        width: ${o[6].width/Dr}px;
        height: ${o[6].height/Dr}px;
        background-image: url(${o[3]}sprite${Hi}.png);
        background-position: -${o[6].x/Dr}px -${o[6].y/Dr}px;
        background-size: ${cn.width/Dr}px ${cn.height/Dr}px;
      `)&&de(e,"style",t),a&128&&de(e,"title",o[7])},d(o){o&&Nt(e)}}}function js(n){let e,t;return{c(){e=Ct("span"),t=Bn(n[7]),de(e,"class","secondary svelte-w9y5n9")},m(o,a){Ft(o,e,a),pt(e,t)},p(o,a){a&128&&da(t,o[7])},d(o){o&&Nt(e)}}}function Ff(n){let e,t,o,a,s,l,i,f,v,b=(n[8]?n[0].place_name:n[0].place_name.replace(/,.*/,""))+"",m,C,j=n[2]==="always"||n[2]!=="never"&&!n[0].address&&!n[0].id.startsWith("road.")&&!n[0].id.startsWith("address.")&&!n[0].id.startsWith("postal_code.")&&(!n[0].id.startsWith("poi.")||!n[5])&&!n[8],T,M,I=(n[8]?"":n[0].place_name.replace(/[^,]*,?\s*/,""))+"",A,x,L,D,R,O;function z($,w){return w&1&&(t=null),w&1&&(o=null),w&1&&(a=null),w&1&&(s=null),cn&&$[6]?Bf:$[5]?Nf:$[0].address?Rf:(t==null&&(t=!!$[0].id.startsWith("road.")),t?Tf:(o==null&&(o=!!$[0].id.startsWith("address.")),o?If:(a==null&&(a=!!$[0].id.startsWith("postal_code.")),a?Pf:(s==null&&(s=!!$[0].id.startsWith("poi.")),s?Mf:$[8]?Cf:Lf))))}let d=z(n,-1),g=d(n),p=j&&js(n);return{c(){e=Ct("li"),g.c(),l=Rr(),i=Ct("span"),f=Ct("span"),v=Ct("span"),m=Bn(b),C=Rr(),p&&p.c(),T=Rr(),M=Ct("span"),A=Bn(I),de(v,"class","primary svelte-w9y5n9"),de(f,"class","svelte-w9y5n9"),de(M,"class","line2 svelte-w9y5n9"),de(i,"class","texts svelte-w9y5n9"),de(e,"tabindex","-1"),de(e,"role","option"),de(e,"aria-selected",x=n[1]==="selected"),de(e,"aria-checked",L=n[1]==="picked"),de(e,"class",D=Ja(n[1])+" svelte-w9y5n9")},m($,w){Ft($,e,w),g.m(e,null),pt(e,l),pt(e,i),pt(i,f),pt(f,v),pt(v,m),pt(f,C),p&&p.m(f,null),pt(i,T),pt(i,M),pt(M,A),R||(O=[ar(e,"mouseenter",n[13]),ar(e,"focus",n[15]),ar(e,"click",n[16])],R=!0)},p($,[w]){d===(d=z($,w))&&g?g.p($,w):(g.d(1),g=d($),g&&(g.c(),g.m(e,l))),w&257&&b!==(b=($[8]?$[0].place_name:$[0].place_name.replace(/,.*/,""))+"")&&da(m,b),w&293&&(j=$[2]==="always"||$[2]!=="never"&&!$[0].address&&!$[0].id.startsWith("road.")&&!$[0].id.startsWith("address.")&&!$[0].id.startsWith("postal_code.")&&(!$[0].id.startsWith("poi.")||!$[5])&&!$[8]),j?p?p.p($,w):(p=js($),p.c(),p.m(f,null)):p&&(p.d(1),p=null),w&257&&I!==(I=($[8]?"":$[0].place_name.replace(/[^,]*,?\s*/,""))+"")&&da(A,I),w&2&&x!==(x=$[1]==="selected")&&de(e,"aria-selected",x),w&2&&L!==(L=$[1]==="picked")&&de(e,"aria-checked",L),w&2&&D!==(D=Ja($[1])+" svelte-w9y5n9")&&de(e,"class",D)},i:Gt,o:Gt,d($){$&&Nt(e),g.d(),p&&p.d(),R=!1,Ln(O)}}}const fu=typeof devicePixelRatio>"u"?1:devicePixelRatio>1.25,Hi=fu?"@2x":"",Dr=fu?2:1;let cn,La;function Of(n,e,t){let o,a,s,{feature:l}=e,{style:i="default"}=e,{showPlaceType:f}=e,{missingIconsCache:v}=e,{iconsBaseUrl:b}=e;const m=lu();let C,j,T,M;function I(){La??(La=fetch(`${b}sprite${Hi}.json`).then(d=>d.json()).then(d=>{cn=d}).catch(()=>{cn=null}))}function A(){j&&v.add(j),x()}function x(){cn!==void 0?L():(I(),La?.then(L))}function L(){do{if(M--,t(4,C=o?.[M]),t(6,T=C?cn?.icons[C]:void 0),T)break;t(5,j=C?b+C.replace(/ /g,"_")+".svg":void 0)}while(M>-1&&(!j||v.has(j)))}function D(d){hf.call(this,n,d)}const R=()=>A(),O=()=>m("select",void 0),z=d=>{document.activeElement!==d.target&&m("select",void 0)};return n.$$set=d=>{"feature"in d&&t(0,l=d.feature),"style"in d&&t(1,i=d.style),"showPlaceType"in d&&t(2,f=d.showPlaceType),"missingIconsCache"in d&&t(11,v=d.missingIconsCache),"iconsBaseUrl"in d&&t(3,b=d.iconsBaseUrl)},n.$$.update=()=>{var d,g,p,$,w;n.$$.dirty&1&&t(12,o=(d=l.properties)==null?void 0:d.categories),n.$$.dirty&1&&t(8,a=l.place_type[0]==="reverse"),n.$$.dirty&1&&t(7,s=((p=(g=l.properties)==null?void 0:g.categories)==null?void 0:p.join(", "))??((w=($=l.properties)==null?void 0:$.place_type_name)==null?void 0:w[0])??l.place_type[0]),n.$$.dirty&4096&&(M=o?.length??0,x())},[l,i,f,b,C,j,T,s,a,m,A,v,o,D,R,O,z]}class jf extends Dn{constructor(e){super(),zn(this,e,Of,Ff,jn,{feature:0,style:1,showPlaceType:2,missingIconsCache:11,iconsBaseUrl:3})}}function zf(n){let e;return{c(){e=Ct("div"),e.innerHTML='<svg viewBox="0 0 18 18" width="24" height="24" class="loading-icon svelte-1ocfouu"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"></path><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"></path></svg>',de(e,"class","svelte-1ocfouu")},m(t,o){Ft(t,e,o)},p:Gt,i:Gt,o:Gt,d(t){t&&Nt(e)}}}class Df extends Dn{constructor(e){super(),zn(this,e,null,zf,jn,{})}}function Uf(n){let e,t,o;return{c(){e=tn("svg"),t=tn("path"),de(t,"stroke-width","4"),de(t,"d","M 5,33.103579 C 5,17.607779 18.457,5 35,5 C 51.543,5 65,17.607779 65,33.103579 C 65,56.388679 40.4668,76.048179 36.6112,79.137779 C 36.3714,79.329879 36.2116,79.457979 36.1427,79.518879 C 35.8203,79.800879 35.4102,79.942779 35,79.942779 C 34.5899,79.942779 34.1797,79.800879 33.8575,79.518879 C 33.7886,79.457979 33.6289,79.330079 33.3893,79.138079 C 29.5346,76.049279 5,56.389379 5,33.103579 Z M 35.0001,49.386379 C 43.1917,49.386379 49.8323,42.646079 49.8323,34.331379 C 49.8323,26.016779 43.1917,19.276479 35.0001,19.276479 C 26.8085,19.276479 20.1679,26.016779 20.1679,34.331379 C 20.1679,42.646079 26.8085,49.386379 35.0001,49.386379 Z"),de(t,"class","svelte-gzo3ar"),de(e,"width",o=n[0]==="list"?20:void 0),de(e,"viewBox","0 0 70 85"),de(e,"fill","none"),de(e,"class","svelte-gzo3ar"),dn(e,"in-map",n[0]!=="list"),dn(e,"list-icon",n[0]==="list")},m(a,s){Ft(a,e,s),pt(e,t)},p(a,[s]){s&1&&o!==(o=a[0]==="list"?20:void 0)&&de(e,"width",o),s&1&&dn(e,"in-map",a[0]!=="list"),s&1&&dn(e,"list-icon",a[0]==="list")},i:Gt,o:Gt,d(a){a&&Nt(e)}}}function Gf(n,e,t){let{displayIn:o}=e;return n.$$set=a=>{"displayIn"in a&&t(0,o=a.displayIn)},[o]}class Wf extends Dn{constructor(e){super(),zn(this,e,Gf,Uf,jn,{displayIn:0})}}function Hf(n){let e,t;return{c(){e=tn("svg"),t=tn("path"),de(t,"d","M30.003-26.765C13.46-26.765 0-14.158 0 1.337c0 23.286 24.535 42.952 28.39 46.04.24.192.402.316.471.376.323.282.732.424 1.142.424.41 0 .82-.142 1.142-.424.068-.06.231-.183.471-.376 3.856-3.09 28.39-22.754 28.39-46.04 0-15.495-13.46-28.102-30.003-28.102Zm1.757 12.469c4.38 0 7.858 1.052 10.431 3.158 2.595 2.105 3.89 4.913 3.89 8.422 0 2.34-.53 4.362-1.593 6.063-1.063 1.702-3.086 3.616-6.063 5.742-2.042 1.51-3.337 2.659-3.89 3.446-.532.787-.8 1.82-.8 3.096v1.914h-8.449V15.18c0-2.041.434-3.815 1.306-5.325.872-1.51 2.467-3.118 4.785-4.82 2.233-1.594 3.7-2.89 4.402-3.889a5.582 5.582 0 0 0 1.087-3.35c0-1.382-.51-2.435-1.531-3.158-1.02-.723-2.45-1.087-4.28-1.087-3.19 0-6.826 1.047-10.91 3.131l-3.472-6.986c4.742-2.659 9.77-3.992 15.087-3.992Zm-1.88 37.324c1.765 0 3.124.472 4.08 1.408.98.936 1.47 2.276 1.47 4.02 0 1.68-.49 3.007-1.47 3.985-.977.957-2.336 1.435-4.08 1.435-1.787 0-3.171-.465-4.15-1.4-.978-.958-1.47-2.298-1.47-4.02 0-1.787.48-3.14 1.436-4.054.957-.915 2.355-1.374 4.184-1.374Z"),de(e,"viewBox","0 0 60.006 21.412"),de(e,"width","14"),de(e,"height","20"),de(e,"class","svelte-en2qvf")},m(o,a){Ft(o,e,a),pt(e,t)},p:Gt,i:Gt,o:Gt,d(o){o&&Nt(e)}}}class qf extends Dn{constructor(e){super(),zn(this,e,null,Hf,jn,{})}}function Jf(n){let e,t,o;return{c(){e=tn("svg"),t=tn("circle"),o=tn("path"),de(t,"cx","4.789"),de(t,"cy","4.787"),de(t,"r","3.85"),de(t,"class","svelte-1aq105l"),de(o,"d","M12.063 12.063 7.635 7.635"),de(o,"class","svelte-1aq105l"),de(e,"xmlns","http://www.w3.org/2000/svg"),de(e,"width","13"),de(e,"height","13"),de(e,"viewBox","0 0 13 13"),de(e,"class","svelte-1aq105l")},m(a,s){Ft(a,e,s),pt(e,t),pt(e,o)},p:Gt,i:Gt,o:Gt,d(a){a&&Nt(e)}}}class Qf extends Dn{constructor(e){super(),zn(this,e,null,Jf,jn,{})}}function Zf(n,e,t){const o=e[1],a=e[0],s=o-a;return n===o&&t?n:((n-a)%s+s)%s+a}function Qa(n){const e=[...n];return e[2]<e[0]&&(Math.abs((e[0]+e[2]+360)/2)>Math.abs((e[0]-360+e[2])/2)?e[0]-=360:e[2]+=360),e}let Mo;async function Vf(n,e,t){const o=n?.getCenterAndZoom();for(const a of e??[])if(!(o&&(a.minZoom!=null&&a.minZoom>o[0]||a.maxZoom!=null&&a.maxZoom<o[0]))){if(a.type==="fixed")return a.coordinates.join(",");e:if(a.type==="client-geolocation"){if(Mo&&a.cachedLocationExpiry&&Mo.time+a.cachedLocationExpiry>Date.now()){if(!Mo.coords)break e;return Mo.coords}let s;try{return s=await new Promise((l,i)=>{t.signal.addEventListener("abort",()=>{i(Error("aborted"))}),navigator.geolocation.getCurrentPosition(f=>{l([f.coords.longitude,f.coords.latitude].map(v=>v.toFixed(6)).join(","))},f=>{i(f)},a)}),s}catch{}finally{a.cachedLocationExpiry&&(Mo={time:Date.now(),coords:s})}if(t.signal.aborted)return}if(a.type==="server-geolocation")return"ip";if(o&&a.type==="map-center")return o[1].toFixed(6)+","+o[2].toFixed(6)}}const Kf=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*(EAST|WEST|[EW])?$/i,zs=/^([+-]?[0-8]?[0-9])\s+([0-5]?[0-9]\.\d{3,})[\s,]{1,}([+-]?[0-1]?[0-9]?[0-9])\s+([0-5]?[0-9]\.\d{3,})$/,Ds=/^(NORTH|SOUTH|[NS])?[\s]*([+-]?[0-8]?[0-9](?:[\.,]\d{3,}))[\s]*([•º°]?)[\s]*(NORTH|SOUTH|[NS])?[\s]*[,/;]?[\s]*(EAST|WEST|[EW])?[\s]*([+-]?[0-1]?[0-9]?[0-9](?:[\.,]\d{3,}))[\s]*([•º°]?)[\s]*(EAST|WEST|[EW])?$/i,Us=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(EAST|WEST|[EW])?$/i,Gs=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)\s*(EAST|WEST|[EW])?$/i,Ws=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''|′′|’’|´´|["″”\.])?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([•º°\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['′´’\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''|′′|´´|’’|["″”\.])?\s*(EAST|WEST|[EW])?$/i;function Xf(n){if(!["DMS","DM","DD"].includes(n))throw new Error("invalid format specified");if(this.decimalCoordinates&&this.decimalCoordinates.trim()){const e=this.decimalCoordinates.split(",").map(j=>Number(j.trim())),t=Number(e[0]),o=Number(e[1]),a=Math.abs(t),s=Math.abs(o),l=t>0?"N":"S",i=o>0?"E":"W";let f;n=="DD"&&(f=`${a}° ${l}, ${s}° ${i}`);const v=Math.floor(a),b=Math.floor(s),m=(a-v)*60,C=(s-b)*60;if(n=="DM"){let j=Hs(m,3).toFixed(3).padStart(6,"0"),T=Hs(C,3).toFixed(3).padStart(6,"0");j.endsWith(".000")&&T.endsWith(".000")&&(j=j.replace(/\.000$/,""),T=T.replace(/\.000$/,"")),f=`${v}° ${j}' ${l}, ${b}° ${T}' ${i}`}if(n=="DMS"){const j=Math.floor(m),T=Math.floor(C);let M=((m-j)*60).toFixed(1).padStart(4,"0"),I=((C-T)*60).toFixed(1).padStart(4,"0");const A=j.toString().padStart(2,"0"),x=T.toString().padStart(2,"0");M.endsWith(".0")&&I.endsWith(".0")&&(M=M.replace(/\.0$/,""),I=I.replace(/\.0$/,"")),f=`${v}° ${A}' ${M}" ${l}, ${b}° ${x}' ${I}" ${i}`}return f}else throw new Error("no decimal coordinates to convert")}function Hs(n,e){const t=Math.pow(10,e);return Math.round((n+Number.EPSILON)*t)/t}function ds(n,e){e||(e=5),n=n.replace(/\s+/g," ").trim();let t=null,o=null,a="",s="",l=null,i=[],f=!1;if(Kf.test(n))throw new Error("invalid coordinate value");if(zs.test(n))if(i=zs.exec(n),f=Po(i),f)t=Math.abs(i[1])+i[2]/60,Number(i[1])<0&&(t*=-1),o=Math.abs(i[3])+i[4]/60,Number(i[3])<0&&(o*=-1),l="DM";else throw new Error("invalid coordinate format");else if(Ds.test(n))if(i=Ds.exec(n),f=Po(i),f){if(t=i[2],o=i[6],t.includes(",")&&(t=t.replace(",",".")),o.includes(",")&&(o=o.replace(",",".")),l="DD",Number(Math.round(t))==Number(t))throw new Error("integer only coordinate provided");if(Number(Math.round(o))==Number(o))throw new Error("integer only coordinate provided");i[1]?(a=i[1],s=i[5]):i[4]&&(a=i[4],s=i[8])}else throw new Error("invalid decimal coordinate format");else if(Us.test(n))if(i=Us.exec(n),f=Po(i),f)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4]/60,l="DM"),i[6]&&(t+=i[6].replace(",",".")/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[9])),i[11]&&(o+=i[11]/60),i[13]&&(o+=i[13].replace(",",".")/3600),parseInt(i[9])<0&&(o=-1*o),i[1]?(a=i[1],s=i[8]):i[7]&&(a=i[7],s=i[14]);else throw new Error("invalid DMS coordinates format");else if(Gs.test(n))if(i=Gs.exec(n),f=Po(i),f)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4]/60,l="DM"),i[6]&&(t+=i[6]/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[10])),i[12]&&(o+=i[12]/60),i[14]&&(o+=i[14]/3600),parseInt(i[10])<0&&(o=-1*o),i[1]?(a=i[1],s=i[9]):i[8]&&(a=i[8],s=i[16]);else throw new Error("invalid DMS coordinates format");else if(Ws.test(n)){if(i=Ws.exec(n),f=Po(i),i.filter(v=>v).length<=5)throw new Error("invalid coordinates format");if(f)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4].replace(",",".")/60,l="DM"),i[6]&&(t+=i[6].replace(",",".")/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[10])),i[12]&&(o+=i[12].replace(",",".")/60),i[14]&&(o+=i[14].replace(",",".")/3600),parseInt(i[10])<0&&(o=-1*o),i[1]?(a=i[1],s=i[9]):i[8]&&(a=i[8],s=i[16]);else throw new Error("invalid coordinates format")}if(f){if(Math.abs(o)>=180)throw new Error("invalid longitude value");if(Math.abs(t)>=90)throw new Error("invalid latitude value");if(a&&!s||!a&&s)throw new Error("invalid coordinates value");if(a&&a==s)throw new Error("invalid coordinates format");t.toString().includes(",")&&(t=t.replace(",",".")),o.toString().includes(",")&&(o=o.replace(",","."));let v=/S|SOUTH/i;v.test(a)&&t>0&&(t=-1*t),v=/W|WEST/i,v.test(s)&&o>0&&(o=-1*o);const b=i[0].trim();let m,C;const j=/[,/;\u0020]/g,T=b.match(j);if(T==null){const A=Math.floor(n.length/2);m=b.substring(0,A).trim(),C=b.substring(A).trim()}else{let A;T.length%2==1?A=Math.floor(T.length/2):A=T.length/2-1;let x=0;if(A==0)x=b.indexOf(T[0]),m=b.substring(0,x).trim(),C=b.substring(x+1).trim();else{let L=0,D=0;for(;L<=A;)x=b.indexOf(T[L],D),D=x+1,L++;m=b.substring(0,x).trim(),C=b.substring(x+1).trim()}}const M=m.split(".");if(M.length==2&&M[1]==0&&M[1].length!=2)throw new Error("invalid coordinates format");const I=C.split(".");if(I.length==2&&I[1]==0&&I[1].length!=2)throw new Error("invalid coordinates format");if(/^\d+$/.test(m)||/^\d+$/.test(C))throw new Error("degree only coordinate/s provided");return t=Number(Number(t).toFixed(e)),o=Number(Number(o).toFixed(e)),Object.freeze({verbatimCoordinates:b,verbatimLatitude:m,verbatimLongitude:C,decimalLatitude:t,decimalLongitude:o,decimalCoordinates:`${t},${o}`,originalFormat:l,closeEnough:Yf,toCoordinateFormat:Xf})}else throw new Error("coordinates pattern match failed")}function Po(n){if(!isNaN(n[0]))return!1;const e=[...n];if(e.shift(),e.length%2>0)return!1;const t=/^[-+]?\d+([\.,]\d+)?$/,o=/[eastsouthnorthwest]+/i,a=e.length/2;for(let s=0;s<a;s++){const l=e[s],i=e[s+a],f=t.test(l)&&t.test(i),v=o.test(l)&&o.test(i),b=l==i;if(!(l==null&&i==null)){if(l==null||i==null)return!1;if(f||v||b)continue;return!1}}return!0}function qs(n,e){const t=Math.abs(n-e);return Number(t.toFixed(6))<=1e-5}function Yf(n){if(!n)throw new Error("coords must be provided");if(n.includes(",")){const e=n.split(",");if(Number(e[0])==NaN||Number(e[1])==NaN)throw new Error("coords are not valid decimals");return qs(this.decimalLatitude,Number(e[0]))&&qs(this.decimalLongitude,e[1])}else throw new Error("coords being tested must be separated by a comma")}const ev=Object.freeze({DMS:"DMS",DM:"DM",DD:"DD"});ds.to=ev;const tv=[{verbatimCoordinates:"40.123, -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123° N 74.123° W",verbatimLatitude:"40.123° N",verbatimLongitude:"74.123° W"},{verbatimCoordinates:"40.123° N 74.123° W",verbatimLatitude:"40.123° N",verbatimLongitude:"74.123° W"},{verbatimCoordinates:'40° 7´ 22.8" N 74° 7´ 22.8" W',verbatimLatitude:'40° 7´ 22.8" N',verbatimLongitude:'74° 7´ 22.8" W'},{verbatimCoordinates:"40° 7.38’ , -74° 7.38’",verbatimLatitude:"40° 7.38’",verbatimLongitude:"-74° 7.38’"},{verbatimCoordinates:"N40°7’22.8’’, W74°7’22.8’’",verbatimLatitude:"N40°7’22.8’’",verbatimLongitude:"W74°7’22.8’’"},{verbatimCoordinates:'40°7’22.8"N, 74°7’22.8"W',verbatimLatitude:'40°7’22.8"N',verbatimLongitude:'74°7’22.8"W'},{verbatimCoordinates:`40°7'22.8"N, 74°7'22.8"W`,verbatimLatitude:`40°7'22.8"N`,verbatimLongitude:`74°7'22.8"W`},{verbatimCoordinates:"40 7 22.8, -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"},{verbatimCoordinates:"40.123 -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123°,-74.123°",verbatimLatitude:"40.123°",verbatimLongitude:"-74.123°"},{verbatimCoordinates:"40.123N74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"4007.38N7407.38W",verbatimLatitude:"4007.38N",verbatimLongitude:"7407.38W"},{verbatimCoordinates:'40°7’22.8"N, 74°7’22.8"W',verbatimLatitude:'40°7’22.8"N',verbatimLongitude:'74°7’22.8"W'},{verbatimCoordinates:"400722.8N740722.8W",verbatimLatitude:"400722.8N",verbatimLongitude:"740722.8W"},{verbatimCoordinates:"N 40 7.38 W 74 7.38",verbatimLatitude:"N 40 7.38",verbatimLongitude:"W 74 7.38"},{verbatimCoordinates:"40:7:22.8N 74:7:22.8W",verbatimLatitude:"40:7:22.8N",verbatimLongitude:"74:7:22.8W"},{verbatimCoordinates:"40:7:23N,74:7:23W",verbatimLatitude:"40:7:23N",verbatimLongitude:"74:7:23W",decimalLatitude:40.1230555555,decimalLongitude:-74.1230555555},{verbatimCoordinates:'40°7’23"N 74°7’23"W',verbatimLatitude:'40°7’23"N',verbatimLongitude:'74°7’23"W',decimalLatitude:40.1230555555,decimalLongitude:-74.12305555555555},{verbatimCoordinates:'40°7’23"S 74°7’23"E',verbatimLatitude:'40°7’23"S',verbatimLongitude:'74°7’23"E',decimalLatitude:-40.1230555555,decimalLongitude:74.12305555555555},{verbatimCoordinates:'40°7’23" -74°7’23"',verbatimLatitude:'40°7’23"',verbatimLongitude:'-74°7’23"',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:'40d 7’ 23" N 74d 7’ 23" W',verbatimLatitude:'40d 7’ 23" N',verbatimLongitude:'74d 7’ 23" W',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:"40.123N 74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"40° 7.38, -74° 7.38",verbatimLatitude:"40° 7.38",verbatimLongitude:"-74° 7.38"},{verbatimCoordinates:"40° 7.38, -74° 7.38",verbatimLatitude:"40° 7.38",verbatimLongitude:"-74° 7.38"},{verbatimCoordinates:"40 7 22.8; -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"}],rv={decimalLatitude:40.123,decimalLongitude:-74.123},nv=[{verbatimCoordinates:`50°4'17.698"south, 14°24'2.826"east`,verbatimLatitude:`50°4'17.698"south`,verbatimLongitude:`14°24'2.826"east`,decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"50d4m17.698S 14d24m2.826E",verbatimLatitude:"50d4m17.698S",verbatimLongitude:"14d24m2.826E",decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"40:26:46N,79:56:55W",verbatimLatitude:"40:26:46N",verbatimLongitude:"79:56:55W",decimalLatitude:40.44611111111111,decimalLongitude:-79.9486111111111},{verbatimCoordinates:"40:26:46.302N 79:56:55.903W",verbatimLatitude:"40:26:46.302N",verbatimLongitude:"79:56:55.903W",decimalLatitude:40.446195,decimalLongitude:-79.94886194444445},{verbatimCoordinates:"40°26′47″N 79°58′36″W",verbatimLatitude:"40°26′47″N",verbatimLongitude:"79°58′36″W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40d 26′ 47″ N 79d 58′ 36″ W",verbatimLatitude:"40d 26′ 47″ N",verbatimLongitude:"79d 58′ 36″ W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40.446195N 79.948862W",verbatimLatitude:"40.446195N",verbatimLongitude:"79.948862W",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40,446195° 79,948862°",verbatimLatitude:"40,446195°",verbatimLongitude:"79,948862°",decimalLatitude:40.446195,decimalLongitude:79.948862},{verbatimCoordinates:"40° 26.7717, -79° 56.93172",verbatimLatitude:"40° 26.7717",verbatimLongitude:"-79° 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.446195, -79.948862",verbatimLatitude:"40.446195",verbatimLongitude:"-79.948862",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.123256; -74.123256",verbatimLatitude:"40.123256",verbatimLongitude:"-74.123256",decimalLatitude:40.123256,decimalLongitude:-74.123256},{verbatimCoordinates:"18°24S 22°45E",verbatimLatitude:"18°24S",verbatimLongitude:"22°45E",decimalLatitude:-18.4,decimalLongitude:22.75}],ov=[{verbatimCoordinates:"10.432342S 10.6345345E",verbatimLatitude:"10.432342S",verbatimLongitude:"10.6345345E",decimalLatitude:-10.432342,decimalLongitude:10.6345345},{verbatimCoordinates:"10.00S 10.00E",verbatimLatitude:"10.00S",verbatimLongitude:"10.00E",decimalLatitude:-10,decimalLongitude:10},{verbatimCoordinates:"00.00S 01.00E",verbatimLatitude:"00.00S",verbatimLongitude:"01.00E",decimalLatitude:0,decimalLongitude:1},{verbatimCoordinates:"18.24S 22.45E",verbatimLatitude:"18.24S",verbatimLongitude:"22.45E",decimalLatitude:-18.4,decimalLongitude:22.75},{verbatimCoordinates:"27deg 15min 45.2sec S 18deg 32min 53.7sec E",verbatimLatitude:"27deg 15min 45.2sec S",verbatimLongitude:"18deg 32min 53.7sec E",decimalLatitude:-27.262555555555554,decimalLongitude:18.54825},{verbatimCoordinates:"-23.3245° S / 28.2344° E",verbatimLatitude:"-23.3245° S",verbatimLongitude:"28.2344° E",decimalLatitude:-23.3245,decimalLongitude:28.2344},{verbatimCoordinates:"40° 26.7717 -79° 56.93172",verbatimLatitude:"40° 26.7717",verbatimLongitude:"-79° 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"27.15.45S 18.32.53E",verbatimLatitude:"27.15.45S",verbatimLongitude:"18.32.53E",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"-27.15.45 18.32.53",verbatimLatitude:"-27.15.45",verbatimLongitude:"18.32.53",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"27.15.45.2S 18.32.53.4E",verbatimLatitude:"27.15.45.2S",verbatimLongitude:"18.32.53.4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"27.15.45,2S 18.32.53,4E",verbatimLatitude:"27.15.45,2S",verbatimLongitude:"18.32.53,4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"S23.43563 °  E22.45634 °",verbatimLatitude:"S23.43563 °",verbatimLongitude:"E22.45634 °",decimalLatitude:-23.43563,decimalLongitude:22.45634},{verbatimCoordinates:"27,71372° S 23,07771° E",verbatimLatitude:"27,71372° S",verbatimLongitude:"23,07771° E",decimalLatitude:-27.71372,decimalLongitude:23.07771},{verbatimCoordinates:"27.45.34 S 23.23.23 E",verbatimLatitude:"27.45.34 S",verbatimLongitude:"23.23.23 E",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"S 27.45.34 E 23.23.23",verbatimLatitude:"S 27.45.34",verbatimLongitude:"E 23.23.23",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"53 16.3863,4 52.8171",verbatimLatitude:"53 16.3863",verbatimLongitude:"4 52.8171",decimalLatitude:53.273105,decimalLongitude:4.88029},{verbatimCoordinates:"50 8.2914,-5 2.4447",verbatimLatitude:"50 8.2914",verbatimLongitude:"-5 2.4447",decimalLatitude:50.13819,decimalLongitude:-5.040745},{verbatimCoordinates:"N 48° 30,6410', E 18° 57,4583'",verbatimLatitude:"N 48° 30,6410'",verbatimLongitude:"E 18° 57,4583'",decimalLatitude:48.51068,decimalLongitude:18.95764},{verbatimCoordinates:"1.23456, 18.33453",verbatimLatitude:"1.23456",verbatimLongitude:"18.33453",decimalLatitude:1.23456,decimalLongitude:18.33453}];function av(){const n=[];return tv.forEach(e=>{e.decimalLatitude?n.push(e):n.push({...e,...rv})}),[...n,...nv,...ov]}const iv=av();ds.formats=iv.map(n=>n.verbatimCoordinates);const sv=ds;function Js(n,e,t){const o=n.slice();return o[97]=e[t],o[99]=t,o}function Qs(n){let e,t,o,a,s;return t=new cu({}),{c(){e=Ct("button"),Fn(t.$$.fragment),de(e,"type","button"),de(e,"title",n[3]),de(e,"class","svelte-bz0zu3")},m(l,i){Ft(l,e,i),kn(t,e,null),o=!0,a||(s=ar(e,"click",n[78]),a=!0)},p(l,i){(!o||i[0]&8)&&de(e,"title",l[3])},i(l){o||(Ht(t.$$.fragment,l),o=!0)},o(l){nr(t.$$.fragment,l),o=!1},d(l){l&&Nt(e),Sn(t),a=!1,s()}}}function Zs(n){let e,t;return e=new Df({}),{c(){Fn(e.$$.fragment)},m(o,a){kn(e,o,a),t=!0},i(o){t||(Ht(e.$$.fragment,o),t=!0)},o(o){nr(e.$$.fragment,o),t=!1},d(o){Sn(e,o)}}}function Vs(n){let e,t,o,a,s;return t=new qf({}),{c(){e=Ct("button"),Fn(t.$$.fragment),de(e,"type","button"),de(e,"title",n[10]),de(e,"class","svelte-bz0zu3"),dn(e,"active",n[0])},m(l,i){Ft(l,e,i),kn(t,e,null),o=!0,a||(s=ar(e,"click",n[79]),a=!0)},p(l,i){(!o||i[0]&1024)&&de(e,"title",l[10]),(!o||i[0]&1)&&dn(e,"active",l[0])},i(l){o||(Ht(t.$$.fragment,l),o=!0)},o(l){nr(t.$$.fragment,l),o=!1},d(l){l&&Nt(e),Sn(t),a=!1,s()}}}function lv(n){let e,t=[],o=new Map,a,s,l,i=Os(n[13]);const f=v=>v[97].id+(v[97].address?","+v[97].address:"");for(let v=0;v<i.length;v+=1){let b=Js(n,i,v),m=f(b);o.set(m,t[v]=Ks(m,b))}return{c(){e=Ct("ul");for(let v=0;v<t.length;v+=1)t[v].c();de(e,"class","options svelte-bz0zu3"),de(e,"role","listbox")},m(v,b){Ft(v,e,b);for(let m=0;m<t.length;m+=1)t[m]&&t[m].m(e,null);a=!0,s||(l=[ar(e,"mouseleave",n[27]),ar(e,"blur",n[83]),ar(e,"keydown",n[23])],s=!0)},p(v,b){b[0]&102823936&&(i=Os(v[13]),Fo(),t=xf(t,b,f,1,v,i,o,e,wf,Ks,null,Js),Oo())},i(v){if(!a){for(let b=0;b<i.length;b+=1)Ht(t[b]);a=!0}},o(v){for(let b=0;b<t.length;b+=1)nr(t[b]);a=!1},d(v){v&&Nt(e);for(let b=0;b<t.length;b+=1)t[b].d();s=!1,Ln(l)}}}function uv(n){let e,t,o,a,s,l;return t=new du({}),{c(){e=Ct("div"),Fn(t.$$.fragment),o=Rr(),a=Ct("div"),s=Bn(n[8]),de(a,"class","svelte-bz0zu3"),de(e,"class","no-results svelte-bz0zu3")},m(i,f){Ft(i,e,f),kn(t,e,null),pt(e,o),pt(e,a),pt(a,s),l=!0},p(i,f){(!l||f[0]&256)&&da(s,i[8])},i(i){l||(Ht(t.$$.fragment,i),l=!0)},o(i){nr(t.$$.fragment,i),l=!1},d(i){i&&Nt(e),Sn(t)}}}function cv(n){let e="",t;return{c(){t=Bn(e)},m(o,a){Ft(o,t,a)},p:Gt,i:Gt,o:Gt,d(o){o&&Nt(t)}}}function dv(n){let e,t,o,a,s,l,i,f,v,b,m;return t=new du({}),f=new cu({}),{c(){e=Ct("div"),Fn(t.$$.fragment),o=Rr(),a=Ct("div"),s=Bn(n[7]),l=Rr(),i=Ct("button"),Fn(f.$$.fragment),de(a,"class","svelte-bz0zu3"),de(i,"class","svelte-bz0zu3"),de(e,"class","error svelte-bz0zu3")},m(C,j){Ft(C,e,j),kn(t,e,null),pt(e,o),pt(e,a),pt(a,s),pt(e,l),pt(e,i),kn(f,i,null),v=!0,b||(m=ar(i,"click",n[80]),b=!0)},p(C,j){(!v||j[0]&128)&&da(s,C[7])},i(C){v||(Ht(t.$$.fragment,C),Ht(f.$$.fragment,C),v=!0)},o(C){nr(t.$$.fragment,C),nr(f.$$.fragment,C),v=!1},d(C){C&&Nt(e),Sn(t),Sn(f),b=!1,m()}}}function Ks(n,e){var t;let o,a,s;function l(){return e[81](e[99])}function i(){return e[82](e[97])}return a=new jf({props:{feature:e[97],showPlaceType:e[11],style:e[15]===e[99]?"selected":((t=e[14])==null?void 0:t.id)===e[97].id?"picked":"default",missingIconsCache:e[21],iconsBaseUrl:e[12]}}),a.$on("mouseenter",l),a.$on("select",i),{key:n,first:null,c(){o=ff(),Fn(a.$$.fragment),this.first=o},m(f,v){Ft(f,o,v),kn(a,f,v),s=!0},p(f,v){var b;e=f;const m={};v[0]&8192&&(m.feature=e[97]),v[0]&2048&&(m.showPlaceType=e[11]),v[0]&57344&&(m.style=e[15]===e[99]?"selected":((b=e[14])==null?void 0:b.id)===e[97].id?"picked":"default"),v[0]&4096&&(m.iconsBaseUrl=e[12]),a.$set(m)},i(f){s||(Ht(a.$$.fragment,f),s=!0)},o(f){nr(a.$$.fragment,f),s=!1},d(f){f&&Nt(o),Sn(a,f)}}}function fv(n){let e,t,o,a,s,l,i,f,v,b,m,C,j,T,M,I,A,x,L,D=!1;s=new Qf({});let R=!n[20]&&Qs(n),O=n[20]&&Zs(),z=n[6]==="button"&&Vs(n);const d=n[70].default,g=lf(d,n,n[69],null),p=[dv,cv,uv,lv],$=[];function w(y,F){var k,N;return y[19]?0:!y[16]&&!y[4]?1:((k=y[13])==null?void 0:k.length)===0?2:(N=y[13])!=null&&N.length&&(y[16]||y[4])?3:-1}return~(T=w(n))&&(M=$[T]=p[T](n)),{c(){e=Rr(),t=Ct("form"),o=Ct("div"),a=Ct("button"),Fn(s.$$.fragment),l=Rr(),i=Ct("input"),f=Rr(),v=Ct("div"),R&&R.c(),b=Rr(),O&&O.c(),m=Rr(),z&&z.c(),C=Rr(),g&&g.c(),j=Rr(),M&&M.c(),de(a,"class","search-button svelte-bz0zu3"),de(a,"type","button"),de(i,"placeholder",n[9]),de(i,"aria-label",n[9]),de(i,"class","svelte-bz0zu3"),de(v,"class","clear-button-container svelte-bz0zu3"),dn(v,"displayable",n[1]!==""),de(o,"class","input-group svelte-bz0zu3"),de(t,"class",I=Ja(n[2])+" svelte-bz0zu3"),dn(t,"can-collapse",n[5]&&n[1]==="")},m(y,F){Ft(y,e,F),Ft(y,t,F),pt(t,o),pt(o,a),kn(s,a,null),pt(o,l),pt(o,i),n[72](i),Bs(i,n[1]),pt(o,f),pt(o,v),R&&R.m(v,null),pt(v,b),O&&O.m(v,null),pt(o,m),z&&z.m(o,null),pt(o,C),g&&g.m(o,null),pt(t,j),~T&&$[T].m(t,null),A=!0,x||(L=[ar(a,"click",n[71]),ar(i,"input",n[73]),ar(i,"focus",n[74]),ar(i,"blur",n[75]),ar(i,"click",n[76]),ar(i,"keydown",n[23]),ar(i,"input",n[24]),ar(i,"change",n[77]),ar(t,"submit",vf(n[22]))],x=!0)},p(y,F){(!A||F[0]&512)&&de(i,"placeholder",y[9]),(!A||F[0]&512)&&de(i,"aria-label",y[9]),F[0]&2&&i.value!==y[1]&&Bs(i,y[1]),y[20]?R&&(Fo(),nr(R,1,1,()=>{R=null}),Oo()):R?(R.p(y,F),F[0]&1048576&&Ht(R,1)):(R=Qs(y),R.c(),Ht(R,1),R.m(v,b)),y[20]?O?F[0]&1048576&&Ht(O,1):(O=Zs(),O.c(),Ht(O,1),O.m(v,null)):O&&(Fo(),nr(O,1,1,()=>{O=null}),Oo()),(!A||F[0]&2)&&dn(v,"displayable",y[1]!==""),y[6]==="button"?z?(z.p(y,F),F[0]&64&&Ht(z,1)):(z=Vs(y),z.c(),Ht(z,1),z.m(o,C)):z&&(Fo(),nr(z,1,1,()=>{z=null}),Oo()),g&&g.p&&(!A||F[2]&128)&&cf(g,d,y,y[69],A?uf(d,y[69]):df(y[69]),null);let k=T;T=w(y),T===k?~T&&$[T].p(y,F):(M&&(Fo(),nr($[k],1,1,()=>{$[k]=null}),Oo()),~T?(M=$[T],M?M.p(y,F):(M=$[T]=p[T](y),M.c()),Ht(M,1),M.m(t,null)):M=null),(!A||F[0]&4&&I!==(I=Ja(y[2])+" svelte-bz0zu3"))&&de(t,"class",I),(!A||F[0]&38)&&dn(t,"can-collapse",y[5]&&y[1]==="")},i(y){A||(Ht(D),Ht(s.$$.fragment,y),Ht(R),Ht(O),Ht(z),Ht(g,y),Ht(M),A=!0)},o(y){nr(D),nr(s.$$.fragment,y),nr(R),nr(O),nr(z),nr(g,y),nr(M),A=!1},d(y){y&&(Nt(e),Nt(t)),Sn(s),n[72](null),R&&R.d(),O&&O.d(),z&&z.d(),g&&g.d(y),~T&&$[T].d(),x=!1,Ln(L)}}}function vv(n,e,t){let o,a,s,{$$slots:l={},$$scope:i}=e;const f={continental_marine:4,country:4,major_landform:8,region:5,subregion:6,county:7,joint_municipality:8,joint_submunicipality:9,municipality:10,municipal_district:11,locality:12,neighbourhood:13,place:14,postal_code:14,road:16,poi:17,address:18,"poi.peak":15,"poi.shop":18,"poi.cafe":18,"poi.restaurant":18,"poi.aerodrome":13};let{class:v=void 0}=e,{apiKey:b=void 0}=e,{bbox:m=void 0}=e,{clearButtonTitle:C="clear"}=e,{clearOnBlur:j=!1}=e,{clearListOnPick:T=!1}=e,{keepListOpen:M=!1}=e,{collapsed:I=!1}=e,{country:A=void 0}=e,{debounceSearch:x=200}=e,{enableReverse:L="never"}=e,{errorMessage:D="Something went wrong…"}=e,{filter:R=()=>!0}=e,{flyTo:O=!0}=e,{fuzzyMatch:z=!0}=e,{language:d=void 0}=e,{limit:g=void 0}=e;const p=41415112612;let{reverseGeocodingLimit:$=p}=e,{mapController:w=void 0}=e,{minLength:y=2}=e,{noResultsMessage:F="Oops! Looks like you're trying to predict something that's not quite right. We can't seem to find what you're looking for. Maybe try double-checking your spelling or try a different search term. Keep on typing - we'll do our best to get you where you need to go!"}=e,{placeholder:k="Search"}=e,{proximity:N=[{type:"server-geolocation"}]}=e,{reverseActive:S=L==="always"}=e,{reverseButtonTitle:E="toggle reverse geocoding"}=e,{searchValue:B=""}=e,{pickedResultStyle:G="full-geometry"}=e,{showPlaceType:Q="if-needed"}=e,{showResultsWhileTyping:q=!0}=e,{selectFirst:X=!0}=e,{flyToSelected:ue=!1}=e,{markerOnSelected:te=!0}=e,{types:ne=void 0}=e;const oe=[];let{reverseGeocodingTypes:H=oe}=e,{exhaustiveReverseGeocoding:J=!1}=e,{excludeTypes:ee=!1}=e;const re=void 0;let{reverseGeocodingExcludeTypes:ae=re}=e,{zoom:Y=f}=e,{apiUrl:ie="https://api.maptiler.com/geocoding"}=e,{fetchParameters:_e={}}=e,{iconsBaseUrl:le="https://cdn.maptiler.com/maptiler-geocoding-control/v2.1.7/icons/"}=e,{adjustUrlQuery:fe=()=>{}}=e,{adjustUrl:se=()=>{}}=e;function Ae(ce){Ce.focus(ce)}function me(){Ce.blur()}function ke(ce,at=!0,Yt=!1){t(1,B=ce),at?(t(15,be=-1),rt()):(Et(void 0,!Yt,Yt),setTimeout(()=>{Ce.focus(),Ce.select()}))}function Se(){t(13,xe=void 0),t(14,he=void 0),t(15,be=-1)}function We(){t(64,Le=[]),t(14,he=void 0)}let xe,Le,he,Re="",Ce,be=-1,Me,Te=[],Ee,Ue,De,qe,Fe=!1;const He=new Set,Ze=lu();pf(()=>{w&&(w.setEventHandler(void 0),w.indicateReverse(!1),w.setSelectedMarker(-1),w.setFeatures(void 0,void 0,!1))});function rt(ce){if(t(17,Fe=!1),Ue&&(clearTimeout(Ue),Ue=void 0),be>-1&&xe)t(14,he=xe[be]),t(1,B=he.place_type[0]==="reverse"?he.place_name:he.place_name.replace(/,.*/,"")),t(19,Me=void 0),t(64,Le=void 0),t(15,be=-1);else if(B){const at=ce||!Ve(B);Ke(B,{exact:!0}).then(()=>{t(64,Le=xe),t(14,he=void 0),at&&vt()}).catch(Yt=>t(19,Me=Yt))}}function Ve(ce){try{return sv(ce,6)}catch{return!1}}async function Ke(ce,{byId:at=!1,exact:Yt=!1}={}){var jt,ir,br;t(19,Me=void 0),Ee?.abort();const kr=new AbortController;t(20,Ee=kr);try{const _t=Ve(ce),Sr=new URL(ie+"/"+encodeURIComponent(_t?_t.decimalLongitude+","+_t.decimalLatitude:ce)+".json"),ur=Sr.searchParams;d!==void 0&&ur.set("language",Array.isArray(d)?d.join(","):d??"");const[dt]=w?.getCenterAndZoom()??[];let st=(jt=!_t||H===oe?ne:H)==null?void 0:jt.map(zt=>typeof zt=="string"?zt:dt===void 0||(zt[0]??0)<=dt&&dt<(zt[1]??1/0)?zt[2]:void 0).filter(zt=>zt!==void 0);st&&(st=[...new Set(st)],ur.set("types",st.join(",")));const Ye=!_t||ae===re?ee:ae;if(Ye&&ur.set("excludeTypes",String(Ye)),m&&ur.set("bbox",m.map(zt=>zt.toFixed(6)).join(",")),A&&ur.set("country",Array.isArray(A)?A.join(","):A),!at&&!_t){const zt=await Vf(w,N,kr);zt&&ur.set("proximity",zt),(Yt||!q)&&ur.set("autocomplete","false"),ur.set("fuzzyMatch",String(z))}const Xe=$===p?g:$;Xe!==void 0&&Xe>1&&st?.length!==1&&console.warn("For reverse geocoding when limit > 1 then types must contain single value."),_t?(Xe===1||Xe!==void 0&&(J||st?.length===1))&&ur.set("limit",String(Xe)):g!==void 0&&ur.set("limit",String(g)),b&&ur.set("key",b),fe(ur),se(Sr);const wt=Sr.searchParams.get("types")===""&&Sr.searchParams.get("excludeTypes")!=="true",qt=Sr.toString();if(qt===Re){at?(T&&t(13,xe=void 0),t(14,he=Te[0])):(t(13,xe=Te),((ir=xe[be])==null?void 0:ir.id)!==a?.id&&t(15,be=-1));return}Re=qt;let Wt;if(wt)Wt={type:"FeatureCollection",features:[]};else{const zt=await fetch(qt,{signal:kr.signal,..._e});if(!zt.ok)throw new Error(await zt.text());Wt=await zt.json()}Ze("response",{url:qt,featureCollection:Wt}),at?(T&&t(13,xe=void 0),t(14,he=Wt.features[0]),Te=[he]):(t(13,xe=Wt.features.filter(R)),_t&&xe.unshift({type:"Feature",properties:{},id:"reverse_"+_t.decimalLongitude+"_"+_t.decimalLatitude,text:_t.decimalLatitude+", "+_t.decimalLongitude,place_name:_t.decimalLatitude+", "+_t.decimalLongitude,place_type:["reverse"],center:[_t.decimalLongitude,_t.decimalLatitude],bbox:[_t.decimalLongitude,_t.decimalLatitude,_t.decimalLongitude,_t.decimalLatitude],geometry:{type:"Point",coordinates:[_t.decimalLongitude,_t.decimalLatitude]}}),Te=xe,((br=xe[be])==null?void 0:br.id)!==a?.id&&t(15,be=-1),_t&&Ce.focus())}catch(_t){if(_t&&typeof _t=="object"&&"name"in _t&&_t.name==="AbortError")return;throw _t}finally{kr===Ee&&t(20,Ee=void 0)}}function vt(){var ce;if(!(Le!=null&&Le.length)||!O)return;const at=[180,90,-180,-90],Yt=!Le.some(ir=>!ir.matching_text);let jt;for(const ir of Le){const br=mt(ir);if(jt=jt===void 0?br:br===void 0?jt:Math.max(jt,br),Yt||!ir.matching_text)for(const kr of[0,1,2,3])at[kr]=Math[kr<2?"min":"max"](at[kr],((ce=ir.bbox)==null?void 0:ce[kr])??ir.center[kr%2])}w&&Le.length>0&&(he&&at[0]===at[2]&&at[1]===at[3]?w.flyTo(he.center,mt(he)):w.fitBounds(Qa(at),50,jt))}function xt(){!he||!w||(!he.bbox||he.bbox[0]===he.bbox[2]&&he.bbox[1]===he.bbox[3]?w.flyTo(he.center,mt(he)):w.fitBounds(Qa(he.bbox),50,mt(he)))}function mt(ce){var at;if(!ce.bbox||ce.bbox[0]!==ce.bbox[2]&&ce.bbox[1]!==ce.bbox[3])return;const Yt=ce.id.replace(/\..*/,"");return(Array.isArray((at=ce.properties)==null?void 0:at.categories)?ce.properties.categories.reduce((jt,ir)=>{const br=Y[Yt+"."+ir];return jt===void 0?br:br===void 0?jt:Math.max(jt,br)},void 0):void 0)??Y[Yt]}function Mt(ce){t(0,S=L==="always"),t(13,xe=void 0),t(14,he=void 0),t(15,be=-1),ke(ce[1].toFixed(6)+", "+Zf(ce[0],[-180,180],!0).toFixed(6),!1,!0)}function $t(ce){if(!xe)return;let at=ce.key==="ArrowDown"?1:ce.key==="ArrowUp"?-1:0;at&&(Ce.focus(),t(17,Fe=!0),ce.preventDefault(),he&&be===-1&&t(15,be=xe.findIndex(Yt=>Yt.id===he?.id)),be===(he||X?0:-1)&&at===-1&&t(15,be=xe.length),t(15,be+=at),be>=xe.length&&t(15,be=-1),be<0&&(he||X)&&t(15,be=0))}function Et(ce,at=!0,Yt=!1){if(t(19,Me=void 0),t(14,he=void 0),t(17,Fe=!0),q||Yt){if(Ue&&clearTimeout(Ue),B.length<y)return;const jt=B;Ue=window.setTimeout(()=>{Ke(jt).catch(ir=>t(19,Me=ir))},at?x:0)}else t(13,xe=void 0),t(19,Me=void 0)}function At(ce){he&&he?.id===ce?.id?xt():(t(14,he=ce),t(1,B=ce.place_name))}function Lt(ce){t(15,be=ce)}function Ot(){(!X||he)&&t(15,be=-1),ue&&xt()}const Kt=()=>Ce.focus();function Pt(ce){Ui[ce?"unshift":"push"](()=>{Ce=ce,t(18,Ce)})}function It(){B=this.value,t(1,B),t(17,Fe),t(31,j),t(16,De)}const lr=()=>t(17,Fe=!0),fr=()=>t(17,Fe=!1),Zr=()=>t(17,Fe=!0),Pr=()=>t(14,he=void 0),xr=()=>{t(1,B=""),t(14,he=void 0),Ce.focus()},Vr=()=>t(0,S=!S),on=()=>t(19,Me=void 0),Fr=ce=>Lt(ce),$r=ce=>At(ce),Or=()=>{};return n.$$set=ce=>{"class"in ce&&t(2,v=ce.class),"apiKey"in ce&&t(29,b=ce.apiKey),"bbox"in ce&&t(30,m=ce.bbox),"clearButtonTitle"in ce&&t(3,C=ce.clearButtonTitle),"clearOnBlur"in ce&&t(31,j=ce.clearOnBlur),"clearListOnPick"in ce&&t(32,T=ce.clearListOnPick),"keepListOpen"in ce&&t(4,M=ce.keepListOpen),"collapsed"in ce&&t(5,I=ce.collapsed),"country"in ce&&t(33,A=ce.country),"debounceSearch"in ce&&t(34,x=ce.debounceSearch),"enableReverse"in ce&&t(6,L=ce.enableReverse),"errorMessage"in ce&&t(7,D=ce.errorMessage),"filter"in ce&&t(35,R=ce.filter),"flyTo"in ce&&t(36,O=ce.flyTo),"fuzzyMatch"in ce&&t(37,z=ce.fuzzyMatch),"language"in ce&&t(38,d=ce.language),"limit"in ce&&t(39,g=ce.limit),"reverseGeocodingLimit"in ce&&t(40,$=ce.reverseGeocodingLimit),"mapController"in ce&&t(41,w=ce.mapController),"minLength"in ce&&t(42,y=ce.minLength),"noResultsMessage"in ce&&t(8,F=ce.noResultsMessage),"placeholder"in ce&&t(9,k=ce.placeholder),"proximity"in ce&&t(43,N=ce.proximity),"reverseActive"in ce&&t(0,S=ce.reverseActive),"reverseButtonTitle"in ce&&t(10,E=ce.reverseButtonTitle),"searchValue"in ce&&t(1,B=ce.searchValue),"pickedResultStyle"in ce&&t(44,G=ce.pickedResultStyle),"showPlaceType"in ce&&t(11,Q=ce.showPlaceType),"showResultsWhileTyping"in ce&&t(45,q=ce.showResultsWhileTyping),"selectFirst"in ce&&t(46,X=ce.selectFirst),"flyToSelected"in ce&&t(47,ue=ce.flyToSelected),"markerOnSelected"in ce&&t(48,te=ce.markerOnSelected),"types"in ce&&t(49,ne=ce.types),"reverseGeocodingTypes"in ce&&t(50,H=ce.reverseGeocodingTypes),"exhaustiveReverseGeocoding"in ce&&t(51,J=ce.exhaustiveReverseGeocoding),"excludeTypes"in ce&&t(52,ee=ce.excludeTypes),"reverseGeocodingExcludeTypes"in ce&&t(53,ae=ce.reverseGeocodingExcludeTypes),"zoom"in ce&&t(54,Y=ce.zoom),"apiUrl"in ce&&t(55,ie=ce.apiUrl),"fetchParameters"in ce&&t(56,_e=ce.fetchParameters),"iconsBaseUrl"in ce&&t(12,le=ce.iconsBaseUrl),"adjustUrlQuery"in ce&&t(57,fe=ce.adjustUrlQuery),"adjustUrl"in ce&&t(58,se=ce.adjustUrl),"$$scope"in ce&&t(69,i=ce.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&64&&t(0,S=L==="always"),n.$$.dirty[0]&16384|n.$$.dirty[1]&8192&&G!=="marker-only"&&he&&!he.address&&he.geometry.type==="Point"&&he.place_type[0]!=="reverse"&&Ke(he.id,{byId:!0}).catch(ce=>t(19,Me=ce)),n.$$.dirty[0]&16384|n.$$.dirty[1]&1058|n.$$.dirty[2]&8&&(w&&he&&he.id!==qe&&O&&(xt(),T&&t(13,xe=void 0),t(64,Le=void 0),t(15,be=-1)),t(65,qe=he?.id)),n.$$.dirty[0]&196608|n.$$.dirty[1]&1&&setTimeout(()=>{t(16,De=Fe),j&&!De&&t(1,B="")}),n.$$.dirty[0]&8194|n.$$.dirty[1]&2048&&B.length<y&&(t(13,xe=void 0),t(19,Me=void 0),t(64,Le=xe)),n.$$.dirty[0]&57344|n.$$.dirty[1]&32768&&X&&xe!=null&&xe.length&&be==-1&&!he&&t(15,be=0),n.$$.dirty[0]&8192|n.$$.dirty[2]&4&&Le!==xe&&t(64,Le=void 0),n.$$.dirty[0]&73729|n.$$.dirty[1]&1024|n.$$.dirty[2]&4&&w&&w.setEventHandler(ce=>{switch(ce.type){case"mapClick":S&&Mt(ce.coordinates);break;case"markerClick":{const at=xe?.find(Yt=>Yt.id===ce.id);at&&At(at)}break;case"markerMouseEnter":Le&&t(15,be=De?xe?.findIndex(at=>at.id===ce.id)??-1:-1);break;case"markerMouseLeave":Le&&t(15,be=-1);break}}),n.$$.dirty[0]&40960&&t(66,a=xe?.[be]),n.$$.dirty[1]&66592|n.$$.dirty[2]&16&&w&&a&&O&&ue&&w.flyTo(a.center,mt(a)),n.$$.dirty[1]&8192&&t(68,o=G==="full-geometry-including-polygon-center-marker"),n.$$.dirty[1]&132096|n.$$.dirty[2]&64&&(te||w==null||w.setFeatures(void 0,void 0,o)),n.$$.dirty[0]&16384|n.$$.dirty[1]&132096|n.$$.dirty[2]&84&&w&&te&&!Le&&(w.setFeatures(a?[a]:void 0,he,o),w.setSelectedMarker(a?0:-1)),n.$$.dirty[0]&16384|n.$$.dirty[1]&1024|n.$$.dirty[2]&68&&w&&w.setFeatures(Le,he,o),n.$$.dirty[0]&32768|n.$$.dirty[1]&1024|n.$$.dirty[2]&4&&Le&&w&&w.setSelectedMarker(be),n.$$.dirty[0]&2|n.$$.dirty[1]&1024&&w){const ce=Ve(B);w.setReverseMarker(ce?[ce.decimalLongitude,ce.decimalLatitude]:void 0)}n.$$.dirty[2]&16&&Ze("select",{feature:a}),n.$$.dirty[0]&16384&&Ze("pick",{feature:he}),n.$$.dirty[0]&73744&&t(67,s=!!(xe!=null&&xe.length)&&(De||M)),n.$$.dirty[2]&32&&Ze("optionsvisibilitychange",{optionsVisible:s}),n.$$.dirty[0]&8192&&Ze("featureslisted",{features:xe}),n.$$.dirty[2]&4&&Ze("featuresmarked",{features:Le}),n.$$.dirty[0]&1&&Ze("reversetoggle",{reverse:S}),n.$$.dirty[0]&2&&Ze("querychange",{query:B}),n.$$.dirty[0]&1|n.$$.dirty[1]&1024&&w&&w.indicateReverse(S)},[S,B,v,C,M,I,L,D,F,k,E,Q,le,xe,he,be,De,Fe,Ce,Me,Ee,He,rt,$t,Et,At,Lt,Ot,f,b,m,j,T,A,x,R,O,z,d,g,$,w,y,N,G,q,X,ue,te,ne,H,J,ee,ae,Y,ie,_e,fe,se,Ae,me,ke,Se,We,Le,qe,a,s,o,i,l,Kt,Pt,It,lr,fr,Zr,Pr,xr,Vr,on,Fr,$r,Or]}let gv=class extends Dn{constructor(n){super(),zn(this,n,vv,fv,jn,{ZOOM_DEFAULTS:28,class:2,apiKey:29,bbox:30,clearButtonTitle:3,clearOnBlur:31,clearListOnPick:32,keepListOpen:4,collapsed:5,country:33,debounceSearch:34,enableReverse:6,errorMessage:7,filter:35,flyTo:36,fuzzyMatch:37,language:38,limit:39,reverseGeocodingLimit:40,mapController:41,minLength:42,noResultsMessage:8,placeholder:9,proximity:43,reverseActive:0,reverseButtonTitle:10,searchValue:1,pickedResultStyle:44,showPlaceType:11,showResultsWhileTyping:45,selectFirst:46,flyToSelected:47,markerOnSelected:48,types:49,reverseGeocodingTypes:50,exhaustiveReverseGeocoding:51,excludeTypes:52,reverseGeocodingExcludeTypes:53,zoom:54,apiUrl:55,fetchParameters:56,iconsBaseUrl:12,adjustUrlQuery:57,adjustUrl:58,focus:59,blur:60,setQuery:61,clearList:62,clearMap:63},null,[-1,-1,-1,-1])}get ZOOM_DEFAULTS(){return this.$$.ctx[28]}get focus(){return this.$$.ctx[59]}get blur(){return this.$$.ctx[60]}get setQuery(){return this.$$.ctx[61]}get clearList(){return this.$$.ctx[62]}get clearMap(){return this.$$.ctx[63]}};function va(n,e,t={}){const o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=e||{},o.geometry=n,o}function fs(n,e,t={}){for(const o of n){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return va({type:"Polygon",coordinates:n},e,t)}function ga(n,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function vu(n,e,t={}){return va({type:"MultiPolygon",coordinates:n},e,t)}var _v=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,yi=Math.ceil,Gr=Math.floor,Er="[BigNumber Error] ",Xs=Er+"Number primitive has more than 15 significant digits: ",Kr=1e14,tt=14,Ys=9007199254740991,Ai=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],In=1e7,Tr=1e9;function gu(n){var e,t,o,a=x.prototype={constructor:x,toString:null,valueOf:null},s=new x(1),l=20,i=4,f=-7,v=21,b=-1e7,m=1e7,C=!1,j=1,T=0,M={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},I="0123456789abcdefghijklmnopqrstuvwxyz",A=!0;function x(d,g){var p,$,w,y,F,k,N,S,E=this;if(!(E instanceof x))return new x(d,g);if(g==null){if(d&&d._isBigNumber===!0){E.s=d.s,!d.c||d.e>m?E.c=E.e=null:d.e<b?E.c=[E.e=0]:(E.e=d.e,E.c=d.c.slice());return}if((k=typeof d=="number")&&d*0==0){if(E.s=1/d<0?(d=-d,-1):1,d===~~d){for(y=0,F=d;F>=10;F/=10,y++);y>m?E.c=E.e=null:(E.e=y,E.c=[d]);return}S=String(d)}else{if(!_v.test(S=String(d)))return o(E,S,k);E.s=S.charCodeAt(0)==45?(S=S.slice(1),-1):1}(y=S.indexOf("."))>-1&&(S=S.replace(".","")),(F=S.search(/e/i))>0?(y<0&&(y=F),y+=+S.slice(F+1),S=S.substring(0,F)):y<0&&(y=S.length)}else{if(Jt(g,2,I.length,"Base"),g==10&&A)return E=new x(d),O(E,l+E.e+1,i);if(S=String(d),k=typeof d=="number"){if(d*0!=0)return o(E,S,k,g);if(E.s=1/d<0?(S=S.slice(1),-1):1,x.DEBUG&&S.replace(/^0\.0*|\./,"").length>15)throw Error(Xs+d)}else E.s=S.charCodeAt(0)===45?(S=S.slice(1),-1):1;for(p=I.slice(0,g),y=F=0,N=S.length;F<N;F++)if(p.indexOf($=S.charAt(F))<0){if($=="."){if(F>y){y=N;continue}}else if(!w&&(S==S.toUpperCase()&&(S=S.toLowerCase())||S==S.toLowerCase()&&(S=S.toUpperCase()))){w=!0,F=-1,y=0;continue}return o(E,String(d),k,g)}k=!1,S=t(S,g,10,E.s),(y=S.indexOf("."))>-1?S=S.replace(".",""):y=S.length}for(F=0;S.charCodeAt(F)===48;F++);for(N=S.length;S.charCodeAt(--N)===48;);if(S=S.slice(F,++N)){if(N-=F,k&&x.DEBUG&&N>15&&(d>Ys||d!==Gr(d)))throw Error(Xs+E.s*d);if((y=y-F-1)>m)E.c=E.e=null;else if(y<b)E.c=[E.e=0];else{if(E.e=y,E.c=[],F=(y+1)%tt,y<0&&(F+=tt),F<N){for(F&&E.c.push(+S.slice(0,F)),N-=tt;F<N;)E.c.push(+S.slice(F,F+=tt));F=tt-(S=S.slice(F)).length}else F-=N;for(;F--;S+="0");E.c.push(+S)}}else E.c=[E.e=0]}x.clone=gu,x.ROUND_UP=0,x.ROUND_DOWN=1,x.ROUND_CEIL=2,x.ROUND_FLOOR=3,x.ROUND_HALF_UP=4,x.ROUND_HALF_DOWN=5,x.ROUND_HALF_EVEN=6,x.ROUND_HALF_CEIL=7,x.ROUND_HALF_FLOOR=8,x.EUCLID=9,x.config=x.set=function(d){var g,p;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(g="DECIMAL_PLACES")&&(p=d[g],Jt(p,0,Tr,g),l=p),d.hasOwnProperty(g="ROUNDING_MODE")&&(p=d[g],Jt(p,0,8,g),i=p),d.hasOwnProperty(g="EXPONENTIAL_AT")&&(p=d[g],p&&p.pop?(Jt(p[0],-1e9,0,g),Jt(p[1],0,Tr,g),f=p[0],v=p[1]):(Jt(p,-1e9,Tr,g),f=-(v=p<0?-p:p))),d.hasOwnProperty(g="RANGE"))if(p=d[g],p&&p.pop)Jt(p[0],-1e9,-1,g),Jt(p[1],1,Tr,g),b=p[0],m=p[1];else if(Jt(p,-1e9,Tr,g),p)b=-(m=p<0?-p:p);else throw Error(Er+g+" cannot be zero: "+p);if(d.hasOwnProperty(g="CRYPTO"))if(p=d[g],p===!!p)if(p)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))C=p;else throw C=!p,Error(Er+"crypto unavailable");else C=p;else throw Error(Er+g+" not true or false: "+p);if(d.hasOwnProperty(g="MODULO_MODE")&&(p=d[g],Jt(p,0,9,g),j=p),d.hasOwnProperty(g="POW_PRECISION")&&(p=d[g],Jt(p,0,Tr,g),T=p),d.hasOwnProperty(g="FORMAT"))if(p=d[g],typeof p=="object")M=p;else throw Error(Er+g+" not an object: "+p);if(d.hasOwnProperty(g="ALPHABET"))if(p=d[g],typeof p=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(p))A=p.slice(0,10)=="0123456789",I=p;else throw Error(Er+g+" invalid: "+p)}else throw Error(Er+"Object expected: "+d);return{DECIMAL_PLACES:l,ROUNDING_MODE:i,EXPONENTIAL_AT:[f,v],RANGE:[b,m],CRYPTO:C,MODULO_MODE:j,POW_PRECISION:T,FORMAT:M,ALPHABET:I}},x.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!x.DEBUG)return!0;var g,p,$=d.c,w=d.e,y=d.s;e:if({}.toString.call($)=="[object Array]"){if((y===1||y===-1)&&w>=-1e9&&w<=Tr&&w===Gr(w)){if($[0]===0){if(w===0&&$.length===1)return!0;break e}if(g=(w+1)%tt,g<1&&(g+=tt),String($[0]).length==g){for(g=0;g<$.length;g++)if(p=$[g],p<0||p>=Kr||p!==Gr(p))break e;if(p!==0)return!0}}}else if($===null&&w===null&&(y===null||y===1||y===-1))return!0;throw Error(Er+"Invalid BigNumber: "+d)},x.maximum=x.max=function(){return D(arguments,-1)},x.minimum=x.min=function(){return D(arguments,1)},x.random=(function(){var d=9007199254740992,g=Math.random()*d&2097151?function(){return Gr(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(p){var $,w,y,F,k,N=0,S=[],E=new x(s);if(p==null?p=l:Jt(p,0,Tr),F=yi(p/tt),C)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(F*=2));N<F;)k=$[N]*131072+($[N+1]>>>11),k>=9e15?(w=crypto.getRandomValues(new Uint32Array(2)),$[N]=w[0],$[N+1]=w[1]):(S.push(k%1e14),N+=2);N=F/2}else if(crypto.randomBytes){for($=crypto.randomBytes(F*=7);N<F;)k=($[N]&31)*281474976710656+$[N+1]*1099511627776+$[N+2]*4294967296+$[N+3]*16777216+($[N+4]<<16)+($[N+5]<<8)+$[N+6],k>=9e15?crypto.randomBytes(7).copy($,N):(S.push(k%1e14),N+=7);N=F/7}else throw C=!1,Error(Er+"crypto unavailable");if(!C)for(;N<F;)k=g(),k<9e15&&(S[N++]=k%1e14);for(F=S[--N],p%=tt,F&&p&&(k=Ai[tt-p],S[N]=Gr(F/k)*k);S[N]===0;S.pop(),N--);if(N<0)S=[y=0];else{for(y=-1;S[0]===0;S.splice(0,1),y-=tt);for(N=1,k=S[0];k>=10;k/=10,N++);N<tt&&(y-=tt-N)}return E.e=y,E.c=S,E}})(),x.sum=function(){for(var d=1,g=arguments,p=new x(g[0]);d<g.length;)p=p.plus(g[d++]);return p},t=(function(){var d="0123456789";function g(p,$,w,y){for(var F,k=[0],N,S=0,E=p.length;S<E;){for(N=k.length;N--;k[N]*=$);for(k[0]+=y.indexOf(p.charAt(S++)),F=0;F<k.length;F++)k[F]>w-1&&(k[F+1]==null&&(k[F+1]=0),k[F+1]+=k[F]/w|0,k[F]%=w)}return k.reverse()}return function(p,$,w,y,F){var k,N,S,E,B,G,Q,q,X=p.indexOf("."),ue=l,te=i;for(X>=0&&(E=T,T=0,p=p.replace(".",""),q=new x($),G=q.pow(p.length-X),T=E,q.c=g(mn(Ur(G.c),G.e,"0"),10,w,d),q.e=q.c.length),Q=g(p,$,w,F?(k=I,d):(k=d,I)),S=E=Q.length;Q[--E]==0;Q.pop());if(!Q[0])return k.charAt(0);if(X<0?--S:(G.c=Q,G.e=S,G.s=y,G=e(G,q,ue,te,w),Q=G.c,B=G.r,S=G.e),N=S+ue+1,X=Q[N],E=w/2,B=B||N<0||Q[N+1]!=null,B=te<4?(X!=null||B)&&(te==0||te==(G.s<0?3:2)):X>E||X==E&&(te==4||B||te==6&&Q[N-1]&1||te==(G.s<0?8:7)),N<1||!Q[0])p=B?mn(k.charAt(1),-ue,k.charAt(0)):k.charAt(0);else{if(Q.length=N,B)for(--w;++Q[--N]>w;)Q[N]=0,N||(++S,Q=[1].concat(Q));for(E=Q.length;!Q[--E];);for(X=0,p="";X<=E;p+=k.charAt(Q[X++]));p=mn(p,S,k.charAt(0))}return p}})(),e=(function(){function d($,w,y){var F,k,N,S,E=0,B=$.length,G=w%In,Q=w/In|0;for($=$.slice();B--;)N=$[B]%In,S=$[B]/In|0,F=Q*N+S*G,k=G*N+F%In*In+E,E=(k/y|0)+(F/In|0)+Q*S,$[B]=k%y;return E&&($=[E].concat($)),$}function g($,w,y,F){var k,N;if(y!=F)N=y>F?1:-1;else for(k=N=0;k<y;k++)if($[k]!=w[k]){N=$[k]>w[k]?1:-1;break}return N}function p($,w,y,F){for(var k=0;y--;)$[y]-=k,k=$[y]<w[y]?1:0,$[y]=k*F+$[y]-w[y];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,w,y,F,k){var N,S,E,B,G,Q,q,X,ue,te,ne,oe,H,J,ee,re,ae,Y=$.s==w.s?1:-1,ie=$.c,_e=w.c;if(!ie||!ie[0]||!_e||!_e[0])return new x(!$.s||!w.s||(ie?_e&&ie[0]==_e[0]:!_e)?NaN:ie&&ie[0]==0||!_e?Y*0:Y/0);for(X=new x(Y),ue=X.c=[],S=$.e-w.e,Y=y+S+1,k||(k=Kr,S=Wr($.e/tt)-Wr(w.e/tt),Y=Y/tt|0),E=0;_e[E]==(ie[E]||0);E++);if(_e[E]>(ie[E]||0)&&S--,Y<0)ue.push(1),B=!0;else{for(J=ie.length,re=_e.length,E=0,Y+=2,G=Gr(k/(_e[0]+1)),G>1&&(_e=d(_e,G,k),ie=d(ie,G,k),re=_e.length,J=ie.length),H=re,te=ie.slice(0,re),ne=te.length;ne<re;te[ne++]=0);ae=_e.slice(),ae=[0].concat(ae),ee=_e[0],_e[1]>=k/2&&ee++;do{if(G=0,N=g(_e,te,re,ne),N<0){if(oe=te[0],re!=ne&&(oe=oe*k+(te[1]||0)),G=Gr(oe/ee),G>1)for(G>=k&&(G=k-1),Q=d(_e,G,k),q=Q.length,ne=te.length;g(Q,te,q,ne)==1;)G--,p(Q,re<q?ae:_e,q,k),q=Q.length,N=1;else G==0&&(N=G=1),Q=_e.slice(),q=Q.length;if(q<ne&&(Q=[0].concat(Q)),p(te,Q,ne,k),ne=te.length,N==-1)for(;g(_e,te,re,ne)<1;)G++,p(te,re<ne?ae:_e,ne,k),ne=te.length}else N===0&&(G++,te=[0]);ue[E++]=G,te[0]?te[ne++]=ie[H]||0:(te=[ie[H]],ne=1)}while((H++<J||te[0]!=null)&&Y--);B=te[0]!=null,ue[0]||ue.splice(0,1)}if(k==Kr){for(E=1,Y=ue[0];Y>=10;Y/=10,E++);O(X,y+(X.e=E+S*tt-1)+1,F,B)}else X.e=S,X.r=+B;return X}})();function L(d,g,p,$){var w,y,F,k,N;if(p==null?p=i:Jt(p,0,8),!d.c)return d.toString();if(w=d.c[0],F=d.e,g==null)N=Ur(d.c),N=$==1||$==2&&(F<=f||F>=v)?Ma(N,F):mn(N,F,"0");else if(d=O(new x(d),g,p),y=d.e,N=Ur(d.c),k=N.length,$==1||$==2&&(g<=y||y<=f)){for(;k<g;N+="0",k++);N=Ma(N,y)}else if(g-=F,N=mn(N,y,"0"),y+1>k){if(--g>0)for(N+=".";g--;N+="0");}else if(g+=y-k,g>0)for(y+1==k&&(N+=".");g--;N+="0");return d.s<0&&w?"-"+N:N}function D(d,g){for(var p,$,w=1,y=new x(d[0]);w<d.length;w++)$=new x(d[w]),(!$.s||(p=Qn(y,$))===g||p===0&&y.s===g)&&(y=$);return y}function R(d,g,p){for(var $=1,w=g.length;!g[--w];g.pop());for(w=g[0];w>=10;w/=10,$++);return(p=$+p*tt-1)>m?d.c=d.e=null:p<b?d.c=[d.e=0]:(d.e=p,d.c=g),d}o=(function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,g=/^([^.]+)\.$/,p=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,w=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(y,F,k,N){var S,E=k?F:F.replace(w,"");if($.test(E))y.s=isNaN(E)?null:E<0?-1:1;else{if(!k&&(E=E.replace(d,function(B,G,Q){return S=(Q=Q.toLowerCase())=="x"?16:Q=="b"?2:8,!N||N==S?G:B}),N&&(S=N,E=E.replace(g,"$1").replace(p,"0.$1")),F!=E))return new x(E,S);if(x.DEBUG)throw Error(Er+"Not a"+(N?" base "+N:"")+" number: "+F);y.s=null}y.c=y.e=null}})();function O(d,g,p,$){var w,y,F,k,N,S,E,B=d.c,G=Ai;if(B){e:{for(w=1,k=B[0];k>=10;k/=10,w++);if(y=g-w,y<0)y+=tt,F=g,N=B[S=0],E=Gr(N/G[w-F-1]%10);else if(S=yi((y+1)/tt),S>=B.length)if($){for(;B.length<=S;B.push(0));N=E=0,w=1,y%=tt,F=y-tt+1}else break e;else{for(N=k=B[S],w=1;k>=10;k/=10,w++);y%=tt,F=y-tt+w,E=F<0?0:Gr(N/G[w-F-1]%10)}if($=$||g<0||B[S+1]!=null||(F<0?N:N%G[w-F-1]),$=p<4?(E||$)&&(p==0||p==(d.s<0?3:2)):E>5||E==5&&(p==4||$||p==6&&(y>0?F>0?N/G[w-F]:0:B[S-1])%10&1||p==(d.s<0?8:7)),g<1||!B[0])return B.length=0,$?(g-=d.e+1,B[0]=G[(tt-g%tt)%tt],d.e=-g||0):B[0]=d.e=0,d;if(y==0?(B.length=S,k=1,S--):(B.length=S+1,k=G[tt-y],B[S]=F>0?Gr(N/G[w-F]%G[F])*k:0),$)for(;;)if(S==0){for(y=1,F=B[0];F>=10;F/=10,y++);for(F=B[0]+=k,k=1;F>=10;F/=10,k++);y!=k&&(d.e++,B[0]==Kr&&(B[0]=1));break}else{if(B[S]+=k,B[S]!=Kr)break;B[S--]=0,k=1}for(y=B.length;B[--y]===0;B.pop());}d.e>m?d.c=d.e=null:d.e<b&&(d.c=[d.e=0])}return d}function z(d){var g,p=d.e;return p===null?d.toString():(g=Ur(d.c),g=p<=f||p>=v?Ma(g,p):mn(g,p,"0"),d.s<0?"-"+g:g)}return a.absoluteValue=a.abs=function(){var d=new x(this);return d.s<0&&(d.s=1),d},a.comparedTo=function(d,g){return Qn(this,new x(d,g))},a.decimalPlaces=a.dp=function(d,g){var p,$,w,y=this;if(d!=null)return Jt(d,0,Tr),g==null?g=i:Jt(g,0,8),O(new x(y),d+y.e+1,g);if(!(p=y.c))return null;if($=((w=p.length-1)-Wr(this.e/tt))*tt,w=p[w])for(;w%10==0;w/=10,$--);return $<0&&($=0),$},a.dividedBy=a.div=function(d,g){return e(this,new x(d,g),l,i)},a.dividedToIntegerBy=a.idiv=function(d,g){return e(this,new x(d,g),0,1)},a.exponentiatedBy=a.pow=function(d,g){var p,$,w,y,F,k,N,S,E,B=this;if(d=new x(d),d.c&&!d.isInteger())throw Error(Er+"Exponent not an integer: "+z(d));if(g!=null&&(g=new x(g)),k=d.e>14,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!d.c||!d.c[0])return E=new x(Math.pow(+z(B),k?d.s*(2-Ca(d)):+z(d))),g?E.mod(g):E;if(N=d.s<0,g){if(g.c?!g.c[0]:!g.s)return new x(NaN);$=!N&&B.isInteger()&&g.isInteger(),$&&(B=B.mod(g))}else{if(d.e>9&&(B.e>0||B.e<-1||(B.e==0?B.c[0]>1||k&&B.c[1]>=24e7:B.c[0]<8e13||k&&B.c[0]<=9999975e7)))return y=B.s<0&&Ca(d)?-0:0,B.e>-1&&(y=1/y),new x(N?1/y:y);T&&(y=yi(T/tt+2))}for(k?(p=new x(.5),N&&(d.s=1),S=Ca(d)):(w=Math.abs(+z(d)),S=w%2),E=new x(s);;){if(S){if(E=E.times(B),!E.c)break;y?E.c.length>y&&(E.c.length=y):$&&(E=E.mod(g))}if(w){if(w=Gr(w/2),w===0)break;S=w%2}else if(d=d.times(p),O(d,d.e+1,1),d.e>14)S=Ca(d);else{if(w=+z(d),w===0)break;S=w%2}B=B.times(B),y?B.c&&B.c.length>y&&(B.c.length=y):$&&(B=B.mod(g))}return $?E:(N&&(E=s.div(E)),g?E.mod(g):y?O(E,T,i,F):E)},a.integerValue=function(d){var g=new x(this);return d==null?d=i:Jt(d,0,8),O(g,g.e+1,d)},a.isEqualTo=a.eq=function(d,g){return Qn(this,new x(d,g))===0},a.isFinite=function(){return!!this.c},a.isGreaterThan=a.gt=function(d,g){return Qn(this,new x(d,g))>0},a.isGreaterThanOrEqualTo=a.gte=function(d,g){return(g=Qn(this,new x(d,g)))===1||g===0},a.isInteger=function(){return!!this.c&&Wr(this.e/tt)>this.c.length-2},a.isLessThan=a.lt=function(d,g){return Qn(this,new x(d,g))<0},a.isLessThanOrEqualTo=a.lte=function(d,g){return(g=Qn(this,new x(d,g)))===-1||g===0},a.isNaN=function(){return!this.s},a.isNegative=function(){return this.s<0},a.isPositive=function(){return this.s>0},a.isZero=function(){return!!this.c&&this.c[0]==0},a.minus=function(d,g){var p,$,w,y,F=this,k=F.s;if(d=new x(d,g),g=d.s,!k||!g)return new x(NaN);if(k!=g)return d.s=-g,F.plus(d);var N=F.e/tt,S=d.e/tt,E=F.c,B=d.c;if(!N||!S){if(!E||!B)return E?(d.s=-g,d):new x(B?F:NaN);if(!E[0]||!B[0])return B[0]?(d.s=-g,d):new x(E[0]?F:i==3?-0:0)}if(N=Wr(N),S=Wr(S),E=E.slice(),k=N-S){for((y=k<0)?(k=-k,w=E):(S=N,w=B),w.reverse(),g=k;g--;w.push(0));w.reverse()}else for($=(y=(k=E.length)<(g=B.length))?k:g,k=g=0;g<$;g++)if(E[g]!=B[g]){y=E[g]<B[g];break}if(y&&(w=E,E=B,B=w,d.s=-d.s),g=($=B.length)-(p=E.length),g>0)for(;g--;E[p++]=0);for(g=Kr-1;$>k;){if(E[--$]<B[$]){for(p=$;p&&!E[--p];E[p]=g);--E[p],E[$]+=Kr}E[$]-=B[$]}for(;E[0]==0;E.splice(0,1),--S);return E[0]?R(d,E,S):(d.s=i==3?-1:1,d.c=[d.e=0],d)},a.modulo=a.mod=function(d,g){var p,$,w=this;return d=new x(d,g),!w.c||!d.s||d.c&&!d.c[0]?new x(NaN):!d.c||w.c&&!w.c[0]?new x(w):(j==9?($=d.s,d.s=1,p=e(w,d,0,3),d.s=$,p.s*=$):p=e(w,d,0,j),d=w.minus(p.times(d)),!d.c[0]&&j==1&&(d.s=w.s),d)},a.multipliedBy=a.times=function(d,g){var p,$,w,y,F,k,N,S,E,B,G,Q,q,X,ue,te=this,ne=te.c,oe=(d=new x(d,g)).c;if(!ne||!oe||!ne[0]||!oe[0])return!te.s||!d.s||ne&&!ne[0]&&!oe||oe&&!oe[0]&&!ne?d.c=d.e=d.s=null:(d.s*=te.s,!ne||!oe?d.c=d.e=null:(d.c=[0],d.e=0)),d;for($=Wr(te.e/tt)+Wr(d.e/tt),d.s*=te.s,N=ne.length,B=oe.length,N<B&&(q=ne,ne=oe,oe=q,w=N,N=B,B=w),w=N+B,q=[];w--;q.push(0));for(X=Kr,ue=In,w=B;--w>=0;){for(p=0,G=oe[w]%ue,Q=oe[w]/ue|0,F=N,y=w+F;y>w;)S=ne[--F]%ue,E=ne[F]/ue|0,k=Q*S+E*G,S=G*S+k%ue*ue+q[y]+p,p=(S/X|0)+(k/ue|0)+Q*E,q[y--]=S%X;q[y]=p}return p?++$:q.splice(0,1),R(d,q,$)},a.negated=function(){var d=new x(this);return d.s=-d.s||null,d},a.plus=function(d,g){var p,$=this,w=$.s;if(d=new x(d,g),g=d.s,!w||!g)return new x(NaN);if(w!=g)return d.s=-g,$.minus(d);var y=$.e/tt,F=d.e/tt,k=$.c,N=d.c;if(!y||!F){if(!k||!N)return new x(w/0);if(!k[0]||!N[0])return N[0]?d:new x(k[0]?$:w*0)}if(y=Wr(y),F=Wr(F),k=k.slice(),w=y-F){for(w>0?(F=y,p=N):(w=-w,p=k),p.reverse();w--;p.push(0));p.reverse()}for(w=k.length,g=N.length,w-g<0&&(p=N,N=k,k=p,g=w),w=0;g;)w=(k[--g]=k[g]+N[g]+w)/Kr|0,k[g]=Kr===k[g]?0:k[g]%Kr;return w&&(k=[w].concat(k),++F),R(d,k,F)},a.precision=a.sd=function(d,g){var p,$,w,y=this;if(d!=null&&d!==!!d)return Jt(d,1,Tr),g==null?g=i:Jt(g,0,8),O(new x(y),d,g);if(!(p=y.c))return null;if(w=p.length-1,$=w*tt+1,w=p[w]){for(;w%10==0;w/=10,$--);for(w=p[0];w>=10;w/=10,$++);}return d&&y.e+1>$&&($=y.e+1),$},a.shiftedBy=function(d){return Jt(d,-9007199254740991,Ys),this.times("1e"+d)},a.squareRoot=a.sqrt=function(){var d,g,p,$,w,y=this,F=y.c,k=y.s,N=y.e,S=l+4,E=new x("0.5");if(k!==1||!F||!F[0])return new x(!k||k<0&&(!F||F[0])?NaN:F?y:1/0);if(k=Math.sqrt(+z(y)),k==0||k==1/0?(g=Ur(F),(g.length+N)%2==0&&(g+="0"),k=Math.sqrt(+g),N=Wr((N+1)/2)-(N<0||N%2),k==1/0?g="5e"+N:(g=k.toExponential(),g=g.slice(0,g.indexOf("e")+1)+N),p=new x(g)):p=new x(k+""),p.c[0]){for(N=p.e,k=N+S,k<3&&(k=0);;)if(w=p,p=E.times(w.plus(e(y,w,S,1))),Ur(w.c).slice(0,k)===(g=Ur(p.c)).slice(0,k))if(p.e<N&&--k,g=g.slice(k-3,k+1),g=="9999"||!$&&g=="4999"){if(!$&&(O(w,w.e+l+2,0),w.times(w).eq(y))){p=w;break}S+=4,k+=4,$=1}else{(!+g||!+g.slice(1)&&g.charAt(0)=="5")&&(O(p,p.e+l+2,1),d=!p.times(p).eq(y));break}}return O(p,p.e+l+1,i,d)},a.toExponential=function(d,g){return d!=null&&(Jt(d,0,Tr),d++),L(this,d,g,1)},a.toFixed=function(d,g){return d!=null&&(Jt(d,0,Tr),d=d+this.e+1),L(this,d,g)},a.toFormat=function(d,g,p){var $,w=this;if(p==null)d!=null&&g&&typeof g=="object"?(p=g,g=null):d&&typeof d=="object"?(p=d,d=g=null):p=M;else if(typeof p!="object")throw Error(Er+"Argument not an object: "+p);if($=w.toFixed(d,g),w.c){var y,F=$.split("."),k=+p.groupSize,N=+p.secondaryGroupSize,S=p.groupSeparator||"",E=F[0],B=F[1],G=w.s<0,Q=G?E.slice(1):E,q=Q.length;if(N&&(y=k,k=N,N=y,q-=y),k>0&&q>0){for(y=q%k||k,E=Q.substr(0,y);y<q;y+=k)E+=S+Q.substr(y,k);N>0&&(E+=S+Q.slice(y)),G&&(E="-"+E)}$=B?E+(p.decimalSeparator||"")+((N=+p.fractionGroupSize)?B.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(p.fractionGroupSeparator||"")):B):E}return(p.prefix||"")+$+(p.suffix||"")},a.toFraction=function(d){var g,p,$,w,y,F,k,N,S,E,B,G,Q=this,q=Q.c;if(d!=null&&(k=new x(d),!k.isInteger()&&(k.c||k.s!==1)||k.lt(s)))throw Error(Er+"Argument "+(k.isInteger()?"out of range: ":"not an integer: ")+z(k));if(!q)return new x(Q);for(g=new x(s),S=p=new x(s),$=N=new x(s),G=Ur(q),y=g.e=G.length-Q.e-1,g.c[0]=Ai[(F=y%tt)<0?tt+F:F],d=!d||k.comparedTo(g)>0?y>0?g:S:k,F=m,m=1/0,k=new x(G),N.c[0]=0;E=e(k,g,0,1),w=p.plus(E.times($)),w.comparedTo(d)!=1;)p=$,$=w,S=N.plus(E.times(w=S)),N=w,g=k.minus(E.times(w=g)),k=w;return w=e(d.minus(p),$,0,1),N=N.plus(w.times(S)),p=p.plus(w.times($)),N.s=S.s=Q.s,y=y*2,B=e(S,$,y,i).minus(Q).abs().comparedTo(e(N,p,y,i).minus(Q).abs())<1?[S,$]:[N,p],m=F,B},a.toNumber=function(){return+z(this)},a.toPrecision=function(d,g){return d!=null&&Jt(d,1,Tr),L(this,d,g,2)},a.toString=function(d){var g,p=this,$=p.s,w=p.e;return w===null?$?(g="Infinity",$<0&&(g="-"+g)):g="NaN":(d==null?g=w<=f||w>=v?Ma(Ur(p.c),w):mn(Ur(p.c),w,"0"):d===10&&A?(p=O(new x(p),l+w+1,i),g=mn(Ur(p.c),p.e,"0")):(Jt(d,2,I.length,"Base"),g=t(mn(Ur(p.c),w,"0"),10,d,$,!0)),$<0&&p.c[0]&&(g="-"+g)),g},a.valueOf=a.toJSON=function(){return z(this)},a._isBigNumber=!0,a[Symbol.toStringTag]="BigNumber",a[Symbol.for("nodejs.util.inspect.custom")]=a.valueOf,n!=null&&x.set(n),x}function Wr(n){var e=n|0;return n>0||n===e?e:e-1}function Ur(n){for(var e,t,o=1,a=n.length,s=n[0]+"";o<a;){for(e=n[o++]+"",t=tt-e.length;t--;e="0"+e);s+=e}for(a=s.length;s.charCodeAt(--a)===48;);return s.slice(0,a+1||1)}function Qn(n,e){var t,o,a=n.c,s=e.c,l=n.s,i=e.s,f=n.e,v=e.e;if(!l||!i)return null;if(t=a&&!a[0],o=s&&!s[0],t||o)return t?o?0:-i:l;if(l!=i)return l;if(t=l<0,o=f==v,!a||!s)return o?0:!a^t?1:-1;if(!o)return f>v^t?1:-1;for(i=(f=a.length)<(v=s.length)?f:v,l=0;l<i;l++)if(a[l]!=s[l])return a[l]>s[l]^t?1:-1;return f==v?0:f>v^t?1:-1}function Jt(n,e,t,o){if(n<e||n>t||n!==Gr(n))throw Error(Er+(o||"Argument")+(typeof n=="number"?n<e||n>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function Ca(n){var e=n.c.length-1;return Wr(n.e/tt)==e&&n.c[e]%2!=0}function Ma(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function mn(n,e,t){var o,a;if(e<0){for(a=t+".";++e;a+=t);n=a+n}else if(o=n.length,++e>o){for(a=t,e-=o;--e;a+=t);n+=a}else e<o&&(n=n.slice(0,e)+"."+n.slice(e));return n}var fn=gu(),pv=class{constructor(n){je(this,"key"),je(this,"left",null),je(this,"right",null),this.key=n}},Io=class extends pv{constructor(n){super(n)}},hv=class{constructor(){je(this,"size",0),je(this,"modificationCount",0),je(this,"splayCount",0)}splay(n){const e=this.root;if(e==null)return this.compare(n,n),-1;let t=null,o=null,a=null,s=null,l=e;const i=this.compare;let f;for(;;)if(f=i(l.key,n),f>0){let v=l.left;if(v==null||(f=i(v.key,n),f>0&&(l.left=v.right,v.right=l,l=v,v=l.left,v==null)))break;t==null?o=l:t.left=l,t=l,l=v}else if(f<0){let v=l.right;if(v==null||(f=i(v.key,n),f<0&&(l.right=v.left,v.left=l,l=v,v=l.right,v==null)))break;a==null?s=l:a.right=l,a=l,l=v}else break;return a!=null&&(a.right=l.left,l.left=s),t!=null&&(t.left=l.right,l.right=o),this.root!==l&&(this.root=l,this.splayCount++),f}splayMin(n){let e=n,t=e.left;for(;t!=null;){const o=t;e.left=o.right,o.right=e,e=o,t=e.left}return e}splayMax(n){let e=n,t=e.right;for(;t!=null;){const o=t;e.right=o.left,o.left=e,e=o,t=e.right}return e}_delete(n){if(this.root==null||this.splay(n)!=0)return null;let e=this.root;const t=e,o=e.left;if(this.size--,o==null)this.root=e.right;else{const a=e.right;e=this.splayMax(o),e.right=a,this.root=e}return this.modificationCount++,t}addNewRoot(n,e){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=n;return}e<0?(n.left=t,n.right=t.right,t.right=null):(n.right=t,n.left=t.left,t.left=null),this.root=n}_first(){const n=this.root;return n==null?null:(this.root=this.splayMin(n),this.root)}_last(){const n=this.root;return n==null?null:(this.root=this.splayMax(n),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(n){return this.validKey(n)&&this.splay(n)==0}defaultCompare(){return(n,e)=>n<e?-1:n>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:n=>{this.root=n},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:n=>{this.splayCount=n},splay:n=>this.splay(n),has:n=>this.has(n)}}},el,tl,Za=class jo extends hv{constructor(e,t){super(),je(this,"root",null),je(this,"compare"),je(this,"validKey"),je(this,el,"[object Set]"),this.compare=e??this.defaultCompare(),this.validKey=t??(o=>o!=null&&o!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const t of e)this.delete(t)}forEach(e){const t=this[Symbol.iterator]();let o;for(;o=t.next(),!o.done;)e(o.value,o.value,this)}add(e){const t=this.splay(e);return t!=0&&this.addNewRoot(new Io(e),t),this}addAndReturn(e){const t=this.splay(e);return t!=0&&this.addNewRoot(new Io(e),t),this.root.key}addAll(e){for(const t of e)this.add(t)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let t=this.root.left;if(t==null)return null;let o=t.right;for(;o!=null;)t=o,o=t.right;return t.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let t=this.root.right;if(t==null)return null;let o=t.left;for(;o!=null;)t=o,o=t.left;return t.key}retainAll(e){const t=new jo(this.compare,this.validKey),o=this.modificationCount;for(const a of e){if(o!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(a)&&this.splay(a)==0&&t.add(this.root.key)}t.size!=this.size&&(this.root=t.root,this.size=t.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const t=new jo(this.compare,this.validKey);for(const o of this)e.has(o)&&t.add(o);return t}difference(e){const t=new jo(this.compare,this.validKey);for(const o of this)e.has(o)||t.add(o);return t}union(e){const t=this.clone();return t.addAll(e),t}clone(){const e=new jo(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function t(a,s){let l,i;do{if(l=a.left,i=a.right,l!=null){const f=new Io(l.key);s.left=f,t(l,f)}if(i!=null){const f=new Io(i.key);s.right=f,a=i,s=f}}while(i!=null)}const o=new Io(e.key);return t(e,o),o}toSet(){return this.clone()}entries(){return new bv(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(tl=Symbol.iterator,el=Symbol.toStringTag,tl)](){return new mv(this.wrap())}},_u=class{constructor(n){je(this,"tree"),je(this,"path",new Array),je(this,"modificationCount",null),je(this,"splayCount"),this.tree=n,this.splayCount=n.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const n=this.path[this.path.length-1];return this.getValue(n)}rebuildPath(n){this.path.splice(0,this.path.length),this.tree.splay(n),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(n){for(;n!=null;)this.path.push(n),n=n.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let n=this.path[this.path.length-1],e=n.right;if(e!=null){for(;e!=null;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===n;)n=this.path.pop();return this.path.length>0}},mv=class extends _u{getValue(n){return n.key}},bv=class extends _u{getValue(n){return[n.key,n.key]}},pu=n=>()=>n,qi=n=>{const e=n?(t,o)=>o.minus(t).abs().isLessThanOrEqualTo(n):pu(!1);return(t,o)=>e(t,o)?0:t.comparedTo(o)};function yv(n){const e=n?(t,o,a,s,l)=>t.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(o).exponentiatedBy(2).plus(l.minus(a).exponentiatedBy(2)).times(n)):pu(!1);return(t,o,a)=>{const s=t.x,l=t.y,i=a.x,f=a.y,v=l.minus(f).times(o.x.minus(i)).minus(s.minus(i).times(o.y.minus(f)));return e(v,s,l,i,f)?0:v.comparedTo(0)}}var Av=n=>n,wv=n=>{if(n){const e=new Za(qi(n)),t=new Za(qi(n)),o=(s,l)=>l.addAndReturn(s),a=s=>({x:o(s.x,e),y:o(s.y,t)});return a({x:new fn(0),y:new fn(0)}),a}return Av},Ji=n=>({set:e=>{En=Ji(e)},reset:()=>Ji(n),compare:qi(n),snap:wv(n),orient:yv(n)}),En=Ji(),To=(n,e)=>n.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(n.ur.x)&&n.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(n.ur.y),Qi=(n,e)=>{if(e.ur.x.isLessThan(n.ll.x)||n.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(n.ll.y)||n.ur.y.isLessThan(e.ll.y))return null;const t=n.ll.x.isLessThan(e.ll.x)?e.ll.x:n.ll.x,o=n.ur.x.isLessThan(e.ur.x)?n.ur.x:e.ur.x,a=n.ll.y.isLessThan(e.ll.y)?e.ll.y:n.ll.y,s=n.ur.y.isLessThan(e.ur.y)?n.ur.y:e.ur.y;return{ll:{x:t,y:a},ur:{x:o,y:s}}},Ba=(n,e)=>n.x.times(e.y).minus(n.y.times(e.x)),hu=(n,e)=>n.x.times(e.x).plus(n.y.times(e.y)),Va=n=>hu(n,n).sqrt(),xv=(n,e,t)=>{const o={x:e.x.minus(n.x),y:e.y.minus(n.y)},a={x:t.x.minus(n.x),y:t.y.minus(n.y)};return Ba(a,o).div(Va(a)).div(Va(o))},$v=(n,e,t)=>{const o={x:e.x.minus(n.x),y:e.y.minus(n.y)},a={x:t.x.minus(n.x),y:t.y.minus(n.y)};return hu(a,o).div(Va(a)).div(Va(o))},rl=(n,e,t)=>e.y.isZero()?null:{x:n.x.plus(e.x.div(e.y).times(t.minus(n.y))),y:t},nl=(n,e,t)=>e.x.isZero()?null:{x:t,y:n.y.plus(e.y.div(e.x).times(t.minus(n.x)))},kv=(n,e,t,o)=>{if(e.x.isZero())return nl(t,o,n.x);if(o.x.isZero())return nl(n,e,t.x);if(e.y.isZero())return rl(t,o,n.y);if(o.y.isZero())return rl(n,e,t.y);const a=Ba(e,o);if(a.isZero())return null;const s={x:t.x.minus(n.x),y:t.y.minus(n.y)},l=Ba(s,e).div(a),i=Ba(s,o).div(a),f=n.x.plus(i.times(e.x)),v=t.x.plus(l.times(o.x)),b=n.y.plus(i.times(e.y)),m=t.y.plus(l.times(o.y)),C=f.plus(v).div(2),j=b.plus(m).div(2);return{x:C,y:j}},ln=class mu{constructor(e,t){je(this,"point"),je(this,"isLeft"),je(this,"segment"),je(this,"otherSE"),je(this,"consumedBy"),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}static compare(e,t){const o=mu.comparePoints(e.point,t.point);return o!==0?o:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:Xa.compare(e.segment,t.segment))}static comparePoints(e,t){return e.x.isLessThan(t.x)?-1:e.x.isGreaterThan(t.x)?1:e.y.isLessThan(t.y)?-1:e.y.isGreaterThan(t.y)?1:0}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const t=e.point.events;for(let o=0,a=t.length;o<a;o++){const s=t[o];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let t=0;t<e;t++){const o=this.point.events[t];if(o.segment.consumedBy===void 0)for(let a=t+1;a<e;a++){const s=this.point.events[a];s.consumedBy===void 0&&o.otherSE.point.events===s.otherSE.point.events&&o.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let t=0,o=this.point.events.length;t<o;t++){const a=this.point.events[t];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&e.push(a)}return e}getLeftmostComparator(e){const t=new Map,o=a=>{const s=a.otherSE;t.set(a,{sine:xv(this.point,e.point,s.point),cosine:$v(this.point,e.point,s.point)})};return(a,s)=>{t.has(a)||o(a),t.has(s)||o(s);const{sine:l,cosine:i}=t.get(a),{sine:f,cosine:v}=t.get(s);return l.isGreaterThanOrEqualTo(0)&&f.isGreaterThanOrEqualTo(0)?i.isLessThan(v)?1:i.isGreaterThan(v)?-1:0:l.isLessThan(0)&&f.isLessThan(0)?i.isLessThan(v)?-1:i.isGreaterThan(v)?1:0:f.isLessThan(l)?-1:f.isGreaterThan(l)?1:0}}},Sv=class Zi{constructor(e){je(this,"events"),je(this,"poly"),je(this,"_isExteriorRing"),je(this,"_enclosingRing"),this.events=e;for(let t=0,o=e.length;t<o;t++)e[t].segment.ringOut=this;this.poly=null}static factory(e){const t=[];for(let o=0,a=e.length;o<a;o++){const s=e[o];if(!s.isInResult()||s.ringOut)continue;let l=null,i=s.leftSE,f=s.rightSE;const v=[i],b=i.point,m=[];for(;l=i,i=f,v.push(i),i.point!==b;)for(;;){const C=i.getAvailableLinkedEvents();if(C.length===0){const M=v[0].point,I=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${M.x}, ${M.y}]. Last matching segment found ends at [${I.x}, ${I.y}].`)}if(C.length===1){f=C[0].otherSE;break}let j=null;for(let M=0,I=m.length;M<I;M++)if(m[M].point===i.point){j=M;break}if(j!==null){const M=m.splice(j)[0],I=v.splice(M.index);I.unshift(I[0].otherSE),t.push(new Zi(I.reverse()));continue}m.push({index:v.length,point:i.point});const T=i.getLeftmostComparator(l);f=C.sort(T)[0].otherSE;break}t.push(new Zi(v))}return t}getGeom(){let e=this.events[0].point;const t=[e];for(let v=1,b=this.events.length-1;v<b;v++){const m=this.events[v].point,C=this.events[v+1].point;En.orient(m,e,C)!==0&&(t.push(m),e=m)}if(t.length===1)return null;const o=t[0],a=t[1];En.orient(o,e,a)===0&&t.shift(),t.push(t[0]);const s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:t.length-1,i=this.isExteriorRing()?t.length:-1,f=[];for(let v=l;v!=i;v+=s)f.push([t[v].x.toNumber(),t[v].y.toNumber()]);return f}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var e,t;let o=this.events[0];for(let l=1,i=this.events.length;l<i;l++){const f=this.events[l];ln.compare(o,f)>0&&(o=f)}let a=o.segment.prevInResult(),s=a?a.prevInResult():null;for(;;){if(!a)return null;if(!s)return a.ringOut;if(s.ringOut!==a.ringOut)return((e=s.ringOut)==null?void 0:e.enclosingRing())!==a.ringOut?a.ringOut:(t=a.ringOut)==null?void 0:t.enclosingRing();a=s.prevInResult(),s=a?a.prevInResult():null}}},ol=class{constructor(n){je(this,"exteriorRing"),je(this,"interiorRings"),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}addInterior(n){this.interiorRings.push(n),n.poly=this}getGeom(){const n=this.exteriorRing.getGeom();if(n===null)return null;const e=[n];for(let t=0,o=this.interiorRings.length;t<o;t++){const a=this.interiorRings[t].getGeom();a!==null&&e.push(a)}return e}},Ev=class{constructor(n){je(this,"rings"),je(this,"polys"),this.rings=n,this.polys=this._composePolys(n)}getGeom(){const n=[];for(let e=0,t=this.polys.length;e<t;e++){const o=this.polys[e].getGeom();o!==null&&n.push(o)}return n}_composePolys(n){var e;const t=[];for(let o=0,a=n.length;o<a;o++){const s=n[o];if(!s.poly)if(s.isExteriorRing())t.push(new ol(s));else{const l=s.enclosingRing();l!=null&&l.poly||t.push(new ol(l)),(e=l?.poly)==null||e.addInterior(s)}}return t}},Lv=class{constructor(n,e=Xa.compare){je(this,"queue"),je(this,"tree"),je(this,"segments"),this.queue=n,this.tree=new Za(e),this.segments=[]}process(n){const e=n.segment,t=[];if(n.consumedBy)return n.isLeft?this.queue.delete(n.otherSE):this.tree.delete(e),t;n.isLeft&&this.tree.add(e);let o=e,a=e;do o=this.tree.lastBefore(o);while(o!=null&&o.consumedBy!=null);do a=this.tree.firstAfter(a);while(a!=null&&a.consumedBy!=null);if(n.isLeft){let s=null;if(o){const i=o.getIntersection(e);if(i!==null&&(e.isAnEndpoint(i)||(s=i),!o.isAnEndpoint(i))){const f=this._splitSafely(o,i);for(let v=0,b=f.length;v<b;v++)t.push(f[v])}}let l=null;if(a){const i=a.getIntersection(e);if(i!==null&&(e.isAnEndpoint(i)||(l=i),!a.isAnEndpoint(i))){const f=this._splitSafely(a,i);for(let v=0,b=f.length;v<b;v++)t.push(f[v])}}if(s!==null||l!==null){let i=null;s===null?i=l:l===null?i=s:i=ln.comparePoints(s,l)<=0?s:l,this.queue.delete(e.rightSE),t.push(e.rightSE);const f=e.split(i);for(let v=0,b=f.length;v<b;v++)t.push(f[v])}t.length>0?(this.tree.delete(e),t.push(n)):(this.segments.push(e),e.prev=o)}else{if(o&&a){const s=o.getIntersection(a);if(s!==null){if(!o.isAnEndpoint(s)){const l=this._splitSafely(o,s);for(let i=0,f=l.length;i<f;i++)t.push(l[i])}if(!a.isAnEndpoint(s)){const l=this._splitSafely(a,s);for(let i=0,f=l.length;i<f;i++)t.push(l[i])}}}this.tree.delete(e)}return t}_splitSafely(n,e){this.tree.delete(n);const t=n.rightSE;this.queue.delete(t);const o=n.split(e);return o.push(t),n.consumedBy===void 0&&this.tree.add(n),o}},Cv=class{constructor(){je(this,"type"),je(this,"numMultiPolys")}run(n,e,t){zo.type=n;const o=[new il(e,!0)];for(let f=0,v=t.length;f<v;f++)o.push(new il(t[f],!1));if(zo.numMultiPolys=o.length,zo.type==="difference"){const f=o[0];let v=1;for(;v<o.length;)Qi(o[v].bbox,f.bbox)!==null?v++:o.splice(v,1)}if(zo.type==="intersection")for(let f=0,v=o.length;f<v;f++){const b=o[f];for(let m=f+1,C=o.length;m<C;m++)if(Qi(b.bbox,o[m].bbox)===null)return[]}const a=new Za(ln.compare);for(let f=0,v=o.length;f<v;f++){const b=o[f].getSweepEvents();for(let m=0,C=b.length;m<C;m++)a.add(b[m])}const s=new Lv(a);let l=null;for(a.size!=0&&(l=a.first(),a.delete(l));l;){const f=s.process(l);for(let v=0,b=f.length;v<b;v++){const m=f[v];m.consumedBy===void 0&&a.add(m)}a.size!=0?(l=a.first(),a.delete(l)):l=null}En.reset();const i=Sv.factory(s.segments);return new Ev(i).getGeom()}},zo=new Cv,Ka=zo,Mv=0,Xa=class Fa{constructor(e,t,o,a){je(this,"id"),je(this,"leftSE"),je(this,"rightSE"),je(this,"rings"),je(this,"windings"),je(this,"ringOut"),je(this,"consumedBy"),je(this,"prev"),je(this,"_prevInResult"),je(this,"_beforeState"),je(this,"_afterState"),je(this,"_isInResult"),this.id=++Mv,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=o,this.windings=a}static compare(e,t){const o=e.leftSE.point.x,a=t.leftSE.point.x,s=e.rightSE.point.x,l=t.rightSE.point.x;if(l.isLessThan(o))return 1;if(s.isLessThan(a))return-1;const i=e.leftSE.point.y,f=t.leftSE.point.y,v=e.rightSE.point.y,b=t.rightSE.point.y;if(o.isLessThan(a)){if(f.isLessThan(i)&&f.isLessThan(v))return 1;if(f.isGreaterThan(i)&&f.isGreaterThan(v))return-1;const m=e.comparePoint(t.leftSE.point);if(m<0)return 1;if(m>0)return-1;const C=t.comparePoint(e.rightSE.point);return C!==0?C:-1}if(o.isGreaterThan(a)){if(i.isLessThan(f)&&i.isLessThan(b))return-1;if(i.isGreaterThan(f)&&i.isGreaterThan(b))return 1;const m=t.comparePoint(e.leftSE.point);if(m!==0)return m;const C=e.comparePoint(t.rightSE.point);return C<0?1:C>0?-1:1}if(i.isLessThan(f))return-1;if(i.isGreaterThan(f))return 1;if(s.isLessThan(l)){const m=t.comparePoint(e.rightSE.point);if(m!==0)return m}if(s.isGreaterThan(l)){const m=e.comparePoint(t.rightSE.point);if(m<0)return 1;if(m>0)return-1}if(!s.eq(l)){const m=v.minus(i),C=s.minus(o),j=b.minus(f),T=l.minus(a);if(m.isGreaterThan(C)&&j.isLessThan(T))return 1;if(m.isLessThan(C)&&j.isGreaterThan(T))return-1}return s.isGreaterThan(l)?1:s.isLessThan(l)||v.isLessThan(b)?-1:v.isGreaterThan(b)?1:e.id<t.id?-1:e.id>t.id?1:0}static fromRing(e,t,o){let a,s,l;const i=ln.comparePoints(e,t);if(i<0)a=e,s=t,l=1;else if(i>0)a=t,s=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const f=new ln(a,!0),v=new ln(s,!1);return new Fa(f,v,[o],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e.isLessThan(t)?e:t},ur:{x:this.rightSE.point.x,y:e.isGreaterThan(t)?e:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(e){return e.x.eq(this.leftSE.point.x)&&e.y.eq(this.leftSE.point.y)||e.x.eq(this.rightSE.point.x)&&e.y.eq(this.rightSE.point.y)}comparePoint(e){return En.orient(this.leftSE.point,e,this.rightSE.point)}getIntersection(e){const t=this.bbox(),o=e.bbox(),a=Qi(t,o);if(a===null)return null;const s=this.leftSE.point,l=this.rightSE.point,i=e.leftSE.point,f=e.rightSE.point,v=To(t,i)&&this.comparePoint(i)===0,b=To(o,s)&&e.comparePoint(s)===0,m=To(t,f)&&this.comparePoint(f)===0,C=To(o,l)&&e.comparePoint(l)===0;if(b&&v)return C&&!m?l:!C&&m?f:null;if(b)return m&&s.x.eq(f.x)&&s.y.eq(f.y)?null:s;if(v)return C&&l.x.eq(i.x)&&l.y.eq(i.y)?null:i;if(C&&m)return null;if(C)return l;if(m)return f;const j=kv(s,this.vector(),i,e.vector());return j===null||!To(a,j)?null:En.snap(j)}split(e){const t=[],o=e.events!==void 0,a=new ln(e,!0),s=new ln(e,!1),l=this.rightSE;this.replaceRightSE(s),t.push(s),t.push(a);const i=new Fa(a,l,this.rings.slice(),this.windings.slice());return ln.comparePoints(i.leftSE.point,i.rightSE.point)>0&&i.swapEvents(),ln.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(a.checkForConsuming(),s.checkForConsuming()),t}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,o=this.windings.length;t<o;t++)this.windings[t]*=-1}consume(e){let t=this,o=e;for(;t.consumedBy;)t=t.consumedBy;for(;o.consumedBy;)o=o.consumedBy;const a=Fa.compare(t,o);if(a!==0){if(a>0){const s=t;t=o,o=s}if(t.prev===o){const s=t;t=o,o=s}for(let s=0,l=o.rings.length;s<l;s++){const i=o.rings[s],f=o.windings[s],v=t.rings.indexOf(i);v===-1?(t.rings.push(i),t.windings.push(f)):t.windings[v]+=f}o.rings=null,o.windings=null,o.consumedBy=t,o.leftSE.consumedBy=t.leftSE,o.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,o=this._afterState.windings,a=this._afterState.multiPolys;for(let i=0,f=this.rings.length;i<f;i++){const v=this.rings[i],b=this.windings[i],m=t.indexOf(v);m===-1?(t.push(v),o.push(b)):o[m]+=b}const s=[],l=[];for(let i=0,f=t.length;i<f;i++){if(o[i]===0)continue;const v=t[i],b=v.poly;if(l.indexOf(b)===-1)if(v.isExterior)s.push(b);else{l.indexOf(b)===-1&&l.push(b);const m=s.indexOf(v.poly);m!==-1&&s.splice(m,1)}}for(let i=0,f=s.length;i<f;i++){const v=s[i].multiPoly;a.indexOf(v)===-1&&a.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(Ka.type){case"union":{const o=e.length===0,a=t.length===0;this._isInResult=o!==a;break}case"intersection":{let o,a;e.length<t.length?(o=e.length,a=t.length):(o=t.length,a=e.length),this._isInResult=a===Ka.numMultiPolys&&o<a;break}case"xor":{const o=Math.abs(e.length-t.length);this._isInResult=o%2===1;break}case"difference":{const o=a=>a.length===1&&a[0].isSubject;this._isInResult=o(e)!==o(t);break}}return this._isInResult}},al=class{constructor(n,e,t){if(je(this,"poly"),je(this,"isExterior"),je(this,"segments"),je(this,"bbox"),!Array.isArray(n)||n.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=t,this.segments=[],typeof n[0][0]!="number"||typeof n[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const o=En.snap({x:new fn(n[0][0]),y:new fn(n[0][1])});this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};let a=o;for(let s=1,l=n.length;s<l;s++){if(typeof n[s][0]!="number"||typeof n[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=En.snap({x:new fn(n[s][0]),y:new fn(n[s][1])});i.x.eq(a.x)&&i.y.eq(a.y)||(this.segments.push(Xa.fromRing(a,i,this)),i.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.x),i.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.y),i.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.x),i.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.y),a=i)}(!o.x.eq(a.x)||!o.y.eq(a.y))&&this.segments.push(Xa.fromRing(a,o,this))}getSweepEvents(){const n=[];for(let e=0,t=this.segments.length;e<t;e++){const o=this.segments[e];n.push(o.leftSE),n.push(o.rightSE)}return n}},Pv=class{constructor(n,e){if(je(this,"multiPoly"),je(this,"exteriorRing"),je(this,"interiorRings"),je(this,"bbox"),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new al(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,o=n.length;t<o;t++){const a=new al(n[t],this,!1);a.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=e}getSweepEvents(){const n=this.exteriorRing.getSweepEvents();for(let e=0,t=this.interiorRings.length;e<t;e++){const o=this.interiorRings[e].getSweepEvents();for(let a=0,s=o.length;a<s;a++)n.push(o[a])}return n}},il=class{constructor(n,e){if(je(this,"isSubject"),je(this,"polys"),je(this,"bbox"),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof n[0][0][0]=="number"&&(n=[n])}catch{}this.polys=[],this.bbox={ll:{x:new fn(Number.POSITIVE_INFINITY),y:new fn(Number.POSITIVE_INFINITY)},ur:{x:new fn(Number.NEGATIVE_INFINITY),y:new fn(Number.NEGATIVE_INFINITY)}};for(let t=0,o=n.length;t<o;t++){const a=new Pv(n[t],this);a.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=e}getSweepEvents(){const n=[];for(let e=0,t=this.polys.length;e<t;e++){const o=this.polys[e].getSweepEvents();for(let a=0,s=o.length;a<s;a++)n.push(o[a])}return n}},Iv=(n,...e)=>Ka.run("union",n,e),Tv=(n,...e)=>Ka.run("difference",n,e);En.set;function bu(n,e,t){if(n!==null)for(var o,a,s,l,i,f,v,b=0,m=0,C,j=n.type,T=j==="FeatureCollection",M=j==="Feature",I=T?n.features.length:1,A=0;A<I;A++){v=T?n.features[A].geometry:M?n.geometry:n,C=v?v.type==="GeometryCollection":!1,i=C?v.geometries.length:1;for(var x=0;x<i;x++){var L=0,D=0;if(l=C?v.geometries[x]:v,l!==null){f=l.coordinates;var R=l.type;switch(b=0,R){case null:break;case"Point":if(e(f,m,A,L,D)===!1)return!1;m++,L++;break;case"LineString":case"MultiPoint":for(o=0;o<f.length;o++){if(e(f[o],m,A,L,D)===!1)return!1;m++,R==="MultiPoint"&&L++}R==="LineString"&&L++;break;case"Polygon":case"MultiLineString":for(o=0;o<f.length;o++){for(a=0;a<f[o].length-b;a++){if(e(f[o][a],m,A,L,D)===!1)return!1;m++}R==="MultiLineString"&&L++,R==="Polygon"&&D++}R==="Polygon"&&L++;break;case"MultiPolygon":for(o=0;o<f.length;o++){for(D=0,a=0;a<f[o].length;a++){for(s=0;s<f[o][a].length-b;s++){if(e(f[o][a][s],m,A,L,D)===!1)return!1;m++}D++}L++}break;case"GeometryCollection":for(o=0;o<l.geometries.length;o++)if(bu(l.geometries[o],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function vs(n,e){var t,o,a,s,l,i,f,v,b,m,C=0,j=n.type==="FeatureCollection",T=n.type==="Feature",M=j?n.features.length:1;for(t=0;t<M;t++){for(i=j?n.features[t].geometry:T?n.geometry:n,v=j?n.features[t].properties:T?n.properties:{},b=j?n.features[t].bbox:T?n.bbox:void 0,m=j?n.features[t].id:T?n.id:void 0,f=i?i.type==="GeometryCollection":!1,l=f?i.geometries.length:1,a=0;a<l;a++){if(s=f?i.geometries[a]:i,s===null){if(e(null,C,v,b,m)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,C,v,b,m)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(e(s.geometries[o],C,v,b,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}C++}}function Rv(n,e){vs(n,function(t,o,a,s,l){var i=t===null?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return e(va(t,a,{bbox:s,id:l}),o,0)===!1?!1:void 0}var f;switch(i){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var v=0;v<t.coordinates.length;v++){var b=t.coordinates[v],m={type:f,coordinates:b};if(e(va(m,a),o,v)===!1)return!1}})}function Nv(n,e={}){const t=[];if(vs(n,a=>{t.push(a.coordinates)}),t.length<2)throw new Error("Must have at least 2 geometries");const o=Iv(t[0],...t.slice(1));return o.length===0?null:o.length===1?fs(o[0],e.properties):vu(o,e.properties)}var yu=Nv;function Bv(n,e={}){if(n.bbox!=null&&e.recompute!==!0)return n.bbox;const t=[1/0,1/0,-1/0,-1/0];return bu(n,o=>{t[0]>o[0]&&(t[0]=o[0]),t[1]>o[1]&&(t[1]=o[1]),t[2]<o[0]&&(t[2]=o[0]),t[3]<o[1]&&(t[3]=o[1])}),t}var sl=Bv;function Fv(n){const e=[];if(vs(n,a=>{e.push(a.coordinates)}),e.length<2)throw new Error("Must have at least two features");const t=n.features[0].properties||{},o=Tv(e[0],...e.slice(1));return o.length===0?null:o.length===1?fs(o[0],t):vu(o,t)}var Ov=Fv;function jv(n){if(!n)throw new Error("geojson is required");var e=[];return Rv(n,function(t){e.push(t)}),ga(e)}var zv=jv;function ll(n,e){const t=Ov(ga([fs([[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]),n]));if(!t)return;t.properties={isMask:!0};const o=Qa(sl(n)),a=(o[2]-o[0])/360/1e3,s=o[0]<-180,l=o[2]>180,i=zv(n);if(i.features.length>1&&(s||l))for(const f of i.features){const v=Qa(sl(f));if(l&&v[0]<-180+a)for(const b of f.geometry.coordinates)for(const m of b)m[0]+=360-a;if(s&&v[2]>180-a)for(const b of f.geometry.coordinates)for(const m of b)m[0]-=360-a}e(ga([i.features.length<2?n:yu(i)??n,t]))}const ul={fill:{paint:{"fill-color":"#000","fill-opacity":.1},filter:["all",["==",["geometry-type"],"Polygon"],["has","isMask"]]},line:{layout:{"line-cap":"square"},paint:{"line-width":["case",["==",["geometry-type"],"Polygon"],2,3],"line-dasharray":[1,1],"line-color":"#3170fe"},filter:["!",["has","isMask"]]}},Pa="mtlr-gc-full-geom",cl="mtlr-gc-full-geom-fill",dl="mtlr-gc-full-geom-line";function Dv(n,e,t=!0,o=!0,a={},s={},l=ul){let i;const f=[];let v,b,m;function C(){if(!n.loaded){n.once("load",C);return}const I=l?l===!0?ul:l:void 0;if(!(I!=null&&I.fill)&&!(I!=null&&I.line))return;const A=n.getSource(Pa);if(A)A.setData(m??ga([]));else if(m)n.addSource(Pa,{type:"geojson",data:m});else return;!n.getLayer(cl)&&I!=null&&I.fill&&n.addLayer({...I?.fill,id:cl,type:"fill",source:Pa}),!n.getLayer(dl)&&I!=null&&I.line&&n.addLayer({...I?.line,id:dl,type:"line",source:Pa})}function j(I){m=I,C()}n.on("styledata",()=>{setTimeout(()=>{m&&C()})});const T=I=>{i?.({type:"mapClick",coordinates:[I.lngLat.lng,I.lngLat.lat]})};function M(I=!1){if(!e)throw new Error;const A=document.createElement("div");return I&&A.classList.add("marker-interactive"),new Wf({props:{displayIn:"maplibre"},target:A}),new e.Marker({element:A,offset:[1,-13]})}return{setEventHandler(I){I?(i=I,n.on("click",T)):(i=void 0,n.off("click",T))},flyTo(I,A){n.flyTo({center:I,...A?{zoom:A}:{},...a})},fitBounds(I,A,x){n.fitBounds([[I[0],I[1]],[I[2],I[3]]],{padding:A,...x?{maxZoom:x}:{},...s})},indicateReverse(I){n.getCanvasContainer().style.cursor=I?"crosshair":""},setReverseMarker(I){!e||!t||(b?I?b.setLngLat(I):(b.remove(),b=void 0):I&&(t instanceof Function?b=t(n)??void 0:(b=(typeof t=="object"?new e.Marker(t):M()).setLngLat(I).addTo(n),b.getElement().classList.add("marker-reverse"))))},setFeatures(I,A,x){for(const L of f)L.remove();if(f.length=0,j(void 0),!!e){e:if(A){let L=!1;if(A.geometry.type==="GeometryCollection"){const D=A.geometry.geometries.filter(R=>R.type==="Polygon"||R.type==="MultiPolygon");t:if(D.length>0){const R=yu(ga(D.map(O=>va(O))));if(!R)break t;ll({...A,geometry:R.geometry},j),L=!0}else{const R=A.geometry.geometries.filter(O=>O.type==="LineString"||O.type==="MultiLineString");R.length>0&&(j({...A,geometry:{type:"GeometryCollection",geometries:R}}),L=!0)}}if(!L){if(A.geometry.type==="Polygon"||A.geometry.type==="MultiPolygon")ll(A,j);else if(A.geometry.type==="LineString"||A.geometry.type==="MultiLineString"){j(A);break e}}if(!x&&!A.geometry.type.endsWith("Point"))break e;if(t instanceof Function){const D=t(n,A);D&&f.push(D)}else t&&f.push(typeof t=="object"?new e.Marker(t):M().setLngLat(A.center).addTo(n))}if(o)for(const L of I??[]){if(L===A)continue;let D;if(o instanceof Function){if(D=o(n,L),!D)continue}else D=(typeof o=="object"?new e.Marker(o):M(!0)).setLngLat(L.center).setPopup(new e.Popup({offset:[1,-27],closeButton:!1,closeOnMove:!0,className:"maptiler-gc-popup"}).setText(L.place_type[0]==="reverse"?L.place_name:L.place_name.replace(/,.*/,""))).addTo(n);const R=D.getElement();R.addEventListener("click",O=>{O.stopPropagation(),i?.({type:"markerClick",id:L.id})}),R.addEventListener("mouseenter",()=>{i?.({type:"markerMouseEnter",id:L.id}),D.togglePopup()}),R.addEventListener("mouseleave",()=>{i?.({type:"markerMouseLeave",id:L.id}),D.togglePopup()}),f.push(D)}}},setSelectedMarker(I){v&&v.getElement().classList.toggle("marker-selected",!1),v=I>-1?f[I]:void 0,v?.getElement().classList.toggle("marker-selected",!0)},getCenterAndZoom(){const I=n.getCenter();return[n.getZoom(),I.lng,I.lat]}}}function Uv(n,e,t){var o,a,s;class l{constructor(A,x){je(this,"type"),je(this,"target"),this.type=x,this.target=A}}class i extends l{constructor(A,x){super(A,"select"),je(this,"feature"),Object.assign(this,x)}}class f extends l{constructor(A,x){super(A,"featureslisted"),je(this,"features"),this.features=x}}class v extends l{constructor(A,x){super(A,"featuresmarked"),je(this,"features"),this.features=x}}class b extends l{constructor(A,x){super(A,"optionsvisibilitychange"),je(this,"optionsVisible"),this.optionsVisible=x}}class m extends l{constructor(A,x){super(A,"pick"),je(this,"feature"),this.feature=x}}class C extends l{constructor(A,x){super(A,"querychange"),je(this,"query"),this.query=x}}class j extends l{constructor(A,x,L){super(A,"response"),je(this,"url"),je(this,"featureCollection"),this.url=x,this.featureCollection=L}}class T extends l{constructor(A,x){super(A,"reversetoggle"),je(this,"reverse"),this.reverse=x}}class M extends n{constructor(A={}){super(),mi(this,o),mi(this,a),mi(this,s),Sa(this,a,A)}onAddInt(A){const x=document.createElement("div");x.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl mapboxgl-ctrl-group";const{marker:L,showResultMarkers:D,flyTo:R,fullGeometryStyle:O,...z}=er(this,a),d=typeof R=="boolean"?{}:R,g={mapController:Dv(A,e,L,D,d,d,O),flyTo:R===void 0?!0:!!R,apiKey:"",...z};return g.apiKey||console.warn("No MapTiler Cloud API key was provided, some or all geocoding requests may fail"),Sa(this,o,new gv({target:x,props:g})),er(this,o).$on("select",p=>{this.fire(new i(this,p.detail))}),er(this,o).$on("pick",p=>{this.fire(new m(this,p.detail.feature))}),er(this,o).$on("featureslisted",p=>{this.fire(new f(this,p.detail.features))}),er(this,o).$on("featuresmarked",p=>{this.fire(new v(this,p.detail.features))}),er(this,o).$on("response",p=>{this.fire(new j(this,p.detail.url,p.detail.featureCollection))}),er(this,o).$on("optionsvisibilitychange",p=>{this.fire(new b(this,p.detail.optionsVisible))}),er(this,o).$on("reversetoggle",p=>{this.fire(new T(this,p.detail.reverse))}),er(this,o).$on("querychange",p=>{this.fire(new C(this,p.detail.query))}),Sa(this,s,x),x}on(A,x){return super.on(A,x)}once(A,x){return super.once(A,x)}off(A,x){return super.off(A,x)}listens(A){return super.listens(A)}setOptions(A){var x;Object.assign(er(this,a),A);const{marker:L,showResultMarkers:D,flyTo:R,fullGeometryStyle:O,...z}=er(this,a);(x=er(this,o))==null||x.$set(z)}setQuery(A,x=!0){var L;(L=er(this,o))==null||L.setQuery(A,x)}clearMap(){var A;(A=er(this,o))==null||A.clearMap()}clearList(){var A;(A=er(this,o))==null||A.clearList()}setReverseMode(A){var x;(x=er(this,o))==null||x.$set({reverseActive:A})}focus(A){var x;(x=er(this,o))==null||x.focus(A)}blur(){var A;(A=er(this,o))==null||A.blur()}onRemove(){var A,x,L;(A=er(this,o))==null||A.$destroy(),Sa(this,o,void 0),(L=(x=er(this,s))==null?void 0:x.parentNode)==null||L.removeChild(er(this,s))}}return o=new WeakMap,a=new WeakMap,s=new WeakMap,{MapLibreBasedGeocodingControl:M,events:{SelectEvent:i,FeaturesListedEvent:f,FeaturesMarkedEvent:v,OptionsVisibilityChangeEvent:b,PickEvent:m,QueryChangeEvent:C,ResponseEvent:j,ReverseToggleEvent:T}}}const{MapLibreBasedGeocodingControl:Gv}=Uv(Li.Evented,Lc);class Wv extends Gv{onAdd(e){return super.onAddInt(e)}}function Hv(n,e){Ne(e,!0);let t=we(void 0),o=["continental_marine","country","major_landform","region","subregion","county","joint_municipality","joint_submunicipality","municipality","municipal_district","locality","neighbourhood","place","postal_code","address","road","poi"];dr(()=>{r(t)&&(e.map?.removeControl(r(t)),K(t,void 0))}),Je(()=>{e.map&&e.loaded&&!r(t)&&(K(t,new Wv({apiKey:Yn,maplibregl:Cr,proximity:[{type:"map-center"}],types:o,country:e.country,marker:!0,showResultMarkers:!0,flyToOptions:{duration:1e3},fitBoundsOptions:{duration:1e3}}),!0),e.map.addControl(r(t),"top-left"))}),Be()}rr(["click"]);function $n(n,e,t){let o=["match",n];for(let[a,s]of Object.entries(e))o.push(a),o.push(s);return o.push(t),o}function vr(n,e,t){let o=["step",n];for(let a=1;a<e.length;a++)o.push(t[a-1]),o.push(e[a]);return o.push(t[t.length-1]),o}function or(){return{type:"FeatureCollection",features:[]}}let Yn="MZEJTanw3WpxRvt7qDfo",fl=`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${Yn}`;new id([["Blank",{version:8,sources:{},layers:[],glyphs:fl}],["Maptiler Streets",`https://api.maptiler.com/maps/streets-v2/style.json?key=${Yn}`],["Maptiler Dataviz",`https://api.maptiler.com/maps/dataviz/style.json?key=${Yn}`],["Maptiler Hybrid",`https://api.maptiler.com/maps/hybrid/style.json?key=${Yn}`],["Maptiler OpenStreetMap",`https://api.maptiler.com/maps/openstreetmap/style.json?key=${Yn}`],["Maptiler OS Open Zoomstack",`https://api.maptiler.com/maps/uk-openzoomstack-light/style.json?key=${Yn}`],["ESRI World Imagery",{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:256,attribution:"ESRI &copy; <a href='http://www.esri.com' target='_blank'>ESRI</a>",minzoom:0,maxzoom:18}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:fl}]]);var qv=P('<p><a href="https://nptscot.github.io/manual/#routenetwork" target="_blank"> </a></p>'),Jv=P("<option> </option>"),Qv=P("<select></select>"),Zv=P("<option> </option>"),Vv=P("<select></select>"),Kv=P("<option> </option>"),Xv=P("<select></select>"),Yv=P("<option> </option>"),eg=P("<select></select>"),tg=P("<label><!></label> <label><!></label> <label><!></label> <label><!></label>",1),rg=P("<tr><th> </th><td> </td><td> </td><td> </td></tr>"),ng=P("<tr><th> </th><td> </td><td> </td><td> </td></tr>"),og=P('<div style="max-width: 30vw; max-height: 60vh; overflow: auto;"><p><!></p> <p><!></p> <p><!></p> <details><summary> </summary> <p> </p> <table><tbody><tr><td></td><th> </th><th> </th><th> </th></tr><!></tbody></table> <p> </p> <table><tbody><tr><td></td><th> </th><th> </th><th> </th></tr><!></tbody></table></details></div>'),ag=P("<!> <!>",1);function ig(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=we(!1),a=we("all"),s=we("bicycle_go_dutch"),l=we("fastest"),i=we("flow"),f=[["all","All"],["commute","Commute"],["primary","Primary School"],["secondary","Secondary"],["utility","Other everyday"]],v=[["bicycle","Baseline"],["bicycle_go_dutch","Go Dutch"],["bicycle_ebike","E-bike"]],b=[["fastest","Fast/Direct"],["quietest","Quiet/Indirect"]],m=[["none","None"],["flow","People cycling per day"],["quietness","Cycle friendliness"],["gradient","Gradient"]],C={colorScale:["#59ee19","#37a009","#FFC300","#C70039","#581845","#000000"],limits:[3,5,7,10,100]};function j(D){return["let","base",["+",.3,["/",3,["+",1,["^",2.718,["-",2.94,["*",D,.0021]]]]]],["interpolate",["linear"],["zoom"],12,["*",2.1,["var","base"]],14,["*",5.25,["var","base"]],15,["*",7.5,["var","base"]],16,["*",18,["var","base"]],18,["*",52.5,["var","base"]]]]}function T(D){return["step",D,"rgba(0,0,0,0)",1,"#9C9C9C",50,"#FFFF73",100,"#AFFF00",250,"#00FFFF",500,"#30B0FF",1e3,"#2E5FFF",2e3,"#0000FF",3e3,"#FF00C5"]}let M=u(()=>`${r(a)}_${r(l)}_${r(s)}`),I=u(()=>({none:"#304ce7",flow:T(["get",r(M)]),quietness:["step",["get","quietness"],"#882255",25,"#CC6677",50,"#44AA99",75,"#117733",101,"#000000"],gradient:vr(["abs",["get","gradient"]],C.limits,C.colorScale)})[r(i)]);var A=ag(),x=V(A);{const D=z=>{var d=qv(),g=c(d),p=c(g);Z($=>U(p,$),[()=>r(t).t(188)]),_(z,d)},R=z=>{var d=tg(),g=V(d);{const S=E=>{var B=Qv();Zt(B,21,()=>f,Vt,(G,Q)=>{var q=u(()=>qr(r(Q),2));let X=()=>r(q)[0],ue=()=>r(q)[1];var te=Jv(),ne=c(te),oe={};Z(()=>{U(ne,ue()),oe!==(oe=X())&&(te.value=(te.__value=X())??"")}),_(G,te)}),An(B,()=>r(a),G=>K(a,G)),_(E,B)};var p=c(g);{let E=u(()=>[S]),B=u(()=>r(t).cx(230));pe(p,{get t(){return r(E)},get x(){return r(B)}})}}var $=h(g,2);{const S=E=>{var B=Vv();Zt(B,21,()=>v,Vt,(G,Q)=>{var q=u(()=>qr(r(Q),2));let X=()=>r(q)[0],ue=()=>r(q)[1];var te=Zv(),ne=c(te),oe={};Z(()=>{U(ne,ue()),oe!==(oe=X())&&(te.value=(te.__value=X())??"")}),_(G,te)}),An(B,()=>r(s),G=>K(s,G)),_(E,B)};var w=c($);{let E=u(()=>[S]),B=u(()=>r(t).cx(231));pe(w,{get t(){return r(E)},get x(){return r(B)}})}}var y=h($,2);{const S=E=>{var B=Xv();Zt(B,21,()=>b,Vt,(G,Q)=>{var q=u(()=>qr(r(Q),2));let X=()=>r(q)[0],ue=()=>r(q)[1];var te=Kv(),ne=c(te),oe={};Z(()=>{U(ne,ue()),oe!==(oe=X())&&(te.value=(te.__value=X())??"")}),_(G,te)}),An(B,()=>r(l),G=>K(l,G)),_(E,B)};var F=c(y);{let E=u(()=>[S]),B=u(()=>r(t).cx(232));pe(F,{get t(){return r(E)},get x(){return r(B)}})}}var k=h(y,2);{const S=E=>{var B=eg();Zt(B,21,()=>m,Vt,(G,Q)=>{var q=u(()=>qr(r(Q),2));let X=()=>r(q)[0],ue=()=>r(q)[1];var te=Yv(),ne=c(te),oe={};Z(()=>{U(ne,ue()),oe!==(oe=X())&&(te.value=(te.__value=X())??"")}),_(G,te)}),An(B,()=>r(i),G=>K(i,G)),_(E,B)};var N=c(k);{let E=u(()=>[S]),B=u(()=>r(t).cx(233));pe(N,{get t(){return r(E)},get x(){return r(B)}})}}_(z,d)};let O=u(()=>r(t).t(229));Br(x,{get label(){return r(O)},get show(){return r(o)},set show(z){K(o,z,!0)},help:D,legend:R,$$slots:{help:!0,legend:!0}})}var L=h(x,2);{let D=u(()=>`pmtiles://${en("cnt/layers/route_network.pmtiles")}`);ba(L,{get url(){return r(D)},children:(R,O)=>{{let z=u(()=>Ge("context-route-network")),d=u(()=>({"line-color":r(I),"line-width":j(["get",r(M)])})),g=u(()=>({visibility:r(o)?"visible":"none"}));gt(R,Ie(()=>r(z),{sourceLayer:"rnet",get paint(){return r(d)},get layout(){return r(g)},hoverCursor:"pointer",children:(p,$)=>{Bt(p,{openOn:"click",children:(y,F)=>{let k=()=>F?.().data;const N=u(()=>k().properties);var S=og(),E=c(S),B=c(E);{let Te=u(()=>r(t).cx(234)),Ee=u(()=>[r(N)[r(M)].toLocaleString()]);pe(B,{get x(){return r(Te)},get a(){return r(Ee)}})}var G=h(E,2),Q=c(G);{let Te=u(()=>r(t).cx(235)),Ee=u(()=>[r(N).gradient]);pe(Q,{get x(){return r(Te)},get a(){return r(Ee)}})}var q=h(G,2),X=c(q);{let Te=u(()=>r(t).cx(236)),Ee=u(()=>[r(N).quietness]);pe(X,{get x(){return r(Te)},get a(){return r(Ee)}})}var ue=h(q,2),te=c(ue),ne=c(te),oe=h(te,2),H=c(oe),J=h(oe,2),ee=c(J),re=c(ee),ae=h(c(re)),Y=c(ae),ie=h(ae),_e=c(ie),le=h(ie),fe=c(le),se=h(re);Zt(se,17,()=>f,Vt,(Te,Ee)=>{var Ue=u(()=>qr(r(Ee),2));let De=()=>r(Ue)[0],qe=()=>r(Ue)[1];var Fe=rg(),He=c(Fe),Ze=c(He),rt=h(He),Ve=c(rt),Ke=h(rt),vt=c(Ke),xt=h(Ke),mt=c(xt);Z((Mt,$t,Et)=>{U(Ze,qe()),U(Ve,Mt),U(vt,$t),U(mt,Et)},[()=>r(N)[`${De()}_fastest_bicycle`].toLocaleString(),()=>r(N)[`${De()}_fastest_bicycle_go_dutch`].toLocaleString(),()=>r(N)[`${De()}_fastest_bicycle_ebike`].toLocaleString()]),_(Te,Fe)});var Ae=h(J,2),me=c(Ae),ke=h(Ae,2),Se=c(ke),We=c(Se),xe=h(c(We)),Le=c(xe),he=h(xe),Re=c(he),Ce=h(he),be=c(Ce),Me=h(We);Zt(Me,17,()=>f,Vt,(Te,Ee)=>{var Ue=u(()=>qr(r(Ee),2));let De=()=>r(Ue)[0],qe=()=>r(Ue)[1];var Fe=ng(),He=c(Fe),Ze=c(He),rt=h(He),Ve=c(rt),Ke=h(rt),vt=c(Ke),xt=h(Ke),mt=c(xt);Z((Mt,$t,Et)=>{U(Ze,qe()),U(Ve,Mt),U(vt,$t),U(mt,Et)},[()=>r(N)[`${De()}_quietest_bicycle`].toLocaleString(),()=>r(N)[`${De()}_quietest_bicycle_go_dutch`].toLocaleString(),()=>r(N)[`${De()}_quietest_bicycle_ebike`].toLocaleString()]),_(Te,Fe)}),Z((Te,Ee,Ue,De,qe,Fe,He,Ze,rt)=>{U(ne,Te),U(H,Ee),U(Y,Ue),U(_e,De),U(fe,qe),U(me,Fe),U(Le,He),U(Re,Ze),U(be,rt)},[()=>r(t).t(237),()=>r(t).t(238),()=>r(t).t(239),()=>r(t).t(240),()=>r(t).t(241),()=>r(t).t(242),()=>r(t).t(239),()=>r(t).t(240),()=>r(t).t(241)]),_(y,S)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}_(n,A),Be()}var sg=P('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),lg=P('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),ug=P('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),cg=P("<!> <!> <!>",1),dg=P('<!> <!> <!> <div class="layer-group"> </div> <!> <!>',1);function fg(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=we(!1),a=we(!1),s=we(!1),l={colorScale:["#27918d","#ffaa33","#440154"],limits:[0,2e3,4e3,1e4]},i={High:"mediumseagreen",Medium:"orange",Low:"red","Should not be used":"brown"},f={"Segregated Track (wide)":"#054d05","Off Road Cycleway":"#3a9120","Segregated Track (narrow)":"#87d668","Shared Footway":"#ffbf00","Painted Cycle Lane":"#7faedd"};var v=dg(),b=V(v);{const A=D=>{cs(D,{get labelColors(){return f}})},x=D=>{var R=sg(),O=c(R),z=c(O);Z(d=>U(z,d),[()=>r(t).t(188)]),_(D,R)};let L=u(()=>r(t).t(187));Br(b,{get label(){return r(L)},get show(){return r(s)},set show(D){K(s,D,!0)},legend:A,help:x,$$slots:{legend:!0,help:!0}})}var m=h(b,2);{const A=D=>{{let R=u(()=>Object.values(i)),O=u(()=>({buckets:Object.keys(i)}));Ar(D,{get colorScale(){return r(R)},get labels(){return r(O)},fullWidthBucketLegend:!0})}},x=D=>{var R=lg(),O=c(R),z=c(O);Z(d=>U(z,d),[()=>r(t).t(188)]),_(D,R)};let L=u(()=>r(t).t(189));Br(m,{get label(){return r(L)},get show(){return r(a)},set show(D){K(a,D,!0)},legend:A,help:x,$$slots:{legend:!0,help:!0}})}var C=h(m,2);ig(C,{});var j=h(C,2),T=c(j),M=h(j,2);{const A=D=>{{let R=u(()=>({limits:l.limits}));Ar(D,{get colorScale(){return l.colorScale},get labels(){return r(R)}})}},x=D=>{var R=ug(),O=c(R),z=c(O);Z(d=>U(z,d),[()=>r(t).t(188)]),_(D,R)};let L=u(()=>r(t).t(191));Br(M,{get label(){return r(L)},get show(){return r(o)},set show(D){K(o,D,!0)},legend:A,help:x,$$slots:{legend:!0,help:!0}})}var I=h(M,2);{let A=u(()=>`pmtiles://${en("cnt/layers/cbd.pmtiles")}`);ba(I,{get url(){return r(A)},children:(x,L)=>{var D=cg(),R=V(D);{let d=u(()=>Ge("context-traffic")),g=u(()=>["has",r(t).t(192)]),p=u(()=>({"line-color":$n(["get",r(t).t(192)],{"0 to 1999":l.colorScale[0],"2000 to 3999":l.colorScale[1],"4000+":l.colorScale[2]},"cyan"),"line-width":fo(0)})),$=u(()=>({visibility:r(o)?"visible":"none"}));gt(R,Ie(()=>r(d),{sourceLayer:"cbd_layer",get filter(){return r(g)},get paint(){return r(p)},get layout(){return r($)}}))}var O=h(R,2);{let d=u(()=>Ge("context-los")),g=u(()=>({"line-color":$n(["get",r(t).t(193)],i,"cyan"),"line-width":fo(1)})),p=u(()=>({visibility:r(a)?"visible":"none"}));gt(O,Ie(()=>r(d),{sourceLayer:"cbd_layer",get paint(){return r(g)},get layout(){return r(p)}}))}var z=h(O,2);{let d=u(()=>Ge("context-existing-infra")),g=u(()=>["!=",["get",r(t).t(194)],r(t).t(195)]),p=u(()=>({"line-color":$n(["get",r(t).t(194)],f,"cyan"),"line-width":fo(1)})),$=u(()=>({visibility:r(s)?"visible":"none"}));gt(z,Ie(()=>r(d),{sourceLayer:"cbd_layer",get filter(){return r(g)},get paint(){return r(p)},get layout(){return r($)}}))}_(x,D)},$$slots:{default:!0}})}Z(A=>U(T,A),[()=>r(t).t(190)]),_(n,v),Be()}var vg=P('<a href="https://www.data.gov.uk/dataset/9a6f9d86-9698-4a5d-a2c8-89f3b212c52c/scottish-school-roll-and-locations" target="_blank"> </a>'),gg=P('<a href="https://data.spatialhub.scot/dataset/gp_practices-is" target="_blank"> </a>'),_g=P('<a href="https://data.spatialhub.scot/dataset/nhs_hospitals-is" target="_blank"> </a>'),pg=P('<a href="https://www.openstreetmap.org/about" target="_blank"> </a>'),hg=P("<p><!></p>"),mg=P("<!> <!>",1);function bg(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=we(!1),i={School:"#7fc97f",GP:"#beaed4",Hospital:"#fdc086",Grocery:"#386cb0",CommunityCenter:"#ffff99",Recreation:"#f0027f"};var f=mg(),v=V(f);{const C=M=>{cs(M,{get labelColors(){return i},swatchClass:"circle"})},j=M=>{var I=hg();{const x=(O,z=Pe)=>{var d=vg(),g=c(d);Z(p=>U(g,p),[()=>r(s).tx(z())]),_(O,d)},L=(O,z=Pe)=>{var d=gg(),g=c(d);Z(p=>U(g,p),[()=>r(s).tx(z())]),_(O,d)},D=(O,z=Pe)=>{var d=_g(),g=c(d);Z(p=>U(g,p),[()=>r(s).tx(z())]),_(O,d)},R=(O,z=Pe)=>{var d=pg(),g=c(d);Z(p=>U(g,p),[()=>r(s).tx(z())]),_(O,d)};var A=c(I);{let O=u(()=>[x,L,D,R]),z=u(()=>r(s).cx(208));pe(A,{get t(){return r(O)},get x(){return r(z)}})}}_(M,I)};let T=u(()=>r(s).t(207));Br(v,{get label(){return r(T)},get show(){return r(l)},set show(M){K(l,M,!0)},legend:C,help:j,$$slots:{legend:!0,help:!0}})}var b=h(v,2);{var m=C=>{{let j=u(()=>t().getPOIs());it(C,{get data(){return r(j)},generateId:!0,children:(T,M)=>{{let I=u(()=>Ge("context-pois")),A=u(()=>({"circle-color":$n(["get","kind"],i,"black"),"circle-radius":10,"circle-stroke-color":"black","circle-stroke-width":1,"circle-opacity":.8})),x=u(()=>({visibility:r(l)?"visible":"none"}));Nn(T,Ie(()=>r(I),{get paint(){return r(A)},get layout(){return r(x)},children:(L,D)=>{Bt(L,{openOn:"hover",children:(O,z)=>{let d=()=>z?.().data;const g=u(()=>d().properties);var p=Ut();Z(()=>U(p,r(g).name||`unnamed ${r(g).kind}`)),_(O,p)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}};ve(b,C=>{t()&&C(m)})}_(n,f),Be(),a()}var yg=P('<!> <div style="display: flex; justify-content: space-between;"><span> </span> <span> </span></div>',1),Ag=P('<a href="https://www.data.gov.uk/dataset/1102bf85-ed49-440a-b211-da87e8d752eb/scottish-index-of-multiple-deprivation-simd-2020" target="_blank"> </a>'),wg=P("<p><!></p>"),xg=P('<!> <div style="display: flex; justify-content: space-between;"><span> </span> <span> </span> <span> </span></div>',1),$g=P('<a href="https://www.data.gov.uk/dataset/1102bf85-ed49-440a-b211-da87e8d752eb/scottish-index-of-multiple-deprivation-simd-2020" target="_blank"> </a>'),kg=P("<p><!></p>"),Sg=P('<!> <div style="display: flex; justify-content: space-between;"><span style="text-align: center; width: 100%"> </span></div>',1),Eg=P("<p> </p>"),Lg=P("<p><!></p>"),Cg=P("<p><!></p>"),Mg=P("<p><!></p>"),Pg=P("<!> <!> <!> <!>",1),Ig=P("<!> <!> <!> <!>",1);function Tg(n,e){Ne(e,!0);const t=()=>ye(yo,"$metricBuckets",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=we(!1),i=we(!1),f=we(!1);var v=Ig(),b=V(v);{const T=A=>{var x=yg(),L=V(x);{let g=u(()=>ta.toReversed()),p=u(()=>({buckets:Pl(oa).toReversed()}));Ar(L,{get colorScale(){return r(g)},get labels(){return r(p)}})}var D=h(L,2),R=c(D),O=c(R),z=h(R,2),d=c(z);Z((g,p)=>{U(O,g),U(d,p)},[()=>r(s).t(210),()=>r(s).t(211)]),_(A,x)},M=A=>{var x=wg();{const D=(R,O=Pe)=>{var z=Ag(),d=c(z);Z(g=>U(d,g),[()=>r(s).tx(O())]),_(R,z)};var L=c(x);{let R=u(()=>[D]),O=u(()=>r(s).cx(212));pe(L,{get t(){return r(R)},get x(){return r(O)}})}}_(A,x)};let I=u(()=>r(s).t(209));Br(b,{get label(){return r(I)},onChange:()=>{r(l)&&(K(i,!1),K(f,!1))},get show(){return r(l)},set show(A){K(l,A,!0)},legend:T,help:M,$$slots:{legend:!0,help:!0}})}var m=h(b,2);{const T=A=>{var x=xg(),L=V(x);{let $=u(()=>({limits:t().population_density}));Ar(L,{get colorScale(){return ea},get labels(){return r($)}})}var D=h(L,2),R=c(D),O=c(R),z=h(R,2),d=c(z),g=h(z,2),p=c(g);Z(($,w,y)=>{U(O,$),U(d,w),U(p,y)},[()=>r(s).t(214),()=>r(s).t(215),()=>r(s).t(216)]),_(A,x)},M=A=>{var x=kg();{const D=(R,O=Pe)=>{var z=$g(),d=c(z);Z(g=>U(d,g),[()=>r(s).tx(O())]),_(R,z)};var L=c(x);{let R=u(()=>[D]),O=u(()=>r(s).cx(217));pe(L,{get t(){return r(R)},get x(){return r(O)}})}}_(A,x)};let I=u(()=>r(s).t(213));Br(m,{get label(){return r(I)},onChange:()=>{r(i)&&(K(l,!1),K(f,!1))},get show(){return r(i)},set show(A){K(i,A,!0)},legend:T,help:M,$$slots:{legend:!0,help:!0}})}var C=h(m,2);{const T=A=>{var x=Sg(),L=V(x);{let z=u(()=>ra.toReversed()),d=u(()=>({limits:na.toReversed().map(g=>`${g}%`)}));Ar(L,{get colorScale(){return r(z)},get labels(){return r(d)}})}var D=h(L,2),R=c(D),O=c(R);Z(z=>U(O,z),[()=>r(s).t(219)]),_(A,x)},M=A=>{var x=Eg(),L=c(x);Z(D=>U(L,D),[()=>r(s).t(220)]),_(A,x)};let I=u(()=>r(s).t(218));Br(C,{get label(){return r(I)},onChange:()=>{r(f)&&(K(l,!1),K(i,!1))},get show(){return r(f)},set show(A){K(f,A,!0)},legend:T,help:M,$$slots:{legend:!0,help:!0}})}var j=h(C,2);{let T=u(()=>`pmtiles://${en("cnt/layers/population.pmtiles")}`);ba(j,{get url(){return r(T)},children:(M,I)=>{var A=Pg(),x=V(A);{let O=u(()=>Ge("context-simd")),z=u(()=>({"fill-color":vr(["get","imd_percentile"],oa,ta),"fill-opacity":bt(.7,.9)})),d=u(()=>({visibility:r(l)?"visible":"none"}));cr(x,Ie(()=>r(O),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(z)},get layout(){return r(d)},children:(g,p)=>{Bt(g,{openOn:"hover",children:(w,y)=>{let F=()=>y?.().data;const k=u(()=>F().properties);var N=Lg(),S=c(N);{let E=u(()=>r(s).cx(221)),B=u(()=>[r(k).id,r(k).population.toLocaleString(),r(k).imd_rank,r(k).imd_percentile]);pe(S,{get x(){return r(E)},get a(){return r(B)}})}_(w,N)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var L=h(x,2);{let O=u(()=>Ge("context-population-car-ownership")),z=u(()=>({"fill-color":vr(["*",100,["/",["get","households_with_cars_or_vans"],["get","total_households"]]],na,ra),"fill-opacity":bt(.7,.9)})),d=u(()=>({visibility:r(f)?"visible":"none"}));cr(L,Ie(()=>r(O),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(z)},get layout(){return r(d)},children:(g,p)=>{Bt(g,{openOn:"hover",children:(w,y)=>{let F=()=>y?.().data;const k=u(()=>F().properties);var N=Cg(),S=c(N);{let E=u(()=>r(s).cx(222)),B=u(()=>[r(k).id,Xi(r(k).households_with_cars_or_vans,r(k).total_households),r(k).total_households.toLocaleString()]);pe(S,{get x(){return r(E)},get a(){return r(B)}})}_(w,N)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var D=h(L,2);{let O=u(()=>Ge("context-population-density")),z=u(()=>({"fill-color":vr(["/",["get","population"],["/",["get","area"],1e6]],t().population_density,ea),"fill-opacity":bt(.7,.9)})),d=u(()=>({visibility:r(i)?"visible":"none"}));cr(D,Ie(()=>r(O),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(z)},get layout(){return r(d)},children:(g,p)=>{Bt(g,{openOn:"hover",children:(w,y)=>{let F=()=>y?.().data;const k=u(()=>F().properties);var N=Mg(),S=c(N);{let E=u(()=>r(s).cx(223)),B=u(()=>[r(k).id,r(k).population.toLocaleString(),Math.round(r(k).population/(r(k).area/1e6)).toLocaleString()]);pe(S,{get x(){return r(E)},get a(){return r(B)}})}_(w,N)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var R=h(D,2);{let O=u(()=>Ge("context-population-outline")),z=u(()=>({visibility:r(l)||r(i)||r(f)?"visible":"none"}));gt(R,Ie(()=>r(O),{sourceLayer:"population",paint:{"line-color":"black","line-width":1},get layout(){return r(z)}}))}_(M,A)},$$slots:{default:!0}})}_(n,v),Be(),a()}var Rg=P("<img/>"),Ng=P('<div style="display: flex; gap: 8px; align-items: center;"><!></div>'),Bg=P('<a href="https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation" target="_blank"> </a>'),Fg=P("<p><!></p>"),Og=P("<p> </p>"),jg=P("<!> <!>",1);function zg(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=we(!1);var a=jg(),s=V(a);{const i=b=>{var m=Ng();{const j=T=>{var M=Rg();Z(I=>{ze(M,"src",Wl),ze(M,"alt",I)},[()=>r(t).t(225)]),_(T,M)};var C=c(m);{let T=u(()=>[j]),M=u(()=>r(t).cx(226));pe(C,{get t(){return r(T)},get x(){return r(M)}})}}_(b,m)},f=b=>{var m=Fg();{const j=(T,M=Pe)=>{var I=Bg(),A=c(I);Z(x=>U(A,x),[()=>r(t).tx(M())]),_(T,I)};var C=c(m);{let T=u(()=>[j]),M=u(()=>r(t).cx(227));pe(C,{get t(){return r(T)},get x(){return r(M)}})}}_(b,m)};let v=u(()=>r(t).t(224));Br(s,{get label(){return r(v)},get show(){return r(o)},set show(b){K(o,b,!0)},legend:i,help:f,$$slots:{legend:!0,help:!0}})}var l=h(s,2);{let i=u(()=>en("cnt/layers/railways.geojson"));it(l,{get data(){return r(i)},generateId:!0,children:(f,v)=>{{let b=u(()=>Ge("context-railway-stations")),m=u(()=>({"icon-image":"national_rail","icon-size":1,"icon-allow-overlap":!0,visibility:r(o)?"visible":"none"}));po(f,Ie(()=>r(b),{get layout(){return r(m)},children:(C,j)=>{Bt(C,{openOn:"hover",children:(M,I)=>{let A=()=>I?.().data;var x=Og(),L=c(x);Z(D=>U(L,D),[()=>A().properties.name??r(t).t(228)]),_(M,x)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}_(n,a),Be()}var Dg=P('<a href="https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data" target="_blank"> </a>'),Ug=P('<a href="https://www.gov.uk/guidance/road-accident-and-safety-statistics-guidance" target="_blank"> </a>'),Gg=P('<a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" target="_blank"> </a>'),Wg=P("<p><!></p> <ul><li> </li> <li> </li> <li> </li> <li> </li> <li><!></li></ul> <p> </p> <p><!></p>",1),Hg=P('<input type="checkbox" class="svelte-1pznq80"/>'),qg=P('<input type="checkbox" class="svelte-1pznq80"/>'),Jg=P('<input type="number" class="svelte-1pznq80"/>'),Qg=P('<input type="number" class="svelte-1pznq80"/>'),Zg=P('<fieldset style="display: flex; gap: 3em;" class="svelte-1pznq80"><label><!></label> <label><!></label></fieldset> <fieldset class="year-filter svelte-1pznq80"><label><!></label> <label><!></label></fieldset> <!>',1),Vg=P("<b> </b>"),Kg=P("<b> </b>"),Xg=P("<b> </b>"),Yg=P("<b> </b>"),e_=P("<p><!></p>"),t_=P("<b> </b>"),r_=P("<p><!></p>"),n_=P("<p><!></p> <p><!></p> <p><!></p> <!> <!> <p> </p>",1),o_=P("<!> <!>",1),a_=P("<!> <!>",1);function i_(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=we(!1),a=ht({pedestrians:!0,cyclists:!0,minYear:2017,maxYear:2023});function s(x){let L=["any"];return a.pedestrians&&L.push(["get","pedestrian"]),a.cyclists&&L.push(["get","cyclist"]),["all",[">=",["get","year"],a.minYear],["<=",["get","year"],a.maxYear],L]}function l(x){let L=[];return x.pedestrian&&L.push("pedestrian"),x.cyclist&&L.push("cyclist"),L.join(", ")}function i(x){window.open(`https://www.cyclestreets.net/collisions/reports/${x.features[0].properties.accident_index}`,"_blank")}let f={1:"Crossing on pedestrian crossing facility",2:"Crossing in zig-zag approach lines",3:"Crossing in zig-zag exit lines",4:"Crossing elsewhere within 50m. of pedestrian crossing",5:"In carriageway, crossing elsewhere",6:"On footway or verge",7:"On refuge, central island or central reservation",8:"In centre of carriageway - not on refuge, island or central reservation",9:"In carriageway, not crossing"},v={1:"Crossing from driver's nearside",2:"Crossing from nearside - masked by parked or stationary vehicle",3:"Crossing from driver's offside",4:"Crossing from offside - masked by parked or stationary vehicle",5:"In carriageway, stationary - not crossing (standing or playing)",6:"In carriageway, stationary - not crossing (standing or playing - masked by parked or stationary vehicle)",7:"Walking along in carriageway, facing traffic",8:"Walking along in carriageway, back to traffic"},b={1:"Fatal",2:"Serious",3:"Slight"},m="#080C54",C="#1F9EB7",j="#CDE594",T={Slight:j,Serious:C,Fatal:m};var M=a_(),I=V(M);{const x=R=>{var O=Wg(),z=V(O);{const ue=(te,ne=Pe)=>{var oe=Dg(),H=c(oe);Z(J=>U(H,J),[()=>r(t).tx(ne())]),_(te,oe)};var d=c(z);{let te=u(()=>[ue]),ne=u(()=>r(t).cx(244));pe(d,{get t(){return r(te)},get x(){return r(ne)}})}}var g=h(z,2),p=c(g),$=c(p),w=h(p,2),y=c(w),F=h(w,2),k=c(F),N=h(F,2),S=c(N),E=h(N,2);{const ue=(te,ne=Pe)=>{var oe=Ug(),H=c(oe);Z(J=>U(H,J),[()=>r(t).tx(ne())]),_(te,oe)};var B=c(E);{let te=u(()=>[ue]),ne=u(()=>r(t).cx(249));pe(B,{get t(){return r(te)},get x(){return r(ne)}})}}var G=h(g,2),Q=c(G),q=h(G,2);{const ue=(te,ne=Pe)=>{var oe=Gg(),H=c(oe);Z(J=>U(H,J),[()=>r(t).tx(ne())]),_(te,oe)};var X=c(q);{let te=u(()=>[ue]),ne=u(()=>r(t).cx(251));pe(X,{get t(){return r(te)},get x(){return r(ne)}})}}Z((ue,te,ne,oe,H)=>{U($,ue),U(y,te),U(k,ne),U(S,oe),U(Q,H)},[()=>r(t).t(245),()=>r(t).t(246),()=>r(t).t(247),()=>r(t).t(248),()=>r(t).t(250)]),_(R,O)},L=R=>{var O=Zg(),z=V(O),d=c(z);{const E=B=>{var G=Hg();un(G,()=>a.pedestrians,Q=>a.pedestrians=Q),_(B,G)};var g=c(d);{let B=u(()=>[E]),G=u(()=>r(t).cx(252));pe(g,{get t(){return r(B)},get x(){return r(G)}})}}var p=h(d,2);{const E=B=>{var G=qg();un(G,()=>a.cyclists,Q=>a.cyclists=Q),_(B,G)};var $=c(p);{let B=u(()=>[E]),G=u(()=>r(t).cx(253));pe($,{get t(){return r(B)},get x(){return r(G)}})}}var w=h(z,2),y=c(w);{const E=B=>{var G=Jg();ze(G,"min",2017),ze(G,"max",2023),aa(G,()=>a.minYear,Q=>a.minYear=Q),_(B,G)};var F=c(y);{let B=u(()=>[E]),G=u(()=>r(t).cx(254));pe(F,{get t(){return r(B)},get x(){return r(G)}})}}var k=h(y,2);{const E=B=>{var G=Qg();ze(G,"min",2017),ze(G,"max",2023),aa(G,()=>a.maxYear,Q=>a.maxYear=Q),_(B,G)};var N=c(k);{let B=u(()=>[E]),G=u(()=>r(t).cx(255));pe(N,{get t(){return r(B)},get x(){return r(G)}})}}var S=h(w,2);cs(S,{get labelColors(){return T},swatchClass:"circle",itemsPerRow:3}),_(R,O)};let D=u(()=>r(t).t(243));Br(I,{get label(){return r(D)},get show(){return r(o)},set show(R){K(o,R,!0)},help:x,legend:L,$$slots:{help:!0,legend:!0}})}var A=h(I,2);{let x=u(()=>`pmtiles://${en("cnt/layers/stats19.pmtiles")}`);ba(A,{get url(){return r(x)},children:(L,D)=>{var R=o_(),O=V(R);{let d=u(()=>Ge("context-stats19-heatmap")),g=u(()=>s()),p=u(()=>({visibility:r(o)?"visible":"none"}));vd(O,Ie(()=>r(d),{sourceLayer:"stats19",maxzoom:13,get filter(){return r(g)},get layout(){return r(p)},paint:{"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,15]}}))}var z=h(O,2);{let d=u(()=>Ge("context-stats19-points")),g=u(()=>({"circle-color":vr(["get","severity"],[1,2,3],[m,C,j]),"circle-opacity":.9,"circle-radius":13,"circle-stroke-color":"black","circle-stroke-width":.1})),p=u(()=>s()),$=u(()=>({visibility:r(o)?"visible":"none"}));Nn(z,Ie(()=>r(d),{sourceLayer:"stats19",minzoom:13,get paint(){return r(g)},get filter(){return r(p)},get layout(){return r($)},hoverCursor:"pointer",onclick:i,children:(w,y)=>{Bt(w,{openOn:"click",children:(k,N)=>{let S=()=>N?.().data;const E=u(()=>S().properties);var B=n_(),G=V(B);{const ae=Y=>{var ie=Vg(),_e=c(ie);Z(()=>U(_e,r(E).year)),_(Y,ie)};var Q=c(G);{let Y=u(()=>[ae]),ie=u(()=>r(t).cx(256));pe(Q,{get t(){return r(Y)},get x(){return r(ie)}})}}var q=h(G,2);{const ae=Y=>{var ie=Kg(),_e=c(ie);Z(()=>U(_e,b[r(E).severity])),_(Y,ie)};var X=c(q);{let Y=u(()=>[ae]),ie=u(()=>r(t).cx(257));pe(X,{get t(){return r(Y)},get x(){return r(ie)}})}}var ue=h(q,2);{const ae=Y=>{var ie=Xg(),_e=c(ie);Z(le=>U(_e,le),[()=>l(r(E))]),_(Y,ie)};var te=c(ue);{let Y=u(()=>[ae]),ie=u(()=>r(t).cx(258));pe(te,{get t(){return r(Y)},get x(){return r(ie)}})}}var ne=h(ue,2);{var oe=ae=>{var Y=e_();{const _e=le=>{var fe=Yg(),se=c(fe);Z(()=>U(se,f[r(E).pedestrian_location])),_(le,fe)};var ie=c(Y);{let le=u(()=>[_e]),fe=u(()=>r(t).cx(259));pe(ie,{get t(){return r(le)},get x(){return r(fe)}})}}_(ae,Y)};ve(ne,ae=>{r(E).pedestrian_location&&ae(oe)})}var H=h(ne,2);{var J=ae=>{var Y=r_();{const _e=le=>{var fe=t_(),se=c(fe);Z(()=>U(se,v[r(E).pedestrian_movement])),_(le,fe)};var ie=c(Y);{let le=u(()=>[_e]),fe=u(()=>r(t).cx(260));pe(ie,{get t(){return r(le)},get x(){return r(fe)}})}}_(ae,Y)};ve(H,ae=>{r(E).pedestrian_movement&&ae(J)})}var ee=h(H,2),re=c(ee);Z(ae=>U(re,ae),[()=>r(t).t(261)]),_(k,B)},$$slots:{default:!0}})},$$slots:{default:!0}}))}_(L,R)},$$slots:{default:!0}})}_(n,M),Be()}var s_=(n,e)=>K(e,!r(e)),l_=P('<div class="layer-group"> </div> <!> <!> <!> <div class="layer-group"> </div> <!> <!> <div class="layer-group"> </div> <!>',1),u_=P("<!> <!>",1),c_=P('<input type="checkbox" role="switch"/>'),d_=P('<div class="pico contextual-layers svelte-6ypeli"><button><div style="display: flex; gap: 12px; color: #333; align-items: center; justify-content: center;"><!> <!></div></button> <div class="contextual-layer-controls svelte-6ypeli"><!> <div class="context-control"><span style="font-size: 20px; margin-left: 8px; margin-top: 4px;"> </span> <select style="width: auto; font-size: 20px; margin: 8px; padding: 8px; text-overflow: ellipsis;"><option> </option><option> </option><option> </option><option> </option></select> <!> <span style="font-size: 20px; margin-left: 8px; margin-top: 4px;"> </span> <label><!></label> <!></div></div></div>');function f_(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",f),o=()=>ye(ja,"$showExistingFiltersAndTRs",f),a=()=>ye(nn,"$appFocus",f),s=()=>ye(Ci,"$maptilerBasemap",f),l=()=>ye(za,"$useMetricUnits",f),i=()=>ye(ia,"$devMode",f),[f,v]=lt(),b=u(()=>ut(ct("main")));let m=we(!1);ji(n,{defaultStyling:!0,children:(C,j)=>{var T=d_();let M;var I=c(T);I.__click=[s_,m];var A=c(I),x=c(A);td(x,{color:"#333"});var L=h(x,2);{var D=oe=>{var H=Ut();Z(J=>U(H,J),[()=>r(b).t(196)]),_(oe,H)};ve(L,oe=>{r(m)&&oe(D)})}var R=h(I,2);let O;var z=c(R);{var d=oe=>{var H=u_(),J=V(H);{let ae=u(()=>r(b).t(197));Br(J,{get label(){return r(ae)},get show(){return sa(),o()},set show(Y){Qe(ja,Y)}})}var ee=h(J,2);{var re=ae=>{var Y=l_(),ie=V(Y),_e=c(ie),le=h(ie,2);Tg(le,{});var fe=h(le,2);bg(fe,{});var se=h(fe,2);i_(se,{});var Ae=h(se,2),me=c(Ae),ke=h(Ae,2);zg(ke,{});var Se=h(ke,2);ef(Se,{});var We=h(Se,2),xe=c(We),Le=h(We,2);fg(Le,{}),Z((he,Re,Ce)=>{U(_e,he),U(me,Re),U(xe,Ce)},[()=>r(b).t(198),()=>r(b).t(199),()=>r(b).t(200)]),_(ae,Y)};ve(ee,ae=>{a()=="cnt"&&ae(re)})}_(oe,H)};ve(z,oe=>{t()&&oe(d)})}var g=h(z,2),p=c(g),$=c(p),w=h(p,2),y=c(w),F=c(y);y.value=y.__value="dataviz";var k=h(y),N=c(k);k.value=k.__value="streets-v2";var S=h(k),E=c(S);S.value=S.__value="hybrid";var B=h(S),G=c(B);B.value=B.__value="uk-openzoomstack-light";var Q=h(w,2);Il(Q,{});var q=h(Q,2),X=c(q),ue=h(q,2);{const oe=H=>{var J=c_();un(J,l,ee=>Qe(za,ee)),_(H,J)};var te=c(ue);{let H=u(()=>[oe]),J=u(()=>r(b).cx(467));pe(te,{get t(){return r(H)},get x(){return r(J)}})}}var ne=h(ue,2);{let oe=u(()=>r(b).t(206));Br(ne,{get label(){return r(oe)},get show(){return sa(),i()},set show(H){Qe(ia,H)}})}Z((oe,H,J,ee,re,ae,Y,ie,_e)=>{M=gr(T,"display: flex; flex-direction: column; border-radius: 5px;",M,oe),St(I,1,`show-layers-button icon-btn ${r(m)?"expanded":""}`,"svelte-6ypeli"),ze(I,"aria-label",H),O=gr(R,"flex-direction: column;",O,J),U($,ee),U(F,re),U(N,ae),U(E,Y),U(G,ie),U(X,_e)},[()=>({width:r(m)?"300px":"auto"}),()=>r(b).t(196),()=>({display:r(m)?"flex":"none"}),()=>r(b).t(201),()=>r(b).t(202),()=>r(b).t(203),()=>r(b).t(204),()=>r(b).t(205),()=>r(b).t(475)]),An(w,s,oe=>Qe(Ci,oe)),_(C,T)},$$slots:{default:!0}}),Be(),v()}rr(["click"]);var v_=P('<div class="flex-container svelte-eqsjzd"><div class="top svelte-eqsjzd"><!></div> <div class="content svelte-eqsjzd"><div class="left svelte-eqsjzd"><!></div> <div class="main svelte-eqsjzd"><!></div></div></div>');function g_(n,e){Ne(e,!0),Je(()=>{Vo.value&&Ya.value&&(Vo.value.innerHTML="",Vo.value.appendChild(Ya.value))}),Je(()=>{Ko.value&&ei.value&&(Ko.value.innerHTML="",Ko.value.appendChild(ei.value))}),Je(()=>{Xo.value&&ti.value&&(Xo.value.innerHTML="",Xo.value.appendChild(ti.value))});var t=v_(),o=c(t),a=c(o);Tt(a,()=>e.top??Pe);var s=h(o,2),l=c(s),i=c(l);Tt(i,()=>e.left??Pe);var f=h(l,2),v=c(f);Tt(v,()=>e.main??Pe),_(n,t),Be()}var __=P("<div><!></div> <div><!></div> <div><!></div>",1);function Mr(n,e){Ne(e,!0);var t=__(),o=V(t),a=c(o);Tt(a,()=>e.top??Pe),vn(o,v=>Ya.value=v,()=>Ya?.value);var s=h(o,2),l=c(s);Tt(l,()=>e.left??Pe),vn(s,v=>ei.value=v,()=>ei?.value);var i=h(s,2),f=c(i);Tt(f,()=>e.main??Pe),vn(i,v=>ti.value=v,()=>ti?.value),_(n,t),Be()}let Ya=ht({value:void 0}),ei=ht({value:void 0}),ti=ht({value:void 0}),Vo=ht({value:void 0}),Ko=ht({value:void 0}),Xo=ht({value:void 0}),ge,Do=null;function go(){return(Do===null||Do.byteLength===0)&&(Do=new Uint8Array(ge.memory.buffer)),Do}let Oa=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});Oa.decode();const p_=2146435072;let wi=0;function h_(n,e){return wi+=e,wi>=p_&&(Oa=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),Oa.decode(),wi=e),Oa.decode(go().subarray(n,n+e))}function kt(n,e){return n=n>>>0,h_(n,e)}function Uo(n){const e=ge.__externref_table_alloc();return ge.__wbindgen_export_2.set(e,n),e}function xi(n,e){try{return n.apply(this,e)}catch(t){const o=Uo(t);ge.__wbindgen_exn_store(o)}}function Au(n,e){return n=n>>>0,go().subarray(n/1,n/1+e)}let tr=0;const Yo=new TextEncoder;"encodeInto"in Yo||(Yo.encodeInto=function(n,e){const t=Yo.encode(n);return e.set(t),{read:n.length,written:t.length}});function Lr(n,e,t){if(t===void 0){const i=Yo.encode(n),f=e(i.length,1)>>>0;return go().subarray(f,f+i.length).set(i),tr=i.length,f}let o=n.length,a=e(o,1)>>>0;const s=go();let l=0;for(;l<o;l++){const i=n.charCodeAt(l);if(i>127)break;s[a+l]=i}if(l!==o){l!==0&&(n=n.slice(l)),a=t(a,o,o=l+n.length*3,1)>>>0;const i=go().subarray(a+l,a+o),f=Yo.encodeInto(n,i);l+=f.written,a=t(a,o,l,1)>>>0}return tr=l,a}let Xn=null;function sn(){return(Xn===null||Xn.buffer.detached===!0||Xn.buffer.detached===void 0&&Xn.buffer!==ge.memory.buffer)&&(Xn=new DataView(ge.memory.buffer)),Xn}function Xr(n){return n==null}function Vi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const a=n.description;return a==null?"Symbol":`Symbol(${a})`}if(e=="function"){const a=n.name;return typeof a=="string"&&a.length>0?`Function(${a})`:"Function"}if(Array.isArray(n)){const a=n.length;let s="[";a>0&&(s+=Vi(n[0]));for(let l=1;l<a;l++)s+=", "+Vi(n[l]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let o;if(t&&t.length>1)o=t[1];else return toString.call(n);if(o=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:o}function vl(n,e){const t=e(n.length*1,1)>>>0;return go().set(n,t/1),tr=n.length,t}function nt(n){const e=ge.__wbindgen_export_2.get(n);return ge.__externref_table_dealloc(n),e}let Go=null;function m_(){return(Go===null||Go.byteLength===0)&&(Go=new Float64Array(ge.memory.buffer)),Go}function b_(n,e){return n=n>>>0,m_().subarray(n/8,n/8+e)}let Wo=null;function y_(){return(Wo===null||Wo.byteLength===0)&&(Wo=new Uint32Array(ge.memory.buffer)),Wo}function A_(n,e){const t=e(n.length*4,4)>>>0;return y_().set(n,t/4),tr=n.length,t}const gl=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>ge.__wbg_ltn_free(n>>>0,1));class Ki{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,gl.unregister(this),e}free(){const e=this.__destroy_into_raw();ge.__wbg_ltn_free(e,0)}constructor(e,t,o,a,s,l,i){const f=vl(e,ge.__wbindgen_malloc),v=tr,b=vl(t,ge.__wbindgen_malloc),m=tr,C=Lr(a,ge.__wbindgen_malloc,ge.__wbindgen_realloc),j=tr;var T=Xr(s)?0:Lr(s,ge.__wbindgen_malloc,ge.__wbindgen_realloc),M=tr;const I=Lr(l,ge.__wbindgen_malloc,ge.__wbindgen_realloc),A=tr,x=ge.ltn_new(f,v,b,m,o,C,j,T,M,I,A,i);if(x[2])throw nt(x[1]);return this.__wbg_ptr=x[0]>>>0,gl.register(this,this.__wbg_ptr,this),this}getInvertedBoundary(){let e,t;try{const s=ge.ltn_getInvertedBoundary(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getBounds(){const e=ge.ltn_getBounds(this.__wbg_ptr);var t=b_(e[0],e[1]).slice();return ge.__wbindgen_free(e[0],e[1]*8,8),t}toRouteSnapper(){const e=ge.ltn_toRouteSnapper(this.__wbg_ptr);var t=Au(e[0],e[1]).slice();return ge.__wbindgen_free(e[0],e[1]*1,1),t}toRouteSnapperGj(){let e,t;try{const s=ge.ltn_toRouteSnapperGj(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderModalFilters(){let e,t;try{const s=ge.ltn_renderModalFilters(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderModalFiltersBeforeEdits(){let e,t;try{const s=ge.ltn_renderModalFiltersBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderTurnRestrictions(){let e,t;try{const s=ge.ltn_renderTurnRestrictions(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderTurnRestrictionsBeforeEdits(){let e,t;try{const s=ge.ltn_renderTurnRestrictionsBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderNeighbourhood(){let e,t;try{const s=ge.ltn_renderNeighbourhood(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderNeighbourhoodBeforeEdits(){let e,t;try{const s=ge.ltn_renderNeighbourhoodBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}generatedBoundaries(){let e,t;try{const s=ge.ltn_generatedBoundaries(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}generateMergedBoundary(e){let t,o;try{const l=ge.ltn_generateMergedBoundary(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,nt(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}extractWaypointsFromRing(e){let t,o;try{const l=ge.ltn_extractWaypointsFromRing(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,nt(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}setCurrentNeighbourhoodBoundary(e,t){const o=Lr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=tr,s=ge.ltn_setCurrentNeighbourhoodBoundary(this.__wbg_ptr,o,a,t);if(s[1])throw nt(s[0])}deleteNeighbourhoodBoundary(e){const t=Lr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=tr;ge.ltn_deleteNeighbourhoodBoundary(this.__wbg_ptr,t,o)}renameNeighbourhoodBoundary(e,t){const o=Lr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=tr,s=Lr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),l=tr;ge.ltn_renameNeighbourhoodBoundary(this.__wbg_ptr,o,a,s,l)}setCurrentNeighbourhood(e){const t=Lr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=tr,a=ge.ltn_setCurrentNeighbourhood(this.__wbg_ptr,t,o);if(a[1])throw nt(a[0])}addModalFilter(e,t){const o=Lr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=tr,s=ge.ltn_addModalFilter(this.__wbg_ptr,e,o,a);if(s[1])throw nt(s[0])}addManyModalFilters(e,t){const o=Lr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=tr,s=ge.ltn_addManyModalFilters(this.__wbg_ptr,e,o,a);if(s[1])throw nt(s[0])}deleteModalFilter(e){ge.ltn_deleteModalFilter(this.__wbg_ptr,e)}addDiagonalFilter(e){const t=ge.ltn_addDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw nt(t[0])}rotateDiagonalFilter(e){const t=ge.ltn_rotateDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw nt(t[0])}deleteDiagonalFilter(e){const t=ge.ltn_deleteDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw nt(t[0])}addTurnRestriction(e,t){const o=ge.ltn_addTurnRestriction(this.__wbg_ptr,e,t);if(o[1])throw nt(o[0])}deleteTurnRestriction(e,t,o){const a=ge.ltn_deleteTurnRestriction(this.__wbg_ptr,e,t,o);if(a[1])throw nt(a[0])}getTurnRestrictionTargets(e){let t,o;try{const l=ge.ltn_getTurnRestrictionTargets(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,nt(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}toggleTravelFlow(e){ge.ltn_toggleTravelFlow(this.__wbg_ptr,e)}toggleMainRoad(e){const t=ge.ltn_toggleMainRoad(this.__wbg_ptr,e);if(t[1])throw nt(t[0])}setMainRoads(e,t){const o=A_(e,ge.__wbindgen_malloc),a=tr,s=ge.ltn_setMainRoads(this.__wbg_ptr,o,a,t);if(s[1])throw nt(s[0])}eraseAllMainRoads(){const e=ge.ltn_eraseAllMainRoads(this.__wbg_ptr);if(e[1])throw nt(e[0])}undo(){const e=ge.ltn_undo(this.__wbg_ptr);if(e[1])throw nt(e[0])}redo(){const e=ge.ltn_redo(this.__wbg_ptr);if(e[1])throw nt(e[0])}getShortcutsCrossingRoad(e){let t,o;try{const l=ge.ltn_getShortcutsCrossingRoad(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,nt(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getAllShortcuts(){let e,t;try{const s=ge.ltn_getAllShortcuts(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getAllShortcutsBeforeEdits(){let e,t;try{const s=ge.ltn_getAllShortcutsBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}toSavefile(){let e,t;try{const s=ge.ltn_toSavefile(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}loadSavefile(e){const t=ge.ltn_loadSavefile(this.__wbg_ptr,e);if(t[1])throw nt(t[0])}changeProjectName(e){const t=Lr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=tr;ge.ltn_changeProjectName(this.__wbg_ptr,t,o)}compareRoute(e,t,o,a,s){let l,i;try{const b=ge.ltn_compareRoute(this.__wbg_ptr,e,t,o,a,s);var f=b[0],v=b[1];if(b[3])throw f=0,v=0,nt(b[2]);return l=f,i=v,kt(f,v)}finally{ge.__wbindgen_free(l,i,1)}}impactToOneDestination(e,t){let o,a;try{const i=ge.ltn_impactToOneDestination(this.__wbg_ptr,e,t);var s=i[0],l=i[1];if(i[3])throw s=0,l=0,nt(i[2]);return o=s,a=l,kt(s,l)}finally{ge.__wbindgen_free(o,a,1)}}predictImpact(e){let t,o;try{const l=ge.ltn_predictImpact(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,nt(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getImpactsOnRoad(e,t){let o,a;try{const i=ge.ltn_getImpactsOnRoad(this.__wbg_ptr,e,t);var s=i[0],l=i[1];if(i[3])throw s=0,l=0,nt(i[2]);return o=s,a=l,kt(s,l)}finally{ge.__wbindgen_free(o,a,1)}}getAllIntersections(){let e,t;try{const s=ge.ltn_getAllIntersections(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getMovements(e){let t,o;try{const l=ge.ltn_getMovements(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,nt(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getDemandModel(){let e,t;try{const s=ge.ltn_getDemandModel(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getPOIs(){let e,t;try{const s=ge.ltn_getPOIs(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getMetricBuckets(){let e,t;try{const s=ge.ltn_getMetricBuckets(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,nt(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getOsmTimestamp(){const e=ge.ltn_getOsmTimestamp(this.__wbg_ptr);return e[0]===0?void 0:e[1]}setHideUnimportantCells(e){ge.ltn_setHideUnimportantCells(this.__wbg_ptr,e)}}Symbol.dispose&&(Ki.prototype[Symbol.dispose]=Ki.prototype.free);const w_=new Set(["basic","cors","default"]);async function x_(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(o){if(n.ok&&w_.has(n.type)&&n.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function $_(){const n={};return n.wbg={},n.wbg.__wbg_Error_e17e777aac105295=function(e,t){return Error(kt(e,t))},n.wbg.__wbg_call_13410aac570ffff7=function(){return xi(function(e,t){return e.call(t)},arguments)},n.wbg.__wbg_debug_c906769d2f88c17b=function(e){console.debug(e)},n.wbg.__wbg_done_75ed0ee6dd243d9d=function(e){return e.done},n.wbg.__wbg_entries_2be2f15bd5554996=function(e){return Object.entries(e)},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let o,a;try{o=e,a=t,console.error(kt(e,t))}finally{ge.__wbindgen_free(o,a,1)}},n.wbg.__wbg_error_99981e16d476aa5c=function(e){console.error(e)},n.wbg.__wbg_get_0da715ceaecea5c8=function(e,t){return e[t>>>0]},n.wbg.__wbg_get_458e874b43b18b25=function(){return xi(function(e,t){return Reflect.get(e,t)},arguments)},n.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,t){return e[t]},n.wbg.__wbg_info_6cf68c1a86a92f6a=function(e){console.info(e)},n.wbg.__wbg_instanceof_ArrayBuffer_67f3012529f6a2dd=function(e){let t;try{t=e instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_instanceof_Map_ebb01a5b6b5ffd0b=function(e){let t;try{t=e instanceof Map}catch{t=!1}return t},n.wbg.__wbg_instanceof_Uint8Array_9a8378d955933db7=function(e){let t;try{t=e instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_isArray_030cce220591fb41=function(e){return Array.isArray(e)},n.wbg.__wbg_isSafeInteger_1c0d1af5542e102a=function(e){return Number.isSafeInteger(e)},n.wbg.__wbg_iterator_f370b34483c71a1c=function(){return Symbol.iterator},n.wbg.__wbg_length_186546c51cd61acd=function(e){return e.length},n.wbg.__wbg_length_6bb7e81f9d7713e4=function(e){return e.length},n.wbg.__wbg_log_6c7b5f4f00b8ce3f=function(e){console.log(e)},n.wbg.__wbg_new_638ebfaedbf32a5e=function(e){return new Uint8Array(e)},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_newnoargs_254190557c45b4ec=function(e,t){return new Function(kt(e,t))},n.wbg.__wbg_next_5b3530e612fde77d=function(e){return e.next},n.wbg.__wbg_next_692e82279131b03c=function(){return xi(function(e){return e.next()},arguments)},n.wbg.__wbg_now_882dd9fbc163f00d=function(e){return e.now()},n.wbg.__wbg_performance_686bdd9b0415bed6=function(e){return e.performance},n.wbg.__wbg_prototypesetcall_3d4a26c1ed734349=function(e,t,o){Uint8Array.prototype.set.call(Au(e,t),o)},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const o=t.stack,a=Lr(o,ge.__wbindgen_malloc,ge.__wbindgen_realloc),s=tr;sn().setInt32(e+4,s,!0),sn().setInt32(e+0,a,!0)},n.wbg.__wbg_static_accessor_GLOBAL_8921f820c2ce3f12=function(){const e=typeof global>"u"?null:global;return Xr(e)?0:Uo(e)},n.wbg.__wbg_static_accessor_GLOBAL_THIS_f0a4409105898184=function(){const e=typeof globalThis>"u"?null:globalThis;return Xr(e)?0:Uo(e)},n.wbg.__wbg_static_accessor_SELF_995b214ae681ff99=function(){const e=typeof self>"u"?null:self;return Xr(e)?0:Uo(e)},n.wbg.__wbg_static_accessor_WINDOW_cde3890479c675ea=function(){const e=typeof window>"u"?null:window;return Xr(e)?0:Uo(e)},n.wbg.__wbg_value_dd9372230531eade=function(e){return e.value},n.wbg.__wbg_warn_e2ada06313f92f09=function(e){console.warn(e)},n.wbg.__wbg_wbindgenbigintgetasi64_ac743ece6ab9bba1=function(e,t){const o=t,a=typeof o=="bigint"?o:void 0;sn().setBigInt64(e+8,Xr(a)?BigInt(0):a,!0),sn().setInt32(e+0,!Xr(a),!0)},n.wbg.__wbg_wbindgenbooleanget_3fe6f642c7d97746=function(e){const t=e,o=typeof t=="boolean"?t:void 0;return Xr(o)?16777215:o?1:0},n.wbg.__wbg_wbindgendebugstring_99ef257a3ddda34d=function(e,t){const o=Vi(t),a=Lr(o,ge.__wbindgen_malloc,ge.__wbindgen_realloc),s=tr;sn().setInt32(e+4,s,!0),sn().setInt32(e+0,a,!0)},n.wbg.__wbg_wbindgenin_d7a1ee10933d2d55=function(e,t){return e in t},n.wbg.__wbg_wbindgenisbigint_ecb90cc08a5a9154=function(e){return typeof e=="bigint"},n.wbg.__wbg_wbindgenisfunction_8cee7dce3725ae74=function(e){return typeof e=="function"},n.wbg.__wbg_wbindgenisobject_307a53c6bd97fbf8=function(e){const t=e;return typeof t=="object"&&t!==null},n.wbg.__wbg_wbindgenisundefined_c4b71d073b92f3c5=function(e){return e===void 0},n.wbg.__wbg_wbindgenjsvaleq_e6f2ad59ccae1b58=function(e,t){return e===t},n.wbg.__wbg_wbindgenjsvallooseeq_9bec8c9be826bed1=function(e,t){return e==t},n.wbg.__wbg_wbindgennumberget_f74b4c7525ac05cb=function(e,t){const o=t,a=typeof o=="number"?o:void 0;sn().setFloat64(e+8,Xr(a)?0:a,!0),sn().setInt32(e+0,!Xr(a),!0)},n.wbg.__wbg_wbindgenstringget_0f16a6ddddef376f=function(e,t){const o=t,a=typeof o=="string"?o:void 0;var s=Xr(a)?0:Lr(a,ge.__wbindgen_malloc,ge.__wbindgen_realloc),l=tr;sn().setInt32(e+4,l,!0),sn().setInt32(e+0,s,!0)},n.wbg.__wbg_wbindgenthrow_451ec1a8469d7eb6=function(e,t){throw new Error(kt(e,t))},n.wbg.__wbindgen_cast_2241b6af4c4b2941=function(e,t){return kt(e,t)},n.wbg.__wbindgen_cast_4625c577ab2ec9ee=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_cast_9ae0607507abb057=function(e){return e},n.wbg.__wbindgen_init_externref_table=function(){const e=ge.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n}function k_(n,e){return ge=n.exports,wu.__wbindgen_wasm_module=e,Xn=null,Go=null,Wo=null,Do=null,ge.__wbindgen_start(),ge}async function wu(n){if(ge!==void 0)return ge;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/ltn/assets/backend_bg-qDQnRCxD.wasm",import.meta.url));const e=$_();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:o}=await x_(await n,e);return k_(t,o)}const S_="/ltn/assets/streets-v2-style-CzuG29E5.json";function _n(n,e){Ne(e,!0);const[t,o]=lt(),a=u(()=>ut(ct("main")));function s(l){l.key==r(a).t(49)&&(l.stopPropagation(),Qe(yt,e.mode))}ro("keydown",_a,s),pa(n,{onclick:()=>Qe(yt,e.mode),children:(l,i)=>{var f=Ut();Z(v=>U(f,v),[()=>r(a).t(50)]),_(l,f)}}),Be(),o()}let si=Rn(null);function E_(n,e,t){let o=r(e).pop();K(e,r(e),!0),o&&t(o)}var L_=P('<input type="checkbox"/>'),C_=P("<span></span>"),M_=P("<b> </b>"),P_=P("<b> </b>"),I_=P("<b> </b>"),T_=P('<ul style="padding-right: 0; padding-left: 20px; margin: 0;"><li><!></li> <li><!></li> <li><!></li></ul>'),R_=P("<span></span> <!>",1),N_=P("<!> <!>",1),B_=P('<p> </p> <div style="display: flex; gap: 16px;"><label><!></label> <button class="secondary"><!></button></div> <!> <!> <!> <!> <!>',1);function xu(n,e){Ne(e,!0);const t=()=>ye(si,"$routeTool",o),[o,a]=lt(),s=[],l=u(()=>ut(ct("main")));let i=W(e,"waypoints",15),f=W(e,"drawnShapeOut",15,void 0);function v(H,J){if(J.length<3)return JSON.parse(H.inner.calculateRoute(J));let ee=JSON.parse(JSON.stringify(J));ee.push(ee[0]);let re=JSON.parse(H.inner.calculateRoute(ee));return re.properties.waypoints.pop(),re.geometry.type=r(l).t(368),re.geometry.coordinates=[re.geometry.coordinates],re}dr(()=>{t()?.stop(),e.map.getCanvas().style.cursor="inherit"});let b=we("snap"),m=we(ht([])),C=we(ht([]));Je(()=>{K(C,z(t(),i(),r(I)),!0)});let j=we(null),T=we(!1),M=we(!1),I=we(!1);function A(){r(m).length==100&&r(m).shift(),K(m,[...r(m),JSON.parse(JSON.stringify(i()))],!0)}function x(H){i().length>=3||(A(),i().push({point:H.lngLat.toArray(),snapped:r(b)=="snap"}),i(i()))}function L(H){K(j,{point:H.lngLat.toArray(),snapped:r(b)=="snap"},!0)}function D(H){A(),i(i()[H].snapped=!i()[H].snapped,!0),i(i())}function R(H){A(),i().splice(H,1),i(i()),K(T,!1)}function O(H,J,ee,re){if(re||J.length>=3)return or();try{if(H&&J.length>0&&ee)return JSON.parse(H.inner.calculateRoute([J[J.length-1],ee]))}catch{}return or()}function z(H,J,ee){if(ee)return r(C);if(!H||J.length<3)return[];let re=[],ae=1,Y=JSON.parse(JSON.stringify(J));Y.push(Y[0]);for(let ie=0;ie<Y.length-1;ie++){let _e=JSON.parse(H.inner.getExtraNodes(Y[ie],Y[ie+1]));for(let[le,fe,se]of _e)re.push({point:[le,fe],snapped:se,insertIdx:ae});ae++}return re}function d(H){A(),i().splice(H.insertIdx,0,{point:H.point,snapped:H.snapped}),i(i()),K(I,!0)}function g(H){i(i()[H.insertIdx].point=H.point,!0),i(i())}function p(){K(I,!1)}function $(){A(),K(M,!0)}Je(()=>{try{t()&&f(v(t(),i()))}catch(H){console.log("error drawing shape",H),f(void 0)}});let w=u(()=>O(t(),i(),r(j),r(T)||r(M)));Je(()=>{let H=i().length==0?"crosshair":"inherit";e.map.getCanvas().style.cursor=H});var y=B_(),F=V(y),k=c(F),N=h(F,2),S=c(N);{const H=J=>{var ee=L_();ee.value=ee.__value="snap",Z(()=>ee.disabled=i().length>=3),Mi(s,[],ee,()=>r(b),re=>K(b,re)),_(J,ee)};var E=c(S);{let J=u(()=>[H]),ee=u(()=>r(l).cx(370));pe(E,{get t(){return r(J)},get x(){return r(ee)}})}}var B=h(S,2);B.__click=[E_,m,i];var G=c(B);{var Q=H=>{var J=Ut();Z(ee=>U(J,ee),[()=>r(l).t(371)]),_(H,J)},q=H=>{{let J=u(()=>r(l).cx(372)),ee=u(()=>[r(m).length]);pe(H,{get x(){return r(J)},get a(){return r(ee)}})}};ve(G,H=>{r(m).length==0?H(Q):H(q,!1)})}var X=h(N,2);ma(X,{onclick:x,onmousemove:L});var ue=h(X,2);Zt(ue,17,()=>r(C),Vt,(H,J,ee)=>{_o(H,{draggable:!0,ondragstart:()=>d(r(J)),ondrag:()=>g(r(J)),ondragend:p,onclick:()=>{d(r(J)),K(I,!1)},zIndex:0,get lngLat(){return r(J).point},set lngLat(re){r(J).point=re},children:(re,ae)=>{var Y=C_();let ie;Z(_e=>ie=St(Y,1,"dot svelte-29me5d",null,ie,_e),[()=>({"snapped-node":r(J).snapped,"free-node":!r(J).snapped,hide:r(I)})]),_(re,Y)},$$slots:{default:!0}})});var te=h(ue,2);Zt(te,17,i,Vt,(H,J,ee)=>{_o(H,{draggable:!0,onclick:()=>D(ee),oncontextmenu:()=>R(ee),onmouseenter:()=>K(T,!0),onmouseleave:()=>K(T,!1),ondragstart:$,ondragend:()=>K(M,!1),zIndex:1,get lngLat(){return r(J).point},set lngLat(re){r(J).point=re},children:(re,ae)=>{var Y=R_(),ie=V(Y);let _e;ie.textContent=ee+1;var le=h(ie,2);Bt(le,{openOn:"hover",popupClass:"edit-waypoint-popup",children:(se,Ae)=>{var me=T_(),ke=c(me);{const Re=(Ce,be=Pe)=>{var Me=M_(),Te=c(Me);Z(Ee=>U(Te,Ee),[()=>r(l).tx(be())]),_(Ce,Me)};var Se=c(ke);{let Ce=u(()=>[Re]),be=u(()=>r(l).cx(182));pe(Se,{get t(){return r(Ce)},get x(){return r(be)}})}}var We=h(ke,2);{const Re=(Ce,be=Pe)=>{var Me=P_(),Te=c(Me);Z(Ee=>U(Te,Ee),[()=>r(l).tx(be())]),_(Ce,Me)};var xe=c(We);{let Ce=u(()=>[Re]),be=u(()=>r(l).cx(373));pe(xe,{get t(){return r(Ce)},get x(){return r(be)}})}}var Le=h(We,2);{const Re=(Ce,be=Pe)=>{var Me=I_(),Te=c(Me);Z(Ee=>U(Te,Ee),[()=>r(l).tx(be())]),_(Ce,Me)};var he=c(Le);{let Ce=u(()=>[Re]),be=u(()=>r(l).cx(183));pe(he,{get t(){return r(Ce)},get x(){return r(be)}})}}_(se,me)},$$slots:{default:!0}}),Z(fe=>_e=St(ie,1,"dot svelte-29me5d",null,_e,fe),[()=>({snapped:r(J).snapped})]),_(re,Y)},$$slots:{default:!0}})});var ne=h(te,2);{let H=u(()=>f()||or());it(ne,{get data(){return r(H)},generateId:!0,children:(J,ee)=>{var re=N_(),ae=V(re);{let ie=u(()=>Ge("draw-area-lines"));gt(ae,Ie(()=>r(ie),{paint:{"line-color":"black","line-width":10}}))}var Y=h(ae,2);{let ie=u(()=>Ge("draw-area-area"));cr(Y,Ie(()=>r(ie),{paint:{"fill-color":"grey","fill-opacity":.5}}))}_(J,re)},$$slots:{default:!0}})}var oe=h(ne,2);it(oe,{get data(){return r(w)},children:(H,J)=>{{let ee=u(()=>Ge("draw-area-lines-preview"));gt(H,Ie(()=>r(ee),{paint:{"line-color":"black","line-width":3}}))}},$$slots:{default:!0}}),Z(H=>{U(k,H),B.disabled=r(m).length==0},[()=>r(l).t(369)]),_(n,y),Be(),a()}rr(["click"]);var F_=P('<div><div class="bucket-color svelte-4l5cu8"></div> <div class="bucket-indicator svelte-4l5cu8"><!></div></div>'),O_=P('<div class="colors svelte-4l5cu8"></div>');function Zn(n,e){function t(s,l){let i=0;for(let f of s.slice(1,-1)){if(l<f)break;i++}return i}let o=u(()=>t(e.limits,e.value));var a=O_();Zt(a,21,()=>e.colorScale,Vt,(s,l,i)=>{var f=F_();let v;var b=c(f);let m;var C=h(b,2),j=c(C);Zc(j,{strokeWidth:"4px",size:"14px"}),Z((T,M)=>{v=St(f,1,"bucket svelte-4l5cu8",null,v,T),m=gr(b,"",m,M)},[()=>({selected:i==r(o)}),()=>({background:r(l)})]),_(s,f)}),_(n,a)}var j_=P("<tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td> </td></tr>",1),z_=P('<table class="svelte-j2xl4e"><tbody><tr><th><!></th><td><!></td></tr><!></tbody></table>');function $u(n,e){Ne(e,!0);const t=()=>ye(nn,"$appFocus",a),o=()=>ye(yo,"$metricBuckets",a),[a,s]=lt(),l=u(()=>ut(ct("main")));var i=z_(),f=c(i),v=c(f),b=c(v);{const I=A=>{Zn(A,{get colorScale(){return Yi},get limits(){return os},get value(){return e.neighbourhoodBoundary.properties.area_km2}})};var m=c(b);{let A=u(()=>[I]),x=u(()=>r(l).cx(107));pe(m,{get t(){return r(A)},get x(){return r(x)}})}}var C=h(b),j=c(C);{let I=u(()=>r(l).cx(108)),A=u(()=>[e.neighbourhoodBoundary.properties.area_km2.toFixed(1)]);pe(j,{get x(){return r(I)},get a(){return r(A)}})}var T=h(v);{var M=I=>{var A=j_(),x=V(A),L=c(x);{const ae=Y=>{{let ie=u(()=>ta.toReversed()),_e=u(()=>100-e.neighbourhoodBoundary.properties.simd);Zn(Y,{get colorScale(){return r(ie)},get limits(){return oa},get value(){return r(_e)}})}};var D=c(L);{let Y=u(()=>[ae]),ie=u(()=>r(l).cx(109));pe(D,{get t(){return r(Y)},get x(){return r(ie)}})}}var R=h(L),O=c(R);{let ae=u(()=>r(l).cx(110)),Y=u(()=>[1+Math.floor(e.neighbourhoodBoundary.properties.simd/20)]);pe(O,{get x(){return r(ae)},get a(){return r(Y)}})}var z=h(x,2),d=c(z);{const ae=Y=>{{let ie=u(()=>e.neighbourhoodBoundary.properties.population/e.neighbourhoodBoundary.properties.area_km2);Zn(Y,{get colorScale(){return ea},get limits(){return o().population_density},get value(){return r(ie)}})}};var g=c(d);{let Y=u(()=>[ae]),ie=u(()=>r(l).cx(111));pe(g,{get t(){return r(Y)},get x(){return r(ie)}})}}var p=h(d),$=c(p);{let ae=u(()=>r(l).cx(112)),Y=u(()=>[Math.round(e.neighbourhoodBoundary.properties.population/e.neighbourhoodBoundary.properties.area_km2).toLocaleString()]);pe($,{get x(){return r(ae)},get a(){return r(Y)}})}var w=h(z,2),y=c(w);{const ae=Y=>{{let ie=u(()=>ra.toReversed()),_e=u(()=>100*(1-e.neighbourhoodBoundary.properties.households_with_cars_or_vans/e.neighbourhoodBoundary.properties.total_households));Zn(Y,{get colorScale(){return r(ie)},get limits(){return na},get value(){return r(_e)}})}};var F=c(y);{let Y=u(()=>[ae]),ie=u(()=>r(l).cx(113));pe(F,{get t(){return r(Y)},get x(){return r(ie)}})}}var k=h(y),N=c(k);{let ae=u(()=>r(l).cx(114)),Y=u(()=>[Xi(e.neighbourhoodBoundary.properties.households_with_cars_or_vans,e.neighbourhoodBoundary.properties.total_households)]);pe(N,{get x(){return r(ae)},get a(){return r(Y)}})}var S=h(w,2),E=c(S);{const ae=Y=>{{let ie=u(()=>e.neighbourhoodBoundary.properties.number_pois/e.neighbourhoodBoundary.properties.area_km2);Zn(Y,{get colorScale(){return es},get limits(){return o().poi_density},get value(){return r(ie)}})}};var B=c(E);{let Y=u(()=>[ae]),ie=u(()=>r(l).cx(115));pe(B,{get t(){return r(Y)},get x(){return r(ie)}})}}var G=h(E),Q=c(G);{let ae=u(()=>r(l).cx(116)),Y=u(()=>[(e.neighbourhoodBoundary.properties.number_pois/e.neighbourhoodBoundary.properties.area_km2).toFixed(1)]);pe(Q,{get x(){return r(ae)},get a(){return r(Y)}})}var q=h(S,2),X=c(q);{const ae=Y=>{{let ie=u(()=>e.neighbourhoodBoundary.properties.number_stats19_collisions/e.neighbourhoodBoundary.properties.area_km2);Zn(Y,{get colorScale(){return ts},get limits(){return o().collision_density},get value(){return r(ie)}})}};var ue=c(X);{let Y=u(()=>[ae]),ie=u(()=>r(l).cx(117));pe(ue,{get t(){return r(Y)},get x(){return r(ie)}})}}var te=h(X),ne=c(te);{let ae=u(()=>r(l).cx(116)),Y=u(()=>[(e.neighbourhoodBoundary.properties.number_stats19_collisions/e.neighbourhoodBoundary.properties.area_km2).toFixed(1)]);pe(ne,{get x(){return r(ae)},get a(){return r(Y)}})}var oe=h(q,2),H=c(oe);{const ae=Y=>{Zn(Y,{get colorScale(){return ns},get limits(){return rs},get value(){return e.neighbourhoodBoundary.properties.combined_score}})};var J=c(H);{let Y=u(()=>[ae]),ie=u(()=>r(l).cx(118));pe(J,{get t(){return r(Y)},get x(){return r(ie)}})}}var ee=h(H),re=c(ee);Z(()=>U(re,`${e.neighbourhoodBoundary.properties.combined_score??""} / 5`)),_(I,A)};ve(T,I=>{t()=="cnt"&&I(M)})}_(n,i),Be(),s()}function ku(n,e,t){let o=new Set(n.toSavefile().features.filter(a=>a.properties.kind=="boundary").map(a=>a.properties.name));for(;;){let a=window.prompt(e,t);if(a===null)return null;if(a=a.trim(),a==="")window.alert("Neighbourhood cannot be blank; please pick a name or cancel");else if(o.has(a))window.alert(`There is already a neighbourhood called ${a}; please pick another name`);else return a}}var D_=P('<!> <div class="sub-labels svelte-173u12u"><span></span> <span> </span> <span></span></div>',1),U_=P('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span> <span> </span></div>',1),G_=P('<!> <div style="display: flex; justify-content: space-between;"><span style="text-align: center; width: 100%"> </span></div>',1),W_=P('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span></div>',1),H_=P('<!> <div style="text-align: center;"> </div>',1),q_=P('<!> <div style="text-align: center;"> </div>',1),J_=P('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span></div> <br/> <p> </p>',1),Q_=P('<div style="display: flex; gap: 16px; align-items: center; width: fit-content;"><label style="margin: 0; padding: 0;" for="prioritization-selection"> </label> <select id="prioritization-selection"><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option></select></div> <!>',1);function Su(n,e){Ne(e,!0);const t=()=>ye(nn,"$appFocus",a),o=()=>ye(yo,"$metricBuckets",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=W(e,"selectedPrioritization",15);function f(){let S=new URL(window.location.href).searchParams.get("prioritisationMetric");S=="area"?i("area"):S=="population_density"?i("population_density"):S=="simd"?i("simd"):S=="stats19"?i("stats19"):S=="pois"?i("pois"):S=="car_ownership"?i("car_ownership"):S=="combined"&&i("combined")}t()=="cnt"?f():i("none"),Je(()=>{const S=new URL(window.location.href);i()=="none"?S.searchParams.delete("prioritisationMetric"):S.searchParams.set("prioritisationMetric",i()),history.replaceState({},"",S)});var v=Q_(),b=V(v),m=c(b),C=c(m),j=h(m,2),T=c(j),M=c(T);T.value=T.__value="none";var I=h(T),A=c(I);I.value=I.__value="area";var x=h(I),L=c(x);x.value=x.__value="simd";var D=h(x),R=c(D);D.value=D.__value="population_density";var O=h(D),z=c(O);O.value=O.__value="car_ownership";var d=h(O),g=c(d);d.value=d.__value="pois";var p=h(d),$=c(p);p.value=p.__value="stats19";var w=h(p),y=c(w);w.value=w.__value="combined";var F=h(b,2);{var k=S=>{var E=D_(),B=V(E);{let X=u(()=>({limits:os}));Ar(B,{get colorScale(){return Yi},get labels(){return r(X)}})}var G=h(B,2),Q=h(c(G),2),q=c(Q);Z(X=>U(q,X),[()=>r(l).t(267)]),_(S,E)},N=S=>{var E=$e(),B=V(E);{var G=q=>{var X=U_(),ue=V(X);{let ae=u(()=>({limits:o().population_density}));Ar(ue,{get colorScale(){return ea},get labels(){return r(ae)}})}var te=h(ue,2),ne=c(te),oe=c(ne),H=h(ne,2),J=c(H),ee=h(H,2),re=c(ee);Z((ae,Y,ie)=>{U(oe,ae),U(J,Y),U(re,ie)},[()=>r(l).t(214),()=>r(l).t(215),()=>r(l).t(216)]),_(q,X)},Q=q=>{var X=$e(),ue=V(X);{var te=oe=>{var H=G_(),J=V(H);{let Y=u(()=>ra.toReversed()),ie=u(()=>({limits:na.toReversed().map(_e=>`${_e}%`)}));Ar(J,{get colorScale(){return r(Y)},get labels(){return r(ie)}})}var ee=h(J,2),re=c(ee),ae=c(re);Z(Y=>U(ae,Y),[()=>r(l).t(219)]),_(oe,H)},ne=oe=>{var H=$e(),J=V(H);{var ee=ae=>{var Y=W_(),ie=V(Y);{let me=u(()=>ta.toReversed()),ke=u(()=>({buckets:Pl(oa).toReversed()}));Ar(ie,{get colorScale(){return r(me)},get labels(){return r(ke)}})}var _e=h(ie,2),le=c(_e),fe=c(le),se=h(le,2),Ae=c(se);Z((me,ke)=>{U(fe,me),U(Ae,ke)},[()=>r(l).t(210),()=>r(l).t(211)]),_(ae,Y)},re=ae=>{var Y=$e(),ie=V(Y);{var _e=fe=>{var se=H_(),Ae=V(se);{let Se=u(()=>({limits:o().collision_density}));Ar(Ae,{get colorScale(){return ts},get labels(){return r(Se)}})}var me=h(Ae,2),ke=c(me);Z(Se=>U(ke,Se),[()=>r(l).t(268)]),_(fe,se)},le=fe=>{var se=$e(),Ae=V(se);{var me=Se=>{var We=q_(),xe=V(We);{let Re=u(()=>({limits:o().poi_density}));Ar(xe,{get colorScale(){return es},get labels(){return r(Re)}})}var Le=h(xe,2),he=c(Le);Z(Re=>U(he,Re),[()=>r(l).t(269)]),_(Se,We)},ke=Se=>{var We=$e(),xe=V(We);{var Le=he=>{var Re=J_(),Ce=V(Re);{let Fe=u(()=>({buckets:rs}));Ar(Ce,{get colorScale(){return ns},get labels(){return r(Fe)}})}var be=h(Ce,2),Me=c(be),Te=c(Me),Ee=h(Me,2),Ue=c(Ee),De=h(be,4),qe=c(De);Z((Fe,He,Ze)=>{U(Te,Fe),U(Ue,He),U(qe,Ze)},[()=>r(l).t(270),()=>r(l).t(271),()=>r(l).t(272)]),_(he,Re)};ve(xe,he=>{i()=="combined"&&he(Le)},!0)}_(Se,We)};ve(Ae,Se=>{i()=="pois"?Se(me):Se(ke,!1)},!0)}_(fe,se)};ve(ie,fe=>{i()=="stats19"?fe(_e):fe(le,!1)},!0)}_(ae,Y)};ve(J,ae=>{i()=="simd"?ae(ee):ae(re,!1)},!0)}_(oe,H)};ve(ue,oe=>{i()=="car_ownership"?oe(te):oe(ne,!1)},!0)}_(q,X)};ve(B,q=>{i()=="population_density"?q(G):q(Q,!1)},!0)}_(S,E)};ve(F,S=>{i()=="area"?S(k):S(N,!1)})}Z((S,E,B,G,Q,q,X,ue,te)=>{U(C,S),U(M,E),U(A,B),U(L,G),U(R,Q),U(z,q),U(g,X),U($,ue),U(y,te)},[()=>r(l).t(262),()=>r(l).t(263),()=>r(l).t(264),()=>r(l).t(209),()=>r(l).t(213),()=>r(l).t(218),()=>r(l).t(265),()=>r(l).t(243),()=>r(l).t(266)]),An(j,i),_(n,v),Be(),s()}function Eu(n,e,t){return{none:n.none,area:vr(["get","area_km2"],os,Yi),car_ownership:vr(["*",100,["/",["get","households_with_cars_or_vans"],["get","total_households"]]],na,ra),population_density:vr(["/",["get","population"],["get","area_km2"]],t.population_density,ea),pois:vr(["/",["get","number_pois"],["get","area_km2"]],t.poi_density,es),simd:vr(["get","simd"],oa,ta),stats19:vr(["/",["get","number_stats19_collisions"],["get","area_km2"]],t.collision_density,ts),combined:vr(["get","combined_score"],rs,ns)}[e]}function Z_(n,e){as("auto_boundaries.geojson",JSON.stringify(r(e),null,"  "))}function V_(n,e,t,o){K(e,null),r(t).clear(),K(t,r(t),!0),K(o,[],!0)}var K_=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav>'),X_=P("<h3> </h3> <p> </p> <!>",1),Y_=P("<p> </p>"),ep=(n,e)=>K(e,"choose-area"),tp=P("<button><!></button>"),rp=(n,e)=>K(e,"draw-area"),np=P("<button><!></button>"),op=P('<div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div> <div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div>',1),ap=P('<div><h3 class="svelte-1ly46ps"> </h3></div> <!> <div style="margin-top: 16px;"><h3 class="svelte-1ly46ps"> </h3> <p> </p></div>',1),ip=(n,e,t)=>e(r(t)),sp=P('<span style="text-align:center;"><!></span>'),lp=P('<!> <!> <!> <hr/> <div><div class="tool-palette svelte-1ly46ps" style="display: flex; align-items: center; gap: 16px;"><!></div> <!> <div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div> <div style="display: flex; gap: 16px; justify-content: space-between; margin-bottom: 16px;"><button> </button> <button class="destructive" style="display: flex; gap: 8px; align-items: center;"><!></button></div> <h3> </h3> <div class="neighbourhood-boundary-summary svelte-1ly46ps"><!></div></div> <hr/> <button class="secondary"> </button>',1),up=P("<!> <!>",1),cp=P("<b> </b>"),dp=P("<b> </b>"),fp=P("<br/>"),vp=P("<b> </b>"),gp=P("<br/>"),_p=P("<b> </b>"),pp=P("<br/>"),hp=P("<b> </b>"),mp=P("<br/>"),bp=P("<b> </b> <br/> ",1),yp=P("<!> <!>",1),Ap=P("<!> <!>",1),wp=P("<!> <!>",1);function xp(n,e){Ne(e,!0);const t=()=>ye(nn,"$appFocus",v),o=()=>ye(Rt,"$backend",v),a=()=>ye(Ao,"$projectStorage",v),s=()=>ye(xn,"$currentProjectID",v),l=()=>ye(yt,"$mode",v),i=()=>ye(yo,"$metricBuckets",v),f=()=>ye(rn,"$map",v),[v,b]=lt(),m=u(()=>ut(ct("main")));let C=we("Generating severance boundaries..."),j=we(ht(or())),T=we("choose-area"),M=we(ht(t()=="cnt"?"combined":"none")),I=we(null),A=we(ht(new Map)),x=we(ht([])),L=we(void 0),D=u(()=>{if(r(L)&&r(L).geometry.coordinates[0].length>3){let F={type:"FeatureCollection",features:[r(L)]};try{return o().generateMergedBoundary(F)}catch(k){console.log(`error merging boundaries: ${k}`)}}return null}),R=u(()=>r(T)=="draw-area"?r(D):r(I));gn(async()=>{await ni(),K(j,o().generatedBoundaries(),!0),K(C,"")});function O(F){let k=F.features[0].id,N=r(j).features[k],S=new Map(r(A));if(S.has(k)?S.delete(k):S.set(k,N),S.size===0)K(I,null),K(A,S,!0);else if(S.size===1)K(I,S.values().next().value,!0),K(A,S,!0);else{let E={type:"FeatureCollection",features:Array.from(S.values())};try{K(I,o().generateMergedBoundary(E),!0),K(A,S,!0)}catch(B){console.log(`error merging boundaries: ${B}`),window.alert(`Sorry, the boundaries you selected cannot be merged.
Error: ${B}`)}}}function z(F){let k=a().nextAvailableNeighbourhoodName(s()),N=ku(o(),r(m).t(15),k);if(N)try{const S={};r(T)=="draw-area"&&r(L)?.properties?.waypoints&&(S.waypoints=r(L).properties.waypoints);let E={type:"Feature",properties:S,geometry:F.geometry};o().setCurrentNeighbourhoodBoundary(N,E),Qe(co,N),la(),Qe(yt,{mode:"neighbourhood"})}catch(S){window.alert(`Sorry, this boundary is invalid: ${S}`)}}function d(F){return Eu({none:["match",["%",["id"],5],0,"blue",1,"yellow",2,"green",3,"purple",4,"orange","black"]},F,i())}function g(F){return{none:bt(.3,.5),area:bt(.7,.9),car_ownership:bt(.7,.9),population_density:bt(.7,.9),pois:bt(.7,.9),simd:bt(.7,.9),stats19:bt(.7,.9),combined:bt(.7,.9)}[F]}function p(F){F.key==r(m).t(16)&&r(R)&&z(r(R))}var $=wp();ro("keydown",_a,p);var w=V($);ho(w,{get loading(){return r(C)}});var y=h(w,2);Mr(y,{top:S=>{var E=K_(),B=c(E),G=c(B),Q=c(G);et(Q,{mode:{mode:"title"}});var q=h(G,2),X=c(q);et(X,{mode:{mode:"pick-neighbourhood"}});var ue=h(q,2),te=c(ue);Z(ne=>U(te,ne),[()=>wr(l().mode)]),_(S,E)},left:S=>{var E=lp(),B=V(E);_n(B,{mode:{mode:"pick-neighbourhood"}});var G=h(B,2);{var Q=be=>{var Me=X_(),Te=V(Me),Ee=c(Te),Ue=h(Te,2),De=c(Ue),qe=h(Ue,2);Su(qe,{get selectedPrioritization(){return r(M)},set selectedPrioritization(Fe){K(M,Fe,!0)}}),Z((Fe,He)=>{U(Ee,Fe),U(De,He)},[()=>r(m).t(17),()=>r(m).t(18)]),_(be,Me)};ve(G,be=>{t()=="cnt"&&be(Q)})}var q=h(G,2);{var X=be=>{var Me=Y_(),Te=c(Me);Z(Ee=>U(Te,Ee),[()=>r(m).t(19)]),_(be,Me)};ve(q,be=>{r(M)=="none"&&be(X)})}var ue=h(q,4),te=c(ue);{const be=(Te,Ee=Pe)=>{var Ue=tp();Ue.__click=[ep,T];let De;{const Fe=He=>{Jl(He,{})};var qe=c(Ue);{let He=u(()=>[Fe]);pe(qe,{get t(){return r(He)},get x(){return Ee()},n:!0})}}Z(Fe=>De=St(Ue,1,"",null,De,Fe),[()=>({active:r(T)=="choose-area"})]),_(Te,Ue)},Me=(Te,Ee=Pe)=>{var Ue=np();Ue.__click=[rp,T];let De;{const Fe=He=>{ls(He,{})};var qe=c(Ue);{let He=u(()=>[Fe]);pe(qe,{get t(){return r(He)},get x(){return Ee()},n:!0})}}Z(Fe=>De=St(Ue,1,"",null,De,Fe),[()=>({active:r(T)=="draw-area"})]),_(Te,Ue)};var ne=c(te);{let Te=u(()=>[be,Me]),Ee=u(()=>r(m).cx(20));pe(ne,{get t(){return r(Te)},get x(){return r(Ee)}})}}var oe=h(te,2);{var H=be=>{var Me=op(),Te=V(Me);let Ee;var Ue=c(Te),De=c(Ue),qe=h(Ue,2),Fe=c(qe),He=h(Te,2);let Ze;var rt=c(He),Ve=c(rt),Ke=h(rt,2),vt=c(Ke);Z((xt,mt,Mt,$t,Et,At)=>{Ee=St(Te,1,"step svelte-1ly46ps",null,Ee,xt),U(De,mt),U(Fe,Mt),Ze=St(He,1,"step svelte-1ly46ps",null,Ze,$t),U(Ve,Et),U(vt,At)},[()=>({active:!r(R),complete:r(R)}),()=>r(m).t(21),()=>r(m).t(22),()=>({active:r(R),complete:r(A).size>1}),()=>r(m).t(23),()=>r(m).t(24)]),_(be,Me)},J=be=>{var Me=$e(),Te=V(Me);{var Ee=Ue=>{var De=ap(),qe=V(De);let Fe;var He=c(qe),Ze=c(He),rt=h(qe,2);xu(rt,{get map(){return f()},get waypoints(){return r(x)},set waypoints($t){K(x,$t,!0)},get drawnShapeOut(){return r(L)},set drawnShapeOut($t){K(L,$t,!0)}});var Ve=h(rt,2);let Ke;var vt=c(Ve),xt=c(vt),mt=h(vt,2),Mt=c(mt);Z(($t,Et,At,Lt,Ot)=>{Fe=St(qe,1,"step svelte-1ly46ps",null,Fe,$t),U(Ze,Et),Ke=St(Ve,1,"step svelte-1ly46ps",null,Ke,At),U(xt,Lt),U(Mt,Ot)},[()=>({active:!r(R),complete:r(R)}),()=>r(m).t(25),()=>({active:r(R),complete:r(A).size>1}),()=>r(m).t(26),()=>r(m).t(27)]),_(Ue,De)};ve(Te,Ue=>{r(T)=="draw-area"&&Ue(Ee)},!0)}_(be,Me)};ve(oe,be=>{r(T)=="choose-area"?be(H):be(J,!1)})}var ee=h(oe,2);let re;var ae=c(ee),Y=c(ae),ie=h(ae,2),_e=c(ie),le=h(ee,2),fe=c(le);fe.__click=[ip,z,R];var se=c(fe),Ae=h(fe,2);Ae.__click=[V_,I,A,x];{const be=Me=>{ii(Me,{})};var me=c(Ae);{let Me=u(()=>[be]),Te=u(()=>r(m).cx(31));pe(me,{get t(){return r(Me)},get x(){return r(Te)}})}}var ke=h(le,2),Se=c(ke),We=h(ke,2),xe=c(We);{var Le=be=>{$u(be,{get neighbourhoodBoundary(){return r(R)}})},he=be=>{var Me=sp(),Te=c(Me);{var Ee=De=>{var qe=Ut();Z(Fe=>U(qe,Fe),[()=>r(m).t(477)]),_(De,qe)},Ue=De=>{var qe=$e(),Fe=V(qe);{var He=Ze=>{var rt=$e(),Ve=V(rt);{var Ke=xt=>{var mt=Ut();Z(Mt=>U(mt,Mt),[()=>r(m).t(34)]),_(xt,mt)},vt=xt=>{var mt=Ut();Z(Mt=>U(mt,Mt),[()=>r(m).t(35)]),_(xt,mt)};ve(Ve,xt=>{r(x).length<3?xt(Ke):xt(vt,!1)})}_(Ze,rt)};ve(Fe,Ze=>{r(T)=="draw-area"&&Ze(He)},!0)}_(De,qe)};ve(Te,De=>{r(T)=="choose-area"?De(Ee):De(Ue,!1)})}_(be,Me)};ve(xe,be=>{r(R)?be(Le):be(he,!1)})}var Re=h(ue,4);Re.__click=[Z_,j];var Ce=c(Re);Z((be,Me,Te,Ee,Ue,De)=>{re=St(ee,1,"step svelte-1ly46ps",null,re,be),U(Y,Me),U(_e,Te),fe.disabled=!r(R),U(se,Ee),Ae.disabled=!(r(R)||r(T)=="draw-area"&&r(x).length>0),U(Se,Ue),U(Ce,De)},[()=>({active:r(R)}),()=>r(m).t(28),()=>r(m).t(29),()=>r(m).t(30),()=>r(m).t(32),()=>r(m).t(36)]),_(S,E)},main:S=>{var E=Ap(),B=V(E);{var G=X=>{{let ue=u(()=>({type:r(m).t(37),features:[r(R)]}));it(X,{get data(){return r(ue)},children:(te,ne)=>{var oe=up(),H=V(oe);{let ee=u(()=>Ge("neighbourhood-boundaries-selected-outline",!1));gt(H,Ie(()=>r(ee),{paint:{"line-color":"black","line-width":4,"line-dasharray":[2,2]}}))}var J=h(H,2);{let ee=u(()=>Ge("neighbourhood-boundaries-selected-outline-base",!1));gt(J,Ie(()=>r(ee),{paint:{"line-color":"white","line-width":8}}))}_(te,oe)},$$slots:{default:!0}})}};ve(B,X=>{r(R)&&X(G)})}var Q=h(B,2);{var q=X=>{it(X,{get data(){return r(j)},generateId:!0,children:(ue,te)=>{var ne=yp(),oe=V(ne);{let J=u(()=>Ge("neighbourhood-boundaries",!1)),ee=u(()=>({"fill-color":d(r(M)),"fill-opacity":g(r(M))}));cr(oe,Ie(()=>r(J),{get paint(){return r(ee)},manageHoverState:!0,hoverCursor:"pointer",onclick:O,children:(re,ae)=>{var Y=$e(),ie=V(Y);{var _e=le=>{Bt(le,{openOn:"hover",children:(se,Ae)=>{let me=()=>Ae?.().data;const ke=u(()=>me().properties);var Se=$e(),We=V(Se);{var xe=he=>{const Re=(Ce,be=Pe)=>{var Me=cp(),Te=c(Me);Z(Ee=>U(Te,Ee),[()=>r(m).tx(be())]),_(Ce,Me)};{let Ce=u(()=>[Re]),be=u(()=>r(m).cx(38)),Me=u(()=>[r(ke).area_km2.toFixed(1)]);pe(he,{get t(){return r(Ce)},get x(){return r(be)},get a(){return r(Me)}})}},Le=he=>{var Re=$e(),Ce=V(Re);{var be=Te=>{const Ee=(De,qe=Pe)=>{var Fe=dp(),He=c(Fe);Z(Ze=>U(He,Ze),[()=>r(m).tx(qe())]),_(De,Fe)},Ue=De=>{var qe=fp();_(De,qe)};{let De=u(()=>[Ee,Ue]),qe=u(()=>r(m).cx(39)),Fe=u(()=>[Xi(r(ke).households_with_cars_or_vans,r(ke).total_households),r(ke).total_households.toLocaleString()]);pe(Te,{get t(){return r(De)},get x(){return r(qe)},get a(){return r(Fe)}})}},Me=Te=>{var Ee=$e(),Ue=V(Ee);{var De=Fe=>{const He=(rt,Ve=Pe)=>{var Ke=vp(),vt=c(Ke);Z(xt=>U(vt,xt),[()=>r(m).tx(Ve())]),_(rt,Ke)},Ze=rt=>{var Ve=gp();_(rt,Ve)};{let rt=u(()=>[He,Ze]),Ve=u(()=>r(m).cx(40)),Ke=u(()=>[Math.round(r(ke).population/r(ke).area_km2).toLocaleString()]);pe(Fe,{get t(){return r(rt)},get x(){return r(Ve)},get a(){return r(Ke)}})}},qe=Fe=>{var He=$e(),Ze=V(He);{var rt=Ke=>{const vt=(mt,Mt=Pe)=>{var $t=_p(),Et=c($t);Z(At=>U(Et,At),[()=>r(m).tx(Mt())]),_(mt,$t)},xt=mt=>{var Mt=pp();_(mt,Mt)};{let mt=u(()=>[vt,xt]),Mt=u(()=>r(m).cx(41)),$t=u(()=>[(r(ke).number_stats19_collisions/r(ke).area_km2).toFixed(1)]);pe(Ke,{get t(){return r(mt)},get x(){return r(Mt)},get a(){return r($t)}})}},Ve=Ke=>{var vt=$e(),xt=V(vt);{var mt=$t=>{const Et=(Lt,Ot=Pe)=>{var Kt=hp(),Pt=c(Kt);Z(It=>U(Pt,It),[()=>r(m).tx(Ot())]),_(Lt,Kt)},At=Lt=>{var Ot=mp();_(Lt,Ot)};{let Lt=u(()=>[Et,At]),Ot=u(()=>r(m).cx(42)),Kt=u(()=>[(r(ke).number_pois/r(ke).area_km2).toFixed(1)]);pe($t,{get t(){return r(Lt)},get x(){return r(Ot)},get a(){return r(Kt)}})}},Mt=$t=>{var Et=$e(),At=V(Et);{var Lt=Ot=>{var Kt=bp(),Pt=V(Kt),It=c(Pt),lr=h(Pt,3);Z(fr=>{U(It,fr),U(lr,` ${r(ke).combined_score??""}`)},[()=>r(m).t(43)]),_(Ot,Kt)};ve(At,Ot=>{r(M)=="combined"&&Ot(Lt)},!0)}_($t,Et)};ve(xt,$t=>{r(M)=="pois"?$t(mt):$t(Mt,!1)},!0)}_(Ke,vt)};ve(Ze,Ke=>{r(M)=="stats19"?Ke(rt):Ke(Ve,!1)},!0)}_(Fe,He)};ve(Ue,Fe=>{r(M)=="population_density"?Fe(De):Fe(qe,!1)},!0)}_(Te,Ee)};ve(Ce,Te=>{r(M)=="car_ownership"?Te(be):Te(Me,!1)},!0)}_(he,Re)};ve(We,he=>{r(M)=="none"||r(M)=="area"?he(xe):he(Le,!1)})}_(se,Se)},$$slots:{default:!0}})};ve(ie,le=>{r(M)!="simd"&&le(_e)})}_(re,Y)},$$slots:{default:!0}}))}var H=h(oe,2);{let J=u(()=>Ge("neighbourhood-boundaries-outline",!1));gt(H,Ie(()=>r(J),{paint:{"line-color":"black","line-width":1}}))}_(ue,ne)},$$slots:{default:!0}})};ve(Q,X=>{r(T)=="choose-area"&&X(q)})}_(S,E)},$$slots:{top:!0,left:!0,main:!0}}),_(n,$),Be(),b()}rr(["click"]);const $p="/ltn/assets/bus_gate_icon-uqLuLB7T.gif",kp="/ltn/assets/bus_gate-Dqp8PR-8.gif",Sp="/ltn/assets/no_entry_icon-C0369Zpr.gif",Ep="/ltn/assets/no_entry-t5FpsRr-.gif",Lp="/ltn/assets/school_street_icon-Dc8MrJ0F.gif",Cp="/ltn/assets/school_street-C6xhQwM-.gif",Mp="/ltn/assets/walk_cycle_only_icon-Cx19XghM.gif",Pp="/ltn/assets/walk_cycle_only-4uLhWa-f.gif";class Dt{filterType;label;description;imageUrl;iconUrl;constructor(e,t,o,a,s){this.filterType=e,this.label=t,this.description=o,this.imageUrl=a,this.iconUrl=s}get iconURL(){return this.iconUrl}get largeImageURL(){return this.imageUrl}static getFilter(e){switch(e){case"walk_cycle_only":return Dt.walkCycleOnly;case"no_entry":return Dt.noEntry;case"bus_gate":return Dt.busGate;case"school_street":return Dt.schoolStreet;default:console.assert(`unknown filter type: "${e}"`);return}}static walkCycleOnly=new Dt("walk_cycle_only","Walking/cycling only","A physical barrier that only allows people walking, cycling, and rolling to pass. Often planters or bollards. Larger vehicles cannot enter.",Pp,Mp);static noEntry=new Dt("no_entry","No entry","An alternative sign to indicate vehicles are not allowed to enter the street. Only people walking, cycling, and rolling may pass through.",Ep,Sp);static busGate=new Dt("bus_gate","Bus gate","A bus gate sign and traffic cameras are installed to allow buses, pedestrians, and cyclists to pass. There is no physical barrier.",kp,$p);static schoolStreet=new Dt("school_street","School street","A closure during school hours only. The barrier usually allows teachers and staff to access the school.",Cp,Lp);static allTypes=[Dt.walkCycleOnly,Dt.noEntry,Dt.busGate,Dt.schoolStreet]}var Ip=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),Tp=P('<input type="checkbox" role="switch"/>'),Rp=P("<u> </u> <p><!></p> <p><!></p> <p><!></p>",1),Np=P("<p> </p>"),Bp=P("<!> <p><!></p> <label><!></label> <p><!></p> <!> <hr/> <!>",1),Fp=P("<!> <!>",1);function Op(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",a),o=()=>ye(yt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=we(ht(or()));try{K(i,t().getDemandModel(),!0)}catch{window.alert("No demand model for this area"),Qe(yt,{mode:"pick-neighbourhood"})}let f=we(!1),v=we(void 0);function b(x,L){if(x==null){let D=L?"sum_to":"sum_from",R=Math.max(...r(i).features.map(z=>z.properties[D])),O=m(R);return[O,vr(["get",D],O,xa)]}else{let D=L?"counts_to":"counts_from",R=[...r(i).features.map(d=>d.properties[D][x])],O=Math.max(...R),z=m(O);return[z,vr(["at",["id"],["literal",R]],z,xa)]}}function m(x){let L=xa.length+1;return Array.from(Array(L).keys()).map(D=>Math.round(x/(L-1)*D))}let C=u(()=>r(v)?r(v).id:null),j=u(()=>r(C)!=null?r(i).features[r(C)]:null),T=u(()=>b(r(C),r(f))),M=u(()=>qr(r(T),2)),I=u(()=>r(M)[0]),A=u(()=>r(M)[1]);Mr(n,{top:R=>{var O=Ip(),z=c(O),d=c(z),g=c(d);et(g,{mode:{mode:"title"}});var p=h(d,2),$=c(p);et($,{mode:{mode:"pick-neighbourhood"}});var w=h(p,2),y=c(w);et(y,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var F=h(w,2),k=c(F);Z(N=>U(k,N),[()=>wr(o().mode)]),_(R,O)},left:R=>{var O=Bp(),z=V(O);_n(z,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var d=h(z,2),g=c(d);{let E=u(()=>r(l).cx(51)),B=u(()=>[r(i).features.length.toLocaleString()]);pe(g,{get x(){return r(E)},get a(){return r(B)}})}var p=h(d,2);{const E=B=>{var G=Tp();un(G,()=>r(f),Q=>K(f,Q)),_(B,G)};var $=c(p);{let B=u(()=>[E]),G=u(()=>r(l).cx(52));pe($,{get t(){return r(B)},get x(){return r(G)}})}}var w=h(p,2),y=c(w);{let E=u(()=>r(l).cx(53)),B=u(()=>[r(f)?"from":"to",r(C)==null?"each zone":"this zone"]);pe(y,{get x(){return r(E)},get a(){return r(B)}})}var F=h(w,2);{let E=u(()=>({limits:r(I)}));Ar(F,{get colorScale(){return xa},get labels(){return r(E)}})}var k=h(F,4);{var N=E=>{var B=Rp(),G=V(B),Q=c(G),q=h(G,2),X=c(q);{let H=u(()=>r(l).cx(54)),J=u(()=>[r(j).properties.sum_from.toLocaleString()]);pe(X,{get x(){return r(H)},get a(){return r(J)}})}var ue=h(q,2),te=c(ue);{let H=u(()=>r(l).cx(55)),J=u(()=>[r(j).properties.sum_to.toLocaleString()]);pe(te,{get x(){return r(H)},get a(){return r(J)}})}var ne=h(ue,2),oe=c(ne);{let H=u(()=>r(l).cx(56)),J=u(()=>[r(j).properties.counts_from[r(C)]]);pe(oe,{get x(){return r(H)},get a(){return r(J)}})}Z(()=>U(Q,r(j).properties.name)),_(E,B)},S=E=>{var B=Np(),G=c(B);Z(Q=>U(G,Q),[()=>r(l).t(57)]),_(E,B)};ve(k,E=>{r(j)&&r(C)!=null?E(N):E(S,!1)})}_(R,O)},main:R=>{it(R,{get data(){return r(i)},generateId:!0,children:(O,z)=>{var d=Fp(),g=V(d);{let $=u(()=>Ge("debug-demand-fill")),w=u(()=>({"fill-color":r(A),"fill-opacity":bt(.5,.1)}));cr(g,Ie(()=>r($),{get paint(){return r(w)},manageHoverState:!0,get hovered(){return r(v)},set hovered(y){K(v,y,!0)}}))}var p=h(g,2);{let $=u(()=>Ge("debug-demand-outline"));gt(p,Ie(()=>r($),{paint:{"line-width":2,"line-color":"black"}}))}_(O,d)},$$slots:{default:!0}})},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}var jp=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav>'),zp=(n,e)=>K(e,or(),!0),Dp=P('<button class="secondary"> </button> <!>',1),Up=P('<a target="_blank"> </a>'),Gp=P("<!> <p> </p> <!> <!>",1),Wp=P("<!> <!>",1),Hp=P("<!> <!>",1);function qp(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",a),o=()=>ye(yt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=we(null),f=we(ht(or())),v=we(0);function b(m){K(i,m.features[0].properties.osm,!0),K(f,t().getMovements(m.features[0].id),!0),K(v,0)}Mr(n,{top:T=>{var M=jp(),I=c(M),A=c(I),x=c(A);et(x,{mode:{mode:"title"}});var L=h(A,2),D=c(L);et(D,{mode:{mode:"pick-neighbourhood"}});var R=h(L,2),O=c(R);Z(z=>U(O,z),[()=>wr(o().mode)]),_(T,M)},left:T=>{var M=Gp(),I=V(M);_n(I,{mode:{mode:"pick-neighbourhood"}});var A=h(I,2),x=c(A),L=h(A,2);{var D=z=>{var d=Dp(),g=V(d);g.__click=[zp,f];var p=c(g),$=h(g,2);oi($,{get list(){return r(f).features},get idx(){return r(v)},set idx(w){K(v,w,!0)}}),Z(w=>U(p,w),[()=>r(l).t(59)]),_(z,d)};ve(L,z=>{r(f).features.length>0&&z(D)})}var R=h(L,2);{var O=z=>{var d=Up(),g=c(d);Z(p=>{ze(d,"href",r(i)),U(g,p)},[()=>r(l).t(60)]),_(z,d)};ve(R,z=>{r(i)&&z(O)})}Z(z=>U(x,z),[()=>r(l).t(58)]),_(T,M)},main:T=>{var M=Hp(),I=V(M);{let x=u(()=>t().getAllIntersections());it(I,{get data(){return r(x)},generateId:!0,children:(L,D)=>{{let R=u(()=>Ge("debug-intersections"));Nn(L,Ie(()=>r(R),{paint:{"circle-radius":15,"circle-color":["case",["get","has_turn_restrictions"],"purple","black"]},manageHoverState:!0,hoverCursor:"pointer",onclick:b}))}},$$slots:{default:!0}})}var A=h(I,2);it(A,{get data(){return r(f)},generateId:!0,children:(x,L)=>{var D=Wp(),R=V(D);{let z=u(()=>Ge("debug-movements-outline"));gt(R,Ie(()=>r(z),{paint:{"line-width":2,"line-color":"red"}}))}var O=h(R,2);{let z=u(()=>Ge("debug-movements-fill")),d=u(()=>["==",["id"],r(v)]);cr(O,Ie(()=>r(z),{get filter(){return r(d)},paint:{"fill-color":"cyan"}}))}_(x,D)},$$slots:{default:!0}}),_(T,M)},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}rr(["click"]);var Jp=P("<!> <!>",1);function ya(n,e){Ne(e,!0);const t=()=>ye(Da,"$roadStyle",a),o=()=>ye(Pi,"$drawBorderEntries",a),[a,s]=lt();let l=W(e,"show",3,!0),i=W(e,"prefix",3,"");function f(T){return["interpolate",["linear"],["zoom"],14,.08*T,22,.7*T]}function v(T){return[0,-50*T]}function b(){return["interpolate",["linear"],["zoom"],14,1,22,.7]}var m=Jp(),C=V(m);{let T=u(()=>Ge(i()+"cells")),M=u(()=>({visibility:!l()||t()=="cells"?"none":"visible"})),I=u(()=>({"fill-color":ri(),"fill-opacity":.5,"fill-outline-color":"hsla(0, 0%, 0%, 0.3)"}));cr(C,Ie(()=>r(T),{filter:["==",["get","kind"],"cell"],get layout(){return r(M)},get paint(){return r(I)}}))}var j=h(C,2);{let T=u(()=>Ge(i()+"border-entries")),M=u(()=>({"icon-image":"border_entry_arrow","icon-rotate":["get","bearing_upon_entry"],"icon-allow-overlap":!0,"icon-size":f(1),"icon-offset":v(1),"symbol-sort-key":["get","bearing_upon_entry"],visibility:l()&&o()?"visible":"none"})),I=u(()=>({"icon-color":ri(),"icon-halo-color":"black","icon-opacity":b(),"icon-halo-width":f(1.5),"icon-halo-blur":0}));po(j,Ie(()=>r(T),{filter:["==",["get","kind"],"border_entry"],get layout(){return r(M)},get paint(){return r(I)},minzoom:13,interactive:!1}))}_(n,m),Be(),s()}function li(n,e){Ne(e,!1),Cc();{let t=Cl(()=>Ge("neighbourhood-boundary"));cr(n,Ie(()=>r(t),{filter:["==",["get","kind"],"boundary"],paint:{"fill-color":"black","fill-opacity":.3}}))}Be()}var Qp=P("<!> <!> <!> <!>",1);function Aa(n,e){Ne(e,!0);const t=()=>ye(za,"$useMetricUnits",s),o=()=>ye(Ii,"$thickRoadsForShortcuts",s),a=()=>ye(Da,"$roadStyle",s),[s,l]=lt();let i=W(e,"interactive",3,!0),f=W(e,"linePopup",3,void 0),v=W(e,"onClickLine",3,(D,R)=>{}),b=W(e,"show",3,!0),m=W(e,"prefix",3,"");function C(D,R){return D=="cells"?ri():D=="edits"?bt(["case",["get","edited"],ws,"white"],Jr.mapFeature.hover.backgroundColor):D=="speeds"?t()?vr(["round",["*",1.60934,["get","speed_mph"]]],Tl,Ti):vr(["round",["get","speed_mph"]],Rl,Ti):R<=2?bt("white","blue"):(console.assert(D=="shortcuts"),bt(["interpolate-hcl",["linear"],["get","shortcuts"],0,"white",1,"#F19A93",R,"#A32015"],Jr.mapFeature.hover.backgroundColor))}function j(D){return D=="edits"?bt(["case",["get","edited"],ws,"gray"],Jr.mapFeature.hover.backgroundColor):bt("gray",Jr.mapFeature.hover.backgroundColor)}function T(D,R,O){return!D||R<=2?fo(O):["interpolate",["linear"],["get","shortcuts"],0,5+O,R,25+O]}var M=Qp(),I=V(M);{let D=u(()=>Ge(m()+"interior-roads-outlines")),R=u(()=>({"line-width":T(o(),e.maxShortcuts,1),"line-color":"black"})),O=u(()=>({visibility:b()?"visible":"none"}));gt(I,Ie(()=>r(D),{filter:["==",["get","kind"],"interior_road"],get paint(){return r(R)},get layout(){return r(O)},minzoom:13}))}var A=h(I,2);{let D=u(()=>Ge(m()+"interior-roads")),R=u(()=>({"line-width":T(o(),e.maxShortcuts,0),"line-color":C(a(),e.maxShortcuts),"line-opacity":bt(1,.5)})),O=u(()=>({"line-sort-key":["get","shortcuts"],visibility:b()?"visible":"none"})),z=u(()=>i()?"pointer":void 0);gt(A,Ie(()=>r(D),{filter:["==",["get","kind"],"interior_road"],get paint(){return r(R)},get layout(){return r(O)},minzoom:13,onclick:d=>i()&&v()(d.features[0],d.event.lngLat),get manageHoverState(){return i()},get hoverCursor(){return r(z)},children:(d,g)=>{var p=$e(),$=V(p);{var w=y=>{var F=$e(),k=V(F);Tt(k,()=>f()??Pe),_(y,F)};ve($,y=>{i()&&y(w)})}_(d,p)},$$slots:{default:!0}}))}var x=h(A,2);{let D=u(()=>Ge(m()+"main-roads-outlines")),R=u(()=>({"line-width":T(o(),e.maxShortcuts,6),"line-color":"black"})),O=u(()=>({visibility:b()?"visible":"none"}));gt(x,Ie(()=>r(D),{filter:["==",["get","kind"],"main_road"],get paint(){return r(R)},get layout(){return r(O)},minzoom:13}))}var L=h(x,2);{let D=u(()=>Ge(m()+"main-roads")),R=u(()=>({"line-width":T(o(),e.maxShortcuts,4),"line-color":j(a()),"line-opacity":bt(1,.5)})),O=u(()=>({"line-sort-key":["get","shortcuts"],visibility:b()?"visible":"none"})),z=u(()=>i()?"pointer":void 0);gt(L,Ie(()=>r(D),{filter:["==",["get","kind"],"main_road"],get paint(){return r(R)},get layout(){return r(O)},minzoom:13,onclick:d=>i()&&v()(d.features[0],d.event.lngLat),get manageHoverState(){return i()},get hoverCursor(){return r(z)},children:(d,g)=>{var p=$e(),$=V(p);{var w=y=>{var F=$e(),k=V(F);Tt(k,()=>f()??Pe),_(y,F)};ve($,y=>{i()&&y(w)})}_(d,p)},$$slots:{default:!0}}))}_(n,M),Be(),l()}var Zp=P("<!> <!>",1);function Vp(n,e){Ne(e,!0);const t=()=>ye(Qt,"$mutationCounter",s),o=()=>ye(Rt,"$backend",s),a=()=>ye(ja,"$showExistingFiltersAndTRs",s),[s,l]=lt();let i=W(e,"children",3,void 0),f=W(e,"turnRestrictionGj",3,null),v=W(e,"show",3,!0),b=W(e,"prefix",3,""),m=W(e,"onClickTurnRestriction",3,()=>{}),C=we(void 0),j=u(()=>r(C)==null?or():{type:"FeatureCollection",features:[{type:"Feature",geometry:JSON.parse(r(C).properties.from_geometry),properties:{}},{type:"Feature",geometry:JSON.parse(r(C).properties.to_geometry),properties:{}}]}),T=u(()=>t()>0&&f()==null?o().renderTurnRestrictions():or());var M=Zp(),I=V(M);{let x=u(()=>f()||r(T));it(I,{get data(){return r(x)},generateId:!0,children:(L,D)=>{{let R=u(()=>Ge(b()+"turn-restrictions")),O=u(()=>a()?void 0:["get","edited"]),z=u(()=>({"icon-image":["concat","no_",["get","kind"],"_turn"],"icon-rotate":["get","icon_angle"],"icon-allow-overlap":!0,"icon-size":.05,visibility:v()?"visible":"none"}));po(L,Ie(()=>r(R),{minzoom:13,get filter(){return r(O)},get layout(){return r(z)},paint:{"icon-opacity":["case",["get","edited"],1,.5]},get onclick(){return m()},get hovered(){return r(C)},set hovered(d){K(C,d,!0)},children:(d,g)=>{var p=$e(),$=V(p);Tt($,()=>i()??Pe),_(d,p)},$$slots:{default:!0}}))}},$$slots:{default:!0}})}var A=h(I,2);it(A,{get data(){return r(j)},children:(x,L)=>{{let D=u(()=>Ge(b()+"turn-restrictions-debug-arrows")),R=u(()=>({visibility:v()?"visible":"none"}));gt(x,Ie(()=>r(D),{interactive:!1,paint:{"line-width":4,"line-color":"red"},get layout(){return r(R)}}))}},$$slots:{default:!0}}),_(n,M),Be(),l()}var Kp=P("<!> <!>",1),Xp=P("<!> <!>",1);function Cn(n,e){Ne(e,!0);const t=()=>ye(Qt,"$mutationCounter",s),o=()=>ye(Rt,"$backend",s),a=()=>ye(ja,"$showExistingFiltersAndTRs",s),[s,l]=lt();let i=W(e,"modalFilterGj",3,null),f=W(e,"turnRestrictionGj",3,null),v=W(e,"onClickModalFilter",3,()=>{}),b=W(e,"onClickTurnRestriction",3,()=>{}),m=W(e,"modalFilterPopup",3,void 0),C=W(e,"turnRestrictionPopup",3,void 0),j=W(e,"show",3,!0),T=W(e,"prefix",3,""),M=13,I=u(()=>t()>0&&i()==null?o().renderModalFilters():or());var A=Xp(),x=V(A);{let D=u(()=>i()||r(I));it(x,{get data(){return r(D)},generateId:!0,children:(R,O)=>{var z=Kp(),d=V(z);{let p=u(()=>Ge(T()+"modal-filters")),$=u(()=>["all",["!=",["get","filter_kind"],"diagonal_filter"],a()?["literal",!0]:["get","edited"]]),w=u(()=>({"icon-image":["get","filter_kind"],"icon-rotate":["get","angle"],"icon-allow-overlap":!0,"icon-size":.1,visibility:j()?"visible":"none"}));po(d,Ie(()=>r(p),{get interactive(){return e.interactive},get filter(){return r($)},minzoom:M,get layout(){return r(w)},paint:{"icon-opacity":["case",["get","edited"],1,.5]},get onclick(){return v()},children:(y,F)=>{var k=$e(),N=V(k);Tt(N,()=>m()??Pe),_(y,k)},$$slots:{default:!0}}))}var g=h(d,2);{let p=u(()=>Ge(T()+"intersection-filters")),$=u(()=>({"icon-image":"diagonal_filter","icon-rotate":["get","angle",["get","filter"]],"icon-allow-overlap":!0,"icon-size":.07,visibility:j()?"visible":"none"}));po(g,Ie(()=>r(p),{filter:["==",["get","filter_kind"],"diagonal_filter"],minzoom:M,get layout(){return r($)},interactive:!1}))}_(R,z)},$$slots:{default:!0}})}var L=h(x,2);Vp(L,{get show(){return j()},get prefix(){return T()},get turnRestrictionGj(){return f()},get onClickTurnRestriction(){return b()},children:(D,R)=>{var O=$e(),z=V(O);Tt(z,()=>C()??Pe),_(D,O)},$$slots:{default:!0}}),_(n,A),Be(),l()}function wa(n,e){Ne(e,!0);let t=W(e,"show",3,!0),o=W(e,"prefix",3,"");{let a=u(()=>Ge(o()+"one-ways")),s=u(()=>({"icon-image":"oneway_arrow","icon-size":1,"symbol-placement":"line","symbol-spacing":50,"icon-allow-overlap":!0,"icon-rotate":["case",["==",["get","travel_flow"],"forwards"],0,180],visibility:t()?"visible":"none"}));po(n,Ie(()=>r(a),{filter:["all",["in",["get","kind"],["literal",["interior_road","main_road"]]],["!=",["get","travel_flow"],"both"]],get layout(){return r(s)},paint:{"icon-opacity":["case",["get","travel_flow_edited"],1,.5]},minzoom:13,interactive:!1}))}Be()}function ri(){return["match",["get","cell_color"],"disconnected","red","pedestrianized","#dddde8",["let","index",["%",["to-number",["get","cell_color"]],10],["match",["var","index"],0,"#8dd3c7",1,"#ffffb3",2,"#bebada",3,"#80b1d3",4,"#fdb462",5,"#b3de69",6,"#fccde5",7,"#bc80bd",8,"#ccebc5",9,"#ffed6f","blue"]]]}var Yp=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),eh=(n,e)=>K(e,null),th=P('<button class="close-btn svelte-ouxims">Ⓧ</button>'),rh=P("<!> <h5> </h5> <!>",1),nh=P("<p> </p>"),oh=P('<!> <h4> </h4> <p> </p> <div style="display: flex; align-items: start; justify-content: space-between;"><h4> </h4> <!></div> <!>',1),ah=P("<!> <!> <!> <!> <!>",1),ih=P("<!> <!>",1),sh=P("<!> <!> <!> <!>",1);function lh(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",a),o=()=>ye(yt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=t().renderNeighbourhood(),f=we(null);function v(b){let m=b.features[0],C=t().getMovements(m.properties.intersection_id);K(f,{feature:m,movements:C,movementIdx:0},!0)}Mr(n,{top:j=>{var T=Yp(),M=c(T),I=c(M),A=c(I);et(A,{mode:{mode:"title"}});var x=h(I,2),L=c(x);et(L,{mode:{mode:"pick-neighbourhood"}});var D=h(x,2),R=c(D);et(R,{mode:{mode:"neighbourhood"}});var O=h(D,2),z=c(O);Z(d=>U(z,d),[()=>wr(o().mode)]),_(j,T)},left:j=>{var T=oh(),M=V(T);_n(M,{mode:{mode:"neighbourhood"}});var I=h(M,2),A=c(I),x=h(I,2),L=c(x),D=h(x,2),R=c(D),O=c(R),z=h(R,2);{var d=w=>{var y=th();y.__click=[eh,f],_(w,y)};ve(z,w=>{r(f)&&w(d)})}var g=h(D,2);{var p=w=>{var y=rh(),F=V(y);io(F,{get properties(){return r(f).feature.properties}});var k=h(F,2),N=c(k),S=h(k,2);oi(S,{get list(){return r(f).movements.features},get idx(){return r(f).movementIdx},set idx(E){r(f).movementIdx=E}}),Z(E=>U(N,E),[()=>r(l).t(64)]),_(w,y)},$=w=>{var y=nh(),F=c(y);Z(k=>U(F,k),[()=>r(l).t(65)]),_(w,y)};ve(g,w=>{r(f)?w(p):w($,!1)})}Z((w,y,F)=>{U(A,w),U(L,y),U(O,F)},[()=>r(l).t(61),()=>r(l).t(62),()=>r(l).t(63)]),_(j,T)},main:j=>{var T=sh(),M=V(T);it(M,{get data(){return i},generateId:!0,children:(D,R)=>{var O=ah(),z=V(O);li(z,{});var d=h(z,2);ya(d,{});var g=h(d,2);wa(g,{});var p=h(g,2);{let w=u(()=>Ge("debug-borders"));Nn(p,Ie(()=>r(w),{filter:["==",["get","kind"],"border_intersection"],paint:{"circle-radius":15,"circle-color":"green"},children:(y,F)=>{Bt(y,{openOn:"hover",children:(N,S)=>{let E=()=>S?.().data;io(N,{get properties(){return E().properties}})},$$slots:{default:!0}})},$$slots:{default:!0}}))}var $=h(p,2);Aa($,{interactive:!0,onClickLine:(y,F)=>window.open(y.properties.way,"_blank"),get maxShortcuts(){return i.maxShortcuts},linePopup:y=>{Bt(y,{openOn:"hover",children:(k,N)=>{let S=()=>N?.().data;io(k,{get properties(){return S().properties}})},$$slots:{default:!0}})},$$slots:{linePopup:!0}}),_(D,O)},$$slots:{default:!0}});var I=h(M,2);Cn(I,{interactive:!0,modalFilterPopup:O=>{Bt(O,{openOn:"hover",children:(d,g)=>{let p=()=>g?.().data;io(d,{get properties(){return p().properties}})},$$slots:{default:!0}})},turnRestrictionPopup:O=>{Bt(O,{openOn:"hover",children:(d,g)=>{let p=()=>g?.().data;io(d,{get properties(){return p().properties}})},$$slots:{default:!0}})},$$slots:{modalFilterPopup:!0,turnRestrictionPopup:!0}});var A=h(I,2);{let D=u(()=>t().getAllIntersections());it(A,{get data(){return r(D)},generateId:!0,children:(R,O)=>{{let z=u(()=>Ge("debug-intersections")),d=u(()=>({"circle-radius":Nl(30),"circle-color":Jr.mapFeature.hover.backgroundColor,"circle-stroke-color":Jr.mapFeature.hover.backgroundColor,"circle-stroke-opacity":.8,"circle-stroke-width":bt(0,3),"circle-opacity":["case",["==",["get","intersection_id"],r(f)?.feature?.properties?.intersection_id??-1],.3,bt(0,.5)]}));Nn(R,Ie(()=>r(z),{get paint(){return r(d)},manageHoverState:!0,hoverCursor:"pointer",onclick:v,children:(g,p)=>{Bt(g,{openOn:"hover",children:(w,y)=>{let F=()=>y?.().data;io(w,{get properties(){return F().properties}})},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}var x=h(A,2);{var L=D=>{it(D,{get data(){return r(f).movements},generateId:!0,children:(R,O)=>{var z=ih(),d=V(z);{let p=u(()=>Ge("debug-movements-outline"));gt(d,Ie(()=>r(p),{paint:{"line-width":2,"line-color":"red"}}))}var g=h(d,2);{let p=u(()=>Ge("debug-movements-fill")),$=u(()=>["==",["id"],r(f).movementIdx]);cr(g,Ie(()=>r(p),{get filter(){return r($)},paint:{"fill-color":"cyan"}}))}_(R,z)},$$slots:{default:!0}})};ve(x,D=>{r(f)&&D(L)})}_(j,T)},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}rr(["click"]);const uh="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='lucide%20lucide-eraser-icon%20lucide-eraser'%20version='1.1'%20id='svg3'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs3'%20/%3e%3cpath%20d='m7%2021-4.3-4.3c-1-1-1-2.5%200-3.4l9.6-9.6c1-1%202.5-1%203.4%200l5.6%205.6c1%201%201%202.5%200%203.4L13%2021'%20id='path1'%20/%3e%3cpath%20d='M22%2021H7'%20id='path2'%20/%3e%3cpath%20d='m5%2011%209%209'%20id='path3'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.0194348;fill-opacity:1'%20d='M%2010.210757,14.752002%206.459622,11.000548%209.8160254,7.6426783%20C%2012.367029,5.0905596%2013.239386,4.2512757%2013.451467,4.1450647%20c%200.349597,-0.1750803%200.789698,-0.1876196%201.091224,-0.031091%200.115256,0.059832%201.582424,1.4856537%203.265247,3.1732297%203.019567,3.0280936%203.057066,3.0684746%203.149916,3.3920116%200.07937,0.276581%200.08343,0.372957%200.02609,0.620542%20-0.06661,0.287624%20-0.13239,0.357763%20-3.515539,3.748403%20-1.896214,1.900412%20-3.460904,3.455295%20-3.477088,3.455295%20-0.01619,0%20-1.717438,-1.688155%20-3.780562,-3.751453%20z'%20id='path4'%20/%3e%3cpath%20style='fill:%23ffffff;fill-opacity:1;stroke:%23ff533e;stroke-width:0.0194348'%20d='M%205.321794,17.868809%20C%204.1705931,16.713048%203.1848808,15.680805%203.131322,15.574936%203.077763,15.469067%203.0207033,15.236442%203.004522,15.057992%202.959692,14.563595%203.080751,14.37604%204.1030807,13.356012%20l%200.8902675,-0.888263%203.7509032,3.751221%203.7509036,3.751222%20H%209.9550205%207.4148864%20Z'%20id='path5'%20/%3e%3c/svg%3e",ch="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='lucide%20lucide-paintbrush-icon%20lucide-paintbrush'%20version='1.1'%20id='svg3'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs3'%20/%3e%3cpath%20d='m14.622%2017.897-10.68-2.913'%20id='path1'%20/%3e%3cpath%20d='M18.376%202.622a1%201%200%201%201%203.002%203.002L17.36%209.643a.5.5%200%200%200%200%20.707l.944.944a2.41%202.41%200%200%201%200%203.408l-.944.944a.5.5%200%200%201-.707%200L8.354%207.348a.5.5%200%200%201%200-.707l.944-.944a2.41%202.41%200%200%201%203.408%200l.944.944a.5.5%200%200%200%20.707%200z'%20id='path2'%20/%3e%3cpath%20d='M9%208c-1.804%202.71-3.97%203.46-6.583%203.948a.507.507%200%200%200-.302.819l7.32%208.883a1%201%200%200%200%201.185.204C12.735%2020.405%2016%2016.792%2016%2015'%20id='path3'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.00941713'%20d='M%2013.216364,10.769138%209.4441913,6.9961356%209.8268793,6.6205315%20C%2010.053748,6.3978626%2010.26605,6.2149074%2010.348288,6.1711993%20c%200.393818,-0.2093087%200.914655,-0.2092623%201.30798,1.172e-4%200.09062,0.048241%200.356713,0.2875083%200.767422,0.6900596%200.345786,0.338918%200.691198,0.6557984%200.767583,0.7041789%200.216015,0.1368197%200.430512,0.2013581%200.722288,0.2173241%200.316089,0.017296%200.499892,-0.017578%200.768527,-0.1458202%200.194182,-0.092699%200.283143,-0.1774989%202.37486,-2.2637553%202.357603,-2.3514493%202.273297,-2.2768061%202.645598,-2.3423855%200.33614,-0.05921%200.694848,0.059949%200.950717,0.3158186%200.253238,0.2532377%200.374946,0.6150471%200.31719,0.9429318%20-0.0673,0.3820937%200.01738,0.2862242%20-2.343684,2.6533839%20-2.086365,2.0917555%20-2.171127,2.1806742%20-2.263828,2.3748599%20-0.127718,0.2675385%20-0.162966,0.4524174%20-0.14652,0.7685267%200.01524,0.292912%200.09451,0.540519%200.242982,0.758947%200.04844,0.07126%200.360914,0.406322%200.694399,0.744591%200.41818,0.424179%200.627762,0.657447%200.675382,0.751709%200.212723,0.421072%200.212671,0.891705%20-1.46e-4,1.312073%20-0.04338,0.08569%20-0.207187,0.276887%20-0.439097,0.512528%20-0.203448,0.20672%20-0.376992,0.375854%20-0.385655,0.375854%20-0.0087,0%20-1.713228,-1.697851%20-3.787922,-3.773003%20z'%20id='path4'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.00941713;fill-opacity:1'%20d='M%209.349188,15.407794%204.525255,14.090285%203.9850003,13.435502%203.4447455,12.780718%203.9569969,12.649282%20C%206.0202821,12.119873%207.4294884,11.334333%208.7020764,10.004212%208.8652116,9.8337017%209.0246733,9.6590433%209.0564355,9.6160824%20l%200.05775,-0.078111%202.9032955,2.9031996%202.903295,2.9032%20-0.06256,0.166083%20c%20-0.122687,0.325724%20-0.617409,1.223308%20-0.670589,1.216662%20-0.008,-9.97e-4%20-2.18528,-0.594692%20-4.8384428,-1.319322%20z'%20id='path5'%20/%3e%3cpath%20style='fill:%23000000;fill-opacity:1;stroke:%23000000;stroke-width:0.00941713;stroke-opacity:1'%20d='M%208.4622824,18.869673%20C%207.5370363,17.746854%206.7832695,16.824931%206.7872451,16.820955%20c%200.00525,-0.0052%205.8629439,1.583356%206.0455299,1.639545%200.04062,0.0125%20-1.405633,1.450684%20-1.775827,1.765924%20-0.389041,0.331289%20-0.845683,0.684738%20-0.884654,0.684738%20-0.01526,0%20-0.7847654,-0.91867%20-1.7100116,-2.041489%20z'%20id='path6'%20/%3e%3c/svg%3e",_l="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='200'%20height='200'%20viewBox='0%200%20208%20208'%20version='1.1'%20id='svg4'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs4'%20/%3e%3cg%20id='g2'%20transform='translate(-0.5,-587.21484)'%20style='display:inline'%3e%3cpath%20fill='none'%20stroke-width='10'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke='%231476c6'%20stroke-opacity='1'%20stroke-miterlimit='4'%20d='m%201026.4453,2047.8516%20c%20564.1016,0%201021.4063,-457.3047%201021.4063,-1021.4063%20C%202047.8516,462.34375%201590.5469,5%201026.4453,5%20462.30469,5%205,462.34375%205,1026.4453%205,1590.5469%20462.30469,2047.8516%201026.4453,2047.8516%20Z%20m%200,0'%20transform='matrix(0.1,0,0,-0.1,0,792)'%20id='path2'%20/%3e%3c/g%3e%3cpath%20fill-rule='nonzero'%20fill='%231476c6'%20fill-opacity='1'%20d='m%20102.14453,4.207026%20c%2054.08594,0%2097.93359,43.84766%2097.93359,97.933604%200,54.08984%20-43.84765,97.9375%20-97.93359,97.9375%20-54.089842,0%20-97.937499,-43.84766%20-97.937499,-97.9375%200,-54.085944%2043.847657,-97.933604%2097.937499,-97.933604'%20id='path3'%20style='display:inline'%20/%3e%3cpath%20fill-rule='nonzero'%20fill='%23ffffff'%20fill-opacity='1'%20d='M%20185.51172,115.58985%20H%2069.265625%20l%2027.648437,27.65234%20H%2056.015625%20L%2014.816406,102.04297%2056.015625,60.843746%20H%2096.914062%20L%2069.265625,88.492186%20H%20185.51172%20v%2027.097664'%20id='path4'%20style='display:inline'%20/%3e%3c/svg%3e",dh="/ltn/assets/traffic_1-MHHbc4qO.svg";function wn(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function fh(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function vh(n){return n.type==="Feature"?n.geometry:n}function Lu(n,e,t={}){if(t.final===!0)return gh(n,e);const o=wn(n),a=wn(e),s=Nr(o[0]),l=Nr(a[0]),i=Nr(o[1]),f=Nr(a[1]),v=Math.sin(l-s)*Math.cos(f),b=Math.cos(i)*Math.sin(f)-Math.sin(i)*Math.cos(f)*Math.cos(l-s);return ca(Math.atan2(v,b))}function gh(n,e){let t=Lu(e,n);return t=(t+180)%360,t}function _h(n,e,t,o={}){const a=wn(n),s=Nr(a[0]),l=Nr(a[1]),i=Nr(t),f=rf(e,o.units),v=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(i)),b=s+Math.atan2(Math.sin(i)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(v)),m=ca(b),C=ca(v);return eo([m,C],o.properties)}function yn(n,e,t={}){var o=wn(n),a=wn(e),s=Nr(a[1]-o[1]),l=Nr(a[0]-o[0]),i=Nr(o[1]),f=Nr(a[1]),v=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(i)*Math.cos(f);return tf(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),t.units)}var ph=yn;function hh(n,e,t={}){const a=vh(n).coordinates;let s=0;for(let l=0;l<a.length&&!(e>=s&&l===a.length-1);l++)if(s>=e){const i=e-s;if(i){const f=Lu(a[l],a[l-1])-180;return _h(a[l],i,f,t)}else return eo(a[l])}else s+=yn(a[l],a[l+1],t);return eo(a[a.length-1])}var mh=hh;function bh(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=u(b),a=50,s=100,l=.01,i=ht(m()),f=u(j),v=setInterval(T,s);dr(()=>clearInterval(v));function b(){return e.paths.features.map(M=>1/M.properties.directness).reduce((M,I)=>M+I,0)}function m(){return e.paths.features.length==0?[]:Array.from({length:a},C)}function C(){let M=Math.random()*r(o),I=0;for(let[A,x]of e.paths.features.entries())if(I+=1/x.properties.directness,M<I)return{idx:A,distance:0};throw new Error(`didnt pick dot, totalDirectness is ${r(o)}`)}function j(){return{type:r(t).t(37),features:i.map(({idx:M,distance:I})=>mh(e.paths.features[M],I,{units:"kilometers"}))}}function T(){for(let[M,I]of i.entries())I.distance+=l,I.distance>=e.paths.features[I.idx].properties.length_meters/1e3&&(i[M]=C())}it(n,{get data(){return r(f)},children:(M,I)=>{{let A=u(()=>Ge("animate-shortcuts"));Nn(M,Ie(()=>r(A),{paint:{"circle-radius":10,"circle-color":"purple","circle-stroke-color":"black","circle-stroke-width":1}}))}},$$slots:{default:!0}}),Be()}class yh{feature;constructor(e){this.feature=e}get intersectionId(){return this.feature.properties.intersection_id}get filter(){return this.feature.properties.filter}get filterAngle(){return this.feature.properties.filter?.angle}get hasRotatedFilter(){return this.feature.properties.filter?.is_rotated??!1}}const $i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAALRQTFRFR3BMemc7uV08rWA9gmc9wlw9+1M8/1c6XGw7rWA8yFs9Tm47d2g8RXA7lmM8N3I6bGo7g2Y8u108wl097lY9vV08pmE9pGE8IHY7/3YajWU8hWc811o+nmI87VU7L3M73Fo+K3Q62Fs+s189kWQ8gGc7iGU8e2g7x1pAC3k6////X6d+H4RKTJ1vjcCjEHg6F3c6HnY6+Pv6NJBbWaR5FX5C4vDoHINIQZZlfbiWmMaszuTYcGgFiwAAACl0Uk5TAMN7grBaDAXjiU7r0O+f9dvJdmUgbZSi/AKouC+zGPg3+yV8wbuzwESr5F6DAAAFwklEQVR42u3ax1rbQACF0STGvRsXMJieMqTICqS//3tlkS8LgpNgSZsZnf8R7hysgp49kyRJkiRJkqQ0mzdn141HvVhctGyTese95clkmIddZZedwXp2ZqR0u1oOLsO/y/qvFm1LJdnpqh+e0nZwjUB6tZZPO/5fBJoGS6zeIAt7NF65IUyq7jDsVza9sFoytVdHYe86PcOlcv6bbShQ341AIq0KnX8IQ78BSbTMQ8E6p9aLv+Y4FG7qWSD6rjrFzz9kKwPG3iaUaew2IPYLwHkpAGHqrXDcTcudf8gXNoz6B+CyJIAwPbZixJ2UPf9w5HVQxM37pQGEtRnjrVv+/EPHu4B4e1kBgO2hHWOt1akAQBgZMtZ6eRUAnhsy1hpVnH+YeBCMtVElAMZzS0baQRXnn+X+H1Df10AeA6LudSUAwsySkfa8GgAvLAmAABAAAkAACADFDuDL+4d9/QRAnQC8/Xj7R5/vAKgPgHePzv/29gcA9QFwf7ujTwDUBsDbXQDeAQAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAAAAAAAAAAAAAAAAAAAAAfne/C8AXAGoD4G7H+X8OANQGQPj+6Pw/3gNQIwDh/YeHfbsLANQJwD4BAICi7HU1AGaWjLSXlZx/dmjJSDuoBEDes2SkjSoBMD61ZKR1KwHQaVsy0g63VQAYGDLWzvpVAFgbstYvAjJPgfG2rABAf27HaLsYlwdwYsZ4Oy5/Ddi6AsTcrPRzwKRlxYhrD8reAnaNGHXXuR8AdwHFO1qYMPLeDMsAuDFg9HWPSlwAruwX/0VgkxU9/2HTfAnUuil4/ufXxkuis2mx8/cEmIyAmwJXgXHDcOlcBTZ73wl2fAmYVI39Pg3YTn0Hllinm8s9/vy7PgNLr8X0ideB/trjf5pvBA5P/n8hyCcjx59u8+6ryflfHwny4WDU9OOfeO2LRXe0Xh/80Xq0bDTPzCNJkiRJkqQk+wnTOFu90krtLAAAAABJRU5ErkJggg==";var Ah=P('<div class="icon"> </div>'),wh=P('<img style="transform: rotate(45deg);" class="svelte-1geomdd"/>'),xh=P('<div style="font-size: 200%; padding-bottom: 4px;" class="icon"> </div>'),$h=P('<img style="transform: rotate(45deg);" class="svelte-1geomdd"/>'),kh=P('<div style="font-size: 200%; margin-top: -12px;" class="icon"> </div>'),Sh=P('<img style="transform: rotate(135deg);" class="svelte-1geomdd"/>'),Eh=P('<div style="display: flex; align-items: center;"><!></div>');function Lh(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));var o=Eh(),a=c(o);{var s=i=>{var f=$e(),v=V(f);{var b=C=>{const j=(M,I=Pe)=>{var A=Ah(),x=c(A);Z(L=>U(x,L),[()=>r(t).tx(I())]),_(M,A)},T=M=>{var I=wh();Z(A=>{ze(I,"src",$i),ze(I,"alt",A)},[()=>r(t).t(176)]),_(M,I)};{let M=u(()=>[j,T]),I=u(()=>r(t).cx(177));pe(C,{get t(){return r(M)},get x(){return r(I)}})}},m=C=>{const j=(M,I=Pe)=>{var A=xh(),x=c(A);Z(L=>U(x,L),[()=>r(t).tx(I())]),_(M,A)},T=M=>{var I=$h();Z(A=>{ze(I,"src",$i),ze(I,"alt",A)},[()=>r(t).t(178)]),_(M,I)};{let M=u(()=>[j,T]),I=u(()=>r(t).cx(179));pe(C,{get t(){return r(M)},get x(){return r(I)}})}};ve(v,C=>{e.intersection.hasRotatedFilter?C(b):C(m,!1)})}_(i,f)},l=i=>{const f=(b,m=Pe)=>{var C=kh(),j=c(C);Z(T=>U(j,T),[()=>r(t).tx(m())]),_(b,C)},v=b=>{var m=Sh();Z(C=>{ze(m,"src",$i),ze(m,"alt",C)},[()=>r(t).t(180)]),_(b,m)};{let b=u(()=>[f,v]),m=u(()=>r(t).cx(181));pe(i,{get t(){return r(b)},get x(){return r(m)}})}};ve(a,i=>{e.intersection.filter?i(s):i(l,!1)})}_(n,o),Be()}function Ch(n,e){Ne(e,!0);let t=W(e,"onClickIntersection",3,i=>{}),o=W(e,"interactive",3,!1),a=W(e,"show",3,!0);function s(i){let f=e.neighbourhood.features[i];return new yh(f)}function l(i){return s(i[0].id)}{let i=u(()=>Ge("editable-intersections")),f=u(()=>({"circle-radius":Nl(30),"circle-color":Jr.mapFeature.hover.backgroundColor,"circle-opacity":bt(0,.5),"circle-stroke-color":Jr.mapFeature.hover.backgroundColor,"circle-stroke-opacity":.8,"circle-stroke-width":bt(0,3)})),v=u(()=>({visibility:a()?"visible":"none"}));Nn(n,Ie(()=>r(i),{filter:["==",["get","kind"],"editable_intersection"],get paint(){return r(f)},get layout(){return r(v)},minzoom:13,get interactive(){return o()},manageHoverState:!0,hoverCursor:"pointer",onclick:b=>t()(l(b.features)),children:(b,m)=>{Bt(b,{openOn:"hover",children:(j,T)=>{let M=()=>T?.().features;{let I=u(()=>l(M()));Lh(j,{get intersection(){return r(I)}})}},$$slots:{default:!0}})},$$slots:{default:!0}}))}Be()}var Mh=(n,e,t)=>Qe(is,r(t).filterType),Ph=P('<button class="outline" style="width: 100%"><img width="80"/> <br/> </button>'),Ih=(n,e)=>e(!1),Th=P('<article style="max-height: 80vh; max-width: 80vw; overflow: auto"><h3> </h3> <table><tbody><tr><td></td><td><img height="300"/> <p> </p></td></tr></tbody></table> <center><button> </button></center></article>');function Rh(n,e){Ne(e,!0);const t=()=>ye(is,"$currentFilterType",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=W(e,"show",15),i=u(()=>Dt.allTypes.find(f=>f.filterType==t()));Bl(n,{get show(){return l()},set show(f){l(f)},children:(f,v)=>{var b=Th(),m=c(b),C=c(m),j=h(m,2),T=c(j),M=c(T),I=c(M);Zt(I,21,()=>Dt.allTypes,Vt,(d,g)=>{var p=Ph();p.__click=[Mh,t,g];var $=c(p),w=h($,3);Z(()=>{p.disabled=t()==r(g).filterType,ze($,"src",r(g).iconURL),ze($,"alt",r(g).label),U(w,` ${r(g).label??""}`)}),_(d,p)});var A=h(I),x=c(A),L=h(x,2),D=c(L),R=h(j,2),O=c(R);O.__click=[Ih,l];var z=c(O);Z((d,g)=>{U(C,d),ze(x,"src",r(i).largeImageURL),ze(x,"alt",r(i).label),U(D,r(i).description),U(z,g)},[()=>r(s).t(174),()=>r(s).t(175)]),_(f,b)},$$slots:{default:!0}}),Be(),a()}rr(["click"]);function Nh(n,e){Ne(e,!0);const t=u(()=>ut(ct("main")));let o=we(null);e.map.on("dragstart",a),e.map.on("mousemove",s),e.map.on("mouseup",l),dr(()=>{e.map.dragPan.enable(),e.map.off("dragstart",a),e.map.off("mousemove",s),e.map.off("mouseup",l)});function a(){e.map.dragPan.disable(),K(o,{type:r(t).t(376),properties:{},geometry:{type:r(t).t(377),coordinates:[]}},!0)}function s(i){if(r(o)){let f=i.lngLat.toArray(),v=r(o).geometry.coordinates.at(-1);if(v&&ph(v,f)*1e3<.5)return;r(o).geometry.coordinates.push(f)}}function l(){!r(o)||r(o).geometry.coordinates.length==0?e.onDone(null):e.onDone(r(o)),K(o,null),e.map.dragPan.enable()}{let i=u(()=>r(o)||or());it(n,{get data(){return r(i)},children:(f,v)=>{{let b=u(()=>Ge("freehand-line"));gt(f,Ie(()=>r(b),{paint:{"line-width":5,"line-color":"red"}}))}},$$slots:{default:!0}})}Be()}var Bh=P("<p><!></p>"),Fh=P("<p><!></p>"),Oh=P("<!> <!> <!>",1),jh=P("<!> <!>",1);function zh(n,e){Ne(e,!0);const t=()=>ye(Ri,"$showBeforeEdits",a),o=()=>ye(Rt,"$backend",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i="before-edits-",f=we(null),v=we(null),b=we(null);Je(()=>{t()&&r(f)==null&&(K(f,o().renderNeighbourhoodBeforeEdits(),!0),K(v,o().renderModalFiltersBeforeEdits(),!0),K(b,o().renderTurnRestrictionsBeforeEdits(),!0))});var m=jh(),C=V(m);{var j=I=>{it(I,{get data(){return r(f)},generateId:!0,children:(A,x)=>{var L=Oh(),D=V(L);ya(D,{get show(){return t()},prefix:i});var R=h(D,2);wa(R,{get show(){return t()},prefix:i});var O=h(R,2);Aa(O,{get show(){return t()},prefix:i,interactive:!0,get maxShortcuts(){return r(f).maxShortcuts},linePopup:d=>{Bt(d,{openOn:"hover",children:(p,$)=>{let w=()=>$?.().data;const y=u(()=>w().properties);var F=$e(),k=V(F);{var N=E=>{var B=Bh(),G=c(B);{let Q=u(()=>r(l).cx(469)),q=u(()=>[r(y).shortcuts,r(y).name??"unnamed road",Ua(r(y).speed_mph)]);pe(G,{get x(){return r(Q)},get a(){return r(q)}})}_(E,B)},S=E=>{var B=$e(),G=V(B);{var Q=q=>{var X=Fh(),ue=c(X);{let te=u(()=>r(l).cx(470)),ne=u(()=>[r(y).name??"unnamed road",Ua(r(y).speed_mph)]);pe(ue,{get x(){return r(te)},get a(){return r(ne)}})}_(q,X)};ve(G,q=>{r(y).kind=="main_road"&&q(Q)},!0)}_(E,B)};ve(k,E=>{r(y).kind=="interior_road"?E(N):E(S,!1)})}_(p,F)},$$slots:{default:!0}})},$$slots:{linePopup:!0}}),_(A,L)},$$slots:{default:!0}})};ve(C,I=>{r(f)&&I(j)})}var T=h(C,2);{var M=I=>{Cn(I,{prefix:i,get show(){return t()},interactive:!1,get modalFilterGj(){return r(v)},get turnRestrictionGj(){return r(b)}})};ve(T,I=>{r(v)&&r(b)&&I(M)})}_(n,m),Be(),s()}var Dh=P("<span></span>"),Uh=P("<b> </b>"),Gh=P("<b> </b>"),Wh=P("<b> </b>"),Hh=P("<li><!></li>"),qh=P('<ul style="padding-right: 0; padding-left: 20px; margin: 0;"><li><!></li> <li><!></li> <!></ul>'),Jh=P("<span></span> <!>",1),Qh=P("<!> <!> <!> <!> <!>",1);function Zh(n,e){Ne(e,!0);const t=()=>ye(si,"$routeTool",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=W(e,"waypoints",15);dr(()=>{l([]),t()?.stop(),e.map.getCanvas().style.cursor="inherit"});let i=!0,f=we(ht([]));Je(()=>{K(f,x(t(),l(),r(C)),!0)});let v=we(null),b=we(!1),m=we(!1),C=we(!1);function j(S){l().push({point:S.lngLat.toArray(),snapped:i}),l(l())}function T(S){K(v,{point:S.lngLat.toArray(),snapped:i},!0)}function M(S){l().splice(S,1),l(l()),K(b,!1)}function I(S,E){try{if(S)return JSON.parse(S.inner.calculateRoute(E))}catch{}return null}function A(S,E,B,G){if(G)return or();try{if(S&&E.length>0&&B)return JSON.parse(S.inner.calculateRoute([E[E.length-1],B]))}catch{}return or()}function x(S,E,B){if(B)return r(f);if(!S)return[];let G=[],Q=1;for(let q=0;q<E.length-1;q++){let X=JSON.parse(S.inner.getExtraNodes(E[q],E[q+1]));for(let[ue,te,ne]of X)G.push({point:[ue,te],snapped:ne,insertIdx:Q});Q++}return G}function L(S){l().splice(S.insertIdx,0,{point:S.point,snapped:S.snapped}),l(l()),K(C,!0)}function D(S){l(l()[S.insertIdx].point=S.point,!0),l(l())}function R(){K(C,!1)}function O(){K(m,!0)}function z(S){S.key==r(s).t(49)&&e.cancel(),S.key==r(s).t(16)&&l().length>1&&g()}function d(S){l().length>1&&S==l().length-1&&g()}function g(){let S=I(t(),l());S?(e.finish(S.properties.full_path.map(E=>E.snapped)),l([])):e.cancel()}let p=u(()=>A(t(),l(),r(v),r(b)||r(m)));Je(()=>{let S=l().length==0?"crosshair":"inherit";e.map.getCanvas().style.cursor=S});var $=Qh();ro("keydown",_a,z);var w=V($);ma(w,{onclick:j,onmousemove:T});var y=h(w,2);Zt(y,17,()=>r(f),Vt,(S,E,B)=>{_o(S,{draggable:!0,ondragstart:()=>L(r(E)),ondrag:()=>D(r(E)),ondragend:R,zIndex:0,get lngLat(){return r(E).point},set lngLat(G){r(E).point=G},children:(G,Q)=>{var q=Dh();let X;Z(ue=>X=St(q,1,"dot svelte-1i3xsfo",null,X,ue),[()=>({"snapped-node":r(E).snapped,"free-node":!r(E).snapped,hide:r(C)})]),_(G,q)},$$slots:{default:!0}})});var F=h(y,2);Zt(F,17,l,Vt,(S,E,B)=>{_o(S,{draggable:!0,onclick:()=>d(B),oncontextmenu:()=>M(B),onmouseenter:()=>K(b,!0),onmouseleave:()=>K(b,!1),ondragstart:O,ondragend:()=>K(m,!1),zIndex:1,get lngLat(){return r(E).point},set lngLat(G){r(E).point=G},children:(G,Q)=>{var q=Jh(),X=V(q);let ue;X.textContent=B+1;var te=h(X,2);Bt(te,{openOn:"hover",popupClass:"waypoint-popup",children:(ne,oe)=>{var H=qh(),J=c(H);{const _e=(le,fe=Pe)=>{var se=Uh(),Ae=c(se);Z(me=>U(Ae,me),[()=>r(s).tx(fe())]),_(le,se)};var ee=c(J);{let le=u(()=>[_e]),fe=u(()=>r(s).cx(182));pe(ee,{get t(){return r(le)},get x(){return r(fe)}})}}var re=h(J,2);{const _e=(le,fe=Pe)=>{var se=Gh(),Ae=c(se);Z(me=>U(Ae,me),[()=>r(s).tx(fe())]),_(le,se)};var ae=c(re);{let le=u(()=>[_e]),fe=u(()=>r(s).cx(183));pe(ae,{get t(){return r(le)},get x(){return r(fe)}})}}var Y=h(re,2);{var ie=_e=>{var le=Hh();{const se=(Ae,me=Pe)=>{var ke=Wh(),Se=c(ke);Z(We=>U(Se,We),[()=>r(s).tx(me())]),_(Ae,ke)};var fe=c(le);{let Ae=u(()=>[se]),me=u(()=>r(s).cx(184));pe(fe,{get t(){return r(Ae)},get x(){return r(me)}})}}_(_e,le)};ve(Y,_e=>{l().length>1&&B==l().length-1&&_e(ie)})}_(ne,H)},$$slots:{default:!0}}),Z(ne=>ue=St(X,1,"dot svelte-1i3xsfo",null,ue,ne),[()=>({snapped:r(E).snapped})]),_(G,q)},$$slots:{default:!0}})});var k=h(F,2);{let S=u(()=>I(t(),l())||or());it(k,{get data(){return r(S)},generateId:!0,children:(E,B)=>{{let G=u(()=>Ge("draw-route-lines"));gt(E,Ie(()=>r(G),{paint:{"line-color":"purple","line-width":10}}))}},$$slots:{default:!0}})}var N=h(k,2);it(N,{get data(){return r(p)},children:(S,E)=>{{let B=u(()=>Ge("draw-route-preview"));gt(S,Ie(()=>r(B),{paint:{"line-color":"black","line-width":3}}))}},$$slots:{default:!0}}),_(n,$),Be(),a()}function Vh(n,e,t){e().eraseAllMainRoads(),sr(Qt,t())}function Kh(n,e,t,o){e().setHideUnimportantCells(t()),sr(Qt,o())}var Xh=P("<li><!></li>"),Yh=P('<div style="display: flex; justify-content: space-between;"><nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav> <nav><ul><li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li> <!></ul></nav></div>'),e0=P('<input type="checkbox" role="switch"/>'),t0=(n,e)=>K(e,{kind:"filter",freehand:!1},!0),r0=(n,e)=>K(e,{kind:"oneway"},!0),n0=(n,e,t)=>K(e,t(),!0),o0=(n,e)=>K(e,{kind:"main-roads",tool:"toggle",waypoints:[]},!0),a0=(n,e)=>K(e,!0),i0=P('<h3> </h3> <p> </p> <!> <div style="display: flex; gap: 8px; align-items: leading; flex-direction: column; width: fit-content;"><button class="outline"> </button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button></div>',1),s0=P("<h3> </h3> <p> </p>",1),l0=P("<h3> </h3> <p> </p>",1),u0=P("<i> </i>"),c0=P('<a href="https://openstreetmap.org/about" target="_blank"> </a>'),d0=(n,e)=>{K(e,{kind:"main-roads",tool:"toggle",waypoints:[]},!0)},f0=(n,e)=>{K(e,{kind:"main-roads",tool:"snap-route-main",waypoints:[]},!0)},v0=(n,e)=>{K(e,{kind:"main-roads",tool:"snap-route-erase",waypoints:[]},!0)},g0=P('<h3> </h3> <p><!></p> <p> </p> <div class="classification-buttons svelte-1i6ad5a" style="display: flex; flex-direction: column; gap: 8px; justify-content: left;"><button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button></div>',1),_0=P("<mark> </mark>"),p0=P('<input type="checkbox"/>'),h0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),m0=P('<input type="checkbox"/>'),b0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),y0=P('<input type="checkbox"/>'),A0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),w0=P('<input type="checkbox"/>'),x0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),$0=P('<div style="display: flex; justify-content: space-between; align-items: center"><h2> </h2> <label><!></label></div> <div><div class="tool-palette" style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 6px;"><div style="height: 50px; display: flex; justify-content: left; gap: 6px;"><button><img/></button> <button><div style="height: 100%; width: 100%; position: relative;"><img style="position: absolute; width: 60%; height: 60%; top: -1px; left: -1px;"/> <img style="position: absolute; width: 60%; height: 60%; bottom: -1px; right: -1px; transform: rotate(180deg);"/></div></button> <button><img/></button> <button><img/></button></div> <div style="height: 50px; display: flex; justify-content: right; gap: 6px;"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button></div></div> <div style="min-height: 200px; padding-bottom: 16px; border-bottom: solid var(--pico-muted-border-color) 1px;"><!></div> <!></div> <h2> </h2> <label><!></label> <label><!></label> <label><!></label> <label><!></label> <label style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;"><span style="text-wrap: nowrap;"> </span> <select style="margin: 0; padding: 8px; width: auto;"><option> </option><option> </option><option> </option><option><!></option></select></label> <!> <h2> </h2> <!>',1),k0=P("<p><!></p>"),S0=P("<p><!></p>"),E0=P('<img width="20"/>'),L0=P("<div><!></div>"),C0=P("<p> </p>"),M0=P("<p> </p>"),P0=P("<p> </p>"),I0=P("<!> <!>",1),T0=P("<!> <!> <!> <!> <!>",1),R0=P('<img width="20"/>'),N0=P("<div><!></div>"),B0=P("<!> <!> <!> <!> <!> <!> <!>",1);function F0(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",M),o=()=>ye(rn,"$map",M),a=()=>ye(Qt,"$mutationCounter",M),s=()=>ye(is,"$currentFilterType",M),l=()=>ye(Ri,"$showBeforeEdits",M),i=()=>ye(xs,"$animateShortcuts",M),f=()=>ye($s,"$hideUnimportantCells",M),v=()=>ye(yt,"$mode",M),b=()=>ye(ia,"$devMode",M),m=()=>ye(Pi,"$drawBorderEntries",M),C=()=>ye(Ii,"$thickRoadsForShortcuts",M),j=()=>ye(Da,"$roadStyle",M),T=()=>ye(za,"$useMetricUnits",M),[M,I]=lt(),A=u(()=>ut(ct("main")));function x(){return{kind:"turn_restriction",from_road_id:null,from_road_name:"",possible_targets:or()}}let L=we(ht({kind:"filter",freehand:!1})),D=we(!1),R=we(ht(t().renderNeighbourhood())),O=u(()=>r(R).features.find(H=>H.properties.kind=="boundary")),z=we(ht(or())),d=we(0);gn(()=>{Fl()}),dr(()=>{o().doubleClickZoom.enable()});function g(H){K(R,t().renderNeighbourhood(),!0),la()}function p(H,J){a()==r(d)||!J||(K(z,t().getAllShortcuts(),!0),K(d,a(),!0))}function $(H,J){r(L).kind=="filter"?(t().addModalFilter(J,s()),sr(Qt,a())):r(L).kind=="oneway"?(t().toggleTravelFlow(H.properties.road),sr(Qt,a())):r(L).kind=="main-roads"&&r(L).tool=="toggle"?(t().toggleMainRoad(H.properties.road),sr(Qt,a())):r(L).kind=="turn_restriction"&&(r(L).from_road_id=H.properties.road,r(L).from_road_name=H.properties.name||"unnamed road",r(L).possible_targets=t().getTurnRestrictionTargets(H.properties.road))}function w(H){r(L).kind=="turn_restriction"&&(o().queryRenderedFeatures(H.point,{layers:["interior-roads","turn-restriction-targets"]}).length>0||K(L,x(),!0))}function y(H){if(r(L).kind=="turn_restriction"&&r(L).from_road_id!=null){let J=H.features[0].properties.road;t().addTurnRestriction(r(L).from_road_id,J),sr(Qt,a())}K(L,x(),!0)}function F(H){let J=H.features[0];t().deleteModalFilter(J.properties.road),sr(Qt,a())}function k(H){let J=H.features[0];t().deleteTurnRestriction(J.properties.intersection,J.properties.from_road,J.properties.to_road),sr(Qt,a())}function N(H){if(r(L).kind!="filter"){console.assert(!1,`this shouldn't happen - intersections should only be clickable when in 'filter' mode, not ${r(L).kind}`);return}H.hasRotatedFilter?(t().deleteDiagonalFilter(H),sr(Qt,a())):H.filter?(t().rotateDiagonalFilter(H),sr(Qt,a())):(t().addDiagonalFilter(H),sr(Qt,a()))}function S(H){return!!(H.kind=="filter"&&H.freehand||H.kind=="main-roads"&&H.tool!="toggle"&&H.waypoints.length>0||H.kind=="turn_restriction"&&H.from_road_id!=null)}function E(H){l()||H.target.tagName!=r(A).t(378)&&(S(r(L))||(H.ctrlKey&&H.key=="z"&&B(),H.ctrlKey&&H.key=="y"&&G(),H.key=="1"&&K(L,{kind:"filter",freehand:!1},!0),H.key=="2"&&K(L,{kind:"oneway"},!0),H.key=="3"&&K(L,x(),!0),H.key=="4"&&K(L,{kind:"main-roads",tool:"toggle",waypoints:[]},!0)))}function B(){t().undo(),sr(Qt,a())}function G(){t().redo(),sr(Qt,a())}function Q(H){H&&(t().addManyModalFilters(H,s()),sr(Qt,a())),K(L,{kind:"filter",freehand:!1},!0)}function q(H){let J=r(L).kind=="main-roads"&&r(L).tool=="snap-route-main";t().setMainRoads(H,J),sr(Qt,a())}let X="Shortcuts are routes from one main road to another, which cut through the neighborhood's interior.",ue="Cells are the coloured area reachable without travelling along a main road.",te="Hide the coloured areas only containing small service roads.",ne={left:zl,right:Oi,straight:Dl,u_left_to_right:Gl,u_right_to_left:Ul};Je(()=>{r(L).kind=="oneway"||r(L).kind=="main-roads"?o().doubleClickZoom.disable():o().doubleClickZoom.enable()}),Je(()=>{r(L).kind=="filter"&&r(L).freehand?o().getCanvas().style.cursor=`url(${ch}) 8 22, cell`:r(L).kind=="main-roads"&&r(L).tool=="snap-route-erase"?o().getCanvas().style.cursor=`url(${uh}) 8 22, cell`:o().getCanvas().style.cursor=""}),Je(()=>{g(a())}),Je(()=>{p(a(),i())});let oe=u(()=>r(R).features.filter(H=>H.properties.kind=="cell"&&H.properties.cell_color=="disconnected").length);ro("keydown",_a,E),Mr(n,{top:re=>{var ae=Yh(),Y=c(ae),ie=c(Y),_e=c(ie),le=c(_e);et(le,{mode:{mode:"title"}});var fe=h(_e,2),se=c(fe);et(se,{mode:{mode:"pick-neighbourhood"}});var Ae=h(fe,2),me=c(Ae),ke=h(Y,2),Se=c(ke),We=c(Se),xe=c(We);et(xe,{mode:{mode:"view-shortcuts"}});var Le=h(We,2),he=c(Le);et(he,{mode:{mode:"route",prevMode:"neighbourhood"}});var Re=h(Le,2),Ce=c(Re);et(Ce,{mode:{mode:"predict-impact",prevMode:"neighbourhood"}});var be=h(Re,2),Me=c(be);et(Me,{mode:{mode:"impact-one-destination"}});var Te=h(be,2),Ee=c(Te);{let qe=u(()=>({mode:"set-boundary",name:r(O).properties.name,existing:r(O)}));et(Ee,{get mode(){return r(qe)}})}var Ue=h(Te,2);{var De=qe=>{var Fe=Xh(),He=c(Fe);et(He,{mode:{mode:"debug-neighbourhood"},children:(Ze,rt)=>{var Ve=Ut();Z(Ke=>U(Ve,Ke),[()=>r(A).t(379)]),_(Ze,Ve)},$$slots:{default:!0}}),_(qe,Fe)};ve(Ue,qe=>{b()&&qe(De)})}Z(qe=>U(me,qe),[()=>wr(v().mode)]),_(re,ae)},left:re=>{var ae=$0(),Y=V(ae),ie=c(Y),_e=c(ie),le=h(ie,2);{const dt=st=>{var Ye=e0();Z(Xe=>Ye.disabled=Xe,[()=>S(r(L))]),un(Ye,l,Xe=>Qe(Ri,Xe)),_(st,Ye)};var fe=c(le);{let st=u(()=>[dt]),Ye=u(()=>r(A).cx(381));pe(fe,{get t(){return r(st)},get x(){return r(Ye)}})}}var se=h(Y,2);let Ae;var me=c(se),ke=c(me),Se=c(ke);Se.__click=[t0,L];let We;var xe=c(Se),Le=h(Se,2);Le.__click=[r0,L];let he;var Re=c(Le),Ce=c(Re),be=h(Ce,2),Me=h(Le,2);Me.__click=[n0,L,x];let Te;var Ee=c(Me),Ue=h(Me,2);Ue.__click=[o0,L];let De;var qe=c(Ue),Fe=h(ke,2),He=c(Fe);He.__click=B;var Ze=c(He);ad(Ze,{});var rt=h(He,2);rt.__click=G;var Ve=c(rt);nd(Ve,{});var Ke=h(me,2),vt=c(Ke);{var xt=dt=>{var st=i0(),Ye=V(st),Xe=c(Ye),wt=h(Ye,2),qt=c(wt),Wt=h(wt,2);Rh(Wt,{get show(){return r(D)},set show(zr){K(D,zr,!0)}});var zt=h(Wt,2),pn=c(zt);pn.__click=[a0,D];var Un=c(pn),yr=h(pn,2);yr.__click=function(...zr){(r(L).freehand?()=>K(L,{kind:"filter",freehand:!1},!0):()=>K(L,{kind:"filter",freehand:!0},!0))?.apply(this,zr)};let jr;var an=c(yr),Mn=c(an);rd(Mn,{});var hn=h(Mn,2),Pn=c(hn);Z((zr,Gn,oo,wo,ao,xo)=>{U(Xe,zr),U(qt,Gn),U(Un,oo),ze(yr,"data-tippy-content",wo),jr=St(yr,1,"",null,jr,ao),U(Pn,xo)},[()=>r(A).t(394),()=>r(A).t(395),()=>r(A).t(396),()=>r(A).t(397),()=>({active:r(L).freehand,outline:!r(L).freehand}),()=>r(A).t(398)]),_(dt,st)},mt=dt=>{var st=$e(),Ye=V(st);{var Xe=qt=>{var Wt=s0(),zt=V(Wt),pn=c(zt),Un=h(zt,2),yr=c(Un);Z((jr,an)=>{U(pn,jr),U(yr,an)},[()=>r(A).t(399),()=>r(A).t(400)]),_(qt,Wt)},wt=qt=>{var Wt=$e(),zt=V(Wt);{var pn=yr=>{var jr=l0(),an=V(jr),Mn=c(an),hn=h(an,2),Pn=c(hn);Z((zr,Gn)=>{U(Mn,zr),U(Pn,Gn)},[()=>r(A).t(387),()=>r(A).t(401)]),_(yr,jr)},Un=yr=>{var jr=$e(),an=V(jr);{var Mn=hn=>{var Pn=g0(),zr=V(Pn),Gn=c(zr),oo=h(zr,2);{const fi=(Hn,qn=Pe)=>{var Jn=u0(),So=c(Jn);Z(Eo=>U(So,Eo),[()=>r(A).tx(qn())]),_(Hn,Jn)},vi=(Hn,qn=Pe)=>{var Jn=c0(),So=c(Jn);Z(Eo=>U(So,Eo),[()=>r(A).tx(qn())]),_(Hn,Jn)};var wo=c(oo);{let Hn=u(()=>[fi,vi]),qn=u(()=>r(A).cx(403));pe(wo,{get t(){return r(Hn)},get x(){return r(qn)}})}}var ao=h(oo,2),xo=c(ao),ci=h(ao,2),Wn=c(ci);Wn.__click=[d0,L];let gs;var Bu=c(Wn),_s=c(Bu);Jl(_s,{});var Fu=h(_s,2),Ou=c(Fu),$o=h(Wn,2);$o.__click=[f0,L];let ps;var ju=c($o),hs=c(ju);od(hs,{});var zu=h(hs,2),Du=c(zu),ko=h($o,2);ko.__click=[v0,L];let ms;var Uu=c(ko),bs=c(Uu);Kc(bs,{});var Gu=h(bs,2),Wu=c(Gu),di=h(ko,2);di.__click=[Vh,t,a],St(di,1,"",null,{},{outline:!0});var Hu=c(di),ys=c(Hu);ii(ys,{});var qu=h(ys,2),Ju=c(qu);Z((fi,vi,Hn,qn,Jn,So,Eo,Qu,Zu,Vu,Ku,Xu)=>{U(Gn,fi),U(xo,vi),ze(Wn,"data-tippy-content",Hn),gs=St(Wn,1,"",null,gs,qn),U(Ou,Jn),ze($o,"data-tippy-content",So),ps=St($o,1,"",null,ps,Eo),U(Du,Qu),ze(ko,"data-tippy-content",Zu),ms=St(ko,1,"",null,ms,Vu),U(Wu,Ku),U(Ju,Xu)},[()=>r(A).t(402),()=>r(A).t(404),()=>r(A).t(405),()=>({active:r(L).tool=="toggle",outline:r(L).tool!="toggle"}),()=>r(A).t(406),()=>r(A).t(407),()=>({active:r(L).tool=="snap-route-main",outline:r(L).tool!="snap-route-main"}),()=>r(A).t(408),()=>r(A).t(407),()=>({active:r(L).tool=="snap-route-erase",outline:r(L).tool!="snap-route-erase"}),()=>r(A).t(409),()=>r(A).t(410)]),_(hn,Pn)};ve(an,hn=>{r(L).kind=="main-roads"&&hn(Mn)},!0)}_(yr,jr)};ve(zt,yr=>{r(L).kind=="turn_restriction"?yr(pn):yr(Un,!1)},!0)}_(qt,Wt)};ve(Ye,qt=>{r(L).kind=="oneway"?qt(Xe):qt(wt,!1)},!0)}_(dt,st)};ve(vt,dt=>{r(L).kind=="filter"?dt(xt):dt(mt,!1)})}var Mt=h(Ke,2);{var $t=dt=>{var st=_0(),Ye=c(st);Z(Xe=>U(Ye,Xe),[()=>r(A).t(411)]),_(dt,st)};ve(Mt,dt=>{r(oe)>0&&dt($t)})}var Et=h(se,2),At=c(Et),Lt=h(Et,2);{const dt=Ye=>{var Xe=p0();un(Xe,i,wt=>Qe(xs,wt)),_(Ye,Xe)},st=(Ye,Xe=Pe)=>{var wt=h0();ze(wt,"data-tippy-content",X);var qt=c(wt);Z(Wt=>U(qt,Wt),[()=>r(A).tx(Xe())]),_(Ye,wt)};var Ot=c(Lt);{let Ye=u(()=>[dt,st]),Xe=u(()=>r(A).cx(413));pe(Ot,{get t(){return r(Ye)},get x(){return r(Xe)}})}}var Kt=h(Lt,2);{const dt=Ye=>{var Xe=m0();un(Xe,m,wt=>Qe(Pi,wt)),_(Ye,Xe)},st=(Ye,Xe=Pe)=>{var wt=b0();ze(wt,"data-tippy-content",ue);var qt=c(wt);Z(Wt=>U(qt,Wt),[()=>r(A).tx(Xe())]),_(Ye,wt)};var Pt=c(Kt);{let Ye=u(()=>[dt,st]),Xe=u(()=>r(A).cx(414));pe(Pt,{get t(){return r(Ye)},get x(){return r(Xe)}})}}var It=h(Kt,2);{const dt=Ye=>{var Xe=y0();Xe.__change=[Kh,t,f,a],un(Xe,f,wt=>Qe($s,wt)),_(Ye,Xe)},st=(Ye,Xe=Pe)=>{var wt=A0();ze(wt,"data-tippy-content",te);var qt=c(wt);Z(Wt=>U(qt,Wt),[()=>r(A).tx(Xe())]),_(Ye,wt)};var lr=c(It);{let Ye=u(()=>[dt,st]),Xe=u(()=>r(A).cx(476));pe(lr,{get t(){return r(Ye)},get x(){return r(Xe)}})}}var fr=h(It,2);{const dt=Ye=>{var Xe=w0();un(Xe,C,wt=>Qe(Ii,wt)),_(Ye,Xe)},st=(Ye,Xe=Pe)=>{var wt=x0();ze(wt,"data-tippy-content",X);var qt=c(wt);Z(Wt=>U(qt,Wt),[()=>r(A).tx(Xe())]),_(Ye,wt)};var Zr=c(fr);{let Ye=u(()=>[dt,st]),Xe=u(()=>r(A).cx(415));pe(Zr,{get t(){return r(Ye)},get x(){return r(Xe)}})}}var Pr=h(fr,2),xr=c(Pr),Vr=c(xr),on=h(xr,2),Fr=c(on),$r=c(Fr);Fr.value=Fr.__value="shortcuts";var Or=h(Fr),ce=c(Or);Or.value=Or.__value="cells";var at=h(Or),Yt=c(at);at.value=at.__value="edits";var jt=h(at),ir=c(jt);{let dt=u(()=>r(A).cx(468)),st=u(()=>[T()?"km/h":"mph"]);pe(ir,{get x(){return r(dt)},get a(){return r(st)}})}jt.value=jt.__value="speeds";var br=h(Pr,2);{var kr=dt=>{{let st=u(()=>({buckets:T()?Tl:Rl}));Ar(dt,{get colorScale(){return Ti},get labels(){return r(st)}})}};ve(br,dt=>{j()=="speeds"&&dt(kr)})}var _t=h(br,2),Sr=c(_t),ur=h(_t,2);$u(ur,{get neighbourhoodBoundary(){return r(O)}}),Z((dt,st,Ye,Xe,wt,qt,Wt,zt,pn,Un,yr,jr,an,Mn,hn,Pn,zr,Gn,oo,wo,ao,xo,ci,Wn)=>{U(_e,dt),Ae=St(se,1,"svelte-1i6ad5a",null,Ae,st),We=St(Se,1,"icon-btn",null,We,Ye),ze(Se,"data-tippy-content",Xe),ze(xe,"src",wt),ze(xe,"alt",qt),he=St(Le,1,"icon-btn",null,he,Wt),ze(Le,"data-tippy-content",zt),ze(Ce,"src",_l),ze(Ce,"alt",pn),ze(be,"src",_l),ze(be,"alt",Un),Te=St(Me,1,"icon-btn",null,Te,yr),ze(Me,"data-tippy-content",jr),ze(Ee,"src",Oi),ze(Ee,"alt",an),De=St(Ue,1,"icon-btn",null,De,Mn),ze(Ue,"data-tippy-content",hn),ze(qe,"src",dh),ze(qe,"alt",Pn),He.disabled=r(R).undo_length==0,ze(He,"data-tippy-content",zr),rt.disabled=r(R).redo_length==0,ze(rt,"data-tippy-content",Gn),U(At,oo),U(Vr,wo),U($r,ao),U(ce,xo),U(Yt,ci),U(Sr,Wn)},[()=>r(A).t(380),()=>({"edits-disabled":l()}),()=>({active:r(L).kind=="filter"}),()=>r(A).t(382),()=>Dt.getFilter(s()).iconURL,()=>r(A).t(383),()=>({active:r(L).kind=="oneway"}),()=>r(A).t(384),()=>r(A).t(385),()=>r(A).t(385),()=>({active:r(L).kind=="turn_restriction"}),()=>r(A).t(386),()=>r(A).t(387),()=>({active:r(L).kind=="main-roads"}),()=>r(A).t(388),()=>r(A).t(389),()=>r(R).undo_length==0?r(A).t(390):r(A).t(391,[r(R).undo_length]),()=>r(R).redo_length==0?r(A).t(392):r(A).t(393,[r(R).redo_length]),()=>r(A).t(412),()=>r(A).t(416),()=>r(A).t(417),()=>r(A).t(418),()=>r(A).t(419),()=>r(A).t(421)]),An(on,j,dt=>Qe(Da,dt)),_(re,ae)},main:re=>{var ae=B0(),Y=V(ae);ma(Y,{onclick:w});var ie=h(Y,2);zh(ie,{});var _e=h(ie,2);it(_e,{get data(){return r(R)},generateId:!0,children:(xe,Le)=>{var he=T0(),Re=V(he);li(Re,{});var Ce=h(Re,2);{let Ee=u(()=>!l());ya(Ce,{get show(){return r(Ee)}})}var be=h(Ce,2);{let Ee=u(()=>!l());wa(be,{get show(){return r(Ee)}})}var Me=h(be,2);{const Ee=qe=>{Bt(qe,{openOn:"hover",children:(He,Ze)=>{let rt=()=>Ze?.().data;const Ve=u(()=>rt().properties);var Ke=I0(),vt=V(Ke);{var xt=At=>{var Lt=k0(),Ot=c(Lt);{let Kt=u(()=>r(A).cx(469)),Pt=u(()=>[r(Ve).shortcuts,r(Ve).name??"unnamed road",Ua(r(Ve).speed_mph)]);pe(Ot,{get x(){return r(Kt)},get a(){return r(Pt)}})}_(At,Lt)},mt=At=>{var Lt=$e(),Ot=V(Lt);{var Kt=Pt=>{var It=S0(),lr=c(It);{let fr=u(()=>r(A).cx(470)),Zr=u(()=>[r(Ve).name??"unnamed road",Ua(r(Ve).speed_mph)]);pe(lr,{get x(){return r(fr)},get a(){return r(Zr)}})}_(Pt,It)};ve(Ot,Pt=>{r(Ve).kind=="main_road"&&Pt(Kt)},!0)}_(At,Lt)};ve(vt,At=>{r(Ve).kind=="interior_road"?At(xt):At(mt,!1)})}var Mt=h(vt,2);{var $t=At=>{var Lt=L0();{const Kt=Pt=>{var It=E0();Z((lr,fr)=>{ze(It,"src",lr),ze(It,"alt",fr)},[()=>Dt.getFilter(s()).iconURL,()=>r(A).t(394)]),_(Pt,It)};var Ot=c(Lt);{let Pt=u(()=>[Kt]),It=u(()=>r(A).cx(422));pe(Ot,{get t(){return r(Pt)},get x(){return r(It)}})}}_(At,Lt)},Et=At=>{var Lt=$e(),Ot=V(Lt);{var Kt=It=>{var lr=C0(),fr=c(lr);Z(Zr=>U(fr,Zr),[()=>r(A).t(423)]),_(It,lr)},Pt=It=>{var lr=$e(),fr=V(lr);{var Zr=xr=>{var Vr=M0(),on=c(Vr);Z(Fr=>U(on,Fr),[()=>r(A).t(424)]),_(xr,Vr)},Pr=xr=>{var Vr=$e(),on=V(Vr);{var Fr=$r=>{var Or=P0(),ce=c(Or);Z(at=>U(ce,at),[()=>r(A).t(425)]),_($r,Or)};ve(on,$r=>{r(L).kind=="turn_restriction"&&$r(Fr)},!0)}_(xr,Vr)};ve(fr,xr=>{r(L).kind=="main-roads"&&r(L).tool=="toggle"?xr(Zr):xr(Pr,!1)},!0)}_(It,lr)};ve(Ot,It=>{r(L).kind=="oneway"?It(Kt):It(Pt,!1)},!0)}_(At,Lt)};ve(Mt,At=>{r(L).kind=="filter"?At($t):At(Et,!1)})}_(He,Ke)},$$slots:{default:!0}})};let Ue=u(()=>!l()),De=u(()=>r(L).kind=="filter"&&!r(L).freehand||r(L).kind=="oneway"||r(L).kind=="main-roads"&&r(L).tool=="toggle"||r(L).kind=="turn_restriction"&&r(L).from_road_id==null);Aa(Me,{get show(){return r(Ue)},get interactive(){return r(De)},onClickLine:$,get maxShortcuts(){return r(R).maxShortcuts},linePopup:Ee,$$slots:{linePopup:!0}})}var Te=h(Me,2);{let Ee=u(()=>!l()),Ue=u(()=>r(L).kind=="filter");Ch(Te,{get show(){return r(Ee)},get interactive(){return r(Ue)},get neighbourhood(){return r(R)},onClickIntersection:N})}_(xe,he)},$$slots:{default:!0}});var le=h(_e,2);{var fe=xe=>{bh(xe,{get paths(){return r(z)}})};ve(le,xe=>{i()&&a()==r(d)&&xe(fe)})}var se=h(le,2);{const xe=Ce=>{Bt(Ce,{openOn:"hover",children:(be,Me)=>{var Te=Ut();Z(Ee=>U(Te,Ee),[()=>r(A).t(426)]),_(be,Te)},$$slots:{default:!0}})},Le=Ce=>{Bt(Ce,{openOn:"hover",children:(be,Me)=>{var Te=Ut();Z(Ee=>U(Te,Ee),[()=>r(A).t(427)]),_(be,Te)},$$slots:{default:!0}})};let he=u(()=>!l()),Re=u(()=>r(L).kind=="filter");Cn(se,{get show(){return r(he)},onClickModalFilter:F,onClickTurnRestriction:k,get interactive(){return r(Re)},modalFilterPopup:xe,turnRestrictionPopup:Le,$$slots:{modalFilterPopup:!0,turnRestrictionPopup:!0}})}var Ae=h(se,2);{var me=xe=>{Nh(xe,{get map(){return o()},onDone:Q})},ke=xe=>{var Le=$e(),he=V(Le);{var Re=Ce=>{Zh(Ce,{get map(){return o()},finish:q,cancel:()=>K(L,{kind:"main-roads",tool:"toggle",waypoints:[]},!0),get waypoints(){return r(L).waypoints},set waypoints(be){r(L).waypoints=be}})};ve(he,Ce=>{r(L).kind=="main-roads"&&r(L).tool!="toggle"&&Ce(Re)},!0)}_(xe,Le)};ve(Ae,xe=>{r(L).kind=="filter"&&r(L).freehand?xe(me):xe(ke,!1)})}var Se=h(Ae,2);{var We=xe=>{{let Le=u(()=>r(L).possible_targets||or());it(xe,{get data(){return r(Le)},generateId:!0,children:(he,Re)=>{{let Ce=u(()=>Ge("turn-restriction-targets")),be=u(()=>({"line-color":"yellow","line-opacity":bt(.5,1),"line-width":fo(1)}));gt(he,Ie(()=>r(Ce),{manageHoverState:!0,get paint(){return r(be)},onclick:y,children:(Me,Te)=>{Bt(Me,{openOn:"hover",children:(Ue,De)=>{let qe=()=>De?.().data;const Fe=u(()=>qe().properties);var He=N0();{const rt=Ve=>{var Ke=R0();Z(vt=>{ze(Ke,"src",ne[r(Fe).kind]),ze(Ke,"alt",vt)},[()=>r(A).t(428)]),_(Ve,Ke)};var Ze=c(He);{let Ve=u(()=>[rt]),Ke=u(()=>r(A).cx(429)),vt=u(()=>[r(L).kind=="turn_restriction"?r(L).from_road_name:"???",r(Fe).name||"unnamed road"]);pe(Ze,{get t(){return r(Ve)},get x(){return r(Ke)},get a(){return r(vt)}})}}_(Ue,He)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}};ve(Se,xe=>{r(L).kind=="turn_restriction"&&xe(We)})}_(re,ae)},$$slots:{top:!0,left:!0,main:!0}}),Be(),I()}rr(["click","change"]);var O0=P("<li><!></li>"),j0=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li><!></li> <li> </li></ul></nav>'),z0=P("<span> </span>"),D0=P("<span> </span>"),U0=P("<p><!></p> <i> </i>",1),G0=P("<i> </i>"),W0=P("<p><!></p>"),H0=P("<i> </i>"),q0=P("<p><!></p>"),J0=P("<!> <!> <!> <!>",1),Q0=P("<!> <p><!></p> <!>",1),Z0=P("<!> <!> <!>",1),V0=P("<!> <!>",1),K0=P("<!> <!>",1);function X0(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",s),o=()=>ye(ss,"$fastSample",s),a=()=>ye(yt,"$mode",s),[s,l]=lt(),i=u(()=>ut(ct("main")));let f=ht(e.road.properties);f.kind="focus";let v=we(ht([])),b=we(0),m=we("Finding changes to this road");gn(async()=>{await ni(),K(v,t().getImpactsOnRoad(f.id,o()),!0),K(m,""),r(v).length==0&&(window.alert("No routes over this road change. (This is a bug in progress of being fixed.)"),Qe(yt,{mode:"predict-impact",prevMode:e.prevPrevMode}))});function C(x){return{type:"FeatureCollection",features:[r(v)[x].before,r(v)[x].after,e.road].filter(L=>L!=null)}}function j(x){return r(v)[x].before!=null?Ho(r(v)[x].before.geometry.coordinates[0]):Ho(r(v)[x].after.geometry.coordinates[0])}function T(x){let L=r(v)[x].before!=null?r(v)[x].before.geometry.coordinates:r(v)[x].after.geometry.coordinates;return Ho(L[L.length-1])}var M=K0(),I=V(M);ho(I,{get loading(){return r(m)}});var A=h(I,2);Mr(A,{top:R=>{var O=j0(),z=c(O),d=c(z),g=c(d);et(g,{mode:{mode:"title"}});var p=h(d,2),$=c(p);et($,{mode:{mode:"pick-neighbourhood"}});var w=h(p,2);{var y=E=>{var B=O0(),G=c(B);et(G,{mode:{mode:"neighbourhood"}}),_(E,B)};ve(w,E=>{e.prevPrevMode=="neighbourhood"&&E(y)})}var F=h(w,2),k=c(F);{let E=u(()=>({mode:"predict-impact",prevMode:e.prevPrevMode}));et(k,{get mode(){return r(E)}})}var N=h(F,2),S=c(N);Z(E=>U(S,E),[()=>wr(a().mode)]),_(R,O)},left:R=>{var O=Q0(),z=V(O);{let w=u(()=>({mode:"predict-impact",prevMode:e.prevPrevMode}));_n(z,{get mode(){return r(w)}})}var d=h(z,2);{const w=(F,k=Pe)=>{var N=z0();gr(N,"",{},{color:"red"});var S=c(N);Z(E=>U(S,E),[()=>r(i).tx(k())]),_(F,N)},y=(F,k=Pe)=>{var N=D0();gr(N,"",{},{color:"blue"});var S=c(N);Z(E=>U(S,E),[()=>r(i).tx(k())]),_(F,N)};var g=c(d);{let F=u(()=>[w,y]),k=u(()=>r(i).cx(66)),N=u(()=>[f.before.toLocaleString(),f.after.toLocaleString(),Math.round(100*f.after/f.before)]);pe(g,{get t(){return r(F)},get x(){return r(k)},get a(){return r(N)}})}}var p=h(d,2);{var $=w=>{var y=J0(),F=V(y);oi(F,{get list(){return r(v)},get idx(){return r(b)},set idx(Q){K(b,Q,!0)}});var k=h(F,2);{var N=Q=>{var q=U0(),X=V(q),ue=c(X);{let oe=u(()=>r(i).cx(67)),H=u(()=>[r(v)[r(b)].count.toLocaleString()]);pe(ue,{get x(){return r(oe)},get a(){return r(H)}})}var te=h(X,2),ne=c(te);Z(oe=>U(ne,oe),[()=>r(i).t(68)]),_(Q,q)};ve(k,Q=>{r(v)[r(b)].count>1&&Q(N)})}var S=h(k,2);{var E=Q=>{var q=W0();gr(q,"",{},{color:"red"});{const ue=(te,ne=Pe)=>{var oe=G0(),H=c(oe);Z(J=>U(H,J),[()=>r(i).tx(ne())]),_(te,oe)};var X=c(q);{let te=u(()=>[ue]),ne=u(()=>r(i).cx(69));pe(X,{get t(){return r(te)},get x(){return r(ne)}})}}_(Q,q)};ve(S,Q=>{r(v)[r(b)].before==null&&Q(E)})}var B=h(S,2);{var G=Q=>{var q=q0();gr(q,"",{},{color:"blue"});{const ue=(te,ne=Pe)=>{var oe=H0(),H=c(oe);Z(J=>U(H,J),[()=>r(i).tx(ne())]),_(te,oe)};var X=c(q);{let te=u(()=>[ue]),ne=u(()=>r(i).cx(70));pe(X,{get t(){return r(te)},get x(){return r(ne)}})}}_(Q,q)};ve(B,Q=>{r(v)[r(b)].after==null&&Q(G)})}_(w,y)};ve(p,w=>{r(v).length>0&&w($)})}_(R,O)},main:R=>{var O=V0(),z=V(O);{var d=p=>{var $=Z0(),w=V($);{let k=u(()=>C(r(b)));it(w,{get data(){return r(k)},children:(N,S)=>{{let E=u(()=>Ge("predict-impact")),B=u(()=>({"line-width":$n(["get","kind"],{focus:8},5),"line-color":$n(["get","kind"],{focus:"black",before:"red",after:"blue"},"cyan"),"line-opacity":$n(["get","kind"],{focus:1},.5)}));gt(N,Ie(()=>r(E),{get paint(){return r(B)}}))}},$$slots:{default:!0}})}var y=h(w,2);{let k=u(()=>j(r(b)));no(y,{get lngLat(){return r(k)},children:(N,S)=>{var E=Ut();Z(B=>U(E,B),[()=>r(i).t(71)]),_(N,E)},$$slots:{default:!0}})}var F=h(y,2);{let k=u(()=>T(r(b)));no(F,{get lngLat(){return r(k)},children:(N,S)=>{var E=Ut();Z(B=>U(E,B),[()=>r(i).t(72)]),_(N,E)},$$slots:{default:!0}})}_(p,$)};ve(z,p=>{r(v).length>0&&p(d)})}var g=h(z,2);Cn(g,{interactive:!1}),_(R,O)},$$slots:{top:!0,left:!0,main:!0}}),_(n,M),Be(),l()}var Y0=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),e1=P("<p> </p>"),t1=P("<i> </i>"),r1=P("<p><!></p>"),n1=P("<p> </p>"),o1=P("<p> </p>"),a1=P("<i> </i>"),i1=P("<p><!></p>"),s1=P("<p> </p>"),l1=P("<!> <p> </p> <u> </u> <!> <u> </u> <!>",1),u1=P("<p><!></p>"),c1=P("<!> <!> <!> <!> <!>",1),d1=P("<!> <!>",1);function f1(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",s),o=()=>ye($a,"$oneDestination",s),a=()=>ye(yt,"$mode",s),[s,l]=lt(),i=u(()=>ut(ct("main")));let f=t().renderNeighbourhood(),v=we(void 0);gn(()=>{setTimeout(()=>{o()&&Ni($a)},10)});function b(D){return D?t().compareRoute(new Li.LngLat(D.properties.pt1_x,D.properties.pt1_y),o(),1):or()}function m(D){Qe(Ia,new Li.LngLat(D.properties.pt1_x,D.properties.pt1_y)),Qe(Ta,o()),Qe(yt,{mode:"route",prevMode:"impact-one-destination"})}function C(D){Qe($a,D.lngLat)}let j=u(()=>t().impactToOneDestination(o())),T=u(()=>b(r(v))),M=u(()=>r(T).features.find(D=>D.properties.kind=="before")),I=u(()=>r(T).features.find(D=>D.properties.kind=="after"));var A=d1(),x=V(A);ma(x,{oncontextmenu:C});var L=h(x,2);Mr(L,{top:z=>{var d=Y0(),g=c(d),p=c(g),$=c(p);et($,{mode:{mode:"title"}});var w=h(p,2),y=c(w);et(y,{mode:{mode:"pick-neighbourhood"}});var F=h(w,2),k=c(F);et(k,{mode:{mode:"neighbourhood"}});var N=h(F,2),S=c(N);Z(E=>U(S,E),[()=>wr(a().mode)]),_(z,d)},left:z=>{var d=l1(),g=V(d);_n(g,{mode:{mode:"neighbourhood"}});var p=h(g,2),$=c(p),w=h(p,2);gr(w,"",{},{color:"red"});var y=c(w),F=h(w,2);{var k=q=>{var X=e1(),ue=c(X);Z((te,ne)=>U(ue,`${te??""}, ${ne??""}`),[()=>Ga(r(M).properties.distance),()=>Wa(r(M).properties.time)]),_(q,X)},N=q=>{var X=$e(),ue=V(X);{var te=oe=>{var H=r1();{const ee=(re,ae=Pe)=>{var Y=t1(),ie=c(Y);Z(_e=>U(ie,_e),[()=>r(i).tx(ae())]),_(re,Y)};var J=c(H);{let re=u(()=>[ee]),ae=u(()=>r(i).cx(75));pe(J,{get t(){return r(re)},get x(){return r(ae)}})}}_(oe,H)},ne=oe=>{var H=n1(),J=c(H);Z(ee=>U(J,ee),[()=>r(i).t(76)]),_(oe,H)};ve(ue,oe=>{r(I)?oe(te):oe(ne,!1)},!0)}_(q,X)};ve(F,q=>{r(M)?q(k):q(N,!1)})}var S=h(F,2);gr(S,"",{},{color:"blue"});var E=c(S),B=h(S,2);{var G=q=>{var X=o1(),ue=c(X);Z((te,ne)=>U(ue,`${te??""}, ${ne??""}`),[()=>Ga(r(I).properties.distance),()=>Wa(r(I).properties.time)]),_(q,X)},Q=q=>{var X=$e(),ue=V(X);{var te=oe=>{var H=i1();{const ee=(re,ae=Pe)=>{var Y=a1(),ie=c(Y);Z(_e=>U(ie,_e),[()=>r(i).tx(ae())]),_(re,Y)};var J=c(H);{let re=u(()=>[ee]),ae=u(()=>r(i).cx(75));pe(J,{get t(){return r(re)},get x(){return r(ae)}})}}_(oe,H)},ne=oe=>{var H=s1(),J=c(H);Z(ee=>U(J,ee),[()=>r(i).t(76)]),_(oe,H)};ve(ue,oe=>{r(M)?oe(te):oe(ne,!1)},!0)}_(q,X)};ve(B,q=>{r(I)?q(G):q(Q,!1)})}Z((q,X,ue)=>{U($,q),U(y,X),U(E,ue)},[()=>r(i).t(73),()=>r(i).t(74),()=>r(i).t(77)]),_(z,d)},main:z=>{var d=c1(),g=V(d);it(g,{get data(){return f},generateId:!0,children:(F,k)=>{{let N=u(()=>Ge("cells")),S=u(()=>({"fill-color":ri(),"fill-opacity":.6}));cr(F,Ie(()=>r(N),{filter:["==",["get","kind"],"cell"],get paint(){return r(S)}}))}},$$slots:{default:!0}});var p=h(g,2);it(p,{get data(){return r(j)},generateId:!0,children:(F,k)=>{{let N=u(()=>Ge("interior-roads")),S=u(()=>({"line-color":["interpolate-hcl",["linear"],["/",["get","time_after"],["get","time_before"]],1,"white",Math.max(r(j).highest_time_ratio,1.1),"red"],"line-width":5}));gt(F,Ie(()=>r(N),{get paint(){return r(S)},manageHoverState:!0,onclick:E=>m(E.features[0]),get hovered(){return r(v)},set hovered(E){K(v,E,!0)},children:(E,B)=>{Bt(E,{openOn:"hover",children:(Q,q)=>{let X=()=>q?.().data;const ue=u(()=>X().properties);var te=u1(),ne=c(te);{let oe=u(()=>r(i).cx(78)),H=u(()=>[(r(ue).time_after/r(ue).time_before).toFixed(1)]);pe(ne,{get x(){return r(oe)},get a(){return r(H)}})}_(Q,te)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}});var $=h(p,2);it($,{get data(){return r(T)},children:(F,k)=>{{let N=u(()=>Ge("compare-route")),S=u(()=>({"line-width":10,"line-color":$n(["get","kind"],{before:"red",after:"blue"},"red")}));gt(F,Ie(()=>r(N),{interactive:!1,get paint(){return r(S)}}))}},$$slots:{default:!0}});var w=h($,2);Cn(w,{interactive:!1});var y=h(w,2);no(y,{draggable:!0,get lngLat(){return sa(),o()},set lngLat(F){Qe($a,F)},children:(F,k)=>{var N=Ut();Z(S=>U(N,S),[()=>r(i).t(79)]),_(F,N)},$$slots:{default:!0}}),_(z,d)},$$slots:{top:!0,left:!0,main:!0}}),_(n,A),Be(),l()}function v1(n,e){as("debug_route_snapper.geojson",e().toRouteSnapperGj())}var g1=(n,e)=>Ol(e()),_1=(n,e)=>e(),p1=P("<li><!></li>"),h1=P('<details class="dropdown" style="display: inline-block; margin-top: 8px"><summary role="button" class="contrast outline"><!> <span style="margin-left: 2px;"> </span></summary> <ul></ul></details>'),m1=P('<a href="mailto:dabreegster@gmail.com"> </a>'),b1=P("<p><!></p>"),y1=P('<div style="display: flex"><i><!></i> <!></div>'),A1=P('<button class="secondary"> </button>'),w1=P('<h2><!></h2> <div style="display: flex; gap: 8px"><button class="outline" style="margin-right: 8px;"><div style="display: flex; align-items: center; gap: 8px; color: black;"><!> <span style="margin-right: 2px;"> </span></div></button> <button class="outline" style="margin-right: 8px;"><div style="display: flex; align-items: center; gap: 8px; color: black;"><!> <span style="margin-right: 2px;"> </span></div></button></div> <!> <p><!></p> <p><!></p> <p><!></p> <!> <!>',1);function x1(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",f),o=()=>ye(Ao,"$projectStorage",f),a=()=>ye(Ml,"$currentProject",f),s=()=>ye(xn,"$currentProjectID",f),l=()=>ye(Qt,"$mutationCounter",f),i=()=>ye(ia,"$devMode",f),[f,v]=lt(),b=u(()=>ut(ct("main")));let m=we(!1),C=t().getOsmTimestamp();function j(J){for(let[ee,re]of o().studyAreaProjects())if(ee==a().study_area_name)return re.filter(ae=>ae.projectID!=J);return[]}function T(){let J=a().project_name,ee=window.prompt(r(b).t(127,[J]),o().nextAvailableProjectName(J));if(ee)try{let re=o().copyProject(s(),ee);Qe(xn,re),t().changeProjectName(ee);let ae=new URL(window.location.href);ae.searchParams.set("project",re),window.history.replaceState(null,"",ae.toString()),window.alert(`Done, you are now working on project ${ee}`)}catch(re){window.alert(`Couldn't copy project: ${re}`)}}function M(J){K(m,!1);let ee=o().project(J);t().loadSavefile(ee),Qe(xn,J),sr(Qt,l());let re=new URL(window.location.href);re.searchParams.set("project",J),window.history.replaceState(null,"",re.toString())}function I(J){let ee=0,re=0,ae=0;for(let Y of J.features)Y.properties.kind=="modal_filter"?ee++:Y.properties.kind=="deleted_existing_modal_filter"?re++:Y.properties.kind=="travel_flow"&&ae++;return{modalFilters:ee,deletedModalFilters:re,travelFlows:ae}}let A=u(()=>I(e.projectGj)),x=u(()=>j(s()));var L=w1(),D=V(L),R=c(D);{let J=u(()=>r(b).cx(128)),ee=u(()=>[a().project_name]);pe(R,{get x(){return r(J)},get a(){return r(ee)}})}var O=h(D,2),z=c(O);z.__click=[g1,s];var d=c(z),g=c(d);ql(g,{});var p=h(g,2),$=c(p),w=h(z,2);w.__click=[_1,T];var y=c(w),F=c(y);Hl(F,{});var k=h(F,2),N=c(k),S=h(O,2);{var E=J=>{var ee=h1(),re=c(ee),ae=c(re);Xc(ae,{});var Y=h(ae,2),ie=c(Y),_e=h(re,2);Zt(_e,21,()=>r(x),Vt,(le,fe)=>{var se=p1(),Ae=c(se);pa(Ae,{onclick:()=>M(r(fe).projectID),children:(me,ke)=>{var Se=Ut();Z(()=>U(Se,r(fe).projectName)),_(me,Se)}}),_(le,se)}),Z(le=>U(ie,le),[()=>r(b).t(133)]),Gc("open","toggle",ee,le=>K(m,le),()=>r(m)),_(J,ee)};ve(S,J=>{a().study_area_name&&r(x).length>0&&J(E)})}var B=h(S,2),G=c(B);{let J=u(()=>r(b).cx(134)),ee=u(()=>[r(A).modalFilters]);pe(G,{get x(){return r(J)},get a(){return r(ee)}})}var Q=h(B,2),q=c(Q);{let J=u(()=>r(b).cx(135)),ee=u(()=>[r(A).deletedModalFilters]);pe(q,{get x(){return r(J)},get a(){return r(ee)}})}var X=h(Q,2),ue=c(X);{let J=u(()=>r(b).cx(136)),ee=u(()=>[r(A).travelFlows]);pe(ue,{get x(){return r(J)},get a(){return r(ee)}})}var te=h(X,2);{var ne=J=>{var ee=y1(),re=c(ee),ae=c(re);{let ie=u(()=>r(b).cx(137)),_e=u(()=>[C.toDateString()]);pe(ae,{get x(){return r(ie)},get a(){return r(_e)}})}var Y=h(re,2);qo(Y,{children:(ie,_e)=>{var le=b1();{const se=(Ae,me=Pe)=>{var ke=m1(),Se=c(ke);Z(We=>U(Se,We),[()=>r(b).tx(me())]),_(Ae,ke)};var fe=c(le);{let Ae=u(()=>[se]),me=u(()=>r(b).cx(138));pe(fe,{get t(){return r(Ae)},get x(){return r(me)}})}}_(ie,le)},$$slots:{default:!0}}),_(J,ee)};ve(te,J=>{C&&J(ne)})}var oe=h(te,2);{var H=J=>{var ee=A1();ee.__click=[v1,t];var re=c(ee);Z(ae=>U(re,ae),[()=>r(b).t(139)]),_(J,ee)};ve(oe,J=>{i()&&J(H)})}Z((J,ee,re,ae)=>{ze(z,"title",J),U($,ee),ze(w,"title",re),U(N,ae)},[()=>r(b).t(129),()=>r(b).t(130),()=>r(b).t(131),()=>r(b).t(132)]),_(n,L),Be(),v()}rr(["click"]);var $1=P("<li><!></li>"),k1=P('<div style="display: flex; justify-content: space-between;"><nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li></ul></nav> <nav><ul><li><!></li> <li><!></li> <!></ul></nav></div>'),S1=(n,e,t)=>e(t()),E1=(n,e,t)=>e(t()),L1=P('<li><h3><!></h3> <span class="actions"><button class="outline icon-btn"><!></button> <button class="icon-btn destructive"><!></button></span></li>'),C1=P("<h3> </h3> <p> </p> <!> <hr/>",1),M1=P('<h2> </h2> <ul class="navigable-list"><!> <li><!></li></ul> <!> <!>',1),P1=P("<b> </b>"),I1=P("<b> </b>"),T1=P("<b> </b>"),R1=P("<h2> </h2> <!>",1),N1=P("<!> <!> <!> <!>",1),B1=P("<!> <!>",1);function F1(n,e){Ne(e,!0);const t=()=>ye(Qt,"$mutationCounter",v),o=()=>ye(Rt,"$backend",v),a=()=>ye(yt,"$mode",v),s=()=>ye(nn,"$appFocus",v),l=()=>ye(yo,"$metricBuckets",v),i=()=>ye(xn,"$currentProjectID",v),f=()=>ye(ia,"$devMode",v),[v,b]=lt(),m=u(()=>ut(ct("main")));let C=u(()=>t()>0?o().toSavefile():or()),j=u(()=>({type:"FeatureCollection",features:r(C).features.filter(O=>O.properties.kind=="boundary")}));Je(()=>{r(j).features.length==0&&Qe(yt,{mode:"add-neighbourhood"})});let T=we(ht(s()=="cnt"?"combined":"none")),M=we(null),I=we(void 0);Qe(co,void 0);function A(O){o().setCurrentNeighbourhood(O),Qe(co,O),Qe(yt,{mode:"neighbourhood"})}function x(O){window.confirm(r(m).t(140,[O]))&&(o().deleteNeighbourhoodBoundary(O),console.assert(!co),la(),sr(Qt,t()))}function L(O){let z=ku(o(),r(m).t(141,[O]),O);z&&(o().renameNeighbourhoodBoundary(O,z),Qe(co,z),la(),sr(Qt,t()))}function D(O){let z=Jr.mapFeature.hover.backgroundColor,d=Eu({none:z},O,l());return["case",["==",["feature-state","highlight"],"yes"],z,d]}function R(O){let z=.7;return{none:["case",["==",["feature-state","highlight"],"yes"],z,bt(.3,z)],area:bt(.7,.9),population_density:bt(.7,.9),simd:bt(.7,.9),stats19:bt(.7,.9),pois:bt(.7,.9),car_ownership:bt(.7,.9),combined:bt(.7,.9)}[O]}Mr(n,{top:g=>{var p=k1(),$=c(p),w=c($),y=c(w),F=c(y);et(F,{mode:{mode:"title"}});var k=h(y,2),N=c(k);ai(N,i,te=>{var ne=Ut();Z(oe=>U(ne,oe),[()=>wr(a().mode)]),_(te,ne)});var S=h($,2),E=c(S),B=c(E),G=c(B);et(G,{mode:{mode:"route",prevMode:"pick-neighbourhood"}});var Q=h(B,2),q=c(Q);et(q,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var X=h(Q,2);{var ue=te=>{var ne=$1(),oe=c(ne);et(oe,{mode:{mode:"debug-intersections"}}),_(te,ne)};ve(X,te=>{f()&&te(ue)})}_(g,p)},left:g=>{var p=M1(),$=V(p),w=c($),y=h($,2),F=c(y);Zt(F,17,()=>r(j).features,Vt,(G,Q)=>{let q=()=>r(Q).properties.name;var X=L1();let ue;var te=c(X),ne=c(te);pa(ne,{onclick:()=>A(q()),children:(ae,Y)=>{var ie=Ut();Z(()=>U(ie,q())),_(ae,ie)}});var oe=h(te,2),H=c(oe);H.__click=[S1,L,q];var J=c(H);ls(J,{color:"black"});var ee=h(H,2);ee.__click=[E1,x,q];var re=c(ee);ii(re,{color:"white"}),Z((ae,Y,ie)=>{ue=St(X,1,"actionable-cell svelte-j2ux5u",null,ue,ae),ze(H,"title",Y),ze(ee,"title",ie)},[()=>({highlighted:r(I)?.properties.name==q()||r(M)==q()}),()=>r(m).t(143),()=>r(m).t(144)]),ro("mouseenter",X,()=>K(M,q(),!0)),ro("mouseleave",X,()=>K(M,null)),_(G,X)});var k=h(F,2),N=c(k);{const G=Q=>{Vc(Q,{})};et(N,{mode:{mode:"add-neighbourhood"},_w_snippet_0:G,children:(Q,q)=>{{let X=u(()=>[G]),ue=u(()=>r(m).cx(145));pe(Q,{get t(){return r(X)},get x(){return r(ue)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}var S=h(y,2);{var E=G=>{var Q=C1(),q=V(Q),X=c(q),ue=h(q,2),te=c(ue),ne=h(ue,2);Su(ne,{get selectedPrioritization(){return r(T)},set selectedPrioritization(oe){K(T,oe,!0)}}),Z((oe,H)=>{U(X,oe),U(te,H)},[()=>r(m).t(17),()=>r(m).t(146)]),_(G,Q)};ve(S,G=>{s()=="cnt"&&G(E)})}var B=h(S,2);x1(B,{get projectGj(){return r(C)}}),Z(G=>U(w,G),[()=>r(m).t(142)]),_(g,p)},main:g=>{var p=B1(),$=V(p);it($,{get data(){return r(j)},promoteId:"name",children:(y,F)=>{var k=N1(),N=V(k);{let G=u(()=>r(M)?[{name:r(M),highlight:"yes"}]:[]);gd(N,{get data(){return r(G)},idCol:"name"})}var S=h(N,2);{let G=u(()=>Ge("neighbourhood-boundaries-selected-outline",!1));gt(S,Ie({filter:["==",["get","kind"],"boundary"]},()=>r(G),{manageHoverState:!1,paint:{"line-color":"black","line-width":4,"line-dasharray":[2,2]}}))}var E=h(S,2);{let G=u(()=>Ge("neighbourhood-boundaries-selected-outline-base",!1));gt(E,Ie({filter:["==",["get","kind"],"boundary"]},()=>r(G),{manageHoverState:!1,paint:{"line-color":"white","line-width":8,"line-opacity":.7}}))}var B=h(E,2);{let G=u(()=>Ge("neighbourhood-boundaries",!1)),Q=u(()=>({"fill-color":D(r(T)),"fill-opacity":R(r(T))}));cr(B,Ie(()=>r(G),{filter:["==",["get","kind"],"boundary"],get paint(){return r(Q)},manageHoverState:!0,hoverCursor:"pointer",onclick:q=>A(q.features[0].properties.name),get hovered(){return r(I)},set hovered(q){K(I,q,!0)},children:(q,X)=>{Bt(q,{openOn:"hover",children:(te,ne)=>{let oe=()=>ne?.().data;const H=u(()=>oe().properties);var J=R1(),ee=V(J),re=c(ee),ae=h(ee,2);{var Y=_e=>{const le=(fe,se=Pe)=>{var Ae=P1(),me=c(Ae);Z(ke=>U(me,ke),[()=>r(m).tx(se())]),_(fe,Ae)};{let fe=u(()=>[le]),se=u(()=>r(m).cx(147)),Ae=u(()=>[Math.round(r(H).population/r(H).area_km2).toLocaleString()]);pe(_e,{get t(){return r(fe)},get x(){return r(se)},get a(){return r(Ae)}})}},ie=_e=>{var le=$e(),fe=V(le);{var se=me=>{const ke=(Se,We=Pe)=>{var xe=I1(),Le=c(xe);Z(he=>U(Le,he),[()=>r(m).tx(We())]),_(Se,xe)};{let Se=u(()=>[ke]),We=u(()=>r(m).cx(148)),xe=u(()=>[(r(H).number_stats19_collisions/r(H).area_km2).toFixed(1)]);pe(me,{get t(){return r(Se)},get x(){return r(We)},get a(){return r(xe)}})}},Ae=me=>{var ke=$e(),Se=V(ke);{var We=xe=>{const Le=(he,Re=Pe)=>{var Ce=T1(),be=c(Ce);Z(Me=>U(be,Me),[()=>r(m).tx(Re())]),_(he,Ce)};{let he=u(()=>[Le]),Re=u(()=>r(m).cx(149)),Ce=u(()=>[(r(H).number_pois/r(H).area_km2).toFixed(1)]);pe(xe,{get t(){return r(he)},get x(){return r(Re)},get a(){return r(Ce)}})}};ve(Se,xe=>{r(T)=="pois"&&xe(We)},!0)}_(me,ke)};ve(fe,me=>{r(T)=="stats19"?me(se):me(Ae,!1)},!0)}_(_e,le)};ve(ae,_e=>{r(T)=="population_density"?_e(Y):_e(ie,!1)})}Z(()=>U(re,r(H).name)),_(te,J)},$$slots:{default:!0}})},$$slots:{default:!0}}))}_(y,k)},$$slots:{default:!0}});var w=h($,2);Cn(w,{interactive:!1}),_(g,p)},$$slots:{top:!0,left:!0,main:!0}}),Be(),b()}rr(["click"]);function pl(n,e,t){Qe(ss,r(t)=="fast")}var O1=P("<li><!></li>"),j1=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li> </li></ul></nav>'),z1=P('<a href="https://nptscot.github.io/data/" target="_blank"> </a>'),D1=P("<p><!></p>"),U1=P("<span> </span> <!>",1),G1=P('<a href="https://www.nomisweb.co.uk/sources/census_2021_od" target="_blank"> </a>'),W1=P('<a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/methodologies/userguidetocensus2021origindestinationdataenglandandwales" target="_blank"> </a>'),H1=P("<p><!></p>"),q1=P("<span> </span> <!>",1),J1=P("<b> </b>"),Q1=P('<a href="mailto:dabreegster@gmail.com"> </a>'),Z1=P("<p><!></p>"),V1=P("<b> </b> <!>",1),K1=P('<input type="radio"/>'),X1=P('<input type="radio"/>'),Y1=P('<input type="number"/>'),em=P('<!> <p><!></p> <div style="display: flex"><!></div> <hr/> <fieldset><label><!></label> <label><!></label></fieldset> <p> </p> <label><!></label> <!>',1),tm=P("<p><!></p> <p> </p>",1),rm=P("<!> <!>",1),nm=P("<!> <!> <!>",1),om=P("<!> <!>",1);function am(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",i),o=()=>ye(yt,"$mode",i),a=()=>ye(ss,"$fastSample",i),s=()=>ye(nn,"$appFocus",i),l=()=>ye(ks,"$minImpactCount",i),[i,f]=lt(),v=[],b=u(()=>ut(ct("main")));let m=["#1a9641","#a6d96a","white","#fdae61","#d7191c"],C=we(""),j=we(ht({type:"FeatureCollection",features:[],max_count:1})),T=t().toSavefile(),M=3,I=10;function A(z){Qe(yt,{mode:"impact-detail",road:z,prevPrevMode:e.prevMode})}async function x(z){K(C,r(b).t(80),!0),await ni(),K(j,t().predictImpact(z),!0),K(C,"")}Je(()=>{x(a())});let L=we(ht(a()?"fast":"accurate"));var D=om(),R=V(D);ho(R,{get loading(){return r(C)}});var O=h(R,2);Mr(O,{top:p=>{var $=j1(),w=c($),y=c(w),F=c(y);et(F,{mode:{mode:"title"}});var k=h(y,2),N=c(k);et(N,{mode:{mode:"pick-neighbourhood"}});var S=h(k,2);{var E=Q=>{var q=O1(),X=c(q);et(X,{mode:{mode:"neighbourhood"}}),_(Q,q)};ve(S,Q=>{e.prevMode=="neighbourhood"&&Q(E)})}var B=h(S,2),G=c(B);Z(Q=>U(G,Q),[()=>wr(o().mode)]),_(p,$)},left:p=>{var $=em(),w=V($);{let J=u(()=>({mode:e.prevMode}));_n(w,{get mode(){return r(J)}})}var y=h(w,2);{const J=(ee,re=Pe)=>{et(ee,{mode:{mode:"debug-demand"},children:(ae,Y)=>{var ie=Ut();Z(_e=>U(ie,_e),[()=>r(b).tx(re())]),_(ae,ie)},$$slots:{default:!0}})};var F=c(y);{let ee=u(()=>[J]),re=u(()=>r(b).cx(81));pe(F,{get t(){return r(ee)},get x(){return r(re)}})}}var k=h(y,2),N=c(k);{var S=J=>{var ee=U1(),re=V(ee),ae=c(re),Y=h(re,2);qo(Y,{children:(ie,_e)=>{var le=D1();{const se=(Ae,me=Pe)=>{var ke=z1(),Se=c(ke);Z(We=>U(Se,We),[()=>r(b).tx(me())]),_(Ae,ke)};var fe=c(le);{let Ae=u(()=>[se]),me=u(()=>r(b).cx(83));pe(fe,{get t(){return r(Ae)},get x(){return r(me)}})}}_(ie,le)},$$slots:{default:!0}}),Z(ie=>U(ae,ie),[()=>r(b).t(82)]),_(J,ee)},E=J=>{var ee=$e(),re=V(ee);{var ae=ie=>{var _e=q1(),le=V(_e),fe=c(le),se=h(le,2);qo(se,{children:(Ae,me)=>{var ke=H1();{const We=(Le,he=Pe)=>{var Re=G1(),Ce=c(Re);Z(be=>U(Ce,be),[()=>r(b).tx(he())]),_(Le,Re)},xe=(Le,he=Pe)=>{var Re=W1(),Ce=c(Re);Z(be=>U(Ce,be),[()=>r(b).tx(he())]),_(Le,Re)};var Se=c(ke);{let Le=u(()=>[We,xe]),he=u(()=>r(b).cx(85));pe(Se,{get t(){return r(Le)},get x(){return r(he)}})}}_(Ae,ke)},$$slots:{default:!0}}),Z(Ae=>U(fe,Ae),[()=>r(b).t(84)]),_(ie,_e)},Y=ie=>{var _e=V1(),le=V(_e),fe=c(le),se=h(le,2);qo(se,{children:(Ae,me)=>{var ke=Z1();{const We=(Le,he=Pe)=>{var Re=J1(),Ce=c(Re);Z(be=>U(Ce,be),[()=>r(b).tx(he())]),_(Le,Re)},xe=(Le,he=Pe)=>{var Re=Q1(),Ce=c(Re);Z(be=>U(Ce,be),[()=>r(b).tx(he())]),_(Le,Re)};var Se=c(ke);{let Le=u(()=>[We,xe]),he=u(()=>r(b).cx(87));pe(Se,{get t(){return r(Le)},get x(){return r(he)}})}}_(Ae,ke)},$$slots:{default:!0}}),Z(Ae=>U(fe,Ae),[()=>r(b).t(86)]),_(ie,_e)};ve(re,ie=>{s()=="england"?ie(ae):ie(Y,!1)},!0)}_(J,ee)};ve(N,J=>{s()=="cnt"?J(S):J(E,!1)})}var B=h(k,4),G=c(B);{const J=ee=>{var re=K1();re.__change=[pl,a,L],re.value=re.__value="fast",Mi(v,[],re,()=>r(L),ae=>K(L,ae)),_(ee,re)};var Q=c(G);{let ee=u(()=>[J]),re=u(()=>r(b).cx(88));pe(Q,{get t(){return r(ee)},get x(){return r(re)}})}}var q=h(G,2);{const J=ee=>{var re=X1();re.__change=[pl,a,L],re.value=re.__value="accurate",Mi(v,[],re,()=>r(L),ae=>K(L,ae)),_(ee,re)};var X=c(q);{let ee=u(()=>[J]),re=u(()=>r(b).cx(89));pe(X,{get t(){return r(ee)},get x(){return r(re)}})}}var ue=h(B,2),te=c(ue),ne=h(ue,2);{const J=ee=>{var re=Y1();ze(re,"min",0),aa(re,l,ae=>Qe(ks,ae)),_(ee,re)};var oe=c(ne);{let ee=u(()=>[J]),re=u(()=>r(b).cx(91));pe(oe,{get t(){return r(ee)},get x(){return r(re)}})}}var H=h(ne,2);Ar(H,{get colorScale(){return m},labels:{limits:["0%","50%","same","150%","200%"]}}),Z(J=>U(te,J),[()=>r(b).t(90)]),_(p,$)},main:p=>{var $=nm(),w=V($);it(w,{get data(){return T},children:(k,N)=>{{let S=u(()=>Ge("neighbourhood-boundaries",!1));cr(k,Ie(()=>r(S),{filter:["==",["get","kind"],"boundary"],paint:{"fill-color":"grey","fill-opacity":.5}}))}},$$slots:{default:!0}});var y=h(w,2);it(y,{get data(){return r(j)},generateId:!0,children:(k,N)=>{var S=rm(),E=V(S);{let G=u(()=>Ge("predict-impact-outline")),Q=u(()=>[">=",["max",["get","before"],["get","after"]],l()]),q=u(()=>({"line-width":["interpolate",["linear"],["get","after"],0,1.5*M,r(j).max_count,1.5*I],"line-color":"black"}));gt(E,Ie(()=>r(G),{get filter(){return r(Q)},get paint(){return r(q)}}))}var B=h(E,2);{let G=u(()=>Ge("predict-impact")),Q=u(()=>[">=",["max",["get","before"],["get","after"]],l()]),q=u(()=>({"line-width":["interpolate",["linear"],["get","after"],0,M,r(j).max_count,I],"line-color":["let","ratio",["*",100,["/",["get","after"],["get","before"]]],["interpolate-hcl",["linear"],["var","ratio"],0,m[0],50,m[1],100,m[2],150,m[3],200,m[4]]]}));gt(B,Ie(()=>r(G),{get filter(){return r(Q)},get paint(){return r(q)},manageHoverState:!0,hoverCursor:"pointer",onclick:X=>A(X.features[0]),children:(X,ue)=>{Bt(X,{openOn:"hover",children:(ne,oe)=>{let H=()=>oe?.().data;const J=u(()=>H().properties);var ee=tm(),re=V(ee),ae=c(re);{let _e=u(()=>r(b).cx(92)),le=u(()=>[r(J).before.toLocaleString(),r(J).after.toLocaleString()]);pe(ae,{get x(){return r(_e)},get a(){return r(le)}})}var Y=h(re,2),ie=c(Y);Z(_e=>U(ie,`${_e??""}%`),[()=>Math.round(100*r(J).after/r(J).before)]),_(ne,ee)},$$slots:{default:!0}})},$$slots:{default:!0}}))}_(k,S)},$$slots:{default:!0}});var F=h(y,2);Cn(F,{interactive:!1}),_(p,$)},$$slots:{top:!0,left:!0,main:!0}}),_(n,D),Be(),f()}rr(["change"]);var im=P("<li><!></li>"),sm=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li> </li></ul></nav>'),lm=P("<p> </p>"),um=P("<i> </i>"),cm=P("<p><!></p>"),dm=P("<p> </p>"),fm=P("<i> </i>"),vm=P("<p><!></p>"),gm=P('<input type="range" min="1.0" max="5.0" step="0.1"/>'),_m=P("<!> <p> </p> <u> </u> <!> <u> </u> <!> <label><!></label> <i> </i>",1),pm=P("<!> <!> <!> <!>",1),hm=P("<!> <!> <!> <!> <!>",1);function mm(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",i),o=()=>ye(Ia,"$routePtA",i),a=()=>ye(Ta,"$routePtB",i),s=()=>ye(Ss,"$mainRoadPenalty",i),l=()=>ye(yt,"$mode",i),[i,f]=lt(),v=u(()=>ut(ct("main")));let b=e.prevMode=="neighbourhood"?t().renderNeighbourhood():null,m=u(()=>t().compareRoute(o(),a(),s())),C=u(()=>r(m).features.find(T=>T.properties.kind=="before")),j=u(()=>r(m).features.find(T=>T.properties.kind=="after"));gn(()=>{setTimeout(()=>{Ni(Ia),Ni(Ta)},10)}),Mr(n,{top:A=>{var x=sm(),L=c(x),D=c(L),R=c(D);et(R,{mode:{mode:"title"}});var O=h(D,2),z=c(O);et(z,{mode:{mode:"pick-neighbourhood"}});var d=h(O,2);{var g=w=>{var y=im(),F=c(y);et(F,{mode:{mode:"neighbourhood"}}),_(w,y)};ve(d,w=>{e.prevMode=="neighbourhood"&&w(g)})}var p=h(d,2),$=c(p);Z(w=>U($,w),[()=>wr(l().mode)]),_(A,x)},left:A=>{var x=_m(),L=V(x);{let G=u(()=>({mode:e.prevMode}));_n(L,{get mode(){return r(G)}})}var D=h(L,2),R=c(D),O=h(D,2);gr(O,"",{},{color:"red"});var z=c(O),d=h(O,2);{var g=G=>{var Q=lm(),q=c(Q);Z((X,ue)=>U(q,`${X??""}, ${ue??""}`),[()=>Ga(r(C).properties.distance),()=>Wa(r(C).properties.time)]),_(G,Q)},p=G=>{var Q=cm();{const X=(ue,te=Pe)=>{var ne=um(),oe=c(ne);Z(H=>U(oe,H),[()=>r(v).tx(te())]),_(ue,ne)};var q=c(Q);{let ue=u(()=>[X]),te=u(()=>r(v).cx(75));pe(q,{get t(){return r(ue)},get x(){return r(te)}})}}_(G,Q)};ve(d,G=>{r(C)?G(g):G(p,!1)})}var $=h(d,2);gr($,"",{},{color:"blue"});var w=c($),y=h($,2);{var F=G=>{var Q=dm(),q=c(Q);Z((X,ue)=>U(q,`${X??""}, ${ue??""}`),[()=>Ga(r(j).properties.distance),()=>Wa(r(j).properties.time)]),_(G,Q)},k=G=>{var Q=vm();{const X=(ue,te=Pe)=>{var ne=fm(),oe=c(ne);Z(H=>U(oe,H),[()=>r(v).tx(te())]),_(ue,ne)};var q=c(Q);{let ue=u(()=>[X]),te=u(()=>r(v).cx(75));pe(q,{get t(){return r(ue)},get x(){return r(te)}})}}_(G,Q)};ve(y,G=>{r(j)?G(F):G(k,!1)})}var N=h(y,2);{const G=Q=>{var q=gm();aa(q,s,X=>Qe(Ss,X)),_(Q,q)};var S=c(N);{let Q=u(()=>[G]),q=u(()=>r(v).cx(94)),X=u(()=>[s()]);pe(S,{get t(){return r(Q)},get x(){return r(q)},get a(){return r(X)}})}}var E=h(N,2),B=c(E);Z((G,Q,q,X)=>{U(R,G),U(z,Q),U(w,q),U(B,X)},[()=>r(v).t(93),()=>r(v).t(74),()=>r(v).t(77),()=>r(v).t(95)]),_(A,x)},main:A=>{var x=hm(),L=V(x);{var D=g=>{it(g,{get data(){return b},generateId:!0,children:(p,$)=>{var w=pm(),y=V(w);li(y,{});var F=h(y,2);ya(F,{});var k=h(F,2);wa(k,{});var N=h(k,2);Aa(N,{interactive:!1,get maxShortcuts(){return b.maxShortcuts}}),_(p,w)},$$slots:{default:!0}})};ve(L,g=>{e.prevMode=="neighbourhood"&&g(D)})}var R=h(L,2);Cn(R,{interactive:!1});var O=h(R,2);it(O,{get data(){return r(m)},children:(g,p)=>{{let $=u(()=>Ge("compare-route")),w=u(()=>({"line-width":10,"line-color":$n(["get","kind"],{before:"red",after:"blue"},"red")}));gt(g,Ie(()=>r($),{get paint(){return r(w)}}))}},$$slots:{default:!0}});var z=h(O,2);no(z,{draggable:!0,get lngLat(){return sa(),o()},set lngLat(g){Qe(Ia,g)},children:(g,p)=>{var $=Ut();Z(w=>U($,w),[()=>r(v).t(71)]),_(g,$)},$$slots:{default:!0}});var d=h(z,2);no(d,{draggable:!0,get lngLat(){return sa(),a()},set lngLat(g){Qe(Ta,g)},children:(g,p)=>{var $=Ut();Z(w=>U($,w),[()=>r(v).t(72)]),_(g,$)},$$slots:{default:!0}}),_(A,x)},$$slots:{top:!0,left:!0,main:!0}}),Be(),f()}function bm(n,e,t,o,a,s){if(r(e))try{t().setCurrentNeighbourhoodBoundary(o.name,r(e)),la(),Qe(yt,{mode:"neighbourhood"})}catch(l){window.alert(`Sorry, this boundary is invalid: ${l}`),s()}}var ym=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),Am=P('<!> <h1> </h1> <!> <div style="display: flex; gap: 16px;"><button> </button> <button class="secondary"> </button></div>',1);function wm(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",s),o=()=>ye(yt,"$mode",s),a=()=>ye(rn,"$map",s),[s,l]=lt(),i=u(()=>ut(ct("main")));let f=we(ht([])),v=we(void 0),b=e.existing.properties.waypoints;if(!b){let C={type:"LineString",coordinates:e.existing.geometry.coordinates[1]};b=t().extractWaypointsFromRing(C)}K(f,b.map(C=>({point:[C.lon,C.lat],snapped:C.snapped})),!0);function m(){Qe(yt,{mode:"neighbourhood"})}Mr(n,{top:T=>{var M=ym(),I=c(M),A=c(I),x=c(A);et(x,{mode:{mode:"title"}});var L=h(A,2),D=c(L);et(D,{mode:{mode:"pick-neighbourhood"}});var R=h(L,2),O=c(R);et(O,{mode:{mode:"neighbourhood"}});var z=h(R,2),d=c(z);Z(g=>U(d,g),[()=>wr(o().mode)]),_(T,M)},left:T=>{var M=Am(),I=V(M);_n(I,{mode:{mode:"neighbourhood"}});var A=h(I,2),x=c(A),L=h(A,2);xu(L,{get map(){return a()},get waypoints(){return r(f)},set waypoints(g){K(f,g,!0)},get drawnShapeOut(){return r(v)},set drawnShapeOut(g){K(v,g,!0)}});var D=h(L,2),R=c(D);R.__click=[bm,v,t,e,o,m];var O=c(R),z=h(R,2);z.__click=m;var d=c(z);Z((g,p,$)=>{U(x,g),R.disabled=r(f).length<3,U(O,p),U(d,$)},[()=>r(i).t(96),()=>r(i).t(97),()=>r(i).t(98)]),_(T,M)},$$slots:{top:!0,left:!0}}),Be(),l()}rr(["click"]);function xm(n,e){var t,o,a,s,l,i,f,v,b,m,C=0,j=n.type==="FeatureCollection",T=n.type==="Feature",M=j?n.features.length:1;for(t=0;t<M;t++){for(i=j?n.features[t].geometry:T?n.geometry:n,v=j?n.features[t].properties:T?n.properties:{},b=j?n.features[t].bbox:T?n.bbox:void 0,m=j?n.features[t].id:T?n.id:void 0,f=i?i.type==="GeometryCollection":!1,l=f?i.geometries.length:1,a=0;a<l;a++){if(s=f?i.geometries[a]:i,s===null){if(e(null,C,v,b,m)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,C,v,b,m)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(e(s.geometries[o],C,v,b,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}C++}}function $m(n,e){xm(n,function(t,o,a,s,l){var i=t===null?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return e(Di(t,a,{bbox:s,id:l}),o,0)===!1?!1:void 0}var f;switch(i){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var v=0;v<t.coordinates.length;v++){var b=t.coordinates[v],m={type:f,coordinates:b};if(e(Di(m,a),o,v)===!1)return!1}})}var km=Object.defineProperty,Sm=Object.defineProperties,Em=Object.getOwnPropertyDescriptors,hl=Object.getOwnPropertySymbols,Lm=Object.prototype.hasOwnProperty,Cm=Object.prototype.propertyIsEnumerable,ml=(n,e,t)=>e in n?km(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,bl=(n,e)=>{for(var t in e||(e={}))Lm.call(e,t)&&ml(n,t,e[t]);if(hl)for(var t of hl(e))Cm.call(e,t)&&ml(n,t,e[t]);return n},yl=(n,e)=>Sm(n,Em(e));function Mm(n,e,t={}){if(!n||!e)throw new Error("lines and pt are required arguments");const o=wn(e);let a=eo([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),s=0;return $m(n,function(l,i,f){const v=fh(l);for(let b=0;b<v.length-1;b++){const m=eo(v[b]);m.properties.dist=yn(e,m,t);const C=wn(m),j=eo(v[b+1]);j.properties.dist=yn(e,j,t);const T=wn(j),M=yn(m,j,t);let I,A;C[0]===o[0]&&C[1]===o[1]?[I,,A]=[C,void 0,!1]:T[0]===o[0]&&T[1]===o[1]?[I,,A]=[T,void 0,!0]:[I,,A]=Tm(m.geometry.coordinates,j.geometry.coordinates,wn(e));let x;I&&(x=eo(I,{dist:yn(e,I,t),multiFeatureIndex:f,location:s+yn(m,I,t)})),x&&x.properties.dist<a.properties.dist&&(a=yl(bl({},x),{properties:yl(bl({},x.properties),{index:A?b+1:b})})),s+=M}}),a}function Pm(n,e){const[t,o,a]=n,[s,l,i]=e;return t*s+o*l+a*i}function Im(n,e){const[t,o,a]=n,[s,l,i]=e;return[o*i-a*l,a*s-t*i,t*l-o*s]}function Al(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2))}function Vn(n,e){const t=Pm(n,e)/(Al(n)*Al(e));return Math.acos(Math.min(Math.max(t,-1),1))}function ki(n){const e=Nr(n[1]),t=Nr(n[0]);return[Math.cos(e)*Math.cos(t),Math.cos(e)*Math.sin(t),Math.sin(e)]}function Kn(n){const[e,t,o]=n,a=ca(Math.asin(o));return[ca(Math.atan2(t,e)),a]}function Tm(n,e,t){const o=ki(n),a=ki(e),s=ki(t),[l,i,f]=s,[v,b,m]=Im(o,a),C=b*f-m*i,j=m*l-v*f,T=v*i-b*l,M=T*b-j*m,I=C*m-T*v,A=j*v-C*b,x=1/Math.sqrt(Math.pow(M,2)+Math.pow(I,2)+Math.pow(A,2)),L=[M*x,I*x,A*x],D=[-1*M*x,-1*I*x,-1*A*x],R=Vn(o,a),O=Vn(o,L),z=Vn(a,L),d=Vn(o,D),g=Vn(a,D);let p;return O<d&&O<g||z<d&&z<g?p=L:p=D,Vn(o,p)>R||Vn(a,p)>R?yn(Kn(p),Kn(o))<=yn(Kn(p),Kn(a))?[Kn(o),!0,!1]:[Kn(a),!1,!0]:[Kn(p),!1,!1]}var Rm=Mm;const Nm=["==",["geometry-type"],"Polygon"],Bm=["==",["geometry-type"],"LineString"],Fm=["==",["geometry-type"],"Point"];function Cu(){return{type:"FeatureCollection",features:[]}}function Si(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:Mu(n)}}}function Mu(n){return[Math.round(n[0]*1e7)/1e7,Math.round(n[1]*1e7)/1e7]}const Pu=Rn(Cu()),Iu=Rn(0),Om=100;class jm{map;active;eventListenersSuccess;eventListenersUpdated;eventListenersFailure;points;cursor;hover;dragFrom;previousStates;constructor(e){this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}onMouseMove=e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,o=this.dragFrom[1]-e.lngLat.lat;for(let a of this.points)a[0]-=t,a[1]-=o}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}};onClick=e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(wl(this.points).forEach((o,a)=>{t.push([a+1,Rm(o,this.cursor).properties.dist])}),t.sort((o,a)=>o[1]-a[1]),t.length>0){let o=t[0][0];this.points.splice(o,0,this.cursor.geometry.coordinates),this.hover=o}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))};onDoubleClick=e=>{this.active&&(e.preventDefault(),this.cursor=Si(e.lngLat.toArray()),this.onClick(e),this.finish())};onMouseDown=e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())};onMouseUp=()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())};onKeypress=e=>{if(!this.active)return;let t=e.target.tagName;t=="INPUT"||t=="TEXTAREA"||(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())};onKeyDown=e=>{if(!this.active)return;let t=e.target.tagName;t=="INPUT"||t=="TEXTAREA"||e.key=="Escape"&&(e.stopPropagation(),this.cancel())};addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e=Cu();this.points.forEach((a,s)=>{let l=Si(a);l.properties.hover=this.hover==s,l.properties.idx=s,e.features.push(l)}),e.features=e.features.concat(wl(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),Pu.set(e);let o="crosshair";this.hover!=null&&(o=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=o,Iu.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=Si(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(Mu),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>Om&&this.previousStates.shift()}}function wl(n){let e=[];for(let t=0;t<n.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[t],n[t+1]]},properties:{}});return n.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[n.length-1],n[0]]},properties:{}}),e}var zm=(n,e)=>e.polygonTool.finish(),Dm=(n,e)=>e.polygonTool.cancel(),Um=(n,e)=>e.polygonTool.undo(),Gm=P('<div style="display: flex; justify-content: space-between;"><button>Finish</button> <button>Cancel</button> <button><!></button></div> <ul><li><b>Click</b> the map to add a vertex</li> <li><b>Click</b> a vertex to delete it</li> <li><b>Drag</b> a vertex or the polygon to move it</li> <li>Press <b>Control+Z</b> to undo your last change</li> <li>Press <b>Enter</b> or <b>double click</b> to finish</li> <li>Press <b>Escape</b> to cancel</li></ul>',1);function Wm(n,e){Ne(e,!0);const t=()=>ye(Iu,"$undoLength",o),[o,a]=lt();var s=Gm(),l=V(s),i=c(l);i.__click=[zm,e];var f=h(i,2);f.__click=[Dm,e];var v=h(f,2);v.__click=[Um,e];var b=c(v);{var m=j=>{var T=Ut("Undo");_(j,T)},C=j=>{var T=Ut();Z(()=>U(T,`Undo (${t()??""})`)),_(j,T)};ve(b,j=>{t()==0?j(m):j(C,!1)})}Z(()=>v.disabled=t()==0),_(n,s),Be(),a()}rr(["click"]);var Hm=P("<!> <!> <!>",1);function qm(n){const e=()=>ye(Pu,"$polygonToolGj",t),[t,o]=lt();it(n,{get data(){return e()},children:(a,s)=>{var l=Hm(),i=V(l);cr(i,{id:"edit-polygon-fill",get filter(){return Nm},paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}});var f=h(i,2);gt(f,{id:"edit-polygon-lines",get filter(){return Bm},paint:{"line-color":"black","line-width":8,"line-opacity":.5}});var v=h(f,2);Nn(v,{id:"edit-polygon-vertices",get filter(){return Fm},paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}),_(a,l)},$$slots:{default:!0}}),o()}async function Jm(n,e,t,o){if(e.map){if(e.map.getZoom()<13){e.onerror?.("Zoom in more to import");return}await t(o())}}function Qm(n,e,t,o){e.map&&(K(t,new jm(e.map),!0),r(t).startNew(),r(t).addEventListenerSuccess(async a=>{K(t,null),await o(a)}),r(t).addEventListenerFailure(()=>{K(t,null)}))}var Zm=P('<button class="btn btn-primary" type="button">Import current view</button> <p class="fst-italic my-3">or...</p> <button class="btn btn-primary" type="button">Draw an area to import on the map</button>',1),Vm=P("<!> <!>",1);function Km(n,e){Ne(e,!0);let t=we(null),o=we(!1);async function a(C){try{e.onloading?.("Loading from Overpass");let T=await(await fetch(Tu(C))).text();r(o)&&as("osm.xml",T),e.gotXml?.(T,C)}catch(j){e.onerror?.(j.toString())}}function s(C){return[C.lng,C.lat]}function l(){let C=e.map.getBounds();return{type:"Feature",properties:{},geometry:{coordinates:[[s(C.getSouthWest()),s(C.getNorthWest()),s(C.getNorthEast()),s(C.getSouthEast()),s(C.getSouthWest())]],type:"Polygon"}}}var i=Vm(),f=V(i);{var v=C=>{Wm(C,{get polygonTool(){return r(t)}})},b=C=>{var j=Zm(),T=V(j);T.__click=[Jm,e,a,l];var M=h(T,4);M.__click=[Qm,e,t,a],_(C,j)};ve(f,C=>{r(t)?C(v):C(b,!1)})}var m=h(f,2);kd(m,{get checked(){return r(o)},set checked(C){K(o,C,!0)},children:(C,j)=>{var T=Ut("Save a copy of the osm.xml after importing");_(C,T)},$$slots:{default:!0}}),_(n,i),Be()}rr(["click"]);function Tu(n){let e='poly:"';if(n.geometry.type=="Polygon")for(let[o,a]of n.geometry.coordinates[0])e+=`${a} ${o} `;else if(n.geometry.type=="MultiPolygon")for(let[o,a]of n.geometry.coordinates[0][0])e+=`${a} ${o} `;else throw new Error("overpassQueryForPolygon needs a Polygon or MultiPolygon");return e=e.slice(0,-1)+'"',`https://overpass-api.de/api/interpreter?data=${`(nwr(${e}); node(w)->.x; <;); out meta;`}`}class Ru{inner;constructor(e,t,o,a,s,l,i){this.inner=new Ki(e||new Uint8Array,t||new Uint8Array,o,a,s,l,i)}getInvertedBoundary(){return JSON.parse(this.inner.getInvertedBoundary())}getBounds(){return Array.from(this.inner.getBounds())}toRouteSnapper(){return this.inner.toRouteSnapper()}toRouteSnapperGj(){return this.inner.toRouteSnapperGj()}renderModalFilters(){return JSON.parse(this.inner.renderModalFilters())}renderModalFiltersBeforeEdits(){return JSON.parse(this.inner.renderModalFiltersBeforeEdits())}renderTurnRestrictions(){return JSON.parse(this.inner.renderTurnRestrictions())}renderTurnRestrictionsBeforeEdits(){return JSON.parse(this.inner.renderTurnRestrictionsBeforeEdits())}renderNeighbourhood(){let e=JSON.parse(this.inner.renderNeighbourhood());return e.maxShortcuts=Math.max(...e.features.map(t=>t.properties.kind=="interior_road"?t.properties.shortcuts:0))??0,e}renderNeighbourhoodBeforeEdits(){let e=JSON.parse(this.inner.renderNeighbourhoodBeforeEdits());return e.maxShortcuts=Math.max(...e.features.map(t=>t.properties.kind=="interior_road"?t.properties.shortcuts:0))??0,e}generatedBoundaries(){return JSON.parse(this.inner.generatedBoundaries())}generateMergedBoundary(e){let t=this.inner.generateMergedBoundary(e);return JSON.parse(t)}setCurrentNeighbourhoodBoundary(e,t){this.inner.setCurrentNeighbourhoodBoundary(e,t)}extractWaypointsFromRing(e){let t=this.inner.extractWaypointsFromRing(e);return JSON.parse(t)}deleteNeighbourhoodBoundary(e){this.inner.deleteNeighbourhoodBoundary(e)}renameNeighbourhoodBoundary(e,t){this.inner.renameNeighbourhoodBoundary(e,t)}setCurrentNeighbourhood(e){this.inner.setCurrentNeighbourhood(e)}addModalFilter(e,t){this.inner.addModalFilter(e,t)}addManyModalFilters(e,t){this.inner.addManyModalFilters(e,t)}deleteModalFilter(e){this.inner.deleteModalFilter(e)}addDiagonalFilter(e){this.inner.addDiagonalFilter(e.intersectionId)}rotateDiagonalFilter(e){this.inner.rotateDiagonalFilter(e.intersectionId)}deleteDiagonalFilter(e){this.inner.deleteDiagonalFilter(e.intersectionId)}toggleTravelFlow(e){this.inner.toggleTravelFlow(e)}toggleMainRoad(e){this.inner.toggleMainRoad(e)}setMainRoads(e,t){this.inner.setMainRoads(new Uint32Array(e),t)}addTurnRestriction(e,t){this.inner.addTurnRestriction(e,t)}deleteTurnRestriction(e,t,o){this.inner.deleteTurnRestriction(e,t,o)}getTurnRestrictionTargets(e){return JSON.parse(this.inner.getTurnRestrictionTargets(e))}undo(){this.inner.undo()}redo(){this.inner.redo()}getShortcutsCrossingRoad(e){return JSON.parse(this.inner.getShortcutsCrossingRoad(e))}getAllShortcuts(){return JSON.parse(this.inner.getAllShortcuts())}getAllShortcutsBeforeEdits(){return JSON.parse(this.inner.getAllShortcutsBeforeEdits())}toSavefile(){return JSON.parse(this.inner.toSavefile())}loadSavefile(e){this.inner.loadSavefile(e)}changeProjectName(e){this.inner.changeProjectName(e)}compareRoute(e,t,o){return JSON.parse(this.inner.compareRoute(e.lng,e.lat,t.lng,t.lat,o))}impactToOneDestination(e){return JSON.parse(this.inner.impactToOneDestination(e.lng,e.lat))}predictImpact(e){return JSON.parse(this.inner.predictImpact(e))}getImpactsOnRoad(e,t){return JSON.parse(this.inner.getImpactsOnRoad(e,t)).map(o=>{let[a,s,l]=o;return{count:a,before:s,after:l}})}getAllIntersections(){return JSON.parse(this.inner.getAllIntersections())}getMovements(e){return JSON.parse(this.inner.getMovements(e))}getDemandModel(){let e=JSON.parse(this.inner.getDemandModel());for(let t of e.features)t.properties.sum_from=Es(t.properties.counts_from),t.properties.sum_to=Es(t.properties.counts_to);return e}getPOIs(){return JSON.parse(this.inner.getPOIs())}getMetricBuckets(){try{return JSON.parse(this.inner.getMetricBuckets())}catch{return null}}eraseAllMainRoads(){this.inner.eraseAllMainRoads()}getOsmTimestamp(){let e=this.inner.getOsmTimestamp();return e?new Date(1e3*Number(e)):null}setHideUnimportantCells(e){this.inner.setHideUnimportantCells(e)}}let mo=Rn(""),bo=Rn(null);async function ui(n){let e=Yr(Ao).project(n);try{console.time("get input files");let{osmBuffer:t,boundary:o,mapModelBuffer:a}=await Xm(e);console.timeEnd("get input files"),mo.set("Download finished, setting up project"),bo.set(100),await ni(),console.time("load"),Rt.set(new Ru(a?new Uint8Array(a):void 0,t?new Uint8Array(t):void 0,o,e.app_focus,e.study_area_name,e.project_name,e.db_schema_version)),Yr(Rt).loadSavefile(e),xn.set(n),console.timeEnd("load"),Nu(n)}catch(t){window.alert(`Couldn't open project: ${t}`),xn.set(void 0)}mo.set(""),bo.set(null)}async function Xm(n){if(n.app_focus=="cnt")return{mapModelBuffer:await Ei(en(`cnt/maps_v4/${n.study_area_name}.bin.gz`))};if(n.app_focus=="england")return{mapModelBuffer:await Ei(en(`england/maps_v4/${n.study_area_name}.bin.gz`))};if(n.study_area_name){let e=await Ei(en(`severance_pbfs/v2/${n.study_area_name}.osm.pbf`)),o=await(await Bi(en(`boundaries/${n.study_area_name}.geojson`))).json();return{osmBuffer:e,boundary:o}}else{mo.set("Grabbing OSM data from Overpass"),bo.set(100);let e=n.features.find(a=>a.properties.kind=="study_area_boundary");return{osmBuffer:await(await Bi(Tu(e))).arrayBuffer(),boundary:e}}}async function Ei(n){return console.log(`Grabbing ${n}`),mo.set(`Downloading ${n}`),await Mc(n,e=>bo.set(e))}function Nu(n){si.set(new Dd(Yr(rn),Yr(Rt).toRouteSnapper(),Rn(or()),Rn(!0),Rn(0))),Yr(rn).fitBounds(Yr(Rt).getBounds(),{duration:500});let e=Yr(Rt).getMetricBuckets();e&&yo.set(e);let t=new URL(window.location.href);t.searchParams.set("project",n),window.history.replaceState(null,"",t.toString())}var Ym=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li> </li></ul></nav>'),e2=P('<input type="text"/>'),t2=(n,e)=>e(),r2=P("<option> </option>"),n2=P("<optgroup></optgroup>"),o2=P("<select><option></option><!></select>"),a2=P("<label><!></label> <i> </i> <div><!></div>",1),i2=P("<div><label><!></label></div> <!>",1),s2=P("<!> <!> <!>",1);function l2(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",v),o=()=>ye(nn,"$appFocus",v),a=()=>ye(Ao,"$projectStorage",v),s=()=>ye(yt,"$mode",v),l=()=>ye(mo,"$loadingMessage",v),i=()=>ye(bo,"$loadingProgress",v),f=()=>ye(rn,"$map",v),[v,b]=lt(),m=u(()=>ut(ct("main")));let C=we(""),j=we(null),T=we(ht([])),M=we("");gn(async()=>{let d=await Bi(en("severance_pbfs/areas.json"));K(T,await d.json(),!0)});async function I(d,g){K(M,r(m).t(160),!0);try{let p;Qe(Rt,new Ru(void 0,new TextEncoder().encode(d),g,o(),p,r(C),a().dbSchemaVersion));const $=a().createProject(t().toSavefile());Qe(xn,$),Nu($),Qe(yt,{mode:"add-neighbourhood"})}catch(p){window.alert(`Couldn't import from Overpass: ${p}`)}K(M,"")}async function A(){if(!r(j))return;let d;try{d=a().createEmptyProject(r(C),r(j))}catch(g){K(j,null),window.alert(`Couldn't create project: ${g}`);return}await ui(d),Qe(yt,{mode:"add-neighbourhood"})}var x={loadExample:A},L=s2(),D=V(L);ho(D,{get loading(){return r(M)},progress:100});var R=h(D,2);ho(R,{get loading(){return l()},get progress(){return i()}});var O=h(R,2);Mr(O,{top:$=>{var w=Ym(),y=c(w),F=c(y),k=c(F);et(k,{mode:{mode:"title"}});var N=h(F,2),S=c(N);Z(E=>U(S,E),[()=>wr(s().mode)]),_($,w)},left:$=>{var w=i2(),y=V(w),F=c(y);{const E=B=>{var G=e2();aa(G,()=>r(C),Q=>K(C,Q)),_(B,G)};var k=c(F);{let B=u(()=>[E]),G=u(()=>r(m).cx(161));pe(k,{get t(){return r(B)},get x(){return r(G)}})}}var N=h(y,2);{var S=E=>{var B=a2(),G=V(B);{const ne=oe=>{var H=o2();H.__change=[t2,A];var J=c(H);J.value=J.__value="";var ee=h(J);Zt(ee,17,()=>r(T),Vt,(re,ae)=>{var Y=u(()=>qr(r(ae),2));let ie=()=>r(Y)[0],_e=()=>r(Y)[1];var le=n2();Zt(le,21,_e,Vt,(fe,se)=>{var Ae=u(()=>qr(r(se),2));let me=()=>r(Ae)[0],ke=()=>r(Ae)[1];var Se=r2(),We=c(Se),xe={};Z(()=>{U(We,ke()),xe!==(xe=me())&&(Se.value=(Se.__value=me())??"")}),_(fe,Se)}),Z(()=>ze(le,"label",ie())),_(re,le)}),An(H,()=>r(j),re=>K(j,re)),_(oe,H)};var Q=c(G);{let oe=u(()=>[ne]),H=u(()=>r(m).cx(162));pe(Q,{get t(){return r(oe)},get x(){return r(H)}})}}var q=h(G,2),X=c(q),ue=h(q,2),te=c(ue);Km(te,{get map(){return f()},gotXml:I,onloading:ne=>K(M,ne,!0),onerror:ne=>window.alert(ne)}),Z(ne=>U(X,ne),[()=>r(m).t(163)]),_(E,B)};ve(N,E=>{r(C)&&E(S)})}_($,w)},main:$=>{qm($)},$$slots:{top:!0,left:!0,main:!0}}),_(n,L);var z=Be(x);return b(),z}rr(["change"]);const u2="/ltn/assets/boundaries-BnmDCWUr.geojson",c2="/ltn/assets/boundaries-Ddt_iXWy.geojson";var d2=()=>window.location.href=".",f2=()=>window.location.href="cnt.html",v2=()=>window.location.href="england.html",g2=P('<a href="mailto:dabreegster@gmail.com"> </a>'),_2=P("<p><!></p>"),p2=P('<span style="display: flex; flex-direction: row; height: 80%; gap: 4px"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><span class="fi fi-gb-sct"></span></button> <button class="outline icon-btn"><span class="fi fi-gb-eng"></span></button> <!></span>');function h2(n,e){Ne(e,!0);const t=()=>ye(nn,"$appFocus",o),[o,a]=lt(),s=u(()=>ut(ct("main")));gn(Fl);var l=p2(),i=c(l);i.__click=[d2];var f=c(i);Yc(f,{color:"black"});var v=h(i,2);v.__click=[f2];var b=h(v,2);b.__click=[v2];var m=h(b,2);qo(m,{children:(C,j)=>{var T=_2();{const I=(A,x=Pe)=>{var L=g2(),D=c(L);Z(R=>U(D,R),[()=>r(s).tx(x())]),_(A,L)};var M=c(T);{let A=u(()=>[I]),x=u(()=>r(s).cx(153));pe(M,{get t(){return r(A)},get x(){return r(x)}})}}_(C,T)},$$slots:{default:!0}}),Z((C,j,T,M,I)=>{ze(i,"data-tippy-content",C),i.disabled=t()=="global",ze(v,"data-tippy-content",j),ze(v,"aria-label",T),v.disabled=t()=="cnt",ze(b,"data-tippy-content",M),ze(b,"aria-label",I),b.disabled=t()=="england"},[()=>r(s).t(150),()=>r(s).t(151),()=>r(s).t(151),()=>r(s).t(152),()=>r(s).t(152)]),_(n,l),Be(),a()}rr(["click"]);function m2(n,e,t,o){r(e)&&t(r(o).t(154,[r(e)]))}var b2=P("<option> </option>"),y2=P("<p><!></p>"),A2=P("<!> <!>",1),w2=P('<p> </p> <select style="width: 90%"><option></option><!></select> <!>',1);function xl(n,e){Ne(e,!0);const t=()=>ye(Ao,"$projectStorage",o),[o,a]=lt(),s=u(()=>ut(ct("main")));let l=we(ht({type:"FeatureCollection",features:[]})),i=we(ht([])),f=we("");gn(async()=>{let x=await fetch(e.boundariesUrl);K(l,await x.json(),!0);for(let L of r(l).features)r(i).push(L.properties.name);r(i).sort(),K(i,r(i),!0)});function v(x){let L=x.features[0].properties;b(`${L.kind}_${L.name}`)}async function b(x){let L,D=!1;for(;!D;){let R=L||t().nextAvailableProjectName(Fi(x));if(L=window.prompt(`Please pick a project name to create in ${Fi(x)}`,R),L===null)return;if(L=L.trim(),L===""){window.alert("Project name cannot be blank; Please pick a name or cancel.");continue}try{let O=t().createEmptyProject(L,x);await ui(O),Qe(yt,{mode:"add-neighbourhood"}),D=!0}catch(O){window.alert(O)}}}var m=w2(),C=V(m),j=c(C),T=h(C,2);T.__change=[m2,f,b,s];var M=c(T);M.value=M.__value="";var I=h(M);Zt(I,17,()=>r(i),Vt,(x,L)=>{var D=b2(),R=c(D),O={};Z(()=>{U(R,r(L)),O!==(O=r(L))&&(D.value=(D.__value=r(L))??"")}),_(x,D)});var A=h(T,2);it(A,{get data(){return r(l)},generateId:!0,children:(x,L)=>{var D=A2(),R=V(D);{let z=u(()=>({"fill-color":Jr.mapFeature.hover.backgroundColor,"fill-outline-color":Jr.mapFeature.hover.backgroundColor,"fill-opacity":bt(0,.5)})),d=u(()=>r(s).t(156));cr(R,{get paint(){return r(z)},get beforeId(){return r(d)},manageHoverState:!0,hoverCursor:"pointer",onclick:v,children:(g,p)=>{Bt(g,{openOn:"hover",children:(w,y)=>{let F=()=>y?.().data;var k=y2(),N=c(k);{let S=u(()=>r(s).cx(157)),E=u(()=>[F().properties.name]);pe(N,{get x(){return r(S)},get a(){return r(E)}})}_(w,k)},$$slots:{default:!0}})},$$slots:{default:!0}})}var O=h(R,2);{let z=u(()=>({"line-color":Jr.mapFeature.hover.backgroundColor,"line-width":2.5})),d=u(()=>r(s).t(156));gt(O,{get paint(){return r(z)},get beforeId(){return r(d)},manageHoverState:!1})}_(x,D)},$$slots:{default:!0}}),Z(x=>U(j,x),[()=>r(s).t(155)]),An(T,()=>r(f),x=>K(f,x)),_(n,m),Be(),a()}rr(["change"]);var x2=P('<label style="margin-top: 16px;"><strong> </strong> <input type="file"/></label>');function $2(n,e){Ne(e,!0);const[t,o]=lt(),a=u(()=>ut(ct("main")));let s=we(void 0);async function l(m){let C=r(s).files[0].name,j=await r(s).files[0].text(),T=JSON.parse(j),M,I,A;T.app_focus&&(console.assert(T.app_focus=="global"||T.app_focus=="cnt"||T.app_focus=="england"),M=T.app_focus),T.study_area_name&&(I=T.study_area_name),T.project_name&&(A=T.project_name),(!T.app_focus||!T.project_name)&&(T.study_area_name&&T.study_area_name.startsWith(r(a).t(158))?(M="cnt",A=Ls(Cs(C,`ltn_cnt_${T.study_area_name}_`),".geojson")):(M="global",A=Ls(Cs(C,"ltn_"),".geojson"))),A=A,M=M;let x=Pc.projectStorage(M);A=x.nextAvailableProjectName(A),T.project_name=A,T.app_focus=M,T.study_area_name=I;let L=x.createProject(T);await ui(L),Qe(yt,{mode:"pick-neighbourhood"})}var i=x2(),f=c(i),v=c(f),b=h(f,2);b.__change=l,vn(b,m=>K(s,m),()=>r(s)),Z(m=>U(v,m),[()=>r(a).t(159)]),_(n,i),Be(),o()}rr(["change"]);var k2=P('<nav aria-label="breadcrumb"><ul><li class="svelte-eliuer"> </li></ul></nav>'),S2=P("<h1> </h1>"),E2=P('<div style="display: flex; justify-content: space-between; align-items: center"><h1> </h1> <!></div>'),L2=(n,e)=>Ol(e()),C2=(n,e,t,o)=>e(t(),o()),M2=(n,e,t,o)=>e(t(),o()),P2=(n,e,t,o)=>e(t(),o()),I2=P('<li class="actionable-cell svelte-eliuer"><h3 class="project-name svelte-eliuer"><!></h3> <span class="actions"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button> <button class="icon-btn destructive"><!></button></span></li>'),T2=P('<h3 class="study-area-name svelte-eliuer"> </h3> <ul class="navigable-list"></ul>',1),R2=P('<h2> </h2> <div class="project-list svelte-eliuer"></div>',1),N2=(n,e)=>Qe(yt,{mode:"new-project"}),B2=P("<button> </button>"),F2=P('<!> <a target="_blank"> </a> <!> <!> <h2> </h2> <!> <!>',1),O2=P("<p> </p>"),j2=P("<!> <!>",1);function z2(n,e){Ne(e,!0);const t=()=>ye(Ms,"$firstTimeLoadProjectFromURL",v),o=()=>ye(rn,"$map",v),a=()=>ye(nn,"$appFocus",v),s=()=>ye(Ao,"$projectStorage",v),l=()=>ye(yt,"$mode",v),i=()=>ye(mo,"$loadingMessage",v),f=()=>ye(bo,"$loadingProgress",v),[v,b]=lt(),m=u(()=>ut(ct("main")));Qe(Rt,null),Qe(si,null),Qe(xn,void 0),Je(()=>{e.wasmReady&&Ic(()=>{if(t()){let O=new URLSearchParams(window.location.search).get("project");O&&j(O),Qe(Ms,!1)}else{let R=new URL(window.location.href);R.searchParams.delete("project"),window.history.replaceState(null,"",R.toString())}if(o()&&!t()){let R=[-180,-90,180,90];a()=="cnt"?R=[-8.943,54.631,-.901,59.489]:a()=="england"&&(R=[-5.96,49.89,2.31,55.94]),o().fitBounds(R,{duration:500})}})});let C=we(ht(s().studyAreaProjects()));function j(R){let O=R;try{A(O)}catch{console.error(`Error trying to fetch project from URL: ${O}`)}}function T(R,O){window.confirm(r(m).t(164,[O]))&&(s().removeProject(R),K(C,s().studyAreaProjects(),!0))}function M(R,O){let z=window.prompt(r(m).t(165,[O]),O);if(z){try{s().renameProject(R,z)}catch(d){window.alert(`Couldn't rename project: ${d}`)}K(C,s().studyAreaProjects(),!0)}}function I(R,O){let z=window.prompt(r(m).t(127,[O]),s().nextAvailableProjectName(O));if(z){try{s().copyProject(R,z)}catch(d){window.alert(`Couldn't copy project: ${d}`)}K(C,s().studyAreaProjects(),!0)}}async function A(R){await ui(R),Qe(yt,{mode:"pick-neighbourhood"})}var x=j2(),L=V(x);ho(L,{get loading(){return i()},get progress(){return f()}});var D=h(L,2);Mr(D,{top:z=>{var d=k2(),g=c(d),p=c(g),$=c(p);Z(w=>U($,w),[()=>wr(l().mode)]),_(z,d)},left:z=>{var d=$e(),g=V(d);{var p=w=>{var y=F2(),F=V(y);{var k=H=>{var J=S2(),ee=c(J);Z(re=>U(ee,re),[()=>r(m).t(44)]),_(H,J)},N=H=>{var J=E2(),ee=c(J),re=c(ee),ae=h(ee,2);h2(ae,{}),Z(Y=>U(re,Y),[()=>r(m).t(166)]),_(H,J)};ve(F,H=>{a()=="cnt"?H(k):H(N,!1)})}var S=h(F,2),E=c(S),B=h(S,2);Il(B,{});var G=h(B,2);{var Q=H=>{var J=R2(),ee=V(J),re=c(ee),ae=h(ee,2);Zt(ae,21,()=>r(C),Vt,(Y,ie)=>{var _e=u(()=>qr(r(ie),2));let le=()=>r(_e)[0],fe=()=>r(_e)[1];var se=T2(),Ae=V(se),me=c(Ae),ke=h(Ae,2);Zt(ke,21,fe,Vt,(Se,We)=>{let xe=()=>r(We).projectID,Le=()=>r(We).projectName;var he=I2(),Re=c(he),Ce=c(Re);pa(Ce,{onclick:()=>A(xe()),children:(Ze,rt)=>{var Ve=Ut();Z(()=>U(Ve,Le())),_(Ze,Ve)}});var be=h(Re,2),Me=c(be);Me.__click=[L2,xe];var Te=c(Me);ql(Te,{color:"black"});var Ee=h(Me,2);Ee.__click=[C2,M,xe,Le];var Ue=c(Ee);ls(Ue,{color:"black"});var De=h(Ee,2);De.__click=[M2,I,xe,Le];var qe=c(De);Hl(qe,{color:"black"});var Fe=h(De,2);Fe.__click=[P2,T,xe,Le];var He=c(Fe);ii(He,{color:"white"}),Z((Ze,rt,Ve,Ke)=>{ze(Me,"title",Ze),ze(Ee,"title",rt),ze(De,"title",Ve),ze(Fe,"title",Ke)},[()=>r(m).t(129),()=>r(m).t(169),()=>r(m).t(132),()=>r(m).t(170)]),_(Se,he)}),Z(Se=>U(me,Se),[()=>Fi(le())]),_(Y,se)}),Z(Y=>U(re,Y),[()=>r(m).t(168)]),_(H,J)};ve(G,H=>{r(C).length>0&&H(Q)})}var q=h(G,2),X=c(q),ue=h(q,2);{var te=H=>{var J=B2();J.__click=[N2,l];var ee=c(J);Z(re=>U(ee,re),[()=>r(m).t(172)]),_(H,J)},ne=H=>{var J=$e(),ee=V(J);{var re=Y=>{xl(Y,{get boundariesUrl(){return u2}})},ae=Y=>{var ie=$e(),_e=V(ie);{var le=fe=>{xl(fe,{get boundariesUrl(){return c2}})};ve(_e,fe=>{a()=="england"&&fe(le)},!0)}_(Y,ie)};ve(ee,Y=>{a()=="cnt"?Y(re):Y(ae,!1)},!0)}_(H,J)};ve(ue,H=>{a()=="global"?H(te):H(ne,!1)})}var oe=h(ue,2);$2(oe,{}),Z((H,J,ee)=>{ze(S,"href",H),U(E,J),U(X,ee)},[()=>`user_guide.html?lang=${jl()}`,()=>r(m).t(167),()=>r(m).t(171)]),_(w,y)},$=w=>{var y=O2(),F=c(y);Z(k=>U(F,k),[()=>r(m).t(173)]),_(w,y)};ve(g,w=>{o()&&e.wasmReady?w(p):w($,!1)})}_(z,d)},$$slots:{top:!0,left:!0}}),_(n,x),Be(),b()}rr(["click"]);var D2=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),U2=P("<p> </p>"),G2=(n,e)=>K(e,{state:"neutral"},!0),W2=P("<b><!></b>"),H2=P("<p> </p> <button> </button> <!> <p><!></p>",1),q2=P("<!> <!>",1),J2=P("<p><!></p>"),Q2=P("<p><!></p>"),Z2=P("<!> <!> <!> <!>",1),V2=P("<!> <!> <!> <!>",1),K2=P("<!> <!> <!>",1);function X2(n,e){Ne(e,!0);const t=()=>ye(Rt,"$backend",a),o=()=>ye(yt,"$mode",a),[a,s]=lt(),l=u(()=>ut(ct("main")));let i=t().renderNeighbourhood(),f=we(ht({state:"neutral"}));function v(b,m){if(r(f).state!="neutral")return;let C=t().getShortcutsCrossingRoad(b.properties.id);if(C.features.length==0){window.alert(r(l).t(99));return}K(f,{state:"chose-road",roadGj:b,gj:C,shortcutIndex:0},!0)}Mr(n,{top:j=>{var T=D2(),M=c(T),I=c(M),A=c(I);et(A,{mode:{mode:"title"}});var x=h(I,2),L=c(x);et(L,{mode:{mode:"pick-neighbourhood"}});var D=h(x,2),R=c(D);et(R,{mode:{mode:"neighbourhood"}});var O=h(D,2),z=c(O);Z(d=>U(z,d),[()=>wr(o().mode)]),_(j,T)},left:j=>{var T=q2(),M=V(T);_n(M,{mode:{mode:"neighbourhood"}});var I=h(M,2);{var A=L=>{var D=U2(),R=c(D);Z(O=>U(R,O),[()=>r(l).t(100)]),_(L,D)},x=L=>{var D=$e(),R=V(D);{var O=z=>{var d=H2(),g=V(d),p=c(g),$=h(g,2);$.__click=[G2,f];var w=c($),y=h($,2);oi(y,{get list(){return r(f).gj.features},get idx(){return r(f).shortcutIndex},set idx(N){r(f).shortcutIndex=N}});var F=h(y,2);{const N=(S,E=Pe)=>{var B=W2(),G=c(B);{let Q=u(()=>[r(f).gj.features[r(f).shortcutIndex].properties.directness.toFixed(1)]);pe(G,{get x(){return E()},n:!0,get a(){return r(Q)}})}_(S,B)};var k=c(F);{let S=u(()=>[N]),E=u(()=>r(l).cx(103));pe(k,{get t(){return r(S)},get x(){return r(E)}})}}Z((N,S)=>{U(p,N),U(w,S)},[()=>r(l).t(101),()=>r(l).t(102)]),_(z,d)};ve(R,z=>{r(f).state=="chose-road"&&z(O)},!0)}_(L,D)};ve(I,L=>{r(f).state=="neutral"?L(A):L(x,!1)})}_(j,T)},main:j=>{var T=K2(),M=V(T);it(M,{get data(){return i},generateId:!0,children:(L,D)=>{var R=Z2(),O=V(R);li(O,{});var z=h(O,2);ya(z,{});var d=h(z,2);wa(d,{});var g=h(d,2);{const p=w=>{var y=$e(),F=V(y);{var k=N=>{Bt(N,{openOn:"hover",children:(E,B)=>{let G=()=>B?.().data;const Q=u(()=>G().properties);var q=$e(),X=V(q);{var ue=ne=>{var oe=J2(),H=c(oe);{let J=u(()=>r(l).cx(104)),ee=u(()=>[r(Q).shortcuts,r(Q).name??"unnamed road"]);pe(H,{get x(){return r(J)},get a(){return r(ee)}})}_(ne,oe)},te=ne=>{var oe=$e(),H=V(oe);{var J=ee=>{var re=Q2(),ae=c(re);{let Y=u(()=>r(l).cx(105)),ie=u(()=>[r(Q).name??"unnamed road"]);pe(ae,{get x(){return r(Y)},get a(){return r(ie)}})}_(ee,re)};ve(H,ee=>{r(Q).kind=="main_road"&&ee(J)},!0)}_(ne,oe)};ve(X,ne=>{r(Q).kind=="interior_road"?ne(ue):ne(te,!1)})}_(E,q)},$$slots:{default:!0}})};ve(F,N=>{r(f).state=="neutral"&&N(k)})}_(w,y)};let $=u(()=>r(f).state=="neutral");Aa(g,{onClickLine:v,get interactive(){return r($)},get maxShortcuts(){return i.maxShortcuts},linePopup:p,$$slots:{linePopup:!0}})}_(L,R)},$$slots:{default:!0}});var I=h(M,2);{var A=L=>{var D=V2(),R=V(D);it(R,{get data(){return r(f).gj.features[r(f).shortcutIndex]},children:(g,p)=>{{let $=u(()=>Ge("shortcuts"));gt(g,Ie(()=>r($),{paint:{"line-width":10,"line-color":"cyan"}}))}},$$slots:{default:!0}});var O=h(R,2);it(O,{get data(){return r(f).roadGj},children:(g,p)=>{{let $=u(()=>Ge("shortcuts-focus"));gt(g,Ie(()=>r($),{paint:{"line-width":5,"line-color":"blue"}}))}},$$slots:{default:!0}});var z=h(O,2);{let g=u(()=>Ho(r(f).gj.features[r(f).shortcutIndex].geometry.coordinates[0]));no(z,{get lngLat(){return r(g)},children:(p,$)=>{var w=Ut();Z(y=>U(w,y),[()=>r(l).t(71)]),_(p,w)},$$slots:{default:!0}})}var d=h(z,2);{let g=u(()=>Ho(r(f).gj.features[r(f).shortcutIndex].geometry.coordinates[r(f).gj.features[r(f).shortcutIndex].geometry.coordinates.length-1]));no(d,{get lngLat(){return r(g)},children:(p,$)=>{var w=Ut();Z(y=>U(w,y),[()=>r(l).t(72)]),_(p,w)},$$slots:{default:!0}})}_(L,D)};ve(I,L=>{r(f).state=="chose-road"&&L(A)})}var x=h(I,2);Cn(x,{interactive:!1}),_(j,T)},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}rr(["click"]);var Y2=P('<link rel="icon" type="image/x-icon"/>'),eb=P("<h1> </h1>"),tb=P("<h1> </h1>"),rb=P('<article style="max-height: 80vh; max-width: 80vw; overflow: auto"><!> <!></article>'),nb=(n,e)=>K(e,!0),ob=()=>window.open(`user_guide.html?lang=${jl()}`,"_blank"),ab=P('<div class="pico" style="display: flex; align-items: center; gap: 8px;"><button class="outline"><img style="height: 32px;"/></button> <div style="width: 100%"></div> <button class="icon-btn"><!></button></div>'),ib=P('<div class="pico"><div></div></div>'),sb=P('<div class="ltn-map-btn zoom-to-fit-btn"><!></div>'),lb=P("<!> <!>",1),ub=P("<!> <!>",1),cb=P("<!> <!> <!> <!> <!> <div></div> <!> <!> <!> <!>",1),db=P('<div style="position: relative; width: 100%; height: 100%;"><!></div>'),fb=P('<div class="pico"><!></div> <div><!></div>',1);function gb(n,e){Ne(e,!0);const t=()=>ye(rn,"$mapStore",f),o=()=>ye(Rt,"$backend",f),a=()=>ye(Ci,"$maptilerBasemap",f),s=()=>ye(zc,"$locale",f),l=()=>ye(nn,"$appFocusStore",f),i=()=>ye(yt,"$mode",f),[f,v]=lt(),b=u(()=>ut(ct("main")));nn.set(e.appFocus);let m=we(!1);gn(async()=>{await wu(),await Yl();try{await(await fetch("/severance_pbfs/areas.json")).json(),Qe(Rc,!0),console.log("Using local asset files")}catch{}K(m,!0)});let C=we(void 0),j=we(!1);function T(O){t().fitBounds(o().getBounds(),{animate:O})}let M=we(ht(Date.now()));function I(){r(C)&&Date.now()-r(M)>500&&(Vd(),K(M,Date.now(),!0))}let A=we(void 0);e.appFocus=="cnt"&&K(A,[-8.943,54.631,-.901,59.489],!0);let x=u(()=>a()=="streets-v2"?S_:`https://api.maptiler.com/maps/${a()}/style.json?key=${Dc}`),L=we(!1);Je(()=>{r(C)&&(r(C).keyboard.disableRotation(),r(C).dragRotate.disable(),r(C).touchZoomRotate.disableRotation(),rn.set(r(C)))});var D=$e();Uc(O=>{var z=Y2();Z(()=>ze(z,"href",qc)),_(O,z)});var R=V(D);Tc(R,()=>Fc(s()),null,O=>{var z=fb(),d=V(z),g=c(d);Bl(g,{get show(){return r(L)},set show(w){K(L,w,!0)},children:(w,y)=>{var F=rb(),k=c(F);{var N=B=>{var G=eb(),Q=c(G);Z(q=>U(Q,q),[()=>r(b).t(44)]),_(B,G)},S=B=>{var G=tb(),Q=c(G);Z(q=>U(Q,q),[()=>r(b).t(45)]),_(B,G)};ve(k,B=>{e.appFocus=="cnt"?B(N):B(S,!1)})}var E=h(k,2);Nc(E,{}),_(w,F)},$$slots:{default:!0}});var p=h(d,2),$=c(p);g_($,{top:k=>{var N=ab(),S=c(N);S.__click=[nb,L];var E=c(S),B=h(S,2);vn(B,q=>Vo.value=q,()=>Vo?.value);var G=h(B,2);G.__click=[ob];var Q=c(G);Bc(Q,{color:"black"}),Z((q,X)=>{ze(E,"src",Qc),ze(E,"alt",q),ze(G,"title",X)},[()=>r(b).t(46),()=>r(b).t(47)]),_(k,N)},left:k=>{var N=ib(),S=c(N);vn(S,E=>Ko.value=E,()=>Ko?.value),_(k,N)},main:k=>{var N=db(),S=c(N);{let E=u(()=>[{id:Dt.walkCycleOnly.filterType,url:Dt.walkCycleOnly.iconURL},{id:Dt.noEntry.filterType,url:Dt.noEntry.iconURL},{id:Dt.busGate.filterType,url:Dt.busGate.iconURL},{id:Dt.schoolStreet.filterType,url:Dt.schoolStreet.iconURL},{id:"diagonal_filter",url:Jc},{id:"no_straight_turn",url:Dl},{id:"no_left_turn",url:zl},{id:"no_right_turn",url:Oi},{id:"no_u_left_to_right_turn",url:Gl},{id:"no_u_right_to_left_turn",url:Ul},{id:"oneway_arrow",url:Hc},{id:"border_entry_arrow",url:Wc,options:{sdf:!0}},{id:"national_rail",url:Wl}]);wd(S,{get style(){return r(x)},hash:!0,get bounds(){return r(A)},maxZoom:19,onerror:B=>{console.log(B.error)},get images(){return r(E)},get map(){return r(C)},set map(B){K(C,B,!0)},get loaded(){return r(j)},set loaded(B){K(j,B,!0)},children:(B,G)=>{var Q=cb(),q=V(Q);Vl(q,{showCompass:!1});var X=h(q,2);ma(X,{onstyledata:I});var ue=h(X,2);{var te=le=>{var fe=lb(),se=V(fe);ji(se,{position:"top-left",children:(me,ke)=>{Is(me,{children:(Se,We)=>{{let xe=u(()=>r(b).t(48));Oc(Se,{get title(){return r(xe)},onclick:()=>T(!0),children:(Le,he)=>{var Re=sb(),Ce=c(Re);ed(Ce,{}),_(Le,Re)},$$slots:{default:!0}})}},$$slots:{default:!0}})},$$slots:{default:!0}});var Ae=h(se,2);ji(Ae,{position:"top-left",children:(me,ke)=>{Is(me,{children:(Se,We)=>{jc(Se,{get map(){return t()},get maptilerBasemap(){return a()}})},$$slots:{default:!0}})},$$slots:{default:!0}}),_(le,fe)};ve(ue,le=>{o()&&le(te)})}var ne=h(ue,2);Hv(ne,{get map(){return r(C)},get loaded(){return r(j)}});var oe=h(ne,2);Kl(oe,{});var H=h(oe,2);vn(H,le=>Xo.value=le,()=>Xo?.value);var J=h(H,2);{var ee=le=>{z2(le,{get wasmReady(){return r(m)}})},re=le=>{var fe=$e(),se=V(fe);{var Ae=me=>{l2(me,{})};ve(se,me=>{i().mode=="new-project"&&me(Ae)},!0)}_(le,fe)};ve(J,le=>{i().mode=="title"?le(ee):le(re,!1)})}var ae=h(J,2);f_(ae,{});var Y=h(ae,2);{var ie=le=>{var fe=ub(),se=V(fe);{let Se=u(()=>o().getInvertedBoundary());it(se,{get data(){return r(Se)},children:(We,xe)=>{{let Le=u(()=>Ge("boundary"));cr(We,Ie(()=>r(Le),{paint:{"fill-color":"black","fill-opacity":.3}}))}},$$slots:{default:!0}})}var Ae=h(se,2);{var me=Se=>{F1(Se,{})},ke=Se=>{var We=$e(),xe=V(We);{var Le=Re=>{wm(Re,{get name(){return i().name},get existing(){return i().existing}})},he=Re=>{var Ce=$e(),be=V(Ce);{var Me=Ee=>{xp(Ee,{})},Te=Ee=>{var Ue=$e(),De=V(Ue);{var qe=He=>{F0(He,{})},Fe=He=>{var Ze=$e(),rt=V(Ze);{var Ve=vt=>{X2(vt,{})},Ke=vt=>{var xt=$e(),mt=V(xt);{var Mt=Et=>{f1(Et,{})},$t=Et=>{var At=$e(),Lt=V(At);{var Ot=Pt=>{mm(Pt,{get prevMode(){return i().prevMode}})},Kt=Pt=>{var It=$e(),lr=V(It);{var fr=Pr=>{am(Pr,{get prevMode(){return i().prevMode}})},Zr=Pr=>{var xr=$e(),Vr=V(xr);{var on=$r=>{X0($r,{get road(){return i().road},get prevPrevMode(){return i().prevPrevMode}})},Fr=$r=>{var Or=$e(),ce=V(Or);{var at=jt=>{lh(jt,{})},Yt=jt=>{var ir=$e(),br=V(ir);{var kr=Sr=>{qp(Sr,{})},_t=Sr=>{var ur=$e(),dt=V(ur);{var st=Ye=>{Op(Ye,{})};ve(dt,Ye=>{i().mode=="debug-demand"&&Ye(st)},!0)}_(Sr,ur)};ve(br,Sr=>{i().mode=="debug-intersections"?Sr(kr):Sr(_t,!1)},!0)}_(jt,ir)};ve(ce,jt=>{i().mode=="debug-neighbourhood"?jt(at):jt(Yt,!1)},!0)}_($r,Or)};ve(Vr,$r=>{i().mode=="impact-detail"?$r(on):$r(Fr,!1)},!0)}_(Pr,xr)};ve(lr,Pr=>{i().mode=="predict-impact"?Pr(fr):Pr(Zr,!1)},!0)}_(Pt,It)};ve(Lt,Pt=>{i().mode=="route"?Pt(Ot):Pt(Kt,!1)},!0)}_(Et,At)};ve(mt,Et=>{i().mode=="impact-one-destination"?Et(Mt):Et($t,!1)},!0)}_(vt,xt)};ve(rt,vt=>{i().mode=="view-shortcuts"?vt(Ve):vt(Ke,!1)},!0)}_(He,Ze)};ve(De,He=>{i().mode=="neighbourhood"?He(qe):He(Fe,!1)},!0)}_(Ee,Ue)};ve(be,Ee=>{i().mode=="add-neighbourhood"?Ee(Me):Ee(Te,!1)},!0)}_(Re,Ce)};ve(xe,Re=>{i().mode=="set-boundary"?Re(Le):Re(he,!1)},!0)}_(Se,We)};ve(Ae,Se=>{i().mode=="pick-neighbourhood"?Se(me):Se(ke,!1)})}_(le,fe)};ve(Y,le=>{o()&&le(ie)})}var _e=h(Y,2);Ud(_e),_(B,Q)},$$slots:{default:!0}})}_(k,N)},$$slots:{top:!0,left:!0,main:!0}}),Z(()=>St(p,1,`app-focus-${l()??""}`)),_(O,z)}),_(n,D),Be(),v()}rr(["click"]);export{gb as A};
