import{c as _l,b as pl,H as Wu,i as Hu,n as qu,s as Ju,a as Qu,d as Zu,e as Vu,U as Ku,p as Xu,r as Yu,t as ec,l as gr,I as _r,f as Le,g as $e,h as Q,j as pr,k as p,o as we,u as vs,q as tc,v as r,w as X,x as ko,y as Ne,z as W,A as hl,B as rc,C as cr,D as Ze,E as u,F as ve,G as Be,J as Rn,K as Gr,L as Tt,M as Pe,N as P,O as sn,P as J,Q as c,R as St,S as ml,T as $r,V as nc,W as bl,X as oc,Y as ac,Z as ic,_ as ht,$ as sc,a0 as Xn,a1 as lc,a2 as uc,a3 as ca,a4 as m,a5 as cc,a6 as dc,a7 as fc,a8 as vc,a9 as gc,aa as ln,ab as _c,ac as pc,ad as pn,ae as Jt,af as U,ag as Qt,ah as Dr,ai as fr,aj as yl,ak as ut,al as be,am as hc,an as fo,ao as mc,ap as Jr,aq as so,ar as Al,as as da,at as Ve,au as yt,av as Vr,aw as Pr,ax as lo,ay as me,az as Qr,aA as ct,aB as dt,aC as bc,aD as Ai,aE as tr,aF as hn,aG as It,aH as Dt,aI as Wi,aJ as ho,aK as Zo,aL as Vo,aM as wl,aN as Ko,aO as Xo,aP as Yo,aQ as De,aR as ea,aS as xl,aT as ta,aU as Ra,aV as wi,aW as Kr,aX as ra,aY as Na,aZ as Mn,a_ as xi,a$ as Hi,b0 as qi,b1 as Ji,b2 as Qi,b3 as Zi,b4 as Vi,b5 as Xa,b6 as na,b7 as Ki,b8 as mo,b9 as bn,ba as ma,bb as Ya,bc as Ba,bd as $i,be as yc,bf as ki,bg as Ur,bh as gs,bi as Si,bj as $l,bk as kl,bl as Vt,bm as Sl,bn as El,bo as Xi,bp as Ei,bq as Fa,br as Ll,bs as _s,bt as lr,bu as Yi,bv as Do,bw as Li,bx as ba,by as Oa,bz as ja,bA as Ea,bB as La,bC as Cl,bD as Uo,bE as ps,bF as hs,bG as ms,bH as Ci,bI as Ac,bJ as Mi,bK as bs,bL as ys,bM as wc,bN as As,bO as Ml,bP as xc,bQ as $c,bR as kc,bS as Sc,bT as Ec,bU as Lc,bV as Cc,bW as Mc,bX as Pc}from"./pico.conditional.jade.min-CyL3qr-n.js";function Tc(n){var e;e=document.head.appendChild(_l());try{pl(()=>n(e),Wu)}finally{}}function ei(n,e,t){var o=n,a=Ku,s,l,i=null,f=Hu()?qu:Ju;function v(){s&&Xu(s),i!==null&&(i.lastChild.remove(),o.before(i),i=null),s=l}pl(()=>{if(f(a,a=e())){var y=o,b=Vu();b&&(i=document.createDocumentFragment(),i.append(y=_l())),l=Qu(()=>t(y)),b?Zu.add_callback(v):v()}})}function Ic(n,e,t,o,a){var s=()=>{o(t[n])};t.addEventListener(e,s),a?Yu(()=>{t[n]=a()}):s(),(t===document.body||t===window||t===document)&&ec(()=>{t.removeEventListener(e,s)})}const Rc="/ltn/assets/arrow-big-up-DKeSc1KD.png",Nc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAk0lEQVRIS+3U0Q2AIAwEUNjMUXQydRJH0zZB0wjGuwJfSsKfuWfO1hg6n9g5P3wPWKTSXe6EVstUNEjoloIVghAG0OxR7swgLEAjHoBCvACM1AAQUgJ0DL0nm67WwJom7XrBlhVl4arUAHYniuE1ABTuBeBwD0CFs4D92T12fp9v9iPrnJ8LBu0KC0Ch9qEfeK3sAPceHxk8hJ17AAAAAElFTkSuQmCC",Bc="/ltn/assets/favicon-DMAVMD4u.ico",Fc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAALRQTFRFR3BMemc7uV08rWA9gmc9wlw9+1M8/1c6XGw7rWA8yFs9Tm47d2g8RXA7lmM8N3I6bGo7g2Y8u108wl097lY9vV08pmE9pGE8IHY7/3YajWU8hWc811o+nmI87VU7L3M73Fo+K3Q62Fs+s189kWQ8gGc7iGU8e2g7x1pAC3k6////X6d+H4RKTJ1vjcCjEHg6F3c6HnY6+Pv6NJBbWaR5FX5C4vDoHINIQZZlfbiWmMaszuTYcGgFiwAAACl0Uk5TAMN7grBaDAXjiU7r0O+f9dvJdmUgbZSi/AKouC+zGPg3+yV8wbuzwESr5F6DAAAFwklEQVR42u3ax1rbQACF0STGvRsXMJieMqTICqS//3tlkS8LgpNgSZsZnf8R7hysgp49kyRJkiRJkqQ0mzdn141HvVhctGyTese95clkmIddZZedwXp2ZqR0u1oOLsO/y/qvFm1LJdnpqh+e0nZwjUB6tZZPO/5fBJoGS6zeIAt7NF65IUyq7jDsVza9sFoytVdHYe86PcOlcv6bbShQ341AIq0KnX8IQ78BSbTMQ8E6p9aLv+Y4FG7qWSD6rjrFzz9kKwPG3iaUaew2IPYLwHkpAGHqrXDcTcudf8gXNoz6B+CyJIAwPbZixJ2UPf9w5HVQxM37pQGEtRnjrVv+/EPHu4B4e1kBgO2hHWOt1akAQBgZMtZ6eRUAnhsy1hpVnH+YeBCMtVElAMZzS0baQRXnn+X+H1Df10AeA6LudSUAwsySkfa8GgAvLAmAABAAAkAACADFDuDL+4d9/QRAnQC8/Xj7R5/vAKgPgHePzv/29gcA9QFwf7ujTwDUBsDbXQDeAQAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAAAAAAAAAAAAAAAAAAAAAfne/C8AXAGoD4G7H+X8OANQGQPj+6Pw/3gNQIwDh/YeHfbsLANQJwD4BAICi7HU1AGaWjLSXlZx/dmjJSDuoBEDes2SkjSoBMD61ZKR1KwHQaVsy0g63VQAYGDLWzvpVAFgbstYvAjJPgfG2rABAf27HaLsYlwdwYsZ4Oy5/Ddi6AsTcrPRzwKRlxYhrD8reAnaNGHXXuR8AdwHFO1qYMPLeDMsAuDFg9HWPSlwAruwX/0VgkxU9/2HTfAnUuil4/ufXxkuis2mx8/cEmIyAmwJXgXHDcOlcBTZ73wl2fAmYVI39Pg3YTn0Hllinm8s9/vy7PgNLr8X0ideB/trjf5pvBA5P/n8hyCcjx59u8+6ryflfHwny4WDU9OOfeO2LRXe0Xh/80Xq0bDTPzCNJkiRJkqQk+wnTOFu90krtLAAAAABJRU5ErkJggg==",Pl="/ltn/assets/no_left_turn-Xpmw1_3C.png",Pi="/ltn/assets/no_right_turn-CZwHVCpW.png",Tl="/ltn/assets/no_straight_turn-BWpcWQch.png",Il="/ltn/assets/no_u_left_to_right_turn-C4sWYlhS.png",Rl="/ltn/assets/no_u_right_to_left_turn-ClrJyulH.png",Oc="/ltn/assets/logo-3MjkCCFo.svg",Nl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAANVAAADaAEorMqLAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAPtJREFUKJF9kT1LwwAURc+NAQsdtFYHa8HBSAcHJ0HBUVz0n7i4ObkoKAV/gYObm5ubu7OKFMQPECFuoQgWRJtch9aSYvSO770D53Flm58kM401BdkesAJcYw4m4scz8kf9qGBGe3ZuNcuCHcEmcGv7qBo/nWKnAzCpR8+/yMGWUWAcU0L6wn4DOgAhcFHEGEoBLGAqoK7te6Eb406h6vv0/NRnyBawDYyATzKFzcmXu9chmaQeHfesVDZeFGqAU0QrMy3BR5FRCKz31FxGGrMdIrpATVD98/0hVSlo16INB9oFLyEuldKsxA/n/4O59DvdB5YNVzKH+U6/AaiZavkY71DDAAAAAElFTkSuQmCC";function jc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m5 12 7-7 7 7"}],["path",{d:"M12 19V5"}]];_r(n,Le({name:"arrow-up"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function zc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M8 12h8"}],["path",{d:"M12 8v8"}]];_r(n,Le({name:"circle-plus"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Bl(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];_r(n,Le({name:"copy"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Dc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21"}],["path",{d:"m5.082 11.09 8.828 8.828"}]];_r(n,Le({name:"eraser"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Fl(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M12 18v-6"}],["path",{d:"m9 15 3 3 3-3"}]];_r(n,Le({name:"file-down"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Uc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"}]];_r(n,Le({name:"folder-open"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Gc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}],["path",{d:"M2 12h20"}]];_r(n,Le({name:"globe"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Wc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];_r(n,Le({name:"house"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Hc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];_r(n,Le({name:"layers"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function qc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"m14.622 17.897-10.68-2.913"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15"}]];_r(n,Le({name:"paintbrush"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function es(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]];_r(n,Le({name:"pencil"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Ol(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M22 14a8 8 0 0 1-8 8"}],["path",{d:"M18 11v-1a2 2 0 0 0-2-2a2 2 0 0 0-2 2"}],["path",{d:"M14 10V9a2 2 0 0 0-2-2a2 2 0 0 0-2 2v1"}],["path",{d:"M10 9.5V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v10"}],["path",{d:"M18 11a2 2 0 1 1 4 0v3a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"}]];_r(n,Le({name:"pointer"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Jc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M21 7v6h-6"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7"}]];_r(n,Le({name:"redo"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Qc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["circle",{cx:"6",cy:"19",r:"3"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"}],["circle",{cx:"18",cy:"5",r:"3"}]];_r(n,Le({name:"route"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function ti(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M10 11v6"}],["path",{d:"M14 11v6"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];_r(n,Le({name:"trash-2"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}function Zc(n,e){const t=gr(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const o=[["path",{d:"M3 7v6h6"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"}]];_r(n,Le({name:"undo"},()=>t,{get iconNode(){return o},children:(a,s)=>{var l=$e(),i=Q(l);pr(i,e,"default",{}),p(a,l)},$$slots:{default:!0}}))}class Vc extends Map{#e=new Map;#t=we(0);#r=we(0);#a=vs||-1;constructor(e){if(super(),e){for(var[t,o]of e)super.set(t,o);this.#r.v=super.size}}#n(e){return vs===this.#a?we(e):tc(e)}has(e){var t=this.#e,o=t.get(e);if(o===void 0){var a=super.get(e);if(a!==void 0)o=this.#n(0),t.set(e,o);else return r(this.#t),!1}return r(o),!0}forEach(e,t){this.#o(),super.forEach(e,t)}get(e){var t=this.#e,o=t.get(e);if(o===void 0){var a=super.get(e);if(a!==void 0)o=this.#n(0),t.set(e,o);else{r(this.#t);return}}return r(o),super.get(e)}set(e,t){var o=this.#e,a=o.get(e),s=super.get(e),l=super.set(e,t),i=this.#t;if(a===void 0)a=this.#n(0),o.set(e,a),X(this.#r,super.size),ko(i);else if(s!==t){ko(a);var f=i.reactions===null?null:new Set(i.reactions),v=f===null||!a.reactions?.every(y=>f.has(y));v&&ko(i)}return l}delete(e){var t=this.#e,o=t.get(e),a=super.delete(e);return o!==void 0&&(t.delete(e),X(this.#r,super.size),X(o,-1),ko(this.#t)),a}clear(){if(super.size!==0){super.clear();var e=this.#e;X(this.#r,0);for(var t of e.values())X(t,-1);ko(this.#t),e.clear()}}#o(){r(this.#t);var e=this.#e;if(this.#r.v!==e.size){for(var t of super.keys())if(!e.has(t)){var o=this.#n(0);e.set(t,o)}}for([,o]of this.#e)r(o)}keys(){return r(this.#t),super.keys()}values(){return this.#o(),super.values()}entries(){return this.#o(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return r(this.#r),super.size}}function oa(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>t!=null))}function ws(n){let e;return t=>{if(t)for(let o in t){let a=e?.[o],s=t[o];a!==s&&n(o,s,a)}else if(e)for(let o in e)n(o,void 0,e[o]);e=t}}function Kc(n,...e){let t=[n];for(let o of e)if(o)Array.isArray(o)&&o[0]===n?t.push(...o.slice(1)):t.push(o);else continue;if(t.length!==1)return t.length===2?t[1]:t}function Xc(n){return n===!0?["has","point_count"]:n===!1?["!",["has","point_count"]]:void 0}function bt(n,e){return["case",["boolean",["feature-state","hover"],!1],e,n]}function fa(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("layer")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"paint",3,void 0),f=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),y=W(e,"applyToClusters",3,void 0),b=W(e,"requireSource",3,!0),L=W(e,"minzoom",3,void 0),O=W(e,"maxzoom",3,void 0),M=W(e,"manageHoverState",3,!1),T=W(e,"hovered",15),x=W(e,"interactive",3,!0),C=W(e,"hoverCursor",3,void 0),_=W(e,"eventsIfTopMost",3,!1),D=W(e,"children",3,void 0),z=W(e,"onclick",3,void 0),I=W(e,"ondblclick",3,void 0),F=W(e,"oncontextmenu",3,void 0),j=W(e,"onmouseenter",3,void 0),d=W(e,"onmousemove",3,void 0),g=W(e,"onmouseleave",3,void 0);const h=hl(),$=u(Gr),w=u(()=>r($).loaded),{layer:A}=rc(),B=u(Gr),k=u(()=>r(B).map),R=u(()=>r(B).eventTopMost),S=u(()=>r(B).layerInfo),E=u(()=>r(B).minzoom),N=u(()=>r(B).maxzoom);cr(()=>{A.value&&(r(S).delete(A.value),r(k).removeLayer(A.value))});let G;function q(fe){if(!x()||!A.value||!r(k)||_()&&r(R)(fe)!==A.value)return;let se=fe.features??[],ye=se[0]?.properties?.cluster_id,he={event:fe,map:r(k),clusterId:ye,layer:A.value,source:r(re),features:se};switch(fe.type){case"click":z()?.(he);break;case"dblclick":I()?.(he);break;case"contextmenu":F()?.(he);break}}function H(fe){if(!x()||!A.value||_()&&r(R)(fe)!==A.value)return;C()&&(r(k).getCanvas().style.cursor=C());let se=fe.features??[];T(se[0]??void 0);let ye=se[0]?.properties?.cluster_id,he={event:fe,map:r(k),clusterId:ye,layer:A.value,source:r(re),features:se};j()?.(he)}function Y(fe){if(!x())return;if(_()&&r(R)(fe)!==A.value){T(void 0),M()&&G!==void 0&&(r(k).setFeatureState({source:r(re),sourceLayer:a(),id:G},{hover:!1}),G=void 0);return}C()&&(r(k).getCanvas().style.cursor=C());let se=fe.features??[],ye=se[0]?.properties?.cluster_id,he=se[0]?.id;he!==G&&(M()&&(G!==void 0&&r(k).setFeatureState({source:r(re),id:G,sourceLayer:a()},{hover:!1}),r(k).setFeatureState({source:r(re),id:he,sourceLayer:a()},{hover:!0})),G=he,T(se[0]??void 0)),d()?.({event:fe,map:r(k),clusterId:ye,layer:A.value,source:r(re),features:se})}function ue(fe){if(!(!x()||!A.value||!r(k))){if(C()&&(r(k).getCanvas().style.cursor=""),T(void 0),M()&&G!==void 0){const se={source:r(re),id:G,sourceLayer:a()};r(k).setFeatureState(se,{hover:!1}),G=void 0}g()?.({map:r(k),layer:A.value,source:r(re)})}}let oe=we(!0);function Z(fe){r(k).off("click",fe,q),r(k).off("dblclick",fe,q),r(k).off("contextmenu",fe,q),r(k).off("mouseenter",fe,H),r(k).off("mousemove",fe,Y),r(k).off("mouseleave",fe,ue)}cr(()=>{A.value&&Z(A.value)});let te=u(()=>Xc(y())),K=u(()=>Kc("all",r(te),v())),V=u(()=>L()??r(E)),ee=u(()=>O()??r(N)),re=u(()=>o()||h?.value);Ze(()=>{if(A.value!==t()&&r(w)&&(r(re)||!b())){A.value&&(Z(A.value),r(S).delete(A.value));let fe=s();if(!s()&&l()){let se=r(k).getStyle().layers,ye=typeof l()=="function"?l():Se=>Se.type===l(),he=se?.find(ye);he&&(fe=he.id)}A.value=t(),r(k).addLayer(oa({id:A.value,type:e.type,source:r(re),"source-layer":a(),filter:r(K),paint:i(),layout:f(),minzoom:r(V),maxzoom:r(ee)}),fe),X(oe,!0),r(k).on("click",A.value,q),r(k).on("dblclick",A.value,q),r(k).on("contextmenu",A.value,q),r(k).on("mouseenter",A.value,H),r(k).on("mousemove",A.value,Y),r(k).on("mouseleave",A.value,ue)}}),Ze(()=>{A.value&&r(S).set(A.value,{interactive:x()})});let ae=u(()=>A.value?ws((fe,se)=>{r(k).style._loaded?r(k).setPaintProperty(A.value,fe,se):r(k).once("styledata",()=>r(k).setPaintProperty(A.value,fe,se))}):void 0),ne=u(()=>A.value?ws((fe,se)=>{r(k).style._loaded?r(k).setLayoutProperty(A.value,fe,se):r(k).once("styledata",()=>r(k).setLayoutProperty(A.value,fe,se))}):void 0);Ze(()=>{r(ae)?.(i())}),Ze(()=>{r(ne)?.(f())}),Ze(()=>{A.value&&r(k).setLayerZoomRange(A.value,r(V),r(ee))}),Ze(()=>{A.value&&(r(oe)?X(oe,!1):r(k).setFilter(A.value,r(K)))});var ie=$e(),_e=Q(ie);{var le=fe=>{var se=$e(),ye=Q(se);ei(ye,()=>A.value,he=>{var Se=$e(),xe=Q(Se);Tt(xe,()=>D()??Pe),p(he,Se)}),p(fe,se)};ve(_e,fe=>{A.value&&fe(le)})}p(n,ie),Be()}function Pn(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("circle")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"applyToClusters",3,void 0),y=W(e,"minzoom",3,void 0),b=W(e,"maxzoom",3,void 0),L=W(e,"hoverCursor",3,void 0),O=W(e,"manageHoverState",3,!1),M=W(e,"hovered",15),T=W(e,"eventsIfTopMost",3,!1),x=W(e,"interactive",3,!0),C=W(e,"children",3,void 0),_=W(e,"onclick",3,void 0),D=W(e,"ondblclick",3,void 0),z=W(e,"oncontextmenu",3,void 0),I=W(e,"onmouseenter",3,void 0),F=W(e,"onmousemove",3,void 0),j=W(e,"onmouseleave",3,void 0);fa(n,{get id(){return t()},type:"circle",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get applyToClusters(){return v()},get minzoom(){return y()},get maxzoom(){return b()},get hoverCursor(){return L()},get manageHoverState(){return O()},get eventsIfTopMost(){return T()},get interactive(){return x()},get onclick(){return _()},get ondblclick(){return D()},get oncontextmenu(){return z()},get onmouseenter(){return I()},get onmousemove(){return F()},get onmouseleave(){return j()},get hovered(){return M()},set hovered(d){M(d)},children:(d,g)=>{var h=$e(),$=Q(h);Tt($,()=>C()??Pe),p(d,h)},$$slots:{default:!0}}),Be()}var Yc=P("<div><!></div>");function Ti(n,e){Ne(e,!0);let t=W(e,"defaultStyling",3,!0),o=W(e,"position",3,"top-right"),a=W(e,"class",3,void 0);const s=u(Gr),l=u(()=>r(s).map);let i=we(void 0),f={onAdd(){return r(i)},onRemove(){r(i)?.parentNode?.removeChild(r(i))}};Ze(()=>{r(i)&&r(l).addControl(f,o())}),cr(()=>{r(l).removeControl(f)});var v=Yc();let y;var b=c(v);Tt(b,()=>e.children??Pe),sn(v,L=>X(i,L),()=>r(i)),J(L=>y=St(v,1,ml(a()),null,y,L),[()=>({"maplibregl-ctrl":t()})]),p(n,v),Be()}var ed=P("<div><!></div>");function xs(n,e){let t=W(e,"class",3,"");var o=ed(),a=c(o);Tt(a,()=>e.children??Pe),J(()=>St(o,1,`maplibregl-ctrl-group ${t()??""}`)),p(n,o)}function ur(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("fill")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"minzoom",3,void 0),y=W(e,"maxzoom",3,void 0),b=W(e,"hoverCursor",3,void 0),L=W(e,"manageHoverState",3,!1),O=W(e,"hovered",15),M=W(e,"eventsIfTopMost",3,!1),T=W(e,"interactive",3,!0),x=W(e,"onclick",3,void 0),C=W(e,"ondblclick",3,void 0),_=W(e,"oncontextmenu",3,void 0),D=W(e,"onmouseenter",3,void 0),z=W(e,"onmousemove",3,void 0),I=W(e,"onmouseleave",3,void 0);fa(n,{get id(){return t()},type:"fill",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get minzoom(){return v()},get maxzoom(){return y()},get hoverCursor(){return b()},get manageHoverState(){return L()},get eventsIfTopMost(){return M()},get interactive(){return T()},get onclick(){return x()},get ondblclick(){return C()},get oncontextmenu(){return _()},get onmouseenter(){return D()},get onmousemove(){return z()},get onmouseleave(){return I()},get hovered(){return O()},set hovered(F){O(F)},children:(F,j)=>{var d=$e(),g=Q(d);Tt(g,()=>e.children??Pe),p(F,d)},$$slots:{default:!0}}),Be()}function td(n,e){Ne(e,!0);const t=u(Gr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"container",3,void 0),i=we(void 0),f=u(()=>typeof l()=="string"?document.querySelector(l())??void 0:l());Ze(()=>{r(i)||(r(f)?X(i,new $r.FullscreenControl({container:r(f)}),!0):X(i,new $r.FullscreenControl,!0),r(o).addControl(r(i),s()))}),cr(()=>{r(a)&&r(i)&&r(o).removeControl(r(i))}),Be()}function jl(n,e,t,o,a){let s=!1;n.getSource(e)&&(s=!0,n.removeSource(e));const l=()=>{o(e)&&(n.addSource(e,t),a())};if(s){const i=()=>{e&&(n.getSource(e)?setTimeout(i,1):l())};i()}else l()}function zl(n,e,t){nc().then(()=>{if(!n.loaded())return;n.getSource(e)===t&&n.removeSource(e)})}function lt(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("geojson")),o=W(e,"generateId",3,!1),a=W(e,"promoteId",3,void 0),s=W(e,"filter",3,void 0),l=W(e,"lineMetrics",3,void 0),i=W(e,"cluster",3,void 0),f=W(e,"maxzoom",3,void 0),v=W(e,"attribution",3,void 0),y=W(e,"buffer",3,void 0),b=W(e,"tolerance",3,void 0);const L=u(Gr),O=u(()=>r(L).map),M=u(()=>r(L).loaded),{source:T}=bl();let x=we(void 0),C=we(!0);Ze(()=>{r(O)&&r(M)&&T.value!==t()&&(T.value=t(),jl(r(O),T.value,oa({type:"geojson",data:e.data,filter:s(),lineMetrics:l(),generateId:o(),promoteId:a(),cluster:!!i(),clusterMinPoints:i()?.minPoints,clusterMaxZoom:i()?.maxZoom,clusterRadius:i()?.radius,clusterProperties:i()?.properties,maxzoom:f(),attribution:v(),buffer:y(),tolerance:b()}),I=>r(O)&&I===T.value,()=>{T.value&&(X(x,r(O).getSource(T.value),!0),X(C,!0))}),r(x))}),Ze(()=>{r(x)&&(r(C)?X(C,!1):r(x).setData(e.data))}),Ze(()=>{r(O).on("style.load",()=>{X(x,r(O).getSource(t()),!0)})}),Ze(()=>{r(x)?.setClusterOptions(oa({cluster:!!i(),clusterMaxZoom:i()?.maxZoom,clusterRadius:i()?.radius}))}),cr(()=>{T.value&&r(x)&&r(O)&&(zl(r(O),T.value,r(x)),T.value=void 0,X(x,void 0))});var _=$e(),D=Q(_);{var z=I=>{var F=$e(),j=Q(F);ei(j,()=>T.value,d=>{var g=$e(),h=Q(g);Tt(h,()=>e.children??Pe),p(d,g)}),p(I,F)};ve(D,I=>{T.value&&I(z)})}p(n,_),Be()}function rd(n,e){Ne(e,!0);const t=u(Gr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"positionOptions",3,void 0),i=W(e,"fitBoundsOptions",3,void 0),f=W(e,"trackUserLocation",3,!1),v=W(e,"showAccuracyCircle",3,!0),y=W(e,"showUserLocation",3,!0),b=W(e,"control",15);Ze(()=>{r(o)&&!b()&&(b(new $r.GeolocateControl({positionOptions:l(),fitBoundsOptions:i(),trackUserLocation:f(),showAccuracyCircle:v(),showUserLocation:y()})),r(o).addControl(b(),s()))}),cr(()=>{r(a)&&b()&&r(o).removeControl(b())}),Be()}function nd(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("heatmap")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"minzoom",3,void 0),y=W(e,"maxzoom",3,void 0),b=W(e,"hoverCursor",3,void 0),L=W(e,"manageHoverState",3,!1),O=W(e,"hovered",15),M=W(e,"eventsIfTopMost",3,!1),T=W(e,"interactive",3,!0),x=W(e,"onclick",3,void 0),C=W(e,"ondblclick",3,void 0),_=W(e,"oncontextmenu",3,void 0),D=W(e,"onmouseenter",3,void 0),z=W(e,"onmousemove",3,void 0),I=W(e,"onmouseleave",3,void 0);fa(n,{get id(){return t()},type:"heatmap",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get minzoom(){return v()},get maxzoom(){return y()},get hoverCursor(){return b()},get manageHoverState(){return L()},get eventsIfTopMost(){return M()},get interactive(){return T()},get onclick(){return x()},get ondblclick(){return C()},get oncontextmenu(){return _()},get onmouseenter(){return D()},get onmousemove(){return z()},get onmouseleave(){return I()},get hovered(){return O()},set hovered(F){O(F)},children:(F,j)=>{var d=$e(),g=Q(d);Tt(g,()=>e.children??Pe),p(F,d)},$$slots:{default:!0}}),Be()}function od(n,e){Ne(e,!0);let t=W(e,"sourceLayer",3,void 0),o=new Set;const a=u(Gr),s=u(()=>r(a).map),l=hl();Ze(()=>{if(e.data&&r(s)&&l?.value){let i=new Set;for(const f of e.data){const v=f[e.idCol];if(!v)continue;o.delete(v),i.add(v);const y={id:v,source:l.value,sourceLayer:t()},b=r(s).getFeatureState(y);let L=!1;for(const O of Object.keys(f))if(b[O]!==f[O]){L=!0;break}L&&r(s).setFeatureState(y,f)}for(const f of o){const v={id:f,source:l.value,sourceLayer:t()},y=r(s).getFeatureState(v);for(const b of Object.keys(y))r(s).removeFeatureState(v,b)}o=i}}),Be()}function gt(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("line")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"layout",3,void 0),f=W(e,"filter",3,void 0),v=W(e,"minzoom",3,void 0),y=W(e,"maxzoom",3,void 0),b=W(e,"hoverCursor",3,void 0),L=W(e,"manageHoverState",3,!1),O=W(e,"hovered",15),M=W(e,"eventsIfTopMost",3,!1),T=W(e,"interactive",3,!0),x=W(e,"children",3,void 0),C=W(e,"onclick",3,void 0),_=W(e,"ondblclick",3,void 0),D=W(e,"oncontextmenu",3,void 0),z=W(e,"onmouseenter",3,void 0),I=W(e,"onmousemove",3,void 0),F=W(e,"onmouseleave",3,void 0);fa(n,{get id(){return t()},type:"line",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return e.paint},get layout(){return i()},get filter(){return f()},get minzoom(){return v()},get maxzoom(){return y()},get hoverCursor(){return b()},get manageHoverState(){return L()},get eventsIfTopMost(){return M()},get interactive(){return T()},get onclick(){return C()},get ondblclick(){return _()},get oncontextmenu(){return D()},get onmouseenter(){return z()},get onmousemove(){return I()},get onmouseleave(){return F()},get hovered(){return O()},set hovered(j){O(j)},children:(j,d)=>{var g=$e(),h=Q(g);Tt(h,()=>x()??Pe),p(j,g)},$$slots:{default:!0}}),Be()}function va(n,e){Ne(e,!0);let t=W(e,"layer",3,void 0),o=oc(e,["$$slots","$$events","$$legacy","layer"]);const a=u(Gr),s=u(()=>r(a).map);function l(y){return o["on"+y]}function i(y){l(y.type)?.(y)}const f=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu","mouseover","mouseout"],v=["click","dblclick","contextmenu","mousemove","movestart","moveend","zoomstart","zoom","zoomend","pitch","rotate","wheel","data","styledata","idle"];Ze(()=>{if(r(s))if(t())for(const y of f)l(y)&&r(s).on(y,t(),i);else for(const y of v)l(y)&&r(s).on(y,i)}),cr(()=>{if(r(s))if(t())for(const y of f)l(y)&&r(s).off(y,t(),i);else for(const y of v)l(y)&&r(s).off(y,i)}),Be()}function ad(n){let e=n.getCenter(),t=Math.round(n.getZoom()*100)/100,o=Math.ceil((t*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,o),s=Math.round(e.lat*a)/a,l=Math.round(e.lng*a)/a,i=`${t}/${s}/${l}`,f=n.getBearing(),v=n.getPitch();return(f||v)&&(i+=`/${Math.round(f*10)/10}`),v&&(i+=`/${Math.round(v)}`),`#${i}`}function id(n){const e=n.replace("#","").split("/").map(parseFloat);return e.some(isNaN)?[]:e}var So=ts;function ts(n,e){return n===e||n!==n&&e!==e?!0:typeof n!=typeof e||{}.toString.call(n)!={}.toString.call(e)||n!==Object(n)||!n?!1:Array.isArray(n)?$s(n,e):{}.toString.call(n)=="[object Set]"?$s(Array.from(n),Array.from(e)):{}.toString.call(n)=="[object Object]"?ld(n,e):sd(n,e)}function sd(n,e){return n.toString()===e.toString()}function $s(n,e){var t=n.length;if(t!=e.length)return!1;for(var o=0;o<t;o++)if(!ts(n[o],e[o]))return!1;return!0}function ld(n,e){var t=Object.keys(n),o=t.length;if(o!=Object.keys(e).length)return!1;for(var a=0;a<o;a++){var s=t[a];if(!(e.hasOwnProperty(s)&&ts(n[s],e[s])))return!1}return!0}function Dl(n,e){Ne(e,!0);const t=u(Gr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"top-left"),l=W(e,"showCompass",3,!0),i=W(e,"showZoom",3,!0),f=W(e,"visualizePitch",3,!1),v=we(void 0);Ze(()=>{r(o)&&!r(v)&&(X(v,new $r.NavigationControl({showCompass:l(),showZoom:i(),visualizePitch:f()}),!0),r(o).addControl(r(v),s()))}),cr(()=>{r(a)&&r(v)&&r(o).removeControl(r(v))}),Be()}function Ul(n,e){Ne(e,!0);const t=u(Gr),o=u(()=>r(t).map),a=u(()=>r(t).loaded);let s=W(e,"position",3,"bottom-left"),l=W(e,"maxWidth",3,void 0),i=W(e,"unit",3,"metric"),f=we(void 0);Ze(()=>{r(o)&&!r(f)&&(X(f,new $r.ScaleControl({maxWidth:l(),unit:i()}),!0),r(o).addControl(r(f),s()))}),cr(()=>{r(a)&&r(f)&&r(o).removeControl(r(f))}),Be()}var ud=P("<!> <!> <!> <!>",1),cd=P("<!> <!>",1),dd=P('<div data-testid="map-container"><!></div>');function fd(n,e){Ne(e,!0);let t=W(e,"map",15,void 0),o=W(e,"mapContainer",15,void 0),a=W(e,"class",3,void 0),s=W(e,"diffStyleUpdates",3,!1),l=W(e,"center",15,void 0),i=W(e,"zoom",15,void 0),f=W(e,"pitch",15,0),v=W(e,"bearing",15,0),y=W(e,"bearingSnap",3,7),b=W(e,"bounds",15,void 0),L=W(e,"fitBoundsOptions",19,()=>({})),O=W(e,"hash",3,!1),M=W(e,"projection",3,void 0),T=W(e,"updateHash",3,se=>{window.history.replaceState(window.history.state,"",se)}),x=W(e,"loaded",15,!1),C=W(e,"minZoom",3,0),_=W(e,"maxZoom",3,22),D=W(e,"minPitch",3,0),z=W(e,"maxPitch",3,60),I=W(e,"renderWorldCopies",3,void 0),F=W(e,"dragPan",3,void 0),j=W(e,"dragRotate",3,void 0),d=W(e,"pitchWithRotate",3,void 0),g=W(e,"antialias",3,void 0),h=W(e,"zoomOnDoubleClick",3,!0),$=W(e,"locale",3,void 0),w=W(e,"interactive",3,!0),A=W(e,"attributionControl",3,void 0),B=W(e,"cooperativeGestures",3,!1),k=W(e,"preserveDrawingBuffer",3,!1),R=W(e,"maxBounds",3,void 0),S=W(e,"images",19,()=>[]),E=W(e,"standardControls",3,!1),N=W(e,"filterLayers",3,void 0),G=W(e,"transformRequest",3,void 0),q=u(()=>typeof E()=="boolean"?void 0:E());const H=ac();ic(new uc(void 0));let Y=we(ht(new Set));async function ue(se,ye=!1){if(t()&&!(!t()?.loaded()&&!ye))if("url"in se){r(Y).add(se.id);try{let he=await t().loadImage(se.url);t().addImage(se.id,he.data,se.options),H.loadedImages.add(se.id)}catch(he){e.onerror?e.onerror({error:he}):console.error(he)}finally{r(Y).delete(se.id)}}else t().addImage(se.id,se.data,se.options),H.loadedImages.add(se.id)}Ze(()=>{if(x()&&t()?.loaded())for(let se of S())!H.loadedImages.has(se.id)&&!r(Y).has(se.id)&&!t().hasImage(se.id)&&ue(se)});let oe=u(()=>S().every(se=>H.loadedImages.has(se.id))),Z=we(void 0),te=we(void 0),K=we(void 0),V=we(void 0);function ee(se){e.onerror?e.onerror(se):se.error.name!=="AbortError"&&console.error(se.error)}function re(se){return ne(),t(H.map=new $r.Map(oa({container:se,style:e.style,locale:$(),center:l(),zoom:i(),pitch:f(),bearing:v(),bearingSnap:y(),minZoom:C(),maxZoom:_(),minPitch:D(),maxPitch:z(),renderWorldCopies:I(),dragPan:F(),dragRotate:j(),pitchWithRotate:d(),antialias:g(),interactive:w(),preserveDrawingBuffer:k(),maxBounds:R(),bounds:b(),attributionControl:A(),transformRequest:G(),cooperativeGestures:B()}))),t().on("load",ye=>{ye.target.getContainer().setAttribute("data-testid","map"),ye.target.getCanvas().setAttribute("data-testid","map-canvas"),e.onload&&e.onload(t()),H.loaded=!0,x(!0)}),t().on("error",ee),e.onmovestart&&t().on("movestart",e.onmovestart),t().on("moveend",ye=>{if(l(ye.target.getCenter()),i(ye.target.getZoom()),f(ye.target.getPitch()),v(ye.target.getBearing()),b(cc(ye.target.getBounds(),b())),e.onmoveend?.(ye),O()){let he=new URL(window.location.href.replace(/(#.+)?$/,ad(ye.target)));T()(he)}}),e.onclick&&t().on("click",e.onclick),e.ondblclick&&t().on("dblclick",e.ondblclick),e.oncontextmenu&&t().on("contextmenu",e.oncontextmenu),e.onmousemove&&t().on("mousemove",e.onmousemove),e.onzoomstart&&t().on("zoomstart",e.onzoomstart),e.onzoom&&t().on("zoom",e.onzoom),e.onzoomend&&t().on("zoomend",e.onzoomend),e.onpitch&&t().on("pitch",e.onpitch),e.onrotate&&t().on("rotate",e.onrotate),e.onwheel&&t().on("wheel",e.onwheel),e.ondata&&t().on("data",e.ondata),e.onidle&&t().on("idle",e.onidle),t().on("style.load",ye=>{if(t()){M()&&t().setProjection(M()),H.loaded=!0,x(!0);const he=t().getStyle();if(X(Z,he.layers.map(Se=>Se.id),!0),X(te,Object.keys(he.sources),!0),r(V))for(const[Se,xe]of Object.entries(r(V)))t().addSource(Se,xe);if(r(K))for(const Se of r(K))t().addLayer(Se);for(const Se of S())ue(Se,!0);e.onstyleload?.(ye)}}),t().on("styledata",ye=>{if(t()&&N()){const he=t().getStyle().layers;if(he)for(let Se of he)N()(Se)||t().setLayoutProperty(Se.id,"visibility","none")}e.onstyledata?.(ye)}),{destroy(){x(!1),H.loaded=!1,t()?.remove()}}}let ae=we(ht(e.style));Ze(()=>{if(t()&&!So(e.style,r(ae))){const se=t().getStyle();if(r(Z)&&X(K,se.layers.filter(ye=>!r(Z).includes(ye.id)),!0),r(te)){const ye=Object.keys(se.sources).filter(he=>!r(te).includes(he));X(V,{},!0);for(const he of ye)r(V)[he]=se.sources[he]}X(ae,e.style,!0),t().setStyle(e.style,{diff:s()}),H.loadedImages.clear(),X(Y,new Set,!0)}}),Ze(()=>{if(t()){let se={};l()!=null&&!So(l(),t().getCenter())&&(se.center=l()),i()!=null&&!So(i(),t().getZoom())&&(se.zoom=i()),v()!=null&&!So(v(),t().getBearing())&&(se.bearing=v()),f()!=null&&!So(f(),t().getPitch())&&(se.pitch=f()),Object.keys(se).length&&t().easeTo(se)}}),Ze(()=>{M()&&x()&&t()?.setProjection(M())}),Ze(()=>{if(b()){const{equal:se,bounds:ye}=sc(b(),t()?.getBounds());se||t()?.fitBounds(ye,L())}}),Ze(()=>{h()?t()?.doubleClickZoom.enable():t()?.doubleClickZoom.disable()});function ne(){if(O()){let se=id(window.location.hash);se.length>=3&&(i(se[0]),l([se[2],se[1]])),se.length==5&&(v(se[3]),f(se[4]))}}var ie=dd();Xn("hashchange",ca,ne);let _e;var le=c(ie);{var fe=se=>{var ye=cd(),he=Q(ye);{var Se=Fe=>{var ke=ud(),Ce=Q(ke);Dl(Ce,{get position(){return r(q)}});var pe=m(Ce,2);{let Ae=u(()=>({...L(),maxZoom:12}));rd(pe,{get position(){return r(q)},get fitBoundsOptions(){return r(Ae)}})}var Me=m(pe,2);td(Me,{get position(){return r(q)}});var Te=m(Me,2);Ul(Te,{get position(){return r(q)}}),p(Fe,ke)};ve(he,Fe=>{E()&&Fe(Se)})}var xe=m(he,2);Tt(xe,()=>e.children??Pe,()=>({map:t(),loaded:x(),loadedImages:H.loadedImages,allImagesLoaded:r(oe)})),p(se,ye)};ve(le,se=>{t()&&se(fe)})}sn(ie,se=>o(se),()=>o()),lc(ie,se=>re?.(se)),J(se=>_e=St(ie,1,ml(a()),"svelte-xbukvd",_e,se),[()=>({"expand-map":!a()})]),p(n,ie),Be()}var vd=P('<div class="sv-popup"><!></div>');function Bt(n,e){Ne(e,!0);let t=W(e,"closeButton",3,void 0),o=W(e,"closeOnClickOutside",3,!0),a=W(e,"closeOnClickInside",3,!1),s=W(e,"closeOnMove",3,!1),l=W(e,"openOn",3,"click"),i=W(e,"openIfTopMost",3,!0),f=W(e,"focusAfterOpen",3,!0),v=W(e,"anchor",3,void 0),y=W(e,"offset",3,void 0),b=W(e,"popupClass",3,void 0),L=W(e,"maxWidth",3,void 0),O=W(e,"lngLat",15,void 0),M=W(e,"html",3,void 0),T=W(e,"open",15,!1),x=W(e,"onopen",3,void 0),C=W(e,"onclose",3,void 0),_=W(e,"onhover",3,void 0),D=dc();const z=u(Gr),I=u(()=>r(z).map),F=u(()=>r(z).eventTopMost),j=u(()=>r(z).markerClickManager),d=u(()=>r(z).loaded),g=fc(),h=vc(),$=gc(),w=["click","dblclick","contextmenu"];let A=we(void 0),B=we(!1),k=we(void 0);function R(){if(!r(A))return;let le=r(A).getElement();!le||le===r(k)||(X(k,le,!0),l()==="hover"&&(r(k).style.pointerEvents="none"),r(k).addEventListener("mouseenter",()=>{X(B,!0)},{passive:!0}),r(k).addEventListener("mouseleave",()=>{X(B,!1)},{passive:!0}),r(k).addEventListener("click",()=>{a()&&T(!1)},{passive:!0}))}ln(()=>{if(r(I))return r(I).on("click",K),r(I).on("contextmenu",K),r(j).add(V),typeof $?.value=="string"&&(r(I).on("click",$.value,H),r(I).on("dblclick",$.value,H),r(I).on("contextmenu",$.value,H),r(I).on("mousemove",$.value,te),r(I).on("mouseleave",$.value,Z),r(I).on("touchstart",$.value,ue),r(I).on("touchend",$.value,oe)),()=>{r(d)&&(r(A)?.remove(),r(I).off("click",K),r(I).off("contextmenu",K),r(j).remove(V),$?.value instanceof $r.Marker?$.value.getPopup()===r(A)&&$.value.setPopup(void 0):typeof $?.value=="string"&&(r(I).off("click",$.value,H),r(I).off("dblclick",$.value,H),r(I).off("contextmenu",$.value,H),r(I).off("mousemove",$.value,te),r(I).off("mouseleave",$.value,Z),r(I).off("touchstart",$.value,ue),r(I).off("touchend",$.value,oe)))}});function S(){if(e.canOpen&&!e.canOpen(r(N))){T(!1);return}T(!0)}function E(le){return i()?!("marker"in le)&&!_c(le)&&r(F)(le)!==g?.value:!1}let N=we(void 0),G=we("normal");function q(le){"layerType"in le&&le.layerType==="deckgl"?(O(le.coordinate),X(N,le.object?[le.object]:void 0,!0)):(O(le.lngLat),X(N,le.features??[],!0))}function H(le){le.type!==l()||E(le)||(q(le),setTimeout(S))}let Y;function ue(le){Y=le.point}function oe(le){if(!Y||l()!=="hover")return;let fe=Y.dist(le.point);Y=void 0,fe<3&&(O(le.lngLat),X(N,le.features??[],!0),r(A)?.isOpen()?X(G,"justOpened"):(X(G,"opening"),S()))}function Z(le){l()!=="hover"||Y||r(G)!=="normal"||(T(!1),X(N,void 0))}function te(le){if(!(l()!=="hover"||Y||r(G)!=="normal")){if(E(le)){T(!1),X(N,void 0);return}X(N,le.features??[],!0),O(le.lngLat),S()}}function K(le){if(r(G)==="justOpened"){X(G,"normal");return}if(!o())return;let fe=[r(k),$?.value instanceof $r.Marker?$.value?.getElement():void 0];T()&&r(A)?.isOpen()&&!fe.some(se=>se?.contains(le.originalEvent.target))&&(le.type==="contextmenu"&&l()==="contextmenu"||le.type!=="contextmenu")&&T(!1)}function V(le){o()&&T()&&r(A)?.isOpen()&&le.marker!==$?.value&&T(!1)}cr(()=>{r(d)&&r(A)?.isOpen()&&r(A).remove()});let ee=we(void 0),re=u(()=>t()??(!o()&&!a()));Ze(()=>{if(!r(A)){let le=b()?`${b()} sv-maplibregl-popup`:"sv-maplibregl-popup";X(A,new $r.Popup({closeButton:r(re),closeOnClick:!1,closeOnMove:s(),focusAfterOpen:f(),maxWidth:L(),className:le,anchor:v(),offset:y()}),!0),X(k,r(A).getElement(),!0),r(A).on("open",()=>{S(),T()&&(R(),x()?.(r(A)))}),r(A).on("close",()=>{T(!1),C()?.(r(A))}),_()&&r(A).on("hover",()=>{_()?.(r(A))})}}),Ze(()=>{r(A)&&$?.value instanceof $r.Marker&&(l()==="click"?$.value.setPopup(r(A)):$.value.getPopup()===r(A)&&$.value.setPopup(void 0))}),Ze(()=>{w.includes(l())&&h.value?.type===l()&&(H(h.value),h.value=void 0)});let ae=u(()=>l()==="hover"&&(h.value?.type==="mousemove"||h.value?.type==="mouseenter"));Ze(()=>{l()==="hover"&&h&&(r(ae)&&h.value&&q(h.value),r(ae)||r(B)?S():T(!1))}),Ze(()=>{r(ee)?r(A)?.setDOMContent(r(ee)):M()&&r(A)?.setHTML(M())}),Ze(()=>{let le=O()??D?.value??void 0;le&&r(A)?.setLngLat(le)}),Ze(()=>{if(r(I)&&r(A)){let le=r(A).isOpen();T()&&!le?(r(A).addTo(r(I)),r(G)==="opening"&&X(G,"justOpened")):!T()&&le&&r(A).remove()}});var ne=$e(),ie=Q(ne);{var _e=le=>{var fe=vd(),se=c(fe);{var ye=he=>{var Se=$e(),xe=Q(Se);Tt(xe,()=>e.children??Pe,()=>({features:r(N),data:r(N)?.[0]??void 0,map:r(I),close:()=>T(!1),isOpen:T()})),p(he,Se)};ve(se,he=>{(r(N)?.length||$?.value instanceof $r.Marker||!$&&T())&&he(ye)})}sn(fe,he=>X(ee,he),()=>r(ee)),p(le,fe)};ve(ie,le=>{e.children&&le(_e)})}p(n,ne),Be()}function vo(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("symbol")),o=W(e,"source",3,void 0),a=W(e,"sourceLayer",3,void 0),s=W(e,"beforeId",3,void 0),l=W(e,"beforeLayerType",3,void 0),i=W(e,"paint",3,void 0),f=W(e,"layout",3,void 0),v=W(e,"filter",3,void 0),y=W(e,"applyToClusters",3,void 0),b=W(e,"minzoom",3,void 0),L=W(e,"maxzoom",3,void 0),O=W(e,"hoverCursor",3,void 0),M=W(e,"manageHoverState",3,!1),T=W(e,"hovered",15),x=W(e,"eventsIfTopMost",3,!1),C=W(e,"interactive",3,!0),_=W(e,"children",3,void 0),D=W(e,"onclick",3,void 0),z=W(e,"ondblclick",3,void 0),I=W(e,"oncontextmenu",3,void 0),F=W(e,"onmouseenter",3,void 0),j=W(e,"onmousemove",3,void 0),d=W(e,"onmouseleave",3,void 0);fa(n,{get id(){return t()},type:"symbol",get source(){return o()},get sourceLayer(){return a()},get beforeId(){return s()},get beforeLayerType(){return l()},get paint(){return i()},get layout(){return f()},get filter(){return v()},get applyToClusters(){return y()},get minzoom(){return b()},get maxzoom(){return L()},get hoverCursor(){return O()},get manageHoverState(){return M()},get eventsIfTopMost(){return x()},get interactive(){return C()},get onclick(){return D()},get ondblclick(){return z()},get oncontextmenu(){return I()},get onmouseenter(){return F()},get onmousemove(){return j()},get onmouseleave(){return d()},get hovered(){return T()},set hovered(g){T(g)},children:(g,h)=>{var $=$e(),w=Q($);Tt(w,()=>_()??Pe),p(g,$)},$$slots:{default:!0}}),Be()}function ga(n,e){Ne(e,!0);let t=W(e,"id",19,()=>Rn("vector")),o=W(e,"url",3,void 0),a=W(e,"tiles",3,void 0),s=W(e,"promoteId",3,void 0),l=W(e,"bounds",3,void 0),i=W(e,"scheme",3,void 0),f=W(e,"attribution",3,void 0),v=W(e,"minzoom",3,void 0),y=W(e,"maxzoom",3,void 0),b=W(e,"volatile",3,void 0);if(o()&&o().includes("pmtiles://")&&!Object.hasOwn($r.config.REGISTERED_PROTOCOLS,"pmtiles")){let z=new pc;$r.addProtocol("pmtiles",z.tile)}const L=u(Gr),O=u(()=>r(L).map),M=u(()=>r(L).loaded),{source:T}=bl();let x=we(void 0);Ze(()=>{r(O)&&r(M)&&T.value!==t()&&(T.value=t(),jl(r(O),T.value,oa({type:"vector",url:o(),tiles:a(),promoteId:s(),bounds:l(),scheme:i(),attribution:f(),minzoom:v(),maxzoom:y(),volatile:b()}),z=>r(O)&&z===T.value,()=>{T.value&&X(x,r(O).getSource(T.value),!0)}))}),Ze(()=>{r(O).on("style.load",()=>{X(x,r(O).getSource(t()),!0)})}),cr(()=>{T.value&&r(O)&&(zl(r(O),T.value,r(x)),T.value=void 0,X(x,void 0))});var C=$e(),_=Q(C);{var D=z=>{var I=$e(),F=Q(I);ei(F,()=>T.value,j=>{var d=$e(),g=Q(d);Tt(g,()=>e.children??Pe),p(j,d)}),p(z,I)};ve(_,z=>{T.value&&z(D)})}p(n,C),Be()}var gd=P('<div class="form-check"><label class="form-check-label"><input class="form-check-input" type="checkbox"/> <!></label></div>');function _d(n,e){Ne(e,!0);let t=W(e,"checked",15);var o=gd(),a=c(o),s=c(a),l=m(s,2);Tt(l,()=>e.children??Pe),pn(s,t),p(n,o),Be()}var pd=P("<tr><td> </td><td> </td></tr>"),hd=P('<table class="svelte-7qv069"><tbody></tbody></table>');function ro(n,e){var t=hd(),o=c(t);Jt(o,21,()=>Object.entries(e.properties),Qt,(a,s)=>{var l=u(()=>Dr(r(s),2));let i=()=>r(l)[0],f=()=>r(l)[1];var v=pd(),y=c(v),b=c(y),L=m(y),O=c(L);J(()=>{U(b,i()),U(O,f())}),p(a,v)}),p(n,t)}var md=P('<div style="display: flex; align-items: center; gap: 6px;"><span></span> </div>'),bd=P("<div></div>");function rs(n,e){let t=W(e,"swatchClass",3,"rectangle"),o=W(e,"itemsPerRow",3,2),a=u(()=>`${100/o()}%`);var s=bd();Jt(s,21,()=>Object.entries(e.labelColors),Qt,(l,i)=>{var f=u(()=>Dr(r(i),2));let v=()=>r(f)[0],y=()=>r(f)[1];var b=md(),L=c(b);let O;var M=m(L);J(T=>{St(L,1,`color-swatch ${t()??""}`,"svelte-kgsne0"),O=fr(L,"",O,T),U(M,` ${v()??""}`)},[()=>({background:y()})]),p(l,b)}),J(()=>fr(s,`display: grid; grid-template-columns: repeat(auto-fill, calc(${r(a)??""} - 10px)); gap: 10px;`)),p(n,s)}var yd=P('<span class="bucket svelte-1twtizg">&nbsp;</span>'),Ad=P('<span class="svelte-1twtizg"> </span>'),wd=P('<div><div class="colors svelte-1twtizg"></div> <div class="labels svelte-1twtizg"></div></div>');function hr(n,e){Ne(e,!0);let t=W(e,"decimalPlaces",3,0),o=W(e,"fullWidthBucketLegend",3,!1);function a(v,y){return("limits"in v?v.limits:v.buckets).map(L=>typeof L=="number"?y>0?L.toFixed(y):L.toLocaleString():L)}var s=wd();let l;var i=c(s);Jt(i,21,()=>e.colorScale,Qt,(v,y)=>{var b=yd();J(()=>fr(b,`background: ${r(y)??""};`)),p(v,b)});var f=m(i,2);Jt(f,21,()=>a(e.labels,t()),Qt,(v,y)=>{var b=Ad(),L=c(b);J(()=>U(L,r(y))),p(v,b)}),J(v=>l=St(s,1,"svelte-1twtizg",null,l,v),[()=>({"full-width-bucket-legend":o(),bucketed:e.labels.hasOwnProperty("buckets"),limits:e.labels.hasOwnProperty("limits")})]),p(n,s),Be()}let je;const Gl=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Gl.decode();let Po=null;function Go(){return(Po===null||Po.byteLength===0)&&(Po=new Uint8Array(je.memory.buffer)),Po}function zr(n,e){return n=n>>>0,Gl.decode(Go().subarray(n,n+e))}const gn=new Array(128).fill(void 0);gn.push(void 0,null,!0,!1);let Wo=gn.length;function Zt(n){Wo===gn.length&&gn.push(gn.length+1);const e=Wo;return Wo=gn[e],gn[e]=n,e}function at(n){return gn[n]}function xd(n){n<132||(gn[n]=Wo,Wo=n)}function oo(n){const e=at(n);return xd(n),e}function ui(n){return n==null}let To=null;function $d(){return(To===null||To.byteLength===0)&&(To=new Float64Array(je.memory.buffer)),To}let Io=null;function vt(){return(Io===null||Io.byteLength===0)&&(Io=new Int32Array(je.memory.buffer)),Io}let Cn=0;const Ca=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},kd=typeof Ca.encodeInto=="function"?function(n,e){return Ca.encodeInto(n,e)}:function(n,e){const t=Ca.encode(n);return e.set(t),{read:n.length,written:t.length}};function ya(n,e,t){if(t===void 0){const i=Ca.encode(n),f=e(i.length,1)>>>0;return Go().subarray(f,f+i.length).set(i),Cn=i.length,f}let o=n.length,a=e(o,1)>>>0;const s=Go();let l=0;for(;l<o;l++){const i=n.charCodeAt(l);if(i>127)break;s[a+l]=i}if(l!==o){l!==0&&(n=n.slice(l)),a=t(a,o,o=l+n.length*3,1)>>>0;const i=Go().subarray(a+l,a+o),f=kd(n,i);l+=f.written}return Cn=l,a}function Ii(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const a=n.description;return a==null?"Symbol":`Symbol(${a})`}if(e=="function"){const a=n.name;return typeof a=="string"&&a.length>0?`Function(${a})`:"Function"}if(Array.isArray(n)){const a=n.length;let s="[";a>0&&(s+=Ii(n[0]));for(let l=1;l<a;l++)s+=", "+Ii(n[l]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let o;if(t.length>1)o=t[1];else return toString.call(n);if(o=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:o}function Sd(n,e){const t=e(n.length*1,1)>>>0;return Go().set(n,t/1),Cn=n.length,t}function ci(n,e){try{return n.apply(this,e)}catch(t){je.__wbindgen_exn_store(Zt(t))}}class za{static __wrap(e){e=e>>>0;const t=Object.create(za.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();je.__wbg_jsroutesnapper_free(e)}constructor(e){try{const s=je.__wbindgen_add_to_stack_pointer(-16),l=Sd(e,je.__wbindgen_malloc),i=Cn;je.jsroutesnapper_new(s,l,i);var t=vt()[s/4+0],o=vt()[s/4+1],a=vt()[s/4+2];if(a)throw oo(o);return za.__wrap(t)}finally{je.__wbindgen_add_to_stack_pointer(16)}}setRouteConfig(e){je.jsroutesnapper_setRouteConfig(this.__wbg_ptr,Zt(e))}setAreaMode(){je.jsroutesnapper_setAreaMode(this.__wbg_ptr)}getConfig(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_getConfig(s,this.__wbg_ptr);var o=vt()[s/4+0],a=vt()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}toFinalFeature(){try{const o=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_toFinalFeature(o,this.__wbg_ptr);var e=vt()[o/4+0],t=vt()[o/4+1];let a;return e!==0&&(a=zr(e,t).slice(),je.__wbindgen_free(e,t*1)),a}finally{je.__wbindgen_add_to_stack_pointer(16)}}renderGeojson(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_renderGeojson(s,this.__wbg_ptr);var o=vt()[s/4+0],a=vt()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}toggleSnapMode(){je.jsroutesnapper_toggleSnapMode(this.__wbg_ptr)}onMouseMove(e,t,o){return je.jsroutesnapper_onMouseMove(this.__wbg_ptr,e,t,o)!==0}onClick(){je.jsroutesnapper_onClick(this.__wbg_ptr)}onDragStart(){return je.jsroutesnapper_onDragStart(this.__wbg_ptr)!==0}onMouseUp(){return je.jsroutesnapper_onMouseUp(this.__wbg_ptr)!==0}clearState(){je.jsroutesnapper_clearState(this.__wbg_ptr)}editExisting(e){try{const a=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_editExisting(a,this.__wbg_ptr,Zt(e));var t=vt()[a/4+0],o=vt()[a/4+1];if(o)throw oo(t)}finally{je.__wbindgen_add_to_stack_pointer(16)}}debugRenderGraph(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_debugRenderGraph(s,this.__wbg_ptr);var o=vt()[s/4+0],a=vt()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}debugSnappableNodes(){let e,t;try{const s=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_debugSnappableNodes(s,this.__wbg_ptr);var o=vt()[s/4+0],a=vt()[s/4+1];return e=o,t=a,zr(o,a)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(e,t,1)}}routeNameForWaypoints(e){let t,o;try{const y=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_routeNameForWaypoints(y,this.__wbg_ptr,Zt(e));var a=vt()[y/4+0],s=vt()[y/4+1],l=vt()[y/4+2],i=vt()[y/4+3],f=a,v=s;if(i)throw f=0,v=0,oo(l);return t=f,o=v,zr(f,v)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(t,o,1)}}addSnappedWaypoint(e,t){je.jsroutesnapper_addSnappedWaypoint(this.__wbg_ptr,e,t)}undo(){je.jsroutesnapper_undo(this.__wbg_ptr)}calculateRoute(e){let t,o;try{const y=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_calculateRoute(y,this.__wbg_ptr,Zt(e));var a=vt()[y/4+0],s=vt()[y/4+1],l=vt()[y/4+2],i=vt()[y/4+3],f=a,v=s;if(i)throw f=0,v=0,oo(l);return t=f,o=v,zr(f,v)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(t,o,1)}}getExtraNodes(e,t){let o,a;try{const b=je.__wbindgen_add_to_stack_pointer(-16);je.jsroutesnapper_getExtraNodes(b,this.__wbg_ptr,Zt(e),Zt(t));var s=vt()[b/4+0],l=vt()[b/4+1],i=vt()[b/4+2],f=vt()[b/4+3],v=s,y=l;if(f)throw v=0,y=0,oo(i);return o=v,a=y,zr(v,y)}finally{je.__wbindgen_add_to_stack_pointer(16),je.__wbindgen_free(o,a,1)}}}async function Ed(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(o){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function Ld(){const n={};return n.wbg={},n.wbg.__wbindgen_string_new=function(e,t){const o=zr(e,t);return Zt(o)},n.wbg.__wbindgen_object_drop_ref=function(e){oo(e)},n.wbg.__wbindgen_error_new=function(e,t){const o=new Error(zr(e,t));return Zt(o)},n.wbg.__wbindgen_number_get=function(e,t){const o=at(t),a=typeof o=="number"?o:void 0;$d()[e/8+1]=ui(a)?0:a,vt()[e/4+0]=!ui(a)},n.wbg.__wbindgen_is_object=function(e){const t=at(e);return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return at(e)===void 0},n.wbg.__wbindgen_in=function(e,t){return at(e)in at(t)},n.wbg.__wbindgen_boolean_get=function(e){const t=at(e);return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return at(e)==at(t)},n.wbg.__wbindgen_string_get=function(e,t){const o=at(t),a=typeof o=="string"?o:void 0;var s=ui(a)?0:ya(a,je.__wbindgen_malloc,je.__wbindgen_realloc),l=Cn;vt()[e/4+1]=l,vt()[e/4+0]=s},n.wbg.__wbg_String_4370c5505c674d30=function(e,t){const o=String(at(t)),a=ya(o,je.__wbindgen_malloc,je.__wbindgen_realloc),s=Cn;vt()[e/4+1]=s,vt()[e/4+0]=a},n.wbg.__wbindgen_object_clone_ref=function(e){const t=at(e);return Zt(t)},n.wbg.__wbg_getwithrefkey_d1f0d12f1f1b63ea=function(e,t){const o=at(e)[at(t)];return Zt(o)},n.wbg.__wbg_new_abda76e883ba8a5f=function(){const e=new Error;return Zt(e)},n.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const o=at(t).stack,a=ya(o,je.__wbindgen_malloc,je.__wbindgen_realloc),s=Cn;vt()[e/4+1]=s,vt()[e/4+0]=a},n.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let o,a;try{o=e,a=t,console.error(zr(e,t))}finally{je.__wbindgen_free(o,a,1)}},n.wbg.__wbg_debug_9a6b3243fbbebb61=function(e){console.debug(at(e))},n.wbg.__wbg_error_788ae33f81d3b84b=function(e){console.error(at(e))},n.wbg.__wbg_info_2e30e8204b29d91d=function(e){console.info(at(e))},n.wbg.__wbg_log_1d3ae0273d8f4f8a=function(e){console.log(at(e))},n.wbg.__wbg_warn_d60e832f9882c1b2=function(e){console.warn(at(e))},n.wbg.__wbg_get_44be0491f933a435=function(e,t){const o=at(e)[t>>>0];return Zt(o)},n.wbg.__wbg_length_fff51ee6522a1a18=function(e){return at(e).length},n.wbg.__wbindgen_is_function=function(e){return typeof at(e)=="function"},n.wbg.__wbg_next_526fc47e980da008=function(e){const t=at(e).next;return Zt(t)},n.wbg.__wbg_next_ddb3312ca1c4e32a=function(){return ci(function(e){const t=at(e).next();return Zt(t)},arguments)},n.wbg.__wbg_done_5c1f01fb660d73b5=function(e){return at(e).done},n.wbg.__wbg_value_1695675138684bd5=function(e){const t=at(e).value;return Zt(t)},n.wbg.__wbg_iterator_97f0c81209c6c35a=function(){return Zt(Symbol.iterator)},n.wbg.__wbg_get_97b561fb56f034b5=function(){return ci(function(e,t){const o=Reflect.get(at(e),at(t));return Zt(o)},arguments)},n.wbg.__wbg_call_cb65541d95d71282=function(){return ci(function(e,t){const o=at(e).call(at(t));return Zt(o)},arguments)},n.wbg.__wbg_isArray_4c24b343cb13cfb1=function(e){return Array.isArray(at(e))},n.wbg.__wbg_instanceof_ArrayBuffer_39ac22089b74fddb=function(e){let t;try{t=at(e)instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_buffer_085ec1f694018c4f=function(e){const t=at(e).buffer;return Zt(t)},n.wbg.__wbg_new_8125e318e6245eed=function(e){const t=new Uint8Array(at(e));return Zt(t)},n.wbg.__wbg_set_5cf90238115182c3=function(e,t,o){at(e).set(at(t),o>>>0)},n.wbg.__wbg_length_72e2208bbc0efc61=function(e){return at(e).length},n.wbg.__wbg_instanceof_Uint8Array_d8d9cb2b8e8ac1d4=function(e){let t;try{t=at(e)instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbindgen_debug_string=function(e,t){const o=Ii(at(t)),a=ya(o,je.__wbindgen_malloc,je.__wbindgen_realloc),s=Cn;vt()[e/4+1]=s,vt()[e/4+0]=a},n.wbg.__wbindgen_throw=function(e,t){throw new Error(zr(e,t))},n.wbg.__wbindgen_memory=function(){const e=je.memory;return Zt(e)},n}function Cd(n,e){return je=n.exports,Wl.__wbindgen_wasm_module=e,To=null,Io=null,Po=null,je}async function Wl(n){if(je!==void 0)return je;typeof n>"u"&&(n=new URL("/ltn/assets/route_snapper_bg-CaN5p6v7.wasm",import.meta.url));const e=Ld();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:o}=await Ed(await n,e);return Cd(t,o)}const Md=30;class Pd{constructor(e,t,o,a,s){this.onMouseMove=l=>{if(!this.active)return;const i=[l.point.x-Md,l.point.y],f=this.map.unproject(l.point).distanceTo(this.map.unproject(i));this.inner.onMouseMove(l.lngLat.lng,l.lngLat.lat,f)&&(this.redraw(),this.dataUpdated())},this.onClick=()=>{this.active&&(this.inner.onClick(),this.redraw(),this.dataUpdated())},this.onDoubleClick=l=>{this.active&&(l.preventDefault(),this.inner.onClick(),this.finish())},this.onDragStart=()=>{this.active&&this.inner.onDragStart()&&this.map.dragPan.disable()},this.onMouseUp=()=>{this.active&&this.inner.onMouseUp()&&this.map.dragPan.enable()},this.onKeyDown=l=>{if(!this.active)return;let i=l.target.tagName;i=="INPUT"||i=="TEXTAREA"||l.key=="Escape"&&(l.stopPropagation(),this.cancel())},this.onKeyPress=l=>{if(!this.active)return;let i=l.target.tagName;i=="INPUT"||i=="TEXTAREA"||(l.key=="Enter"?(l.stopPropagation(),this.finish()):l.key=="s"||l.key=="S"?(l.stopPropagation(),this.inner.toggleSnapMode(),this.redraw()):l.key=="z"&&l.ctrlKey&&this.undo())},this.map=e,console.time("Deserialize and setup JsRouteSnapper"),this.inner=new za(t),console.timeEnd("Deserialize and setup JsRouteSnapper"),this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.routeToolGj=o,this.snapMode=a,this.undoLength=s,this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("dragstart",this.onDragStart),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keypress",this.onKeyPress)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("dragstart",this.onDragStart),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keypress",this.onKeyPress)}startRoute(){this.active||(this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}startArea(){this.active||(this.inner.setAreaMode(),this.active=!0,this.map.boxZoom.disable(),this.map.doubleClickZoom.disable())}stop(){this.active=!1,this.inner.clearState(),this.redraw(),this.map.boxZoom.enable(),this.map.doubleClickZoom.enable()}editExistingRoute(e){this.active&&window.alert("Bug: editExistingRoute called when tool is already active"),e.properties.waypoints||(e.properties.waypoints=[{lon:e.geometry.coordinates[0][0],lat:e.geometry.coordinates[0][1],snapped:!0},{lon:e.geometry.coordinates[e.geometry.coordinates.length-1][0],lat:e.geometry.coordinates[e.geometry.coordinates.length-1][1],snapped:!0}]),this.startRoute(),this.inner.editExisting(e.properties.waypoints),this.redraw()}editExistingArea(e){this.active&&window.alert("Bug: editExistingArea called when tool is already active"),e.properties.waypoints||window.alert("Bug: editExistingArea called for a polygon not produced by the route-snapper"),this.startArea(),this.inner.editExisting(e.properties.waypoints),this.redraw()}addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}isActive(){return this.active}finish(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersSuccess)t(JSON.parse(e));else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){this.inner.clearState(),this.finish()}setRouteConfig(e){this.inner.setRouteConfig(e),this.redraw()}addSnappedWaypoint(e){this.inner.addSnappedWaypoint(e[0],e[1]),this.redraw()}undo(){this.inner.undo(),this.redraw()}toggleSnapMode(){this.inner.toggleSnapMode(),this.redraw()}redraw(){let e=JSON.parse(this.inner.renderGeojson());this.routeToolGj.set(e),this.map.getCanvas().style.cursor=e.cursor,this.snapMode.set(e.snap_mode),this.undoLength.set(e.undo_length)}dataUpdated(){let e=this.inner.toFinalFeature();if(e)for(let t of this.eventListenersUpdated)t(JSON.parse(e))}}function Td(n){const e=()=>be(hc,"$interactiveMapLayersEnabled",t),[t,o]=ut();let a={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]}};lt(n,{get data(){return a},children:(s,l)=>{{let i=yl(()=>({visibility:e()?"none":"visible"}));ur(s,{paint:{"fill-color":"black","fill-opacity":0},get layout(){return r(i)}})}},$$slots:{default:!0}}),o()}var Id=P('<span class="dot svelte-1j0tfn0"><!></span>'),Rd=P('<span class="dot svelte-1j0tfn0"><!></span>');function Yn(n,e){Ne(e,!0);let t=W(e,"lngLat",15),o=W(e,"draggable",3,!1);var a=$e(),s=Q(a);{var l=f=>{fo(f,{draggable:!0,get lngLat(){return t()},set lngLat(v){t(v)},children:(v,y)=>{var b=Id(),L=c(b);Tt(L,()=>e.children),p(v,b)},$$slots:{default:!0}})},i=f=>{fo(f,{get lngLat(){return t()},children:(v,y)=>{var b=Rd(),L=c(b);Tt(L,()=>e.children),p(v,b)},$$slots:{default:!0}})};ve(s,f=>{o()?f(l):f(i,!1)})}p(n,a),Be()}var Nd=P("<progress></progress>"),Bd=P('<progress max="100"></progress>'),Fd=P("<div><!></div>"),Od=P('<div class="cover svelte-1lcxh3p"><div class="background svelte-1lcxh3p"> <!></div></div>');function go(n,e){Ne(e,!0);let t=W(e,"progress",3,null),o=we(void 0),a=we(void 0);Ze(()=>{if(e.loading&&!r(o))X(o,Date.now(),!0),X(a,e.loading,!0);else if(!e.loading&&r(o)){const f=Date.now()-r(o);console.log(`Loading "${r(a)}" took ${f}ms`),X(o,void 0)}});var s=$e(),l=Q(s);{var i=f=>{var v=Od(),y=c(v),b=c(y),L=m(b);{var O=M=>{var T=Fd(),x=c(T);{var C=D=>{var z=Nd();fr(z,"",{},{width:"100%"}),p(D,z)},_=D=>{var z=Bd();fr(z,"",{},{width:"100%"}),J(()=>mc(z,t())),p(D,z)};ve(x,D=>{t()==100?D(C):D(_,!1)})}p(M,T)};ve(L,M=>{t()!=null&&M(O)})}J(()=>U(b,`${e.loading??""} `)),p(f,v)};ve(l,f=>{e.loading&&f(i)})}p(n,s),Be()}function mr(n){switch(n){case"title":return"Choose project";case"new-project":return"New project";case"pick-neighbourhood":return Jr(Al)?.project_name||"Pick neighbourhood";case"set-boundary":return"Adjust boundary";case"add-neighbourhood":return"Add a neighbourhood";case"neighbourhood":return Jr(so)||"Editing";case"view-shortcuts":return"Shortcuts";case"impact-one-destination":return"Impact on one destination";case"route":return"Route";case"predict-impact":return"Predict impact";case"impact-detail":return"Impact detail";case"debug-intersections":return"Debug intersections";case"debug-neighbourhood":return"Debug neighbourhood";case"debug-demand":return"Explore origin/destination demand data"}}var jd=P('<span class="page-title svelte-tym4cg"> </span>');function et(n,e){Ne(e,!0);const[t,o]=ut();let a=W(e,"children",3,void 0);da(n,{onclick:()=>Ve(yt,e.mode),children:(s,l)=>{var i=$e(),f=Q(i);{var v=b=>{var L=$e(),O=Q(L);Tt(O,a),p(b,L)},y=b=>{var L=jd(),O=c(L);J(M=>U(O,M),[()=>mr(e.mode.mode)]),p(b,L)};ve(f,b=>{a()?b(v):b(y,!1)})}p(s,i)}}),Be(),o()}function We(n,e=!0){return{id:n,beforeId:Hl(n),eventsIfTopMost:e}}function Hl(n){let e=Jr(Vr);if(!e){console.warn(`getBeforeId(${n}) called before map is ready. Z-ordering may be incorrect.`);return}let t,o=!1;for(let a=Da.length-1;a>=0;a--){let s=Da[a];if(s==n){o=!0;break}e.getLayer(s)&&(t=s)}if(!o)throw new Error(`Layer ID ${n} not defined in layerZorder`);return t}let di=n=>n,fi=n=>n;const Da=[di(fi("Background")),"neighbourhood-boundaries",di("Ferry line"),"neighbourhood-boundaries-outline","neighbourhood-boundaries-selected-outline-base","neighbourhood-boundaries-selected-outline","debug-borders","debug-filters","cells","before-edits-cells","interior-roads-outlines","before-edits-interior-roads-outlines","interior-roads","before-edits-interior-roads","main-roads-outlines","before-edits-main-roads-outlines","main-roads","before-edits-main-roads","turn-restriction-targets","debug-intersections","debug-movements-outline","debug-movements-fill","debug-editable-intersections","editable-intersections","intersection-filters","before-edits-intersection-filters","border-entries","before-edits-border-entries","compare-route","shortcuts","shortcuts-focus","predict-impact-outline","predict-impact",fi("Building"),"draw-area-lines","draw-area-area","draw-area-lines-preview","draw-route-lines","draw-route-preview","debug-demand-fill","debug-demand-outline","one-ways","before-edits-one-ways","context-population-car-ownership","context-simd","context-population-density","context-population-outline","context-traffic","context-los","context-existing-infra","context-route-network","context-bus-routes","context-pois","context-railway-stations","context-stats19-heatmap","context-stats19-points",fi("Road labels"),di("road_label"),"animate-shortcuts","modal-filters","before-edits-modal-filters","turn-restrictions","before-edits-turn-restrictions","turn-restrictions-debug-arrows","before-edits-turn-restrictions-debug-arrows","boundary","neighbourhood-boundary","freehand-line","edit-polygon-fill","edit-polygon-lines","edit-polygon-vertices"];function zd(){let n=Jr(Vr);if(!n)return;let e=["Background","Ferry line","Building","Road labels","road_label"];for(let t=Da.length-1;t>=0;t--){let o=Da[t];if(e.includes(o)||!n.getLayer(o))continue;let a=Hl(o);a&&n.moveLayer(o,a)}}var Dd=P('<a href="https://wiki.openstreetmap.org/wiki/Tag:route%3Dbus" target="_blank"> </a>'),Ud=P("<p><!></p>"),Gd=P("<!> <!>",1);function Wd(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=we(!1);var a=Gd(),s=Q(a);{const i=v=>{var y=Ud();{const L=(O,M=Pe)=>{var T=Dd(),x=c(T);J(C=>U(x,C),[()=>r(t).tx(M())]),p(O,T)};var b=c(y);{let O=u(()=>[L]),M=u(()=>r(t).cx(186));me(b,{get t(){return r(O)},get x(){return r(M)}})}}p(v,y)};let f=u(()=>r(t).t(185));Pr(s,{get label(){return r(f)},get show(){return r(o)},set show(v){X(o,v,!0)},help:i,$$slots:{help:!0}})}var l=m(s,2);{let i=u(()=>`pmtiles://${Qr("cnt/layers/bus_routes.pmtiles")}`);ga(l,{get url(){return r(i)},children:(f,v)=>{{let y=u(()=>We("context-bus-routes")),b=u(()=>({"line-color":"blue","line-width":lo(0)})),L=u(()=>({visibility:r(o)?"visible":"none"}));gt(f,Le(()=>r(y),{sourceLayer:"bus_routes",get paint(){return r(b)},get layout(){return r(L)}}))}},$$slots:{default:!0}})}p(n,a),Be()}var Er=63710088e-1,ql={centimeters:Er*100,centimetres:Er*100,degrees:360/(2*Math.PI),feet:Er*3.28084,inches:Er*39.37,kilometers:Er/1e3,kilometres:Er/1e3,meters:Er,metres:Er,miles:Er/1609.344,millimeters:Er*1e3,millimetres:Er*1e3,nauticalmiles:Er/1852,radians:1,yards:Er*1.0936};function Ri(n,e,t={}){const o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=e||{},o.geometry=n,o}function Vn(n,e,t={}){if(!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ks(n[0])||!ks(n[1]))throw new Error("coordinates must contain numbers");return Ri({type:"Point",coordinates:n},e,t)}function Hd(n,e="kilometers"){const t=ql[e];if(!t)throw new Error(e+" units is invalid");return n*t}function qd(n,e="kilometers"){const t=ql[e];if(!t)throw new Error(e+" units is invalid");return n/t}function aa(n){return n%(2*Math.PI)*180/Math.PI}function Mr(n){return n%360*Math.PI/180}function ks(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}var Jd=Object.defineProperty,Jl=n=>{throw TypeError(n)},Qd=(n,e,t)=>e in n?Jd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ze=(n,e,t)=>Qd(n,typeof e!="symbol"?e+"":e,t),Ql=(n,e,t)=>e.has(n)||Jl("Cannot "+t),Yt=(n,e,t)=>(Ql(n,e,"read from private field"),e.get(n)),vi=(n,e,t)=>e.has(n)?Jl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Aa=(n,e,t,o)=>(Ql(n,e,"write to private field"),e.set(n,t),t);function Ut(){}function Zd(n,e){for(const t in e)n[t]=e[t];return n}function Zl(n){return n()}function Ss(){return Object.create(null)}function $n(n){n.forEach(Zl)}function Vl(n){return typeof n=="function"}function Nn(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let wa;function vr(n,e){return n===e?!0:(wa||(wa=document.createElement("a")),wa.href=e,n===wa.href)}function Vd(n){return Object.keys(n).length===0}function Kd(n,e,t,o){if(n){const a=Kl(n,e,t,o);return n[0](a)}}function Kl(n,e,t,o){return n[1]&&o?Zd(t.ctx.slice(),n[1](o(e))):t.ctx}function Xd(n,e,t,o){return n[2],e.dirty}function Yd(n,e,t,o,a,s){if(a){const l=Kl(e,t,o,s);n.p(l,a)}}function ef(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let o=0;o<t;o++)e[o]=-1;return e}return-1}function Ua(n){return n??""}function pt(n,e){n.appendChild(e)}function Ft(n,e,t){n.insertBefore(e,t||null)}function Rt(n){n.parentNode&&n.parentNode.removeChild(n)}function Ct(n){return document.createElement(n)}function Zr(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Tn(n){return document.createTextNode(n)}function Cr(){return Tn(" ")}function tf(){return Tn("")}function ir(n,e,t,o){return n.addEventListener(e,t,o),()=>n.removeEventListener(e,t,o)}function rf(n){return function(e){return e.preventDefault(),n.call(this,e)}}function de(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function nf(n){return Array.from(n.childNodes)}function ia(n,e){e=""+e,n.data!==e&&(n.data=e)}function Es(n,e){n.value=e??""}function on(n,e,t){n.classList.toggle(e,!!t)}function of(n,e,{bubbles:t=!1,cancelable:o=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:o})}let sa;function Ho(n){sa=n}function Xl(){if(!sa)throw new Error("Function called outside component initialization");return sa}function af(n){Xl().$$.on_destroy.push(n)}function Yl(){const n=Xl();return(e,t,{cancelable:o=!1}={})=>{const a=n.$$.callbacks[e];if(a){const s=of(e,t,{cancelable:o});return a.slice().forEach(l=>{l.call(n,s)}),!s.defaultPrevented}return!0}}function sf(n,e){const t=n.$$.callbacks[e.type];t&&t.slice().forEach(o=>o.call(this,e))}const ao=[],Ni=[];let uo=[];const Ls=[],lf=Promise.resolve();let Bi=!1;function uf(){Bi||(Bi=!0,lf.then(eu))}function Fi(n){uo.push(n)}const gi=new Set;let no=0;function eu(){if(no!==0)return;const n=sa;do{try{for(;no<ao.length;){const e=ao[no];no++,Ho(e),cf(e.$$)}}catch(e){throw ao.length=0,no=0,e}for(Ho(null),ao.length=0,no=0;Ni.length;)Ni.pop()();for(let e=0;e<uo.length;e+=1){const t=uo[e];gi.has(t)||(gi.add(t),t())}uo.length=0}while(ao.length);for(;Ls.length;)Ls.pop()();Bi=!1,gi.clear(),Ho(n)}function cf(n){if(n.fragment!==null){n.update(),$n(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Fi)}}function df(n){const e=[],t=[];uo.forEach(o=>n.indexOf(o)===-1?e.push(o):t.push(o)),t.forEach(o=>o()),uo=e}const Ma=new Set;let Kn;function Ro(){Kn={r:0,c:[],p:Kn}}function No(){Kn.r||$n(Kn.c),Kn=Kn.p}function Wt(n,e){n&&n.i&&(Ma.delete(n),n.i(e))}function rr(n,e,t,o){if(n&&n.o){if(Ma.has(n))return;Ma.add(n),Kn.c.push(()=>{Ma.delete(n),o&&(t&&n.d(1),o())}),n.o(e)}else o&&o()}function Cs(n){return n?.length!==void 0?n:Array.from(n)}function ff(n,e){rr(n,1,1,()=>{e.delete(n.key)})}function vf(n,e,t,o,a,s,l,i,f,v,y,b){let L=n.length,O=s.length,M=L;const T={};for(;M--;)T[n[M].key]=M;const x=[],C=new Map,_=new Map,D=[];for(M=O;M--;){const j=b(a,s,M),d=t(j);let g=l.get(d);g?D.push(()=>g.p(j,e)):(g=v(d,j),g.c()),C.set(d,x[M]=g),d in T&&_.set(d,Math.abs(M-T[d]))}const z=new Set,I=new Set;function F(j){Wt(j,1),j.m(i,y),l.set(j.key,j),y=j.first,O--}for(;L&&O;){const j=x[O-1],d=n[L-1],g=j.key,h=d.key;j===d?(y=j.first,L--,O--):C.has(h)?!l.has(g)||z.has(g)?F(j):I.has(h)?L--:_.get(g)>_.get(h)?(I.add(g),F(j)):(z.add(h),L--):(f(d,l),L--)}for(;L--;){const j=n[L];C.has(j.key)||f(j,l)}for(;O;)F(x[O-1]);return $n(D),x}function In(n){n&&n.c()}function An(n,e,t){const{fragment:o,after_update:a}=n.$$;o&&o.m(e,t),Fi(()=>{const s=n.$$.on_mount.map(Zl).filter(Vl);n.$$.on_destroy?n.$$.on_destroy.push(...s):$n(s),n.$$.on_mount=[]}),a.forEach(Fi)}function wn(n,e){const t=n.$$;t.fragment!==null&&(df(t.after_update),$n(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function gf(n,e){n.$$.dirty[0]===-1&&(ao.push(n),uf(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Bn(n,e,t,o,a,s,l=null,i=[-1]){const f=sa;Ho(n);const v=n.$$={fragment:null,ctx:[],props:s,update:Ut,not_equal:a,bound:Ss(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Ss(),dirty:i,skip_bound:!1,root:e.target||f.$$.root};l&&l(v.root);let y=!1;if(v.ctx=t?t(n,e.props||{},(b,L,...O)=>{const M=O.length?O[0]:L;return v.ctx&&a(v.ctx[b],v.ctx[b]=M)&&(!v.skip_bound&&v.bound[b]&&v.bound[b](M),y&&gf(n,b)),L}):[],v.update(),y=!0,$n(v.before_update),v.fragment=o?o(v.ctx):!1,e.target){if(e.hydrate){const b=nf(e.target);v.fragment&&v.fragment.l(b),b.forEach(Rt)}else v.fragment&&v.fragment.c();e.intro&&Wt(n.$$.fragment),An(n,e.target,e.anchor),eu()}Ho(f)}class Fn{constructor(){ze(this,"$$"),ze(this,"$$set")}$destroy(){wn(this,1),this.$destroy=Ut}$on(e,t){if(!Vl(t))return Ut;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(t),()=>{const a=o.indexOf(t);a!==-1&&o.splice(a,1)}}$set(e){this.$$set&&!Vd(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const _f="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(_f);function pf(n){let e,t;return{c(){e=Zr("svg"),t=Zr("path"),de(t,"d","M13.12.706a.982.982 0 0 0-1.391 0L6.907 5.517 2.087.696a.982.982 0 1 0-1.391 1.39l4.821 4.821L.696 11.73a.982.982 0 1 0 1.39 1.39l4.821-4.821 4.822 4.821a.982.982 0 1 0 1.39-1.39L8.298 6.908l4.821-4.822a.988.988 0 0 0 0-1.38Z"),de(e,"viewBox","0 0 14 14"),de(e,"width","13"),de(e,"height","13"),de(e,"class","svelte-en2qvf")},m(o,a){Ft(o,e,a),pt(e,t)},p:Ut,i:Ut,o:Ut,d(o){o&&Rt(e)}}}class tu extends Fn{constructor(e){super(),Bn(this,e,null,pf,Nn,{})}}function hf(n){let e,t;return{c(){e=Zr("svg"),t=Zr("path"),de(t,"d","M15 0C6.705 0 0 6.705 0 15C0 23.295 6.705 30 15 30C23.295 30 30 23.295 30 15C30 6.705 23.295 0 15 0ZM22.5 20.385L20.385 22.5L15 17.115L9.615 22.5L7.5 20.385L12.885 15L7.5 9.615L9.615 7.5L15 12.885L20.385 7.5L22.5 9.615L17.115 15L22.5 20.385Z"),de(e,"viewBox","0 0 30 30"),de(e,"fill","none"),de(e,"xmlns","http://www.w3.org/2000/svg"),de(e,"class","svelte-d2loi5")},m(o,a){Ft(o,e,a),pt(e,t)},p:Ut,i:Ut,o:Ut,d(o){o&&Rt(e)}}}class ru extends Fn{constructor(e){super(),Bn(this,e,null,hf,Nn,{})}}function mf(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"area.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"area.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function bf(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"reverse.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"reverse.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function yf(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"poi.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"poi.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function Af(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"postal_code.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"postal_code.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function wf(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"street.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"street.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function xf(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"road.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"road.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function $f(n){let e,t;return{c(){e=Ct("img"),vr(e.src,t=n[3]+"housenumber.svg")||de(e,"src",t),de(e,"alt",n[7]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(o,a){Ft(o,e,a)},p(o,a){a&8&&!vr(e.src,t=o[3]+"housenumber.svg")&&de(e,"src",t),a&128&&de(e,"alt",o[7]),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function kf(n){let e,t,o,a;return{c(){e=Ct("img"),vr(e.src,t=n[5])||de(e,"src",t),de(e,"alt",n[4]),de(e,"title",n[7]),de(e,"class","svelte-w9y5n9")},m(s,l){Ft(s,e,l),o||(a=ir(e,"error",n[14]),o=!0)},p(s,l){l&32&&!vr(e.src,t=s[5])&&de(e,"src",t),l&16&&de(e,"alt",s[4]),l&128&&de(e,"title",s[7])},d(s){s&&Rt(e),o=!1,a()}}}function Sf(n){let e,t;return{c(){e=Ct("div"),de(e,"class","sprite-icon svelte-w9y5n9"),de(e,"style",t=`
        width: ${n[6].width/Br}px;
        height: ${n[6].height/Br}px;
        background-image: url(${n[3]}sprite${Oi}.png);
        background-position: -${n[6].x/Br}px -${n[6].y/Br}px;
        background-size: ${nn.width/Br}px ${nn.height/Br}px;
      `),de(e,"title",n[7])},m(o,a){Ft(o,e,a)},p(o,a){a&72&&t!==(t=`
        width: ${o[6].width/Br}px;
        height: ${o[6].height/Br}px;
        background-image: url(${o[3]}sprite${Oi}.png);
        background-position: -${o[6].x/Br}px -${o[6].y/Br}px;
        background-size: ${nn.width/Br}px ${nn.height/Br}px;
      `)&&de(e,"style",t),a&128&&de(e,"title",o[7])},d(o){o&&Rt(e)}}}function Ms(n){let e,t;return{c(){e=Ct("span"),t=Tn(n[7]),de(e,"class","secondary svelte-w9y5n9")},m(o,a){Ft(o,e,a),pt(e,t)},p(o,a){a&128&&ia(t,o[7])},d(o){o&&Rt(e)}}}function Ef(n){let e,t,o,a,s,l,i,f,v,y=(n[8]?n[0].place_name:n[0].place_name.replace(/,.*/,""))+"",b,L,O=n[2]==="always"||n[2]!=="never"&&!n[0].address&&!n[0].id.startsWith("road.")&&!n[0].id.startsWith("address.")&&!n[0].id.startsWith("postal_code.")&&(!n[0].id.startsWith("poi.")||!n[5])&&!n[8],M,T,x=(n[8]?"":n[0].place_name.replace(/[^,]*,?\s*/,""))+"",C,_,D,z,I,F;function j($,w){return w&1&&(t=null),w&1&&(o=null),w&1&&(a=null),w&1&&(s=null),nn&&$[6]?Sf:$[5]?kf:$[0].address?$f:(t==null&&(t=!!$[0].id.startsWith("road.")),t?xf:(o==null&&(o=!!$[0].id.startsWith("address.")),o?wf:(a==null&&(a=!!$[0].id.startsWith("postal_code.")),a?Af:(s==null&&(s=!!$[0].id.startsWith("poi.")),s?yf:$[8]?bf:mf))))}let d=j(n,-1),g=d(n),h=O&&Ms(n);return{c(){e=Ct("li"),g.c(),l=Cr(),i=Ct("span"),f=Ct("span"),v=Ct("span"),b=Tn(y),L=Cr(),h&&h.c(),M=Cr(),T=Ct("span"),C=Tn(x),de(v,"class","primary svelte-w9y5n9"),de(f,"class","svelte-w9y5n9"),de(T,"class","line2 svelte-w9y5n9"),de(i,"class","texts svelte-w9y5n9"),de(e,"tabindex","-1"),de(e,"role","option"),de(e,"aria-selected",_=n[1]==="selected"),de(e,"aria-checked",D=n[1]==="picked"),de(e,"class",z=Ua(n[1])+" svelte-w9y5n9")},m($,w){Ft($,e,w),g.m(e,null),pt(e,l),pt(e,i),pt(i,f),pt(f,v),pt(v,b),pt(f,L),h&&h.m(f,null),pt(i,M),pt(i,T),pt(T,C),I||(F=[ir(e,"mouseenter",n[13]),ir(e,"focus",n[15]),ir(e,"click",n[16])],I=!0)},p($,[w]){d===(d=j($,w))&&g?g.p($,w):(g.d(1),g=d($),g&&(g.c(),g.m(e,l))),w&257&&y!==(y=($[8]?$[0].place_name:$[0].place_name.replace(/,.*/,""))+"")&&ia(b,y),w&293&&(O=$[2]==="always"||$[2]!=="never"&&!$[0].address&&!$[0].id.startsWith("road.")&&!$[0].id.startsWith("address.")&&!$[0].id.startsWith("postal_code.")&&(!$[0].id.startsWith("poi.")||!$[5])&&!$[8]),O?h?h.p($,w):(h=Ms($),h.c(),h.m(f,null)):h&&(h.d(1),h=null),w&257&&x!==(x=($[8]?"":$[0].place_name.replace(/[^,]*,?\s*/,""))+"")&&ia(C,x),w&2&&_!==(_=$[1]==="selected")&&de(e,"aria-selected",_),w&2&&D!==(D=$[1]==="picked")&&de(e,"aria-checked",D),w&2&&z!==(z=Ua($[1])+" svelte-w9y5n9")&&de(e,"class",z)},i:Ut,o:Ut,d($){$&&Rt(e),g.d(),h&&h.d(),I=!1,$n(F)}}}const nu=typeof devicePixelRatio>"u"?1:devicePixelRatio>1.25,Oi=nu?"@2x":"",Br=nu?2:1;let nn,xa;function Lf(n,e,t){let o,a,s,{feature:l}=e,{style:i="default"}=e,{showPlaceType:f}=e,{missingIconsCache:v}=e,{iconsBaseUrl:y}=e;const b=Yl();let L,O,M,T;function x(){xa??(xa=fetch(`${y}sprite${Oi}.json`).then(d=>d.json()).then(d=>{nn=d}).catch(()=>{nn=null}))}function C(){O&&v.add(O),_()}function _(){nn!==void 0?D():(x(),xa?.then(D))}function D(){do{if(T--,t(4,L=o?.[T]),t(6,M=L?nn?.icons[L]:void 0),M)break;t(5,O=L?y+L.replace(/ /g,"_")+".svg":void 0)}while(T>-1&&(!O||v.has(O)))}function z(d){sf.call(this,n,d)}const I=()=>C(),F=()=>b("select",void 0),j=d=>{document.activeElement!==d.target&&b("select",void 0)};return n.$$set=d=>{"feature"in d&&t(0,l=d.feature),"style"in d&&t(1,i=d.style),"showPlaceType"in d&&t(2,f=d.showPlaceType),"missingIconsCache"in d&&t(11,v=d.missingIconsCache),"iconsBaseUrl"in d&&t(3,y=d.iconsBaseUrl)},n.$$.update=()=>{var d,g,h,$,w;n.$$.dirty&1&&t(12,o=(d=l.properties)==null?void 0:d.categories),n.$$.dirty&1&&t(8,a=l.place_type[0]==="reverse"),n.$$.dirty&1&&t(7,s=((h=(g=l.properties)==null?void 0:g.categories)==null?void 0:h.join(", "))??((w=($=l.properties)==null?void 0:$.place_type_name)==null?void 0:w[0])??l.place_type[0]),n.$$.dirty&4096&&(T=o?.length??0,_())},[l,i,f,y,L,O,M,s,a,b,C,v,o,z,I,F,j]}class Cf extends Fn{constructor(e){super(),Bn(this,e,Lf,Ef,Nn,{feature:0,style:1,showPlaceType:2,missingIconsCache:11,iconsBaseUrl:3})}}function Mf(n){let e;return{c(){e=Ct("div"),e.innerHTML='<svg viewBox="0 0 18 18" width="24" height="24" class="loading-icon svelte-1ocfouu"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"></path><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"></path></svg>',de(e,"class","svelte-1ocfouu")},m(t,o){Ft(t,e,o)},p:Ut,i:Ut,o:Ut,d(t){t&&Rt(e)}}}class Pf extends Fn{constructor(e){super(),Bn(this,e,null,Mf,Nn,{})}}function Tf(n){let e,t,o;return{c(){e=Zr("svg"),t=Zr("path"),de(t,"stroke-width","4"),de(t,"d","M 5,33.103579 C 5,17.607779 18.457,5 35,5 C 51.543,5 65,17.607779 65,33.103579 C 65,56.388679 40.4668,76.048179 36.6112,79.137779 C 36.3714,79.329879 36.2116,79.457979 36.1427,79.518879 C 35.8203,79.800879 35.4102,79.942779 35,79.942779 C 34.5899,79.942779 34.1797,79.800879 33.8575,79.518879 C 33.7886,79.457979 33.6289,79.330079 33.3893,79.138079 C 29.5346,76.049279 5,56.389379 5,33.103579 Z M 35.0001,49.386379 C 43.1917,49.386379 49.8323,42.646079 49.8323,34.331379 C 49.8323,26.016779 43.1917,19.276479 35.0001,19.276479 C 26.8085,19.276479 20.1679,26.016779 20.1679,34.331379 C 20.1679,42.646079 26.8085,49.386379 35.0001,49.386379 Z"),de(t,"class","svelte-gzo3ar"),de(e,"width",o=n[0]==="list"?20:void 0),de(e,"viewBox","0 0 70 85"),de(e,"fill","none"),de(e,"class","svelte-gzo3ar"),on(e,"in-map",n[0]!=="list"),on(e,"list-icon",n[0]==="list")},m(a,s){Ft(a,e,s),pt(e,t)},p(a,[s]){s&1&&o!==(o=a[0]==="list"?20:void 0)&&de(e,"width",o),s&1&&on(e,"in-map",a[0]!=="list"),s&1&&on(e,"list-icon",a[0]==="list")},i:Ut,o:Ut,d(a){a&&Rt(e)}}}function If(n,e,t){let{displayIn:o}=e;return n.$$set=a=>{"displayIn"in a&&t(0,o=a.displayIn)},[o]}class Rf extends Fn{constructor(e){super(),Bn(this,e,If,Tf,Nn,{displayIn:0})}}function Nf(n){let e,t;return{c(){e=Zr("svg"),t=Zr("path"),de(t,"d","M30.003-26.765C13.46-26.765 0-14.158 0 1.337c0 23.286 24.535 42.952 28.39 46.04.24.192.402.316.471.376.323.282.732.424 1.142.424.41 0 .82-.142 1.142-.424.068-.06.231-.183.471-.376 3.856-3.09 28.39-22.754 28.39-46.04 0-15.495-13.46-28.102-30.003-28.102Zm1.757 12.469c4.38 0 7.858 1.052 10.431 3.158 2.595 2.105 3.89 4.913 3.89 8.422 0 2.34-.53 4.362-1.593 6.063-1.063 1.702-3.086 3.616-6.063 5.742-2.042 1.51-3.337 2.659-3.89 3.446-.532.787-.8 1.82-.8 3.096v1.914h-8.449V15.18c0-2.041.434-3.815 1.306-5.325.872-1.51 2.467-3.118 4.785-4.82 2.233-1.594 3.7-2.89 4.402-3.889a5.582 5.582 0 0 0 1.087-3.35c0-1.382-.51-2.435-1.531-3.158-1.02-.723-2.45-1.087-4.28-1.087-3.19 0-6.826 1.047-10.91 3.131l-3.472-6.986c4.742-2.659 9.77-3.992 15.087-3.992Zm-1.88 37.324c1.765 0 3.124.472 4.08 1.408.98.936 1.47 2.276 1.47 4.02 0 1.68-.49 3.007-1.47 3.985-.977.957-2.336 1.435-4.08 1.435-1.787 0-3.171-.465-4.15-1.4-.978-.958-1.47-2.298-1.47-4.02 0-1.787.48-3.14 1.436-4.054.957-.915 2.355-1.374 4.184-1.374Z"),de(e,"viewBox","0 0 60.006 21.412"),de(e,"width","14"),de(e,"height","20"),de(e,"class","svelte-en2qvf")},m(o,a){Ft(o,e,a),pt(e,t)},p:Ut,i:Ut,o:Ut,d(o){o&&Rt(e)}}}class Bf extends Fn{constructor(e){super(),Bn(this,e,null,Nf,Nn,{})}}function Ff(n){let e,t,o;return{c(){e=Zr("svg"),t=Zr("circle"),o=Zr("path"),de(t,"cx","4.789"),de(t,"cy","4.787"),de(t,"r","3.85"),de(t,"class","svelte-1aq105l"),de(o,"d","M12.063 12.063 7.635 7.635"),de(o,"class","svelte-1aq105l"),de(e,"xmlns","http://www.w3.org/2000/svg"),de(e,"width","13"),de(e,"height","13"),de(e,"viewBox","0 0 13 13"),de(e,"class","svelte-1aq105l")},m(a,s){Ft(a,e,s),pt(e,t),pt(e,o)},p:Ut,i:Ut,o:Ut,d(a){a&&Rt(e)}}}class Of extends Fn{constructor(e){super(),Bn(this,e,null,Ff,Nn,{})}}function jf(n,e,t){const o=e[1],a=e[0],s=o-a;return n===o&&t?n:((n-a)%s+s)%s+a}function Ga(n){const e=[...n];return e[2]<e[0]&&(Math.abs((e[0]+e[2]+360)/2)>Math.abs((e[0]-360+e[2])/2)?e[0]-=360:e[2]+=360),e}let Eo;async function zf(n,e,t){const o=n?.getCenterAndZoom();for(const a of e??[])if(!(o&&(a.minZoom!=null&&a.minZoom>o[0]||a.maxZoom!=null&&a.maxZoom<o[0]))){if(a.type==="fixed")return a.coordinates.join(",");e:if(a.type==="client-geolocation"){if(Eo&&a.cachedLocationExpiry&&Eo.time+a.cachedLocationExpiry>Date.now()){if(!Eo.coords)break e;return Eo.coords}let s;try{return s=await new Promise((l,i)=>{t.signal.addEventListener("abort",()=>{i(Error("aborted"))}),navigator.geolocation.getCurrentPosition(f=>{l([f.coords.longitude,f.coords.latitude].map(v=>v.toFixed(6)).join(","))},f=>{i(f)},a)}),s}catch{}finally{a.cachedLocationExpiry&&(Eo={time:Date.now(),coords:s})}if(t.signal.aborted)return}if(a.type==="server-geolocation")return"ip";if(o&&a.type==="map-center")return o[1].toFixed(6)+","+o[2].toFixed(6)}}const Df=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*(EAST|WEST|[EW])?$/i,Ps=/^([+-]?[0-8]?[0-9])\s+([0-5]?[0-9]\.\d{3,})[\s,]{1,}([+-]?[0-1]?[0-9]?[0-9])\s+([0-5]?[0-9]\.\d{3,})$/,Ts=/^(NORTH|SOUTH|[NS])?[\s]*([+-]?[0-8]?[0-9](?:[\.,]\d{3,}))[\s]*([]?)[\s]*(NORTH|SOUTH|[NS])?[\s]*[,/;]?[\s]*(EAST|WEST|[EW])?[\s]*([+-]?[0-1]?[0-9]?[0-9](?:[\.,]\d{3,}))[\s]*([]?)[\s]*(EAST|WEST|[EW])?$/i,Is=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(EAST|WEST|[EW])?$/i,Rs=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)\s*(EAST|WEST|[EW])?$/i,Ns=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''||||["\.])?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''||||["\.])?\s*(EAST|WEST|[EW])?$/i;function Uf(n){if(!["DMS","DM","DD"].includes(n))throw new Error("invalid format specified");if(this.decimalCoordinates&&this.decimalCoordinates.trim()){const e=this.decimalCoordinates.split(",").map(O=>Number(O.trim())),t=Number(e[0]),o=Number(e[1]),a=Math.abs(t),s=Math.abs(o),l=t>0?"N":"S",i=o>0?"E":"W";let f;n=="DD"&&(f=`${a} ${l}, ${s} ${i}`);const v=Math.floor(a),y=Math.floor(s),b=(a-v)*60,L=(s-y)*60;if(n=="DM"){let O=Bs(b,3).toFixed(3).padStart(6,"0"),M=Bs(L,3).toFixed(3).padStart(6,"0");O.endsWith(".000")&&M.endsWith(".000")&&(O=O.replace(/\.000$/,""),M=M.replace(/\.000$/,"")),f=`${v} ${O}' ${l}, ${y} ${M}' ${i}`}if(n=="DMS"){const O=Math.floor(b),M=Math.floor(L);let T=((b-O)*60).toFixed(1).padStart(4,"0"),x=((L-M)*60).toFixed(1).padStart(4,"0");const C=O.toString().padStart(2,"0"),_=M.toString().padStart(2,"0");T.endsWith(".0")&&x.endsWith(".0")&&(T=T.replace(/\.0$/,""),x=x.replace(/\.0$/,"")),f=`${v} ${C}' ${T}" ${l}, ${y} ${_}' ${x}" ${i}`}return f}else throw new Error("no decimal coordinates to convert")}function Bs(n,e){const t=Math.pow(10,e);return Math.round((n+Number.EPSILON)*t)/t}function ns(n,e){e||(e=5),n=n.replace(/\s+/g," ").trim();let t=null,o=null,a="",s="",l=null,i=[],f=!1;if(Df.test(n))throw new Error("invalid coordinate value");if(Ps.test(n))if(i=Ps.exec(n),f=Lo(i),f)t=Math.abs(i[1])+i[2]/60,Number(i[1])<0&&(t*=-1),o=Math.abs(i[3])+i[4]/60,Number(i[3])<0&&(o*=-1),l="DM";else throw new Error("invalid coordinate format");else if(Ts.test(n))if(i=Ts.exec(n),f=Lo(i),f){if(t=i[2],o=i[6],t.includes(",")&&(t=t.replace(",",".")),o.includes(",")&&(o=o.replace(",",".")),l="DD",Number(Math.round(t))==Number(t))throw new Error("integer only coordinate provided");if(Number(Math.round(o))==Number(o))throw new Error("integer only coordinate provided");i[1]?(a=i[1],s=i[5]):i[4]&&(a=i[4],s=i[8])}else throw new Error("invalid decimal coordinate format");else if(Is.test(n))if(i=Is.exec(n),f=Lo(i),f)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4]/60,l="DM"),i[6]&&(t+=i[6].replace(",",".")/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[9])),i[11]&&(o+=i[11]/60),i[13]&&(o+=i[13].replace(",",".")/3600),parseInt(i[9])<0&&(o=-1*o),i[1]?(a=i[1],s=i[8]):i[7]&&(a=i[7],s=i[14]);else throw new Error("invalid DMS coordinates format");else if(Rs.test(n))if(i=Rs.exec(n),f=Lo(i),f)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4]/60,l="DM"),i[6]&&(t+=i[6]/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[10])),i[12]&&(o+=i[12]/60),i[14]&&(o+=i[14]/3600),parseInt(i[10])<0&&(o=-1*o),i[1]?(a=i[1],s=i[9]):i[8]&&(a=i[8],s=i[16]);else throw new Error("invalid DMS coordinates format");else if(Ns.test(n)){if(i=Ns.exec(n),f=Lo(i),i.filter(v=>v).length<=5)throw new Error("invalid coordinates format");if(f)t=Math.abs(parseInt(i[2])),i[4]&&(t+=i[4].replace(",",".")/60,l="DM"),i[6]&&(t+=i[6].replace(",",".")/3600,l="DMS"),parseInt(i[2])<0&&(t=-1*t),o=Math.abs(parseInt(i[10])),i[12]&&(o+=i[12].replace(",",".")/60),i[14]&&(o+=i[14].replace(",",".")/3600),parseInt(i[10])<0&&(o=-1*o),i[1]?(a=i[1],s=i[9]):i[8]&&(a=i[8],s=i[16]);else throw new Error("invalid coordinates format")}if(f){if(Math.abs(o)>=180)throw new Error("invalid longitude value");if(Math.abs(t)>=90)throw new Error("invalid latitude value");if(a&&!s||!a&&s)throw new Error("invalid coordinates value");if(a&&a==s)throw new Error("invalid coordinates format");t.toString().includes(",")&&(t=t.replace(",",".")),o.toString().includes(",")&&(o=o.replace(",","."));let v=/S|SOUTH/i;v.test(a)&&t>0&&(t=-1*t),v=/W|WEST/i,v.test(s)&&o>0&&(o=-1*o);const y=i[0].trim();let b,L;const O=/[,/;\u0020]/g,M=y.match(O);if(M==null){const C=Math.floor(n.length/2);b=y.substring(0,C).trim(),L=y.substring(C).trim()}else{let C;M.length%2==1?C=Math.floor(M.length/2):C=M.length/2-1;let _=0;if(C==0)_=y.indexOf(M[0]),b=y.substring(0,_).trim(),L=y.substring(_+1).trim();else{let D=0,z=0;for(;D<=C;)_=y.indexOf(M[D],z),z=_+1,D++;b=y.substring(0,_).trim(),L=y.substring(_+1).trim()}}const T=b.split(".");if(T.length==2&&T[1]==0&&T[1].length!=2)throw new Error("invalid coordinates format");const x=L.split(".");if(x.length==2&&x[1]==0&&x[1].length!=2)throw new Error("invalid coordinates format");if(/^\d+$/.test(b)||/^\d+$/.test(L))throw new Error("degree only coordinate/s provided");return t=Number(Number(t).toFixed(e)),o=Number(Number(o).toFixed(e)),Object.freeze({verbatimCoordinates:y,verbatimLatitude:b,verbatimLongitude:L,decimalLatitude:t,decimalLongitude:o,decimalCoordinates:`${t},${o}`,originalFormat:l,closeEnough:Gf,toCoordinateFormat:Uf})}else throw new Error("coordinates pattern match failed")}function Lo(n){if(!isNaN(n[0]))return!1;const e=[...n];if(e.shift(),e.length%2>0)return!1;const t=/^[-+]?\d+([\.,]\d+)?$/,o=/[eastsouthnorthwest]+/i,a=e.length/2;for(let s=0;s<a;s++){const l=e[s],i=e[s+a],f=t.test(l)&&t.test(i),v=o.test(l)&&o.test(i),y=l==i;if(!(l==null&&i==null)){if(l==null||i==null)return!1;if(f||v||y)continue;return!1}}return!0}function Fs(n,e){const t=Math.abs(n-e);return Number(t.toFixed(6))<=1e-5}function Gf(n){if(!n)throw new Error("coords must be provided");if(n.includes(",")){const e=n.split(",");if(Number(e[0])==NaN||Number(e[1])==NaN)throw new Error("coords are not valid decimals");return Fs(this.decimalLatitude,Number(e[0]))&&Fs(this.decimalLongitude,e[1])}else throw new Error("coords being tested must be separated by a comma")}const Wf=Object.freeze({DMS:"DMS",DM:"DM",DD:"DD"});ns.to=Wf;const Hf=[{verbatimCoordinates:"40.123, -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123 N 74.123 W",verbatimLatitude:"40.123 N",verbatimLongitude:"74.123 W"},{verbatimCoordinates:"40.123 N 74.123 W",verbatimLatitude:"40.123 N",verbatimLongitude:"74.123 W"},{verbatimCoordinates:'40 7 22.8" N 74 7 22.8" W',verbatimLatitude:'40 7 22.8" N',verbatimLongitude:'74 7 22.8" W'},{verbatimCoordinates:"40 7.38 , -74 7.38",verbatimLatitude:"40 7.38",verbatimLongitude:"-74 7.38"},{verbatimCoordinates:"N40722.8, W74722.8",verbatimLatitude:"N40722.8",verbatimLongitude:"W74722.8"},{verbatimCoordinates:'40722.8"N, 74722.8"W',verbatimLatitude:'40722.8"N',verbatimLongitude:'74722.8"W'},{verbatimCoordinates:`407'22.8"N, 747'22.8"W`,verbatimLatitude:`407'22.8"N`,verbatimLongitude:`747'22.8"W`},{verbatimCoordinates:"40 7 22.8, -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"},{verbatimCoordinates:"40.123 -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123,-74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123N74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"4007.38N7407.38W",verbatimLatitude:"4007.38N",verbatimLongitude:"7407.38W"},{verbatimCoordinates:'40722.8"N, 74722.8"W',verbatimLatitude:'40722.8"N',verbatimLongitude:'74722.8"W'},{verbatimCoordinates:"400722.8N740722.8W",verbatimLatitude:"400722.8N",verbatimLongitude:"740722.8W"},{verbatimCoordinates:"N 40 7.38 W 74 7.38",verbatimLatitude:"N 40 7.38",verbatimLongitude:"W 74 7.38"},{verbatimCoordinates:"40:7:22.8N 74:7:22.8W",verbatimLatitude:"40:7:22.8N",verbatimLongitude:"74:7:22.8W"},{verbatimCoordinates:"40:7:23N,74:7:23W",verbatimLatitude:"40:7:23N",verbatimLongitude:"74:7:23W",decimalLatitude:40.1230555555,decimalLongitude:-74.1230555555},{verbatimCoordinates:'40723"N 74723"W',verbatimLatitude:'40723"N',verbatimLongitude:'74723"W',decimalLatitude:40.1230555555,decimalLongitude:-74.12305555555555},{verbatimCoordinates:'40723"S 74723"E',verbatimLatitude:'40723"S',verbatimLongitude:'74723"E',decimalLatitude:-40.1230555555,decimalLongitude:74.12305555555555},{verbatimCoordinates:'40723" -74723"',verbatimLatitude:'40723"',verbatimLongitude:'-74723"',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:'40d 7 23" N 74d 7 23" W',verbatimLatitude:'40d 7 23" N',verbatimLongitude:'74d 7 23" W',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:"40.123N 74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"40 7.38, -74 7.38",verbatimLatitude:"40 7.38",verbatimLongitude:"-74 7.38"},{verbatimCoordinates:"40 7.38, -74 7.38",verbatimLatitude:"40 7.38",verbatimLongitude:"-74 7.38"},{verbatimCoordinates:"40 7 22.8; -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"}],qf={decimalLatitude:40.123,decimalLongitude:-74.123},Jf=[{verbatimCoordinates:`504'17.698"south, 1424'2.826"east`,verbatimLatitude:`504'17.698"south`,verbatimLongitude:`1424'2.826"east`,decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"50d4m17.698S 14d24m2.826E",verbatimLatitude:"50d4m17.698S",verbatimLongitude:"14d24m2.826E",decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"40:26:46N,79:56:55W",verbatimLatitude:"40:26:46N",verbatimLongitude:"79:56:55W",decimalLatitude:40.44611111111111,decimalLongitude:-79.9486111111111},{verbatimCoordinates:"40:26:46.302N 79:56:55.903W",verbatimLatitude:"40:26:46.302N",verbatimLongitude:"79:56:55.903W",decimalLatitude:40.446195,decimalLongitude:-79.94886194444445},{verbatimCoordinates:"402647N 795836W",verbatimLatitude:"402647N",verbatimLongitude:"795836W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40d 26 47 N 79d 58 36 W",verbatimLatitude:"40d 26 47 N",verbatimLongitude:"79d 58 36 W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40.446195N 79.948862W",verbatimLatitude:"40.446195N",verbatimLongitude:"79.948862W",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40,446195 79,948862",verbatimLatitude:"40,446195",verbatimLongitude:"79,948862",decimalLatitude:40.446195,decimalLongitude:79.948862},{verbatimCoordinates:"40 26.7717, -79 56.93172",verbatimLatitude:"40 26.7717",verbatimLongitude:"-79 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.446195, -79.948862",verbatimLatitude:"40.446195",verbatimLongitude:"-79.948862",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.123256; -74.123256",verbatimLatitude:"40.123256",verbatimLongitude:"-74.123256",decimalLatitude:40.123256,decimalLongitude:-74.123256},{verbatimCoordinates:"1824S 2245E",verbatimLatitude:"1824S",verbatimLongitude:"2245E",decimalLatitude:-18.4,decimalLongitude:22.75}],Qf=[{verbatimCoordinates:"10.432342S 10.6345345E",verbatimLatitude:"10.432342S",verbatimLongitude:"10.6345345E",decimalLatitude:-10.432342,decimalLongitude:10.6345345},{verbatimCoordinates:"10.00S 10.00E",verbatimLatitude:"10.00S",verbatimLongitude:"10.00E",decimalLatitude:-10,decimalLongitude:10},{verbatimCoordinates:"00.00S 01.00E",verbatimLatitude:"00.00S",verbatimLongitude:"01.00E",decimalLatitude:0,decimalLongitude:1},{verbatimCoordinates:"18.24S 22.45E",verbatimLatitude:"18.24S",verbatimLongitude:"22.45E",decimalLatitude:-18.4,decimalLongitude:22.75},{verbatimCoordinates:"27deg 15min 45.2sec S 18deg 32min 53.7sec E",verbatimLatitude:"27deg 15min 45.2sec S",verbatimLongitude:"18deg 32min 53.7sec E",decimalLatitude:-27.262555555555554,decimalLongitude:18.54825},{verbatimCoordinates:"-23.3245 S / 28.2344 E",verbatimLatitude:"-23.3245 S",verbatimLongitude:"28.2344 E",decimalLatitude:-23.3245,decimalLongitude:28.2344},{verbatimCoordinates:"40 26.7717 -79 56.93172",verbatimLatitude:"40 26.7717",verbatimLongitude:"-79 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"27.15.45S 18.32.53E",verbatimLatitude:"27.15.45S",verbatimLongitude:"18.32.53E",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"-27.15.45 18.32.53",verbatimLatitude:"-27.15.45",verbatimLongitude:"18.32.53",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"27.15.45.2S 18.32.53.4E",verbatimLatitude:"27.15.45.2S",verbatimLongitude:"18.32.53.4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"27.15.45,2S 18.32.53,4E",verbatimLatitude:"27.15.45,2S",verbatimLongitude:"18.32.53,4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"S23.43563   E22.45634 ",verbatimLatitude:"S23.43563 ",verbatimLongitude:"E22.45634 ",decimalLatitude:-23.43563,decimalLongitude:22.45634},{verbatimCoordinates:"27,71372 S 23,07771 E",verbatimLatitude:"27,71372 S",verbatimLongitude:"23,07771 E",decimalLatitude:-27.71372,decimalLongitude:23.07771},{verbatimCoordinates:"27.45.34 S 23.23.23 E",verbatimLatitude:"27.45.34 S",verbatimLongitude:"23.23.23 E",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"S 27.45.34 E 23.23.23",verbatimLatitude:"S 27.45.34",verbatimLongitude:"E 23.23.23",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"53 16.3863,4 52.8171",verbatimLatitude:"53 16.3863",verbatimLongitude:"4 52.8171",decimalLatitude:53.273105,decimalLongitude:4.88029},{verbatimCoordinates:"50 8.2914,-5 2.4447",verbatimLatitude:"50 8.2914",verbatimLongitude:"-5 2.4447",decimalLatitude:50.13819,decimalLongitude:-5.040745},{verbatimCoordinates:"N 48 30,6410', E 18 57,4583'",verbatimLatitude:"N 48 30,6410'",verbatimLongitude:"E 18 57,4583'",decimalLatitude:48.51068,decimalLongitude:18.95764},{verbatimCoordinates:"1.23456, 18.33453",verbatimLatitude:"1.23456",verbatimLongitude:"18.33453",decimalLatitude:1.23456,decimalLongitude:18.33453}];function Zf(){const n=[];return Hf.forEach(e=>{e.decimalLatitude?n.push(e):n.push({...e,...qf})}),[...n,...Jf,...Qf]}const Vf=Zf();ns.formats=Vf.map(n=>n.verbatimCoordinates);const Kf=ns;function Os(n,e,t){const o=n.slice();return o[97]=e[t],o[99]=t,o}function js(n){let e,t,o,a,s;return t=new tu({}),{c(){e=Ct("button"),In(t.$$.fragment),de(e,"type","button"),de(e,"title",n[3]),de(e,"class","svelte-bz0zu3")},m(l,i){Ft(l,e,i),An(t,e,null),o=!0,a||(s=ir(e,"click",n[78]),a=!0)},p(l,i){(!o||i[0]&8)&&de(e,"title",l[3])},i(l){o||(Wt(t.$$.fragment,l),o=!0)},o(l){rr(t.$$.fragment,l),o=!1},d(l){l&&Rt(e),wn(t),a=!1,s()}}}function zs(n){let e,t;return e=new Pf({}),{c(){In(e.$$.fragment)},m(o,a){An(e,o,a),t=!0},i(o){t||(Wt(e.$$.fragment,o),t=!0)},o(o){rr(e.$$.fragment,o),t=!1},d(o){wn(e,o)}}}function Ds(n){let e,t,o,a,s;return t=new Bf({}),{c(){e=Ct("button"),In(t.$$.fragment),de(e,"type","button"),de(e,"title",n[10]),de(e,"class","svelte-bz0zu3"),on(e,"active",n[0])},m(l,i){Ft(l,e,i),An(t,e,null),o=!0,a||(s=ir(e,"click",n[79]),a=!0)},p(l,i){(!o||i[0]&1024)&&de(e,"title",l[10]),(!o||i[0]&1)&&on(e,"active",l[0])},i(l){o||(Wt(t.$$.fragment,l),o=!0)},o(l){rr(t.$$.fragment,l),o=!1},d(l){l&&Rt(e),wn(t),a=!1,s()}}}function Xf(n){let e,t=[],o=new Map,a,s,l,i=Cs(n[13]);const f=v=>v[97].id+(v[97].address?","+v[97].address:"");for(let v=0;v<i.length;v+=1){let y=Os(n,i,v),b=f(y);o.set(b,t[v]=Us(b,y))}return{c(){e=Ct("ul");for(let v=0;v<t.length;v+=1)t[v].c();de(e,"class","options svelte-bz0zu3"),de(e,"role","listbox")},m(v,y){Ft(v,e,y);for(let b=0;b<t.length;b+=1)t[b]&&t[b].m(e,null);a=!0,s||(l=[ir(e,"mouseleave",n[27]),ir(e,"blur",n[83]),ir(e,"keydown",n[23])],s=!0)},p(v,y){y[0]&102823936&&(i=Cs(v[13]),Ro(),t=vf(t,y,f,1,v,i,o,e,ff,Us,null,Os),No())},i(v){if(!a){for(let y=0;y<i.length;y+=1)Wt(t[y]);a=!0}},o(v){for(let y=0;y<t.length;y+=1)rr(t[y]);a=!1},d(v){v&&Rt(e);for(let y=0;y<t.length;y+=1)t[y].d();s=!1,$n(l)}}}function Yf(n){let e,t,o,a,s,l;return t=new ru({}),{c(){e=Ct("div"),In(t.$$.fragment),o=Cr(),a=Ct("div"),s=Tn(n[8]),de(a,"class","svelte-bz0zu3"),de(e,"class","no-results svelte-bz0zu3")},m(i,f){Ft(i,e,f),An(t,e,null),pt(e,o),pt(e,a),pt(a,s),l=!0},p(i,f){(!l||f[0]&256)&&ia(s,i[8])},i(i){l||(Wt(t.$$.fragment,i),l=!0)},o(i){rr(t.$$.fragment,i),l=!1},d(i){i&&Rt(e),wn(t)}}}function ev(n){let e="",t;return{c(){t=Tn(e)},m(o,a){Ft(o,t,a)},p:Ut,i:Ut,o:Ut,d(o){o&&Rt(t)}}}function tv(n){let e,t,o,a,s,l,i,f,v,y,b;return t=new ru({}),f=new tu({}),{c(){e=Ct("div"),In(t.$$.fragment),o=Cr(),a=Ct("div"),s=Tn(n[7]),l=Cr(),i=Ct("button"),In(f.$$.fragment),de(a,"class","svelte-bz0zu3"),de(i,"class","svelte-bz0zu3"),de(e,"class","error svelte-bz0zu3")},m(L,O){Ft(L,e,O),An(t,e,null),pt(e,o),pt(e,a),pt(a,s),pt(e,l),pt(e,i),An(f,i,null),v=!0,y||(b=ir(i,"click",n[80]),y=!0)},p(L,O){(!v||O[0]&128)&&ia(s,L[7])},i(L){v||(Wt(t.$$.fragment,L),Wt(f.$$.fragment,L),v=!0)},o(L){rr(t.$$.fragment,L),rr(f.$$.fragment,L),v=!1},d(L){L&&Rt(e),wn(t),wn(f),y=!1,b()}}}function Us(n,e){var t;let o,a,s;function l(){return e[81](e[99])}function i(){return e[82](e[97])}return a=new Cf({props:{feature:e[97],showPlaceType:e[11],style:e[15]===e[99]?"selected":((t=e[14])==null?void 0:t.id)===e[97].id?"picked":"default",missingIconsCache:e[21],iconsBaseUrl:e[12]}}),a.$on("mouseenter",l),a.$on("select",i),{key:n,first:null,c(){o=tf(),In(a.$$.fragment),this.first=o},m(f,v){Ft(f,o,v),An(a,f,v),s=!0},p(f,v){var y;e=f;const b={};v[0]&8192&&(b.feature=e[97]),v[0]&2048&&(b.showPlaceType=e[11]),v[0]&57344&&(b.style=e[15]===e[99]?"selected":((y=e[14])==null?void 0:y.id)===e[97].id?"picked":"default"),v[0]&4096&&(b.iconsBaseUrl=e[12]),a.$set(b)},i(f){s||(Wt(a.$$.fragment,f),s=!0)},o(f){rr(a.$$.fragment,f),s=!1},d(f){f&&Rt(o),wn(a,f)}}}function rv(n){let e,t,o,a,s,l,i,f,v,y,b,L,O,M,T,x,C,_,D,z=!1;s=new Of({});let I=!n[20]&&js(n),F=n[20]&&zs(),j=n[6]==="button"&&Ds(n);const d=n[70].default,g=Kd(d,n,n[69],null),h=[tv,ev,Yf,Xf],$=[];function w(A,B){var k,R;return A[19]?0:!A[16]&&!A[4]?1:((k=A[13])==null?void 0:k.length)===0?2:(R=A[13])!=null&&R.length&&(A[16]||A[4])?3:-1}return~(M=w(n))&&(T=$[M]=h[M](n)),{c(){e=Cr(),t=Ct("form"),o=Ct("div"),a=Ct("button"),In(s.$$.fragment),l=Cr(),i=Ct("input"),f=Cr(),v=Ct("div"),I&&I.c(),y=Cr(),F&&F.c(),b=Cr(),j&&j.c(),L=Cr(),g&&g.c(),O=Cr(),T&&T.c(),de(a,"class","search-button svelte-bz0zu3"),de(a,"type","button"),de(i,"placeholder",n[9]),de(i,"aria-label",n[9]),de(i,"class","svelte-bz0zu3"),de(v,"class","clear-button-container svelte-bz0zu3"),on(v,"displayable",n[1]!==""),de(o,"class","input-group svelte-bz0zu3"),de(t,"class",x=Ua(n[2])+" svelte-bz0zu3"),on(t,"can-collapse",n[5]&&n[1]==="")},m(A,B){Ft(A,e,B),Ft(A,t,B),pt(t,o),pt(o,a),An(s,a,null),pt(o,l),pt(o,i),n[72](i),Es(i,n[1]),pt(o,f),pt(o,v),I&&I.m(v,null),pt(v,y),F&&F.m(v,null),pt(o,b),j&&j.m(o,null),pt(o,L),g&&g.m(o,null),pt(t,O),~M&&$[M].m(t,null),C=!0,_||(D=[ir(a,"click",n[71]),ir(i,"input",n[73]),ir(i,"focus",n[74]),ir(i,"blur",n[75]),ir(i,"click",n[76]),ir(i,"keydown",n[23]),ir(i,"input",n[24]),ir(i,"change",n[77]),ir(t,"submit",rf(n[22]))],_=!0)},p(A,B){(!C||B[0]&512)&&de(i,"placeholder",A[9]),(!C||B[0]&512)&&de(i,"aria-label",A[9]),B[0]&2&&i.value!==A[1]&&Es(i,A[1]),A[20]?I&&(Ro(),rr(I,1,1,()=>{I=null}),No()):I?(I.p(A,B),B[0]&1048576&&Wt(I,1)):(I=js(A),I.c(),Wt(I,1),I.m(v,y)),A[20]?F?B[0]&1048576&&Wt(F,1):(F=zs(),F.c(),Wt(F,1),F.m(v,null)):F&&(Ro(),rr(F,1,1,()=>{F=null}),No()),(!C||B[0]&2)&&on(v,"displayable",A[1]!==""),A[6]==="button"?j?(j.p(A,B),B[0]&64&&Wt(j,1)):(j=Ds(A),j.c(),Wt(j,1),j.m(o,L)):j&&(Ro(),rr(j,1,1,()=>{j=null}),No()),g&&g.p&&(!C||B[2]&128)&&Yd(g,d,A,A[69],C?Xd(d,A[69]):ef(A[69]),null);let k=M;M=w(A),M===k?~M&&$[M].p(A,B):(T&&(Ro(),rr($[k],1,1,()=>{$[k]=null}),No()),~M?(T=$[M],T?T.p(A,B):(T=$[M]=h[M](A),T.c()),Wt(T,1),T.m(t,null)):T=null),(!C||B[0]&4&&x!==(x=Ua(A[2])+" svelte-bz0zu3"))&&de(t,"class",x),(!C||B[0]&38)&&on(t,"can-collapse",A[5]&&A[1]==="")},i(A){C||(Wt(z),Wt(s.$$.fragment,A),Wt(I),Wt(F),Wt(j),Wt(g,A),Wt(T),C=!0)},o(A){rr(z),rr(s.$$.fragment,A),rr(I),rr(F),rr(j),rr(g,A),rr(T),C=!1},d(A){A&&(Rt(e),Rt(t)),wn(s),n[72](null),I&&I.d(),F&&F.d(),j&&j.d(),g&&g.d(A),~M&&$[M].d(),_=!1,$n(D)}}}function nv(n,e,t){let o,a,s,{$$slots:l={},$$scope:i}=e;const f={continental_marine:4,country:4,major_landform:8,region:5,subregion:6,county:7,joint_municipality:8,joint_submunicipality:9,municipality:10,municipal_district:11,locality:12,neighbourhood:13,place:14,postal_code:14,road:16,poi:17,address:18,"poi.peak":15,"poi.shop":18,"poi.cafe":18,"poi.restaurant":18,"poi.aerodrome":13};let{class:v=void 0}=e,{apiKey:y=void 0}=e,{bbox:b=void 0}=e,{clearButtonTitle:L="clear"}=e,{clearOnBlur:O=!1}=e,{clearListOnPick:M=!1}=e,{keepListOpen:T=!1}=e,{collapsed:x=!1}=e,{country:C=void 0}=e,{debounceSearch:_=200}=e,{enableReverse:D="never"}=e,{errorMessage:z="Something went wrong"}=e,{filter:I=()=>!0}=e,{flyTo:F=!0}=e,{fuzzyMatch:j=!0}=e,{language:d=void 0}=e,{limit:g=void 0}=e;const h=41415112612;let{reverseGeocodingLimit:$=h}=e,{mapController:w=void 0}=e,{minLength:A=2}=e,{noResultsMessage:B="Oops! Looks like you're trying to predict something that's not quite right. We can't seem to find what you're looking for. Maybe try double-checking your spelling or try a different search term. Keep on typing - we'll do our best to get you where you need to go!"}=e,{placeholder:k="Search"}=e,{proximity:R=[{type:"server-geolocation"}]}=e,{reverseActive:S=D==="always"}=e,{reverseButtonTitle:E="toggle reverse geocoding"}=e,{searchValue:N=""}=e,{pickedResultStyle:G="full-geometry"}=e,{showPlaceType:q="if-needed"}=e,{showResultsWhileTyping:H=!0}=e,{selectFirst:Y=!0}=e,{flyToSelected:ue=!1}=e,{markerOnSelected:oe=!0}=e,{types:Z=void 0}=e;const te=[];let{reverseGeocodingTypes:K=te}=e,{exhaustiveReverseGeocoding:V=!1}=e,{excludeTypes:ee=!1}=e;const re=void 0;let{reverseGeocodingExcludeTypes:ae=re}=e,{zoom:ne=f}=e,{apiUrl:ie="https://api.maptiler.com/geocoding"}=e,{fetchParameters:_e={}}=e,{iconsBaseUrl:le="https://cdn.maptiler.com/maptiler-geocoding-control/v2.1.7/icons/"}=e,{adjustUrlQuery:fe=()=>{}}=e,{adjustUrl:se=()=>{}}=e;function ye(ce){Te.focus(ce)}function he(){Te.blur()}function Se(ce,_t=!0,Kt=!1){t(1,N=ce),_t?(t(15,Ae=-1),Xe()):(it(void 0,!Kt,Kt),setTimeout(()=>{Te.focus(),Te.select()}))}function xe(){t(13,ke=void 0),t(14,pe=void 0),t(15,Ae=-1)}function Fe(){t(64,Ce=[]),t(14,pe=void 0)}let ke,Ce,pe,Me="",Te,Ae=-1,Ee,Ie=[],Re,Ue,Ge,Je,Oe=!1;const Qe=new Set,qe=Yl();af(()=>{w&&(w.setEventHandler(void 0),w.indicateReverse(!1),w.setSelectedMarker(-1),w.setFeatures(void 0,void 0,!1))});function Xe(ce){if(t(17,Oe=!1),Ue&&(clearTimeout(Ue),Ue=void 0),Ae>-1&&ke)t(14,pe=ke[Ae]),t(1,N=pe.place_type[0]==="reverse"?pe.place_name:pe.place_name.replace(/,.*/,"")),t(19,Ee=void 0),t(64,Ce=void 0),t(15,Ae=-1);else if(N){const _t=ce||!st(N);ft(N,{exact:!0}).then(()=>{t(64,Ce=ke),t(14,pe=void 0),_t&&wt()}).catch(Kt=>t(19,Ee=Kt))}}function st(ce){try{return Kf(ce,6)}catch{return!1}}async function ft(ce,{byId:_t=!1,exact:Kt=!1}={}){var Gt,sr,yr;t(19,Ee=void 0),Re?.abort();const nt=new AbortController;t(20,Re=nt);try{const He=st(ce),Ye=new URL(ie+"/"+encodeURIComponent(He?He.decimalLongitude+","+He.decimalLatitude:ce)+".json"),Ke=Ye.searchParams;d!==void 0&&Ke.set("language",Array.isArray(d)?d.join(","):d??"");const[$t]=w?.getCenterAndZoom()??[];let Pt=(Gt=!He||K===te?Z:K)==null?void 0:Gt.map(Lt=>typeof Lt=="string"?Lt:$t===void 0||(Lt[0]??0)<=$t&&$t<(Lt[1]??1/0)?Lt[2]:void 0).filter(Lt=>Lt!==void 0);Pt&&(Pt=[...new Set(Pt)],Ke.set("types",Pt.join(",")));const Ht=!He||ae===re?ee:ae;if(Ht&&Ke.set("excludeTypes",String(Ht)),b&&Ke.set("bbox",b.map(Lt=>Lt.toFixed(6)).join(",")),C&&Ke.set("country",Array.isArray(C)?C.join(","):C),!_t&&!He){const Lt=await zf(w,R,nt);Lt&&Ke.set("proximity",Lt),(Kt||!H)&&Ke.set("autocomplete","false"),Ke.set("fuzzyMatch",String(j))}const Ar=$===h?g:$;Ar!==void 0&&Ar>1&&Pt?.length!==1&&console.warn("For reverse geocoding when limit > 1 then types must contain single value."),He?(Ar===1||Ar!==void 0&&(V||Pt?.length===1))&&Ke.set("limit",String(Ar)):g!==void 0&&Ke.set("limit",String(g)),y&&Ke.set("key",y),fe(Ke),se(Ye);const Hr=Ye.searchParams.get("types")===""&&Ye.searchParams.get("excludeTypes")!=="true",Rr=Ye.toString();if(Rr===Me){_t?(M&&t(13,ke=void 0),t(14,pe=Ie[0])):(t(13,ke=Ie),((sr=ke[Ae])==null?void 0:sr.id)!==a?.id&&t(15,Ae=-1));return}Me=Rr;let Xt;if(Hr)Xt={type:"FeatureCollection",features:[]};else{const Lt=await fetch(Rr,{signal:nt.signal,..._e});if(!Lt.ok)throw new Error(await Lt.text());Xt=await Lt.json()}qe("response",{url:Rr,featureCollection:Xt}),_t?(M&&t(13,ke=void 0),t(14,pe=Xt.features[0]),Ie=[pe]):(t(13,ke=Xt.features.filter(I)),He&&ke.unshift({type:"Feature",properties:{},id:"reverse_"+He.decimalLongitude+"_"+He.decimalLatitude,text:He.decimalLatitude+", "+He.decimalLongitude,place_name:He.decimalLatitude+", "+He.decimalLongitude,place_type:["reverse"],center:[He.decimalLongitude,He.decimalLatitude],bbox:[He.decimalLongitude,He.decimalLatitude,He.decimalLongitude,He.decimalLatitude],geometry:{type:"Point",coordinates:[He.decimalLongitude,He.decimalLatitude]}}),Ie=ke,((yr=ke[Ae])==null?void 0:yr.id)!==a?.id&&t(15,Ae=-1),He&&Te.focus())}catch(He){if(He&&typeof He=="object"&&"name"in He&&He.name==="AbortError")return;throw He}finally{nt===Re&&t(20,Re=void 0)}}function wt(){var ce;if(!(Ce!=null&&Ce.length)||!F)return;const _t=[180,90,-180,-90],Kt=!Ce.some(sr=>!sr.matching_text);let Gt;for(const sr of Ce){const yr=mt(sr);if(Gt=Gt===void 0?yr:yr===void 0?Gt:Math.max(Gt,yr),Kt||!sr.matching_text)for(const nt of[0,1,2,3])_t[nt]=Math[nt<2?"min":"max"](_t[nt],((ce=sr.bbox)==null?void 0:ce[nt])??sr.center[nt%2])}w&&Ce.length>0&&(pe&&_t[0]===_t[2]&&_t[1]===_t[3]?w.flyTo(pe.center,mt(pe)):w.fitBounds(Ga(_t),50,Gt))}function At(){!pe||!w||(!pe.bbox||pe.bbox[0]===pe.bbox[2]&&pe.bbox[1]===pe.bbox[3]?w.flyTo(pe.center,mt(pe)):w.fitBounds(Ga(pe.bbox),50,mt(pe)))}function mt(ce){var _t;if(!ce.bbox||ce.bbox[0]!==ce.bbox[2]&&ce.bbox[1]!==ce.bbox[3])return;const Kt=ce.id.replace(/\..*/,"");return(Array.isArray((_t=ce.properties)==null?void 0:_t.categories)?ce.properties.categories.reduce((Gt,sr)=>{const yr=ne[Kt+"."+sr];return Gt===void 0?yr:yr===void 0?Gt:Math.max(Gt,yr)},void 0):void 0)??ne[Kt]}function Mt(ce){t(0,S=D==="always"),t(13,ke=void 0),t(14,pe=void 0),t(15,Ae=-1),Se(ce[1].toFixed(6)+", "+jf(ce[0],[-180,180],!0).toFixed(6),!1,!0)}function tt(ce){if(!ke)return;let _t=ce.key==="ArrowDown"?1:ce.key==="ArrowUp"?-1:0;_t&&(Te.focus(),t(17,Oe=!0),ce.preventDefault(),pe&&Ae===-1&&t(15,Ae=ke.findIndex(Kt=>Kt.id===pe?.id)),Ae===(pe||Y?0:-1)&&_t===-1&&t(15,Ae=ke.length),t(15,Ae+=_t),Ae>=ke.length&&t(15,Ae=-1),Ae<0&&(pe||Y)&&t(15,Ae=0))}function it(ce,_t=!0,Kt=!1){if(t(19,Ee=void 0),t(14,pe=void 0),t(17,Oe=!0),H||Kt){if(Ue&&clearTimeout(Ue),N.length<A)return;const Gt=N;Ue=window.setTimeout(()=>{ft(Gt).catch(sr=>t(19,Ee=sr))},_t?_:0)}else t(13,ke=void 0),t(19,Ee=void 0)}function Nt(ce){pe&&pe?.id===ce?.id?At():(t(14,pe=ce),t(1,N=ce.place_name))}function Ot(ce){t(15,Ae=ce)}function Et(){(!Y||pe)&&t(15,Ae=-1),ue&&At()}const xt=()=>Te.focus();function jt(ce){Ni[ce?"unshift":"push"](()=>{Te=ce,t(18,Te)})}function or(){N=this.value,t(1,N),t(17,Oe),t(31,O),t(16,Ge)}const br=()=>t(17,Oe=!0),cn=()=>t(17,Oe=!1),Sr=()=>t(17,Oe=!0),ar=()=>t(14,pe=void 0),Xr=()=>{t(1,N=""),t(14,pe=void 0),Te.focus()},Tr=()=>t(0,S=!S),dn=()=>t(19,Ee=void 0),Wr=ce=>Ot(ce),Ir=ce=>Nt(ce),Yr=()=>{};return n.$$set=ce=>{"class"in ce&&t(2,v=ce.class),"apiKey"in ce&&t(29,y=ce.apiKey),"bbox"in ce&&t(30,b=ce.bbox),"clearButtonTitle"in ce&&t(3,L=ce.clearButtonTitle),"clearOnBlur"in ce&&t(31,O=ce.clearOnBlur),"clearListOnPick"in ce&&t(32,M=ce.clearListOnPick),"keepListOpen"in ce&&t(4,T=ce.keepListOpen),"collapsed"in ce&&t(5,x=ce.collapsed),"country"in ce&&t(33,C=ce.country),"debounceSearch"in ce&&t(34,_=ce.debounceSearch),"enableReverse"in ce&&t(6,D=ce.enableReverse),"errorMessage"in ce&&t(7,z=ce.errorMessage),"filter"in ce&&t(35,I=ce.filter),"flyTo"in ce&&t(36,F=ce.flyTo),"fuzzyMatch"in ce&&t(37,j=ce.fuzzyMatch),"language"in ce&&t(38,d=ce.language),"limit"in ce&&t(39,g=ce.limit),"reverseGeocodingLimit"in ce&&t(40,$=ce.reverseGeocodingLimit),"mapController"in ce&&t(41,w=ce.mapController),"minLength"in ce&&t(42,A=ce.minLength),"noResultsMessage"in ce&&t(8,B=ce.noResultsMessage),"placeholder"in ce&&t(9,k=ce.placeholder),"proximity"in ce&&t(43,R=ce.proximity),"reverseActive"in ce&&t(0,S=ce.reverseActive),"reverseButtonTitle"in ce&&t(10,E=ce.reverseButtonTitle),"searchValue"in ce&&t(1,N=ce.searchValue),"pickedResultStyle"in ce&&t(44,G=ce.pickedResultStyle),"showPlaceType"in ce&&t(11,q=ce.showPlaceType),"showResultsWhileTyping"in ce&&t(45,H=ce.showResultsWhileTyping),"selectFirst"in ce&&t(46,Y=ce.selectFirst),"flyToSelected"in ce&&t(47,ue=ce.flyToSelected),"markerOnSelected"in ce&&t(48,oe=ce.markerOnSelected),"types"in ce&&t(49,Z=ce.types),"reverseGeocodingTypes"in ce&&t(50,K=ce.reverseGeocodingTypes),"exhaustiveReverseGeocoding"in ce&&t(51,V=ce.exhaustiveReverseGeocoding),"excludeTypes"in ce&&t(52,ee=ce.excludeTypes),"reverseGeocodingExcludeTypes"in ce&&t(53,ae=ce.reverseGeocodingExcludeTypes),"zoom"in ce&&t(54,ne=ce.zoom),"apiUrl"in ce&&t(55,ie=ce.apiUrl),"fetchParameters"in ce&&t(56,_e=ce.fetchParameters),"iconsBaseUrl"in ce&&t(12,le=ce.iconsBaseUrl),"adjustUrlQuery"in ce&&t(57,fe=ce.adjustUrlQuery),"adjustUrl"in ce&&t(58,se=ce.adjustUrl),"$$scope"in ce&&t(69,i=ce.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&64&&t(0,S=D==="always"),n.$$.dirty[0]&16384|n.$$.dirty[1]&8192&&G!=="marker-only"&&pe&&!pe.address&&pe.geometry.type==="Point"&&pe.place_type[0]!=="reverse"&&ft(pe.id,{byId:!0}).catch(ce=>t(19,Ee=ce)),n.$$.dirty[0]&16384|n.$$.dirty[1]&1058|n.$$.dirty[2]&8&&(w&&pe&&pe.id!==Je&&F&&(At(),M&&t(13,ke=void 0),t(64,Ce=void 0),t(15,Ae=-1)),t(65,Je=pe?.id)),n.$$.dirty[0]&196608|n.$$.dirty[1]&1&&setTimeout(()=>{t(16,Ge=Oe),O&&!Ge&&t(1,N="")}),n.$$.dirty[0]&8194|n.$$.dirty[1]&2048&&N.length<A&&(t(13,ke=void 0),t(19,Ee=void 0),t(64,Ce=ke)),n.$$.dirty[0]&57344|n.$$.dirty[1]&32768&&Y&&ke!=null&&ke.length&&Ae==-1&&!pe&&t(15,Ae=0),n.$$.dirty[0]&8192|n.$$.dirty[2]&4&&Ce!==ke&&t(64,Ce=void 0),n.$$.dirty[0]&73729|n.$$.dirty[1]&1024|n.$$.dirty[2]&4&&w&&w.setEventHandler(ce=>{switch(ce.type){case"mapClick":S&&Mt(ce.coordinates);break;case"markerClick":{const _t=ke?.find(Kt=>Kt.id===ce.id);_t&&Nt(_t)}break;case"markerMouseEnter":Ce&&t(15,Ae=Ge?ke?.findIndex(_t=>_t.id===ce.id)??-1:-1);break;case"markerMouseLeave":Ce&&t(15,Ae=-1);break}}),n.$$.dirty[0]&40960&&t(66,a=ke?.[Ae]),n.$$.dirty[1]&66592|n.$$.dirty[2]&16&&w&&a&&F&&ue&&w.flyTo(a.center,mt(a)),n.$$.dirty[1]&8192&&t(68,o=G==="full-geometry-including-polygon-center-marker"),n.$$.dirty[1]&132096|n.$$.dirty[2]&64&&(oe||w==null||w.setFeatures(void 0,void 0,o)),n.$$.dirty[0]&16384|n.$$.dirty[1]&132096|n.$$.dirty[2]&84&&w&&oe&&!Ce&&(w.setFeatures(a?[a]:void 0,pe,o),w.setSelectedMarker(a?0:-1)),n.$$.dirty[0]&16384|n.$$.dirty[1]&1024|n.$$.dirty[2]&68&&w&&w.setFeatures(Ce,pe,o),n.$$.dirty[0]&32768|n.$$.dirty[1]&1024|n.$$.dirty[2]&4&&Ce&&w&&w.setSelectedMarker(Ae),n.$$.dirty[0]&2|n.$$.dirty[1]&1024&&w){const ce=st(N);w.setReverseMarker(ce?[ce.decimalLongitude,ce.decimalLatitude]:void 0)}n.$$.dirty[2]&16&&qe("select",{feature:a}),n.$$.dirty[0]&16384&&qe("pick",{feature:pe}),n.$$.dirty[0]&73744&&t(67,s=!!(ke!=null&&ke.length)&&(Ge||T)),n.$$.dirty[2]&32&&qe("optionsvisibilitychange",{optionsVisible:s}),n.$$.dirty[0]&8192&&qe("featureslisted",{features:ke}),n.$$.dirty[2]&4&&qe("featuresmarked",{features:Ce}),n.$$.dirty[0]&1&&qe("reversetoggle",{reverse:S}),n.$$.dirty[0]&2&&qe("querychange",{query:N}),n.$$.dirty[0]&1|n.$$.dirty[1]&1024&&w&&w.indicateReverse(S)},[S,N,v,L,T,x,D,z,B,k,E,q,le,ke,pe,Ae,Ge,Oe,Te,Ee,Re,Qe,Xe,tt,it,Nt,Ot,Et,f,y,b,O,M,C,_,I,F,j,d,g,$,w,A,R,G,H,Y,ue,oe,Z,K,V,ee,ae,ne,ie,_e,fe,se,ye,he,Se,xe,Fe,Ce,Je,a,s,o,i,l,xt,jt,or,br,cn,Sr,ar,Xr,Tr,dn,Wr,Ir,Yr]}let ov=class extends Fn{constructor(n){super(),Bn(this,n,nv,rv,Nn,{ZOOM_DEFAULTS:28,class:2,apiKey:29,bbox:30,clearButtonTitle:3,clearOnBlur:31,clearListOnPick:32,keepListOpen:4,collapsed:5,country:33,debounceSearch:34,enableReverse:6,errorMessage:7,filter:35,flyTo:36,fuzzyMatch:37,language:38,limit:39,reverseGeocodingLimit:40,mapController:41,minLength:42,noResultsMessage:8,placeholder:9,proximity:43,reverseActive:0,reverseButtonTitle:10,searchValue:1,pickedResultStyle:44,showPlaceType:11,showResultsWhileTyping:45,selectFirst:46,flyToSelected:47,markerOnSelected:48,types:49,reverseGeocodingTypes:50,exhaustiveReverseGeocoding:51,excludeTypes:52,reverseGeocodingExcludeTypes:53,zoom:54,apiUrl:55,fetchParameters:56,iconsBaseUrl:12,adjustUrlQuery:57,adjustUrl:58,focus:59,blur:60,setQuery:61,clearList:62,clearMap:63},null,[-1,-1,-1,-1])}get ZOOM_DEFAULTS(){return this.$$.ctx[28]}get focus(){return this.$$.ctx[59]}get blur(){return this.$$.ctx[60]}get setQuery(){return this.$$.ctx[61]}get clearList(){return this.$$.ctx[62]}get clearMap(){return this.$$.ctx[63]}};function la(n,e,t={}){const o={type:"Feature"};return(t.id===0||t.id)&&(o.id=t.id),t.bbox&&(o.bbox=t.bbox),o.properties=e||{},o.geometry=n,o}function os(n,e,t={}){for(const o of n){if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(o[o.length-1].length!==o[0].length)throw new Error("First and last Position are not equivalent.");for(let a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return la({type:"Polygon",coordinates:n},e,t)}function ua(n,e={}){const t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=n,t}function ou(n,e,t={}){return la({type:"MultiPolygon",coordinates:n},e,t)}var av=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,_i=Math.ceil,Or=Math.floor,wr="[BigNumber Error] ",Gs=wr+"Number primitive has more than 15 significant digits: ",qr=1e14,rt=14,Ws=9007199254740991,pi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Ln=1e7,Lr=1e9;function au(n){var e,t,o,a=_.prototype={constructor:_,toString:null,valueOf:null},s=new _(1),l=20,i=4,f=-7,v=21,y=-1e7,b=1e7,L=!1,O=1,M=0,T={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},x="0123456789abcdefghijklmnopqrstuvwxyz",C=!0;function _(d,g){var h,$,w,A,B,k,R,S,E=this;if(!(E instanceof _))return new _(d,g);if(g==null){if(d&&d._isBigNumber===!0){E.s=d.s,!d.c||d.e>b?E.c=E.e=null:d.e<y?E.c=[E.e=0]:(E.e=d.e,E.c=d.c.slice());return}if((k=typeof d=="number")&&d*0==0){if(E.s=1/d<0?(d=-d,-1):1,d===~~d){for(A=0,B=d;B>=10;B/=10,A++);A>b?E.c=E.e=null:(E.e=A,E.c=[d]);return}S=String(d)}else{if(!av.test(S=String(d)))return o(E,S,k);E.s=S.charCodeAt(0)==45?(S=S.slice(1),-1):1}(A=S.indexOf("."))>-1&&(S=S.replace(".","")),(B=S.search(/e/i))>0?(A<0&&(A=B),A+=+S.slice(B+1),S=S.substring(0,B)):A<0&&(A=S.length)}else{if(qt(g,2,x.length,"Base"),g==10&&C)return E=new _(d),F(E,l+E.e+1,i);if(S=String(d),k=typeof d=="number"){if(d*0!=0)return o(E,S,k,g);if(E.s=1/d<0?(S=S.slice(1),-1):1,_.DEBUG&&S.replace(/^0\.0*|\./,"").length>15)throw Error(Gs+d)}else E.s=S.charCodeAt(0)===45?(S=S.slice(1),-1):1;for(h=x.slice(0,g),A=B=0,R=S.length;B<R;B++)if(h.indexOf($=S.charAt(B))<0){if($=="."){if(B>A){A=R;continue}}else if(!w&&(S==S.toUpperCase()&&(S=S.toLowerCase())||S==S.toLowerCase()&&(S=S.toUpperCase()))){w=!0,B=-1,A=0;continue}return o(E,String(d),k,g)}k=!1,S=t(S,g,10,E.s),(A=S.indexOf("."))>-1?S=S.replace(".",""):A=S.length}for(B=0;S.charCodeAt(B)===48;B++);for(R=S.length;S.charCodeAt(--R)===48;);if(S=S.slice(B,++R)){if(R-=B,k&&_.DEBUG&&R>15&&(d>Ws||d!==Or(d)))throw Error(Gs+E.s*d);if((A=A-B-1)>b)E.c=E.e=null;else if(A<y)E.c=[E.e=0];else{if(E.e=A,E.c=[],B=(A+1)%rt,A<0&&(B+=rt),B<R){for(B&&E.c.push(+S.slice(0,B)),R-=rt;B<R;)E.c.push(+S.slice(B,B+=rt));B=rt-(S=S.slice(B)).length}else B-=R;for(;B--;S+="0");E.c.push(+S)}}else E.c=[E.e=0]}_.clone=au,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(d){var g,h;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(g="DECIMAL_PLACES")&&(h=d[g],qt(h,0,Lr,g),l=h),d.hasOwnProperty(g="ROUNDING_MODE")&&(h=d[g],qt(h,0,8,g),i=h),d.hasOwnProperty(g="EXPONENTIAL_AT")&&(h=d[g],h&&h.pop?(qt(h[0],-1e9,0,g),qt(h[1],0,Lr,g),f=h[0],v=h[1]):(qt(h,-1e9,Lr,g),f=-(v=h<0?-h:h))),d.hasOwnProperty(g="RANGE"))if(h=d[g],h&&h.pop)qt(h[0],-1e9,-1,g),qt(h[1],1,Lr,g),y=h[0],b=h[1];else if(qt(h,-1e9,Lr,g),h)y=-(b=h<0?-h:h);else throw Error(wr+g+" cannot be zero: "+h);if(d.hasOwnProperty(g="CRYPTO"))if(h=d[g],h===!!h)if(h)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))L=h;else throw L=!h,Error(wr+"crypto unavailable");else L=h;else throw Error(wr+g+" not true or false: "+h);if(d.hasOwnProperty(g="MODULO_MODE")&&(h=d[g],qt(h,0,9,g),O=h),d.hasOwnProperty(g="POW_PRECISION")&&(h=d[g],qt(h,0,Lr,g),M=h),d.hasOwnProperty(g="FORMAT"))if(h=d[g],typeof h=="object")T=h;else throw Error(wr+g+" not an object: "+h);if(d.hasOwnProperty(g="ALPHABET"))if(h=d[g],typeof h=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(h))C=h.slice(0,10)=="0123456789",x=h;else throw Error(wr+g+" invalid: "+h)}else throw Error(wr+"Object expected: "+d);return{DECIMAL_PLACES:l,ROUNDING_MODE:i,EXPONENTIAL_AT:[f,v],RANGE:[y,b],CRYPTO:L,MODULO_MODE:O,POW_PRECISION:M,FORMAT:T,ALPHABET:x}},_.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!_.DEBUG)return!0;var g,h,$=d.c,w=d.e,A=d.s;e:if({}.toString.call($)=="[object Array]"){if((A===1||A===-1)&&w>=-1e9&&w<=Lr&&w===Or(w)){if($[0]===0){if(w===0&&$.length===1)return!0;break e}if(g=(w+1)%rt,g<1&&(g+=rt),String($[0]).length==g){for(g=0;g<$.length;g++)if(h=$[g],h<0||h>=qr||h!==Or(h))break e;if(h!==0)return!0}}}else if($===null&&w===null&&(A===null||A===1||A===-1))return!0;throw Error(wr+"Invalid BigNumber: "+d)},_.maximum=_.max=function(){return z(arguments,-1)},_.minimum=_.min=function(){return z(arguments,1)},_.random=(function(){var d=9007199254740992,g=Math.random()*d&2097151?function(){return Or(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(h){var $,w,A,B,k,R=0,S=[],E=new _(s);if(h==null?h=l:qt(h,0,Lr),B=_i(h/rt),L)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(B*=2));R<B;)k=$[R]*131072+($[R+1]>>>11),k>=9e15?(w=crypto.getRandomValues(new Uint32Array(2)),$[R]=w[0],$[R+1]=w[1]):(S.push(k%1e14),R+=2);R=B/2}else if(crypto.randomBytes){for($=crypto.randomBytes(B*=7);R<B;)k=($[R]&31)*281474976710656+$[R+1]*1099511627776+$[R+2]*4294967296+$[R+3]*16777216+($[R+4]<<16)+($[R+5]<<8)+$[R+6],k>=9e15?crypto.randomBytes(7).copy($,R):(S.push(k%1e14),R+=7);R=B/7}else throw L=!1,Error(wr+"crypto unavailable");if(!L)for(;R<B;)k=g(),k<9e15&&(S[R++]=k%1e14);for(B=S[--R],h%=rt,B&&h&&(k=pi[rt-h],S[R]=Or(B/k)*k);S[R]===0;S.pop(),R--);if(R<0)S=[A=0];else{for(A=-1;S[0]===0;S.splice(0,1),A-=rt);for(R=1,k=S[0];k>=10;k/=10,R++);R<rt&&(A-=rt-R)}return E.e=A,E.c=S,E}})(),_.sum=function(){for(var d=1,g=arguments,h=new _(g[0]);d<g.length;)h=h.plus(g[d++]);return h},t=(function(){var d="0123456789";function g(h,$,w,A){for(var B,k=[0],R,S=0,E=h.length;S<E;){for(R=k.length;R--;k[R]*=$);for(k[0]+=A.indexOf(h.charAt(S++)),B=0;B<k.length;B++)k[B]>w-1&&(k[B+1]==null&&(k[B+1]=0),k[B+1]+=k[B]/w|0,k[B]%=w)}return k.reverse()}return function(h,$,w,A,B){var k,R,S,E,N,G,q,H,Y=h.indexOf("."),ue=l,oe=i;for(Y>=0&&(E=M,M=0,h=h.replace(".",""),H=new _($),G=H.pow(h.length-Y),M=E,H.c=g(vn(Fr(G.c),G.e,"0"),10,w,d),H.e=H.c.length),q=g(h,$,w,B?(k=x,d):(k=d,x)),S=E=q.length;q[--E]==0;q.pop());if(!q[0])return k.charAt(0);if(Y<0?--S:(G.c=q,G.e=S,G.s=A,G=e(G,H,ue,oe,w),q=G.c,N=G.r,S=G.e),R=S+ue+1,Y=q[R],E=w/2,N=N||R<0||q[R+1]!=null,N=oe<4?(Y!=null||N)&&(oe==0||oe==(G.s<0?3:2)):Y>E||Y==E&&(oe==4||N||oe==6&&q[R-1]&1||oe==(G.s<0?8:7)),R<1||!q[0])h=N?vn(k.charAt(1),-ue,k.charAt(0)):k.charAt(0);else{if(q.length=R,N)for(--w;++q[--R]>w;)q[R]=0,R||(++S,q=[1].concat(q));for(E=q.length;!q[--E];);for(Y=0,h="";Y<=E;h+=k.charAt(q[Y++]));h=vn(h,S,k.charAt(0))}return h}})(),e=(function(){function d($,w,A){var B,k,R,S,E=0,N=$.length,G=w%Ln,q=w/Ln|0;for($=$.slice();N--;)R=$[N]%Ln,S=$[N]/Ln|0,B=q*R+S*G,k=G*R+B%Ln*Ln+E,E=(k/A|0)+(B/Ln|0)+q*S,$[N]=k%A;return E&&($=[E].concat($)),$}function g($,w,A,B){var k,R;if(A!=B)R=A>B?1:-1;else for(k=R=0;k<A;k++)if($[k]!=w[k]){R=$[k]>w[k]?1:-1;break}return R}function h($,w,A,B){for(var k=0;A--;)$[A]-=k,k=$[A]<w[A]?1:0,$[A]=k*B+$[A]-w[A];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,w,A,B,k){var R,S,E,N,G,q,H,Y,ue,oe,Z,te,K,V,ee,re,ae,ne=$.s==w.s?1:-1,ie=$.c,_e=w.c;if(!ie||!ie[0]||!_e||!_e[0])return new _(!$.s||!w.s||(ie?_e&&ie[0]==_e[0]:!_e)?NaN:ie&&ie[0]==0||!_e?ne*0:ne/0);for(Y=new _(ne),ue=Y.c=[],S=$.e-w.e,ne=A+S+1,k||(k=qr,S=jr($.e/rt)-jr(w.e/rt),ne=ne/rt|0),E=0;_e[E]==(ie[E]||0);E++);if(_e[E]>(ie[E]||0)&&S--,ne<0)ue.push(1),N=!0;else{for(V=ie.length,re=_e.length,E=0,ne+=2,G=Or(k/(_e[0]+1)),G>1&&(_e=d(_e,G,k),ie=d(ie,G,k),re=_e.length,V=ie.length),K=re,oe=ie.slice(0,re),Z=oe.length;Z<re;oe[Z++]=0);ae=_e.slice(),ae=[0].concat(ae),ee=_e[0],_e[1]>=k/2&&ee++;do{if(G=0,R=g(_e,oe,re,Z),R<0){if(te=oe[0],re!=Z&&(te=te*k+(oe[1]||0)),G=Or(te/ee),G>1)for(G>=k&&(G=k-1),q=d(_e,G,k),H=q.length,Z=oe.length;g(q,oe,H,Z)==1;)G--,h(q,re<H?ae:_e,H,k),H=q.length,R=1;else G==0&&(R=G=1),q=_e.slice(),H=q.length;if(H<Z&&(q=[0].concat(q)),h(oe,q,Z,k),Z=oe.length,R==-1)for(;g(_e,oe,re,Z)<1;)G++,h(oe,re<Z?ae:_e,Z,k),Z=oe.length}else R===0&&(G++,oe=[0]);ue[E++]=G,oe[0]?oe[Z++]=ie[K]||0:(oe=[ie[K]],Z=1)}while((K++<V||oe[0]!=null)&&ne--);N=oe[0]!=null,ue[0]||ue.splice(0,1)}if(k==qr){for(E=1,ne=ue[0];ne>=10;ne/=10,E++);F(Y,A+(Y.e=E+S*rt-1)+1,B,N)}else Y.e=S,Y.r=+N;return Y}})();function D(d,g,h,$){var w,A,B,k,R;if(h==null?h=i:qt(h,0,8),!d.c)return d.toString();if(w=d.c[0],B=d.e,g==null)R=Fr(d.c),R=$==1||$==2&&(B<=f||B>=v)?ka(R,B):vn(R,B,"0");else if(d=F(new _(d),g,h),A=d.e,R=Fr(d.c),k=R.length,$==1||$==2&&(g<=A||A<=f)){for(;k<g;R+="0",k++);R=ka(R,A)}else if(g-=B,R=vn(R,A,"0"),A+1>k){if(--g>0)for(R+=".";g--;R+="0");}else if(g+=A-k,g>0)for(A+1==k&&(R+=".");g--;R+="0");return d.s<0&&w?"-"+R:R}function z(d,g){for(var h,$,w=1,A=new _(d[0]);w<d.length;w++)$=new _(d[w]),(!$.s||(h=Gn(A,$))===g||h===0&&A.s===g)&&(A=$);return A}function I(d,g,h){for(var $=1,w=g.length;!g[--w];g.pop());for(w=g[0];w>=10;w/=10,$++);return(h=$+h*rt-1)>b?d.c=d.e=null:h<y?d.c=[d.e=0]:(d.e=h,d.c=g),d}o=(function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,g=/^([^.]+)\.$/,h=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,w=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(A,B,k,R){var S,E=k?B:B.replace(w,"");if($.test(E))A.s=isNaN(E)?null:E<0?-1:1;else{if(!k&&(E=E.replace(d,function(N,G,q){return S=(q=q.toLowerCase())=="x"?16:q=="b"?2:8,!R||R==S?G:N}),R&&(S=R,E=E.replace(g,"$1").replace(h,"0.$1")),B!=E))return new _(E,S);if(_.DEBUG)throw Error(wr+"Not a"+(R?" base "+R:"")+" number: "+B);A.s=null}A.c=A.e=null}})();function F(d,g,h,$){var w,A,B,k,R,S,E,N=d.c,G=pi;if(N){e:{for(w=1,k=N[0];k>=10;k/=10,w++);if(A=g-w,A<0)A+=rt,B=g,R=N[S=0],E=Or(R/G[w-B-1]%10);else if(S=_i((A+1)/rt),S>=N.length)if($){for(;N.length<=S;N.push(0));R=E=0,w=1,A%=rt,B=A-rt+1}else break e;else{for(R=k=N[S],w=1;k>=10;k/=10,w++);A%=rt,B=A-rt+w,E=B<0?0:Or(R/G[w-B-1]%10)}if($=$||g<0||N[S+1]!=null||(B<0?R:R%G[w-B-1]),$=h<4?(E||$)&&(h==0||h==(d.s<0?3:2)):E>5||E==5&&(h==4||$||h==6&&(A>0?B>0?R/G[w-B]:0:N[S-1])%10&1||h==(d.s<0?8:7)),g<1||!N[0])return N.length=0,$?(g-=d.e+1,N[0]=G[(rt-g%rt)%rt],d.e=-g||0):N[0]=d.e=0,d;if(A==0?(N.length=S,k=1,S--):(N.length=S+1,k=G[rt-A],N[S]=B>0?Or(R/G[w-B]%G[B])*k:0),$)for(;;)if(S==0){for(A=1,B=N[0];B>=10;B/=10,A++);for(B=N[0]+=k,k=1;B>=10;B/=10,k++);A!=k&&(d.e++,N[0]==qr&&(N[0]=1));break}else{if(N[S]+=k,N[S]!=qr)break;N[S--]=0,k=1}for(A=N.length;N[--A]===0;N.pop());}d.e>b?d.c=d.e=null:d.e<y&&(d.c=[d.e=0])}return d}function j(d){var g,h=d.e;return h===null?d.toString():(g=Fr(d.c),g=h<=f||h>=v?ka(g,h):vn(g,h,"0"),d.s<0?"-"+g:g)}return a.absoluteValue=a.abs=function(){var d=new _(this);return d.s<0&&(d.s=1),d},a.comparedTo=function(d,g){return Gn(this,new _(d,g))},a.decimalPlaces=a.dp=function(d,g){var h,$,w,A=this;if(d!=null)return qt(d,0,Lr),g==null?g=i:qt(g,0,8),F(new _(A),d+A.e+1,g);if(!(h=A.c))return null;if($=((w=h.length-1)-jr(this.e/rt))*rt,w=h[w])for(;w%10==0;w/=10,$--);return $<0&&($=0),$},a.dividedBy=a.div=function(d,g){return e(this,new _(d,g),l,i)},a.dividedToIntegerBy=a.idiv=function(d,g){return e(this,new _(d,g),0,1)},a.exponentiatedBy=a.pow=function(d,g){var h,$,w,A,B,k,R,S,E,N=this;if(d=new _(d),d.c&&!d.isInteger())throw Error(wr+"Exponent not an integer: "+j(d));if(g!=null&&(g=new _(g)),k=d.e>14,!N.c||!N.c[0]||N.c[0]==1&&!N.e&&N.c.length==1||!d.c||!d.c[0])return E=new _(Math.pow(+j(N),k?d.s*(2-$a(d)):+j(d))),g?E.mod(g):E;if(R=d.s<0,g){if(g.c?!g.c[0]:!g.s)return new _(NaN);$=!R&&N.isInteger()&&g.isInteger(),$&&(N=N.mod(g))}else{if(d.e>9&&(N.e>0||N.e<-1||(N.e==0?N.c[0]>1||k&&N.c[1]>=24e7:N.c[0]<8e13||k&&N.c[0]<=9999975e7)))return A=N.s<0&&$a(d)?-0:0,N.e>-1&&(A=1/A),new _(R?1/A:A);M&&(A=_i(M/rt+2))}for(k?(h=new _(.5),R&&(d.s=1),S=$a(d)):(w=Math.abs(+j(d)),S=w%2),E=new _(s);;){if(S){if(E=E.times(N),!E.c)break;A?E.c.length>A&&(E.c.length=A):$&&(E=E.mod(g))}if(w){if(w=Or(w/2),w===0)break;S=w%2}else if(d=d.times(h),F(d,d.e+1,1),d.e>14)S=$a(d);else{if(w=+j(d),w===0)break;S=w%2}N=N.times(N),A?N.c&&N.c.length>A&&(N.c.length=A):$&&(N=N.mod(g))}return $?E:(R&&(E=s.div(E)),g?E.mod(g):A?F(E,M,i,B):E)},a.integerValue=function(d){var g=new _(this);return d==null?d=i:qt(d,0,8),F(g,g.e+1,d)},a.isEqualTo=a.eq=function(d,g){return Gn(this,new _(d,g))===0},a.isFinite=function(){return!!this.c},a.isGreaterThan=a.gt=function(d,g){return Gn(this,new _(d,g))>0},a.isGreaterThanOrEqualTo=a.gte=function(d,g){return(g=Gn(this,new _(d,g)))===1||g===0},a.isInteger=function(){return!!this.c&&jr(this.e/rt)>this.c.length-2},a.isLessThan=a.lt=function(d,g){return Gn(this,new _(d,g))<0},a.isLessThanOrEqualTo=a.lte=function(d,g){return(g=Gn(this,new _(d,g)))===-1||g===0},a.isNaN=function(){return!this.s},a.isNegative=function(){return this.s<0},a.isPositive=function(){return this.s>0},a.isZero=function(){return!!this.c&&this.c[0]==0},a.minus=function(d,g){var h,$,w,A,B=this,k=B.s;if(d=new _(d,g),g=d.s,!k||!g)return new _(NaN);if(k!=g)return d.s=-g,B.plus(d);var R=B.e/rt,S=d.e/rt,E=B.c,N=d.c;if(!R||!S){if(!E||!N)return E?(d.s=-g,d):new _(N?B:NaN);if(!E[0]||!N[0])return N[0]?(d.s=-g,d):new _(E[0]?B:i==3?-0:0)}if(R=jr(R),S=jr(S),E=E.slice(),k=R-S){for((A=k<0)?(k=-k,w=E):(S=R,w=N),w.reverse(),g=k;g--;w.push(0));w.reverse()}else for($=(A=(k=E.length)<(g=N.length))?k:g,k=g=0;g<$;g++)if(E[g]!=N[g]){A=E[g]<N[g];break}if(A&&(w=E,E=N,N=w,d.s=-d.s),g=($=N.length)-(h=E.length),g>0)for(;g--;E[h++]=0);for(g=qr-1;$>k;){if(E[--$]<N[$]){for(h=$;h&&!E[--h];E[h]=g);--E[h],E[$]+=qr}E[$]-=N[$]}for(;E[0]==0;E.splice(0,1),--S);return E[0]?I(d,E,S):(d.s=i==3?-1:1,d.c=[d.e=0],d)},a.modulo=a.mod=function(d,g){var h,$,w=this;return d=new _(d,g),!w.c||!d.s||d.c&&!d.c[0]?new _(NaN):!d.c||w.c&&!w.c[0]?new _(w):(O==9?($=d.s,d.s=1,h=e(w,d,0,3),d.s=$,h.s*=$):h=e(w,d,0,O),d=w.minus(h.times(d)),!d.c[0]&&O==1&&(d.s=w.s),d)},a.multipliedBy=a.times=function(d,g){var h,$,w,A,B,k,R,S,E,N,G,q,H,Y,ue,oe=this,Z=oe.c,te=(d=new _(d,g)).c;if(!Z||!te||!Z[0]||!te[0])return!oe.s||!d.s||Z&&!Z[0]&&!te||te&&!te[0]&&!Z?d.c=d.e=d.s=null:(d.s*=oe.s,!Z||!te?d.c=d.e=null:(d.c=[0],d.e=0)),d;for($=jr(oe.e/rt)+jr(d.e/rt),d.s*=oe.s,R=Z.length,N=te.length,R<N&&(H=Z,Z=te,te=H,w=R,R=N,N=w),w=R+N,H=[];w--;H.push(0));for(Y=qr,ue=Ln,w=N;--w>=0;){for(h=0,G=te[w]%ue,q=te[w]/ue|0,B=R,A=w+B;A>w;)S=Z[--B]%ue,E=Z[B]/ue|0,k=q*S+E*G,S=G*S+k%ue*ue+H[A]+h,h=(S/Y|0)+(k/ue|0)+q*E,H[A--]=S%Y;H[A]=h}return h?++$:H.splice(0,1),I(d,H,$)},a.negated=function(){var d=new _(this);return d.s=-d.s||null,d},a.plus=function(d,g){var h,$=this,w=$.s;if(d=new _(d,g),g=d.s,!w||!g)return new _(NaN);if(w!=g)return d.s=-g,$.minus(d);var A=$.e/rt,B=d.e/rt,k=$.c,R=d.c;if(!A||!B){if(!k||!R)return new _(w/0);if(!k[0]||!R[0])return R[0]?d:new _(k[0]?$:w*0)}if(A=jr(A),B=jr(B),k=k.slice(),w=A-B){for(w>0?(B=A,h=R):(w=-w,h=k),h.reverse();w--;h.push(0));h.reverse()}for(w=k.length,g=R.length,w-g<0&&(h=R,R=k,k=h,g=w),w=0;g;)w=(k[--g]=k[g]+R[g]+w)/qr|0,k[g]=qr===k[g]?0:k[g]%qr;return w&&(k=[w].concat(k),++B),I(d,k,B)},a.precision=a.sd=function(d,g){var h,$,w,A=this;if(d!=null&&d!==!!d)return qt(d,1,Lr),g==null?g=i:qt(g,0,8),F(new _(A),d,g);if(!(h=A.c))return null;if(w=h.length-1,$=w*rt+1,w=h[w]){for(;w%10==0;w/=10,$--);for(w=h[0];w>=10;w/=10,$++);}return d&&A.e+1>$&&($=A.e+1),$},a.shiftedBy=function(d){return qt(d,-9007199254740991,Ws),this.times("1e"+d)},a.squareRoot=a.sqrt=function(){var d,g,h,$,w,A=this,B=A.c,k=A.s,R=A.e,S=l+4,E=new _("0.5");if(k!==1||!B||!B[0])return new _(!k||k<0&&(!B||B[0])?NaN:B?A:1/0);if(k=Math.sqrt(+j(A)),k==0||k==1/0?(g=Fr(B),(g.length+R)%2==0&&(g+="0"),k=Math.sqrt(+g),R=jr((R+1)/2)-(R<0||R%2),k==1/0?g="5e"+R:(g=k.toExponential(),g=g.slice(0,g.indexOf("e")+1)+R),h=new _(g)):h=new _(k+""),h.c[0]){for(R=h.e,k=R+S,k<3&&(k=0);;)if(w=h,h=E.times(w.plus(e(A,w,S,1))),Fr(w.c).slice(0,k)===(g=Fr(h.c)).slice(0,k))if(h.e<R&&--k,g=g.slice(k-3,k+1),g=="9999"||!$&&g=="4999"){if(!$&&(F(w,w.e+l+2,0),w.times(w).eq(A))){h=w;break}S+=4,k+=4,$=1}else{(!+g||!+g.slice(1)&&g.charAt(0)=="5")&&(F(h,h.e+l+2,1),d=!h.times(h).eq(A));break}}return F(h,h.e+l+1,i,d)},a.toExponential=function(d,g){return d!=null&&(qt(d,0,Lr),d++),D(this,d,g,1)},a.toFixed=function(d,g){return d!=null&&(qt(d,0,Lr),d=d+this.e+1),D(this,d,g)},a.toFormat=function(d,g,h){var $,w=this;if(h==null)d!=null&&g&&typeof g=="object"?(h=g,g=null):d&&typeof d=="object"?(h=d,d=g=null):h=T;else if(typeof h!="object")throw Error(wr+"Argument not an object: "+h);if($=w.toFixed(d,g),w.c){var A,B=$.split("."),k=+h.groupSize,R=+h.secondaryGroupSize,S=h.groupSeparator||"",E=B[0],N=B[1],G=w.s<0,q=G?E.slice(1):E,H=q.length;if(R&&(A=k,k=R,R=A,H-=A),k>0&&H>0){for(A=H%k||k,E=q.substr(0,A);A<H;A+=k)E+=S+q.substr(A,k);R>0&&(E+=S+q.slice(A)),G&&(E="-"+E)}$=N?E+(h.decimalSeparator||"")+((R=+h.fractionGroupSize)?N.replace(new RegExp("\\d{"+R+"}\\B","g"),"$&"+(h.fractionGroupSeparator||"")):N):E}return(h.prefix||"")+$+(h.suffix||"")},a.toFraction=function(d){var g,h,$,w,A,B,k,R,S,E,N,G,q=this,H=q.c;if(d!=null&&(k=new _(d),!k.isInteger()&&(k.c||k.s!==1)||k.lt(s)))throw Error(wr+"Argument "+(k.isInteger()?"out of range: ":"not an integer: ")+j(k));if(!H)return new _(q);for(g=new _(s),S=h=new _(s),$=R=new _(s),G=Fr(H),A=g.e=G.length-q.e-1,g.c[0]=pi[(B=A%rt)<0?rt+B:B],d=!d||k.comparedTo(g)>0?A>0?g:S:k,B=b,b=1/0,k=new _(G),R.c[0]=0;E=e(k,g,0,1),w=h.plus(E.times($)),w.comparedTo(d)!=1;)h=$,$=w,S=R.plus(E.times(w=S)),R=w,g=k.minus(E.times(w=g)),k=w;return w=e(d.minus(h),$,0,1),R=R.plus(w.times(S)),h=h.plus(w.times($)),R.s=S.s=q.s,A=A*2,N=e(S,$,A,i).minus(q).abs().comparedTo(e(R,h,A,i).minus(q).abs())<1?[S,$]:[R,h],b=B,N},a.toNumber=function(){return+j(this)},a.toPrecision=function(d,g){return d!=null&&qt(d,1,Lr),D(this,d,g,2)},a.toString=function(d){var g,h=this,$=h.s,w=h.e;return w===null?$?(g="Infinity",$<0&&(g="-"+g)):g="NaN":(d==null?g=w<=f||w>=v?ka(Fr(h.c),w):vn(Fr(h.c),w,"0"):d===10&&C?(h=F(new _(h),l+w+1,i),g=vn(Fr(h.c),h.e,"0")):(qt(d,2,x.length,"Base"),g=t(vn(Fr(h.c),w,"0"),10,d,$,!0)),$<0&&h.c[0]&&(g="-"+g)),g},a.valueOf=a.toJSON=function(){return j(this)},a._isBigNumber=!0,a[Symbol.toStringTag]="BigNumber",a[Symbol.for("nodejs.util.inspect.custom")]=a.valueOf,n!=null&&_.set(n),_}function jr(n){var e=n|0;return n>0||n===e?e:e-1}function Fr(n){for(var e,t,o=1,a=n.length,s=n[0]+"";o<a;){for(e=n[o++]+"",t=rt-e.length;t--;e="0"+e);s+=e}for(a=s.length;s.charCodeAt(--a)===48;);return s.slice(0,a+1||1)}function Gn(n,e){var t,o,a=n.c,s=e.c,l=n.s,i=e.s,f=n.e,v=e.e;if(!l||!i)return null;if(t=a&&!a[0],o=s&&!s[0],t||o)return t?o?0:-i:l;if(l!=i)return l;if(t=l<0,o=f==v,!a||!s)return o?0:!a^t?1:-1;if(!o)return f>v^t?1:-1;for(i=(f=a.length)<(v=s.length)?f:v,l=0;l<i;l++)if(a[l]!=s[l])return a[l]>s[l]^t?1:-1;return f==v?0:f>v^t?1:-1}function qt(n,e,t,o){if(n<e||n>t||n!==Or(n))throw Error(wr+(o||"Argument")+(typeof n=="number"?n<e||n>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function $a(n){var e=n.c.length-1;return jr(n.e/rt)==e&&n.c[e]%2!=0}function ka(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function vn(n,e,t){var o,a;if(e<0){for(a=t+".";++e;a+=t);n=a+n}else if(o=n.length,++e>o){for(a=t,e-=o;--e;a+=t);n+=a}else e<o&&(n=n.slice(0,e)+"."+n.slice(e));return n}var an=au(),iv=class{constructor(n){ze(this,"key"),ze(this,"left",null),ze(this,"right",null),this.key=n}},Co=class extends iv{constructor(n){super(n)}},sv=class{constructor(){ze(this,"size",0),ze(this,"modificationCount",0),ze(this,"splayCount",0)}splay(n){const e=this.root;if(e==null)return this.compare(n,n),-1;let t=null,o=null,a=null,s=null,l=e;const i=this.compare;let f;for(;;)if(f=i(l.key,n),f>0){let v=l.left;if(v==null||(f=i(v.key,n),f>0&&(l.left=v.right,v.right=l,l=v,v=l.left,v==null)))break;t==null?o=l:t.left=l,t=l,l=v}else if(f<0){let v=l.right;if(v==null||(f=i(v.key,n),f<0&&(l.right=v.left,v.left=l,l=v,v=l.right,v==null)))break;a==null?s=l:a.right=l,a=l,l=v}else break;return a!=null&&(a.right=l.left,l.left=s),t!=null&&(t.left=l.right,l.right=o),this.root!==l&&(this.root=l,this.splayCount++),f}splayMin(n){let e=n,t=e.left;for(;t!=null;){const o=t;e.left=o.right,o.right=e,e=o,t=e.left}return e}splayMax(n){let e=n,t=e.right;for(;t!=null;){const o=t;e.right=o.left,o.left=e,e=o,t=e.right}return e}_delete(n){if(this.root==null||this.splay(n)!=0)return null;let e=this.root;const t=e,o=e.left;if(this.size--,o==null)this.root=e.right;else{const a=e.right;e=this.splayMax(o),e.right=a,this.root=e}return this.modificationCount++,t}addNewRoot(n,e){this.size++,this.modificationCount++;const t=this.root;if(t==null){this.root=n;return}e<0?(n.left=t,n.right=t.right,t.right=null):(n.right=t,n.left=t.left,t.left=null),this.root=n}_first(){const n=this.root;return n==null?null:(this.root=this.splayMin(n),this.root)}_last(){const n=this.root;return n==null?null:(this.root=this.splayMax(n),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(n){return this.validKey(n)&&this.splay(n)==0}defaultCompare(){return(n,e)=>n<e?-1:n>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:n=>{this.root=n},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:n=>{this.splayCount=n},splay:n=>this.splay(n),has:n=>this.has(n)}}},Hs,qs,Wa=class Bo extends sv{constructor(e,t){super(),ze(this,"root",null),ze(this,"compare"),ze(this,"validKey"),ze(this,Hs,"[object Set]"),this.compare=e??this.defaultCompare(),this.validKey=t??(o=>o!=null&&o!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const t of e)this.delete(t)}forEach(e){const t=this[Symbol.iterator]();let o;for(;o=t.next(),!o.done;)e(o.value,o.value,this)}add(e){const t=this.splay(e);return t!=0&&this.addNewRoot(new Co(e),t),this}addAndReturn(e){const t=this.splay(e);return t!=0&&this.addNewRoot(new Co(e),t),this.root.key}addAll(e){for(const t of e)this.add(t)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let t=this.root.left;if(t==null)return null;let o=t.right;for(;o!=null;)t=o,o=t.right;return t.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let t=this.root.right;if(t==null)return null;let o=t.left;for(;o!=null;)t=o,o=t.left;return t.key}retainAll(e){const t=new Bo(this.compare,this.validKey),o=this.modificationCount;for(const a of e){if(o!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(a)&&this.splay(a)==0&&t.add(this.root.key)}t.size!=this.size&&(this.root=t.root,this.size=t.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const t=new Bo(this.compare,this.validKey);for(const o of this)e.has(o)&&t.add(o);return t}difference(e){const t=new Bo(this.compare,this.validKey);for(const o of this)e.has(o)||t.add(o);return t}union(e){const t=this.clone();return t.addAll(e),t}clone(){const e=new Bo(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function t(a,s){let l,i;do{if(l=a.left,i=a.right,l!=null){const f=new Co(l.key);s.left=f,t(l,f)}if(i!=null){const f=new Co(i.key);s.right=f,a=i,s=f}}while(i!=null)}const o=new Co(e.key);return t(e,o),o}toSet(){return this.clone()}entries(){return new uv(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(qs=Symbol.iterator,Hs=Symbol.toStringTag,qs)](){return new lv(this.wrap())}},iu=class{constructor(n){ze(this,"tree"),ze(this,"path",new Array),ze(this,"modificationCount",null),ze(this,"splayCount"),this.tree=n,this.splayCount=n.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const n=this.path[this.path.length-1];return this.getValue(n)}rebuildPath(n){this.path.splice(0,this.path.length),this.tree.splay(n),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(n){for(;n!=null;)this.path.push(n),n=n.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let t=this.tree.getRoot();for(;t!=null;)this.path.push(t),t=t.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let n=this.path[this.path.length-1],e=n.right;if(e!=null){for(;e!=null;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===n;)n=this.path.pop();return this.path.length>0}},lv=class extends iu{getValue(n){return n.key}},uv=class extends iu{getValue(n){return[n.key,n.key]}},su=n=>()=>n,ji=n=>{const e=n?(t,o)=>o.minus(t).abs().isLessThanOrEqualTo(n):su(!1);return(t,o)=>e(t,o)?0:t.comparedTo(o)};function cv(n){const e=n?(t,o,a,s,l)=>t.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(o).exponentiatedBy(2).plus(l.minus(a).exponentiatedBy(2)).times(n)):su(!1);return(t,o,a)=>{const s=t.x,l=t.y,i=a.x,f=a.y,v=l.minus(f).times(o.x.minus(i)).minus(s.minus(i).times(o.y.minus(f)));return e(v,s,l,i,f)?0:v.comparedTo(0)}}var dv=n=>n,fv=n=>{if(n){const e=new Wa(ji(n)),t=new Wa(ji(n)),o=(s,l)=>l.addAndReturn(s),a=s=>({x:o(s.x,e),y:o(s.y,t)});return a({x:new an(0),y:new an(0)}),a}return dv},zi=n=>({set:e=>{xn=zi(e)},reset:()=>zi(n),compare:ji(n),snap:fv(n),orient:cv(n)}),xn=zi(),Mo=(n,e)=>n.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(n.ur.x)&&n.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(n.ur.y),Di=(n,e)=>{if(e.ur.x.isLessThan(n.ll.x)||n.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(n.ll.y)||n.ur.y.isLessThan(e.ll.y))return null;const t=n.ll.x.isLessThan(e.ll.x)?e.ll.x:n.ll.x,o=n.ur.x.isLessThan(e.ur.x)?n.ur.x:e.ur.x,a=n.ll.y.isLessThan(e.ll.y)?e.ll.y:n.ll.y,s=n.ur.y.isLessThan(e.ur.y)?n.ur.y:e.ur.y;return{ll:{x:t,y:a},ur:{x:o,y:s}}},Pa=(n,e)=>n.x.times(e.y).minus(n.y.times(e.x)),lu=(n,e)=>n.x.times(e.x).plus(n.y.times(e.y)),Ha=n=>lu(n,n).sqrt(),vv=(n,e,t)=>{const o={x:e.x.minus(n.x),y:e.y.minus(n.y)},a={x:t.x.minus(n.x),y:t.y.minus(n.y)};return Pa(a,o).div(Ha(a)).div(Ha(o))},gv=(n,e,t)=>{const o={x:e.x.minus(n.x),y:e.y.minus(n.y)},a={x:t.x.minus(n.x),y:t.y.minus(n.y)};return lu(a,o).div(Ha(a)).div(Ha(o))},Js=(n,e,t)=>e.y.isZero()?null:{x:n.x.plus(e.x.div(e.y).times(t.minus(n.y))),y:t},Qs=(n,e,t)=>e.x.isZero()?null:{x:t,y:n.y.plus(e.y.div(e.x).times(t.minus(n.x)))},_v=(n,e,t,o)=>{if(e.x.isZero())return Qs(t,o,n.x);if(o.x.isZero())return Qs(n,e,t.x);if(e.y.isZero())return Js(t,o,n.y);if(o.y.isZero())return Js(n,e,t.y);const a=Pa(e,o);if(a.isZero())return null;const s={x:t.x.minus(n.x),y:t.y.minus(n.y)},l=Pa(s,e).div(a),i=Pa(s,o).div(a),f=n.x.plus(i.times(e.x)),v=t.x.plus(l.times(o.x)),y=n.y.plus(i.times(e.y)),b=t.y.plus(l.times(o.y)),L=f.plus(v).div(2),O=y.plus(b).div(2);return{x:L,y:O}},rn=class uu{constructor(e,t){ze(this,"point"),ze(this,"isLeft"),ze(this,"segment"),ze(this,"otherSE"),ze(this,"consumedBy"),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=t}static compare(e,t){const o=uu.comparePoints(e.point,t.point);return o!==0?o:(e.point!==t.point&&e.link(t),e.isLeft!==t.isLeft?e.isLeft?1:-1:Ja.compare(e.segment,t.segment))}static comparePoints(e,t){return e.x.isLessThan(t.x)?-1:e.x.isGreaterThan(t.x)?1:e.y.isLessThan(t.y)?-1:e.y.isGreaterThan(t.y)?1:0}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const t=e.point.events;for(let o=0,a=t.length;o<a;o++){const s=t[o];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let t=0;t<e;t++){const o=this.point.events[t];if(o.segment.consumedBy===void 0)for(let a=t+1;a<e;a++){const s=this.point.events[a];s.consumedBy===void 0&&o.otherSE.point.events===s.otherSE.point.events&&o.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const e=[];for(let t=0,o=this.point.events.length;t<o;t++){const a=this.point.events[t];a!==this&&!a.segment.ringOut&&a.segment.isInResult()&&e.push(a)}return e}getLeftmostComparator(e){const t=new Map,o=a=>{const s=a.otherSE;t.set(a,{sine:vv(this.point,e.point,s.point),cosine:gv(this.point,e.point,s.point)})};return(a,s)=>{t.has(a)||o(a),t.has(s)||o(s);const{sine:l,cosine:i}=t.get(a),{sine:f,cosine:v}=t.get(s);return l.isGreaterThanOrEqualTo(0)&&f.isGreaterThanOrEqualTo(0)?i.isLessThan(v)?1:i.isGreaterThan(v)?-1:0:l.isLessThan(0)&&f.isLessThan(0)?i.isLessThan(v)?-1:i.isGreaterThan(v)?1:0:f.isLessThan(l)?-1:f.isGreaterThan(l)?1:0}}},pv=class Ui{constructor(e){ze(this,"events"),ze(this,"poly"),ze(this,"_isExteriorRing"),ze(this,"_enclosingRing"),this.events=e;for(let t=0,o=e.length;t<o;t++)e[t].segment.ringOut=this;this.poly=null}static factory(e){const t=[];for(let o=0,a=e.length;o<a;o++){const s=e[o];if(!s.isInResult()||s.ringOut)continue;let l=null,i=s.leftSE,f=s.rightSE;const v=[i],y=i.point,b=[];for(;l=i,i=f,v.push(i),i.point!==y;)for(;;){const L=i.getAvailableLinkedEvents();if(L.length===0){const T=v[0].point,x=v[v.length-1].point;throw new Error(`Unable to complete output ring starting at [${T.x}, ${T.y}]. Last matching segment found ends at [${x.x}, ${x.y}].`)}if(L.length===1){f=L[0].otherSE;break}let O=null;for(let T=0,x=b.length;T<x;T++)if(b[T].point===i.point){O=T;break}if(O!==null){const T=b.splice(O)[0],x=v.splice(T.index);x.unshift(x[0].otherSE),t.push(new Ui(x.reverse()));continue}b.push({index:v.length,point:i.point});const M=i.getLeftmostComparator(l);f=L.sort(M)[0].otherSE;break}t.push(new Ui(v))}return t}getGeom(){let e=this.events[0].point;const t=[e];for(let v=1,y=this.events.length-1;v<y;v++){const b=this.events[v].point,L=this.events[v+1].point;xn.orient(b,e,L)!==0&&(t.push(b),e=b)}if(t.length===1)return null;const o=t[0],a=t[1];xn.orient(o,e,a)===0&&t.shift(),t.push(t[0]);const s=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:t.length-1,i=this.isExteriorRing()?t.length:-1,f=[];for(let v=l;v!=i;v+=s)f.push([t[v].x.toNumber(),t[v].y.toNumber()]);return f}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var e,t;let o=this.events[0];for(let l=1,i=this.events.length;l<i;l++){const f=this.events[l];rn.compare(o,f)>0&&(o=f)}let a=o.segment.prevInResult(),s=a?a.prevInResult():null;for(;;){if(!a)return null;if(!s)return a.ringOut;if(s.ringOut!==a.ringOut)return((e=s.ringOut)==null?void 0:e.enclosingRing())!==a.ringOut?a.ringOut:(t=a.ringOut)==null?void 0:t.enclosingRing();a=s.prevInResult(),s=a?a.prevInResult():null}}},Zs=class{constructor(n){ze(this,"exteriorRing"),ze(this,"interiorRings"),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}addInterior(n){this.interiorRings.push(n),n.poly=this}getGeom(){const n=this.exteriorRing.getGeom();if(n===null)return null;const e=[n];for(let t=0,o=this.interiorRings.length;t<o;t++){const a=this.interiorRings[t].getGeom();a!==null&&e.push(a)}return e}},hv=class{constructor(n){ze(this,"rings"),ze(this,"polys"),this.rings=n,this.polys=this._composePolys(n)}getGeom(){const n=[];for(let e=0,t=this.polys.length;e<t;e++){const o=this.polys[e].getGeom();o!==null&&n.push(o)}return n}_composePolys(n){var e;const t=[];for(let o=0,a=n.length;o<a;o++){const s=n[o];if(!s.poly)if(s.isExteriorRing())t.push(new Zs(s));else{const l=s.enclosingRing();l!=null&&l.poly||t.push(new Zs(l)),(e=l?.poly)==null||e.addInterior(s)}}return t}},mv=class{constructor(n,e=Ja.compare){ze(this,"queue"),ze(this,"tree"),ze(this,"segments"),this.queue=n,this.tree=new Wa(e),this.segments=[]}process(n){const e=n.segment,t=[];if(n.consumedBy)return n.isLeft?this.queue.delete(n.otherSE):this.tree.delete(e),t;n.isLeft&&this.tree.add(e);let o=e,a=e;do o=this.tree.lastBefore(o);while(o!=null&&o.consumedBy!=null);do a=this.tree.firstAfter(a);while(a!=null&&a.consumedBy!=null);if(n.isLeft){let s=null;if(o){const i=o.getIntersection(e);if(i!==null&&(e.isAnEndpoint(i)||(s=i),!o.isAnEndpoint(i))){const f=this._splitSafely(o,i);for(let v=0,y=f.length;v<y;v++)t.push(f[v])}}let l=null;if(a){const i=a.getIntersection(e);if(i!==null&&(e.isAnEndpoint(i)||(l=i),!a.isAnEndpoint(i))){const f=this._splitSafely(a,i);for(let v=0,y=f.length;v<y;v++)t.push(f[v])}}if(s!==null||l!==null){let i=null;s===null?i=l:l===null?i=s:i=rn.comparePoints(s,l)<=0?s:l,this.queue.delete(e.rightSE),t.push(e.rightSE);const f=e.split(i);for(let v=0,y=f.length;v<y;v++)t.push(f[v])}t.length>0?(this.tree.delete(e),t.push(n)):(this.segments.push(e),e.prev=o)}else{if(o&&a){const s=o.getIntersection(a);if(s!==null){if(!o.isAnEndpoint(s)){const l=this._splitSafely(o,s);for(let i=0,f=l.length;i<f;i++)t.push(l[i])}if(!a.isAnEndpoint(s)){const l=this._splitSafely(a,s);for(let i=0,f=l.length;i<f;i++)t.push(l[i])}}}this.tree.delete(e)}return t}_splitSafely(n,e){this.tree.delete(n);const t=n.rightSE;this.queue.delete(t);const o=n.split(e);return o.push(t),n.consumedBy===void 0&&this.tree.add(n),o}},bv=class{constructor(){ze(this,"type"),ze(this,"numMultiPolys")}run(n,e,t){Fo.type=n;const o=[new Ks(e,!0)];for(let f=0,v=t.length;f<v;f++)o.push(new Ks(t[f],!1));if(Fo.numMultiPolys=o.length,Fo.type==="difference"){const f=o[0];let v=1;for(;v<o.length;)Di(o[v].bbox,f.bbox)!==null?v++:o.splice(v,1)}if(Fo.type==="intersection")for(let f=0,v=o.length;f<v;f++){const y=o[f];for(let b=f+1,L=o.length;b<L;b++)if(Di(y.bbox,o[b].bbox)===null)return[]}const a=new Wa(rn.compare);for(let f=0,v=o.length;f<v;f++){const y=o[f].getSweepEvents();for(let b=0,L=y.length;b<L;b++)a.add(y[b])}const s=new mv(a);let l=null;for(a.size!=0&&(l=a.first(),a.delete(l));l;){const f=s.process(l);for(let v=0,y=f.length;v<y;v++){const b=f[v];b.consumedBy===void 0&&a.add(b)}a.size!=0?(l=a.first(),a.delete(l)):l=null}xn.reset();const i=pv.factory(s.segments);return new hv(i).getGeom()}},Fo=new bv,qa=Fo,yv=0,Ja=class Ta{constructor(e,t,o,a){ze(this,"id"),ze(this,"leftSE"),ze(this,"rightSE"),ze(this,"rings"),ze(this,"windings"),ze(this,"ringOut"),ze(this,"consumedBy"),ze(this,"prev"),ze(this,"_prevInResult"),ze(this,"_beforeState"),ze(this,"_afterState"),ze(this,"_isInResult"),this.id=++yv,this.leftSE=e,e.segment=this,e.otherSE=t,this.rightSE=t,t.segment=this,t.otherSE=e,this.rings=o,this.windings=a}static compare(e,t){const o=e.leftSE.point.x,a=t.leftSE.point.x,s=e.rightSE.point.x,l=t.rightSE.point.x;if(l.isLessThan(o))return 1;if(s.isLessThan(a))return-1;const i=e.leftSE.point.y,f=t.leftSE.point.y,v=e.rightSE.point.y,y=t.rightSE.point.y;if(o.isLessThan(a)){if(f.isLessThan(i)&&f.isLessThan(v))return 1;if(f.isGreaterThan(i)&&f.isGreaterThan(v))return-1;const b=e.comparePoint(t.leftSE.point);if(b<0)return 1;if(b>0)return-1;const L=t.comparePoint(e.rightSE.point);return L!==0?L:-1}if(o.isGreaterThan(a)){if(i.isLessThan(f)&&i.isLessThan(y))return-1;if(i.isGreaterThan(f)&&i.isGreaterThan(y))return 1;const b=t.comparePoint(e.leftSE.point);if(b!==0)return b;const L=e.comparePoint(t.rightSE.point);return L<0?1:L>0?-1:1}if(i.isLessThan(f))return-1;if(i.isGreaterThan(f))return 1;if(s.isLessThan(l)){const b=t.comparePoint(e.rightSE.point);if(b!==0)return b}if(s.isGreaterThan(l)){const b=e.comparePoint(t.rightSE.point);if(b<0)return 1;if(b>0)return-1}if(!s.eq(l)){const b=v.minus(i),L=s.minus(o),O=y.minus(f),M=l.minus(a);if(b.isGreaterThan(L)&&O.isLessThan(M))return 1;if(b.isLessThan(L)&&O.isGreaterThan(M))return-1}return s.isGreaterThan(l)?1:s.isLessThan(l)||v.isLessThan(y)?-1:v.isGreaterThan(y)?1:e.id<t.id?-1:e.id>t.id?1:0}static fromRing(e,t,o){let a,s,l;const i=rn.comparePoints(e,t);if(i<0)a=e,s=t,l=1;else if(i>0)a=t,s=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const f=new rn(a,!0),v=new rn(s,!1);return new Ta(f,v,[o],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,t=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e.isLessThan(t)?e:t},ur:{x:this.rightSE.point.x,y:e.isGreaterThan(t)?e:t}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(e){return e.x.eq(this.leftSE.point.x)&&e.y.eq(this.leftSE.point.y)||e.x.eq(this.rightSE.point.x)&&e.y.eq(this.rightSE.point.y)}comparePoint(e){return xn.orient(this.leftSE.point,e,this.rightSE.point)}getIntersection(e){const t=this.bbox(),o=e.bbox(),a=Di(t,o);if(a===null)return null;const s=this.leftSE.point,l=this.rightSE.point,i=e.leftSE.point,f=e.rightSE.point,v=Mo(t,i)&&this.comparePoint(i)===0,y=Mo(o,s)&&e.comparePoint(s)===0,b=Mo(t,f)&&this.comparePoint(f)===0,L=Mo(o,l)&&e.comparePoint(l)===0;if(y&&v)return L&&!b?l:!L&&b?f:null;if(y)return b&&s.x.eq(f.x)&&s.y.eq(f.y)?null:s;if(v)return L&&l.x.eq(i.x)&&l.y.eq(i.y)?null:i;if(L&&b)return null;if(L)return l;if(b)return f;const O=_v(s,this.vector(),i,e.vector());return O===null||!Mo(a,O)?null:xn.snap(O)}split(e){const t=[],o=e.events!==void 0,a=new rn(e,!0),s=new rn(e,!1),l=this.rightSE;this.replaceRightSE(s),t.push(s),t.push(a);const i=new Ta(a,l,this.rings.slice(),this.windings.slice());return rn.comparePoints(i.leftSE.point,i.rightSE.point)>0&&i.swapEvents(),rn.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(a.checkForConsuming(),s.checkForConsuming()),t}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,o=this.windings.length;t<o;t++)this.windings[t]*=-1}consume(e){let t=this,o=e;for(;t.consumedBy;)t=t.consumedBy;for(;o.consumedBy;)o=o.consumedBy;const a=Ta.compare(t,o);if(a!==0){if(a>0){const s=t;t=o,o=s}if(t.prev===o){const s=t;t=o,o=s}for(let s=0,l=o.rings.length;s<l;s++){const i=o.rings[s],f=o.windings[s],v=t.rings.indexOf(i);v===-1?(t.rings.push(i),t.windings.push(f)):t.windings[v]+=f}o.rings=null,o.windings=null,o.consumedBy=t,o.leftSE.consumedBy=t.leftSE,o.rightSE.consumedBy=t.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const t=this._afterState.rings,o=this._afterState.windings,a=this._afterState.multiPolys;for(let i=0,f=this.rings.length;i<f;i++){const v=this.rings[i],y=this.windings[i],b=t.indexOf(v);b===-1?(t.push(v),o.push(y)):o[b]+=y}const s=[],l=[];for(let i=0,f=t.length;i<f;i++){if(o[i]===0)continue;const v=t[i],y=v.poly;if(l.indexOf(y)===-1)if(v.isExterior)s.push(y);else{l.indexOf(y)===-1&&l.push(y);const b=s.indexOf(v.poly);b!==-1&&s.splice(b,1)}}for(let i=0,f=s.length;i<f;i++){const v=s[i].multiPoly;a.indexOf(v)===-1&&a.push(v)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,t=this.afterState().multiPolys;switch(qa.type){case"union":{const o=e.length===0,a=t.length===0;this._isInResult=o!==a;break}case"intersection":{let o,a;e.length<t.length?(o=e.length,a=t.length):(o=t.length,a=e.length),this._isInResult=a===qa.numMultiPolys&&o<a;break}case"xor":{const o=Math.abs(e.length-t.length);this._isInResult=o%2===1;break}case"difference":{const o=a=>a.length===1&&a[0].isSubject;this._isInResult=o(e)!==o(t);break}}return this._isInResult}},Vs=class{constructor(n,e,t){if(ze(this,"poly"),ze(this,"isExterior"),ze(this,"segments"),ze(this,"bbox"),!Array.isArray(n)||n.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=t,this.segments=[],typeof n[0][0]!="number"||typeof n[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const o=xn.snap({x:new an(n[0][0]),y:new an(n[0][1])});this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};let a=o;for(let s=1,l=n.length;s<l;s++){if(typeof n[s][0]!="number"||typeof n[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=xn.snap({x:new an(n[s][0]),y:new an(n[s][1])});i.x.eq(a.x)&&i.y.eq(a.y)||(this.segments.push(Ja.fromRing(a,i,this)),i.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.x),i.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.y),i.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.x),i.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.y),a=i)}(!o.x.eq(a.x)||!o.y.eq(a.y))&&this.segments.push(Ja.fromRing(a,o,this))}getSweepEvents(){const n=[];for(let e=0,t=this.segments.length;e<t;e++){const o=this.segments[e];n.push(o.leftSE),n.push(o.rightSE)}return n}},Av=class{constructor(n,e){if(ze(this,"multiPoly"),ze(this,"exteriorRing"),ze(this,"interiorRings"),ze(this,"bbox"),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Vs(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let t=1,o=n.length;t<o;t++){const a=new Vs(n[t],this,!1);a.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=e}getSweepEvents(){const n=this.exteriorRing.getSweepEvents();for(let e=0,t=this.interiorRings.length;e<t;e++){const o=this.interiorRings[e].getSweepEvents();for(let a=0,s=o.length;a<s;a++)n.push(o[a])}return n}},Ks=class{constructor(n,e){if(ze(this,"isSubject"),ze(this,"polys"),ze(this,"bbox"),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof n[0][0][0]=="number"&&(n=[n])}catch{}this.polys=[],this.bbox={ll:{x:new an(Number.POSITIVE_INFINITY),y:new an(Number.POSITIVE_INFINITY)},ur:{x:new an(Number.NEGATIVE_INFINITY),y:new an(Number.NEGATIVE_INFINITY)}};for(let t=0,o=n.length;t<o;t++){const a=new Av(n[t],this);a.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=e}getSweepEvents(){const n=[];for(let e=0,t=this.polys.length;e<t;e++){const o=this.polys[e].getSweepEvents();for(let a=0,s=o.length;a<s;a++)n.push(o[a])}return n}},wv=(n,...e)=>qa.run("union",n,e),xv=(n,...e)=>qa.run("difference",n,e);xn.set;function cu(n,e,t){if(n!==null)for(var o,a,s,l,i,f,v,y=0,b=0,L,O=n.type,M=O==="FeatureCollection",T=O==="Feature",x=M?n.features.length:1,C=0;C<x;C++){v=M?n.features[C].geometry:T?n.geometry:n,L=v?v.type==="GeometryCollection":!1,i=L?v.geometries.length:1;for(var _=0;_<i;_++){var D=0,z=0;if(l=L?v.geometries[_]:v,l!==null){f=l.coordinates;var I=l.type;switch(y=0,I){case null:break;case"Point":if(e(f,b,C,D,z)===!1)return!1;b++,D++;break;case"LineString":case"MultiPoint":for(o=0;o<f.length;o++){if(e(f[o],b,C,D,z)===!1)return!1;b++,I==="MultiPoint"&&D++}I==="LineString"&&D++;break;case"Polygon":case"MultiLineString":for(o=0;o<f.length;o++){for(a=0;a<f[o].length-y;a++){if(e(f[o][a],b,C,D,z)===!1)return!1;b++}I==="MultiLineString"&&D++,I==="Polygon"&&z++}I==="Polygon"&&D++;break;case"MultiPolygon":for(o=0;o<f.length;o++){for(z=0,a=0;a<f[o].length;a++){for(s=0;s<f[o][a].length-y;s++){if(e(f[o][a][s],b,C,D,z)===!1)return!1;b++}z++}D++}break;case"GeometryCollection":for(o=0;o<l.geometries.length;o++)if(cu(l.geometries[o],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function as(n,e){var t,o,a,s,l,i,f,v,y,b,L=0,O=n.type==="FeatureCollection",M=n.type==="Feature",T=O?n.features.length:1;for(t=0;t<T;t++){for(i=O?n.features[t].geometry:M?n.geometry:n,v=O?n.features[t].properties:M?n.properties:{},y=O?n.features[t].bbox:M?n.bbox:void 0,b=O?n.features[t].id:M?n.id:void 0,f=i?i.type==="GeometryCollection":!1,l=f?i.geometries.length:1,a=0;a<l;a++){if(s=f?i.geometries[a]:i,s===null){if(e(null,L,v,y,b)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,L,v,y,b)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(e(s.geometries[o],L,v,y,b)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function $v(n,e){as(n,function(t,o,a,s,l){var i=t===null?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return e(la(t,a,{bbox:s,id:l}),o,0)===!1?!1:void 0}var f;switch(i){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var v=0;v<t.coordinates.length;v++){var y=t.coordinates[v],b={type:f,coordinates:y};if(e(la(b,a),o,v)===!1)return!1}})}function kv(n,e={}){const t=[];if(as(n,a=>{t.push(a.coordinates)}),t.length<2)throw new Error("Must have at least 2 geometries");const o=wv(t[0],...t.slice(1));return o.length===0?null:o.length===1?os(o[0],e.properties):ou(o,e.properties)}var du=kv;function Sv(n,e={}){if(n.bbox!=null&&e.recompute!==!0)return n.bbox;const t=[1/0,1/0,-1/0,-1/0];return cu(n,o=>{t[0]>o[0]&&(t[0]=o[0]),t[1]>o[1]&&(t[1]=o[1]),t[2]<o[0]&&(t[2]=o[0]),t[3]<o[1]&&(t[3]=o[1])}),t}var Xs=Sv;function Ev(n){const e=[];if(as(n,a=>{e.push(a.coordinates)}),e.length<2)throw new Error("Must have at least two features");const t=n.features[0].properties||{},o=xv(e[0],...e.slice(1));return o.length===0?null:o.length===1?os(o[0],t):ou(o,t)}var Lv=Ev;function Cv(n){if(!n)throw new Error("geojson is required");var e=[];return $v(n,function(t){e.push(t)}),ua(e)}var Mv=Cv;function Ys(n,e){const t=Lv(ua([os([[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]),n]));if(!t)return;t.properties={isMask:!0};const o=Ga(Xs(n)),a=(o[2]-o[0])/360/1e3,s=o[0]<-180,l=o[2]>180,i=Mv(n);if(i.features.length>1&&(s||l))for(const f of i.features){const v=Ga(Xs(f));if(l&&v[0]<-180+a)for(const y of f.geometry.coordinates)for(const b of y)b[0]+=360-a;if(s&&v[2]>180-a)for(const y of f.geometry.coordinates)for(const b of y)b[0]-=360-a}e(ua([i.features.length<2?n:du(i)??n,t]))}const el={fill:{paint:{"fill-color":"#000","fill-opacity":.1},filter:["all",["==",["geometry-type"],"Polygon"],["has","isMask"]]},line:{layout:{"line-cap":"square"},paint:{"line-width":["case",["==",["geometry-type"],"Polygon"],2,3],"line-dasharray":[1,1],"line-color":"#3170fe"},filter:["!",["has","isMask"]]}},Sa="mtlr-gc-full-geom",tl="mtlr-gc-full-geom-fill",rl="mtlr-gc-full-geom-line";function Pv(n,e,t=!0,o=!0,a={},s={},l=el){let i;const f=[];let v,y,b;function L(){if(!n.loaded){n.once("load",L);return}const x=l?l===!0?el:l:void 0;if(!(x!=null&&x.fill)&&!(x!=null&&x.line))return;const C=n.getSource(Sa);if(C)C.setData(b??ua([]));else if(b)n.addSource(Sa,{type:"geojson",data:b});else return;!n.getLayer(tl)&&x!=null&&x.fill&&n.addLayer({...x?.fill,id:tl,type:"fill",source:Sa}),!n.getLayer(rl)&&x!=null&&x.line&&n.addLayer({...x?.line,id:rl,type:"line",source:Sa})}function O(x){b=x,L()}n.on("styledata",()=>{setTimeout(()=>{b&&L()})});const M=x=>{i?.({type:"mapClick",coordinates:[x.lngLat.lng,x.lngLat.lat]})};function T(x=!1){if(!e)throw new Error;const C=document.createElement("div");return x&&C.classList.add("marker-interactive"),new Rf({props:{displayIn:"maplibre"},target:C}),new e.Marker({element:C,offset:[1,-13]})}return{setEventHandler(x){x?(i=x,n.on("click",M)):(i=void 0,n.off("click",M))},flyTo(x,C){n.flyTo({center:x,...C?{zoom:C}:{},...a})},fitBounds(x,C,_){n.fitBounds([[x[0],x[1]],[x[2],x[3]]],{padding:C,..._?{maxZoom:_}:{},...s})},indicateReverse(x){n.getCanvasContainer().style.cursor=x?"crosshair":""},setReverseMarker(x){!e||!t||(y?x?y.setLngLat(x):(y.remove(),y=void 0):x&&(t instanceof Function?y=t(n)??void 0:(y=(typeof t=="object"?new e.Marker(t):T()).setLngLat(x).addTo(n),y.getElement().classList.add("marker-reverse"))))},setFeatures(x,C,_){for(const D of f)D.remove();if(f.length=0,O(void 0),!!e){e:if(C){let D=!1;if(C.geometry.type==="GeometryCollection"){const z=C.geometry.geometries.filter(I=>I.type==="Polygon"||I.type==="MultiPolygon");t:if(z.length>0){const I=du(ua(z.map(F=>la(F))));if(!I)break t;Ys({...C,geometry:I.geometry},O),D=!0}else{const I=C.geometry.geometries.filter(F=>F.type==="LineString"||F.type==="MultiLineString");I.length>0&&(O({...C,geometry:{type:"GeometryCollection",geometries:I}}),D=!0)}}if(!D){if(C.geometry.type==="Polygon"||C.geometry.type==="MultiPolygon")Ys(C,O);else if(C.geometry.type==="LineString"||C.geometry.type==="MultiLineString"){O(C);break e}}if(!_&&!C.geometry.type.endsWith("Point"))break e;if(t instanceof Function){const z=t(n,C);z&&f.push(z)}else t&&f.push(typeof t=="object"?new e.Marker(t):T().setLngLat(C.center).addTo(n))}if(o)for(const D of x??[]){if(D===C)continue;let z;if(o instanceof Function){if(z=o(n,D),!z)continue}else z=(typeof o=="object"?new e.Marker(o):T(!0)).setLngLat(D.center).setPopup(new e.Popup({offset:[1,-27],closeButton:!1,closeOnMove:!0,className:"maptiler-gc-popup"}).setText(D.place_type[0]==="reverse"?D.place_name:D.place_name.replace(/,.*/,""))).addTo(n);const I=z.getElement();I.addEventListener("click",F=>{F.stopPropagation(),i?.({type:"markerClick",id:D.id})}),I.addEventListener("mouseenter",()=>{i?.({type:"markerMouseEnter",id:D.id}),z.togglePopup()}),I.addEventListener("mouseleave",()=>{i?.({type:"markerMouseLeave",id:D.id}),z.togglePopup()}),f.push(z)}}},setSelectedMarker(x){v&&v.getElement().classList.toggle("marker-selected",!1),v=x>-1?f[x]:void 0,v?.getElement().classList.toggle("marker-selected",!0)},getCenterAndZoom(){const x=n.getCenter();return[n.getZoom(),x.lng,x.lat]}}}function Tv(n,e,t){var o,a,s;class l{constructor(C,_){ze(this,"type"),ze(this,"target"),this.type=_,this.target=C}}class i extends l{constructor(C,_){super(C,"select"),ze(this,"feature"),Object.assign(this,_)}}class f extends l{constructor(C,_){super(C,"featureslisted"),ze(this,"features"),this.features=_}}class v extends l{constructor(C,_){super(C,"featuresmarked"),ze(this,"features"),this.features=_}}class y extends l{constructor(C,_){super(C,"optionsvisibilitychange"),ze(this,"optionsVisible"),this.optionsVisible=_}}class b extends l{constructor(C,_){super(C,"pick"),ze(this,"feature"),this.feature=_}}class L extends l{constructor(C,_){super(C,"querychange"),ze(this,"query"),this.query=_}}class O extends l{constructor(C,_,D){super(C,"response"),ze(this,"url"),ze(this,"featureCollection"),this.url=_,this.featureCollection=D}}class M extends l{constructor(C,_){super(C,"reversetoggle"),ze(this,"reverse"),this.reverse=_}}class T extends n{constructor(C={}){super(),vi(this,o),vi(this,a),vi(this,s),Aa(this,a,C)}onAddInt(C){const _=document.createElement("div");_.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl mapboxgl-ctrl-group";const{marker:D,showResultMarkers:z,flyTo:I,fullGeometryStyle:F,...j}=Yt(this,a),d=typeof I=="boolean"?{}:I,g={mapController:Pv(C,e,D,z,d,d,F),flyTo:I===void 0?!0:!!I,apiKey:"",...j};return g.apiKey||console.warn("No MapTiler Cloud API key was provided, some or all geocoding requests may fail"),Aa(this,o,new ov({target:_,props:g})),Yt(this,o).$on("select",h=>{this.fire(new i(this,h.detail))}),Yt(this,o).$on("pick",h=>{this.fire(new b(this,h.detail.feature))}),Yt(this,o).$on("featureslisted",h=>{this.fire(new f(this,h.detail.features))}),Yt(this,o).$on("featuresmarked",h=>{this.fire(new v(this,h.detail.features))}),Yt(this,o).$on("response",h=>{this.fire(new O(this,h.detail.url,h.detail.featureCollection))}),Yt(this,o).$on("optionsvisibilitychange",h=>{this.fire(new y(this,h.detail.optionsVisible))}),Yt(this,o).$on("reversetoggle",h=>{this.fire(new M(this,h.detail.reverse))}),Yt(this,o).$on("querychange",h=>{this.fire(new L(this,h.detail.query))}),Aa(this,s,_),_}on(C,_){return super.on(C,_)}once(C,_){return super.once(C,_)}off(C,_){return super.off(C,_)}listens(C){return super.listens(C)}setOptions(C){var _;Object.assign(Yt(this,a),C);const{marker:D,showResultMarkers:z,flyTo:I,fullGeometryStyle:F,...j}=Yt(this,a);(_=Yt(this,o))==null||_.$set(j)}setQuery(C,_=!0){var D;(D=Yt(this,o))==null||D.setQuery(C,_)}clearMap(){var C;(C=Yt(this,o))==null||C.clearMap()}clearList(){var C;(C=Yt(this,o))==null||C.clearList()}setReverseMode(C){var _;(_=Yt(this,o))==null||_.$set({reverseActive:C})}focus(C){var _;(_=Yt(this,o))==null||_.focus(C)}blur(){var C;(C=Yt(this,o))==null||C.blur()}onRemove(){var C,_,D;(C=Yt(this,o))==null||C.$destroy(),Aa(this,o,void 0),(D=(_=Yt(this,s))==null?void 0:_.parentNode)==null||D.removeChild(Yt(this,s))}}return o=new WeakMap,a=new WeakMap,s=new WeakMap,{MapLibreBasedGeocodingControl:T,events:{SelectEvent:i,FeaturesListedEvent:f,FeaturesMarkedEvent:v,OptionsVisibilityChangeEvent:y,PickEvent:b,QueryChangeEvent:L,ResponseEvent:O,ReverseToggleEvent:M}}}const{MapLibreBasedGeocodingControl:Iv}=Tv(Ai.Evented,bc);class Rv extends Iv{onAdd(e){return super.onAddInt(e)}}function Nv(n,e){Ne(e,!0);let t=we(void 0),o=["continental_marine","country","major_landform","region","subregion","county","joint_municipality","joint_submunicipality","municipality","municipal_district","locality","neighbourhood","place","postal_code","address","road","poi"];cr(()=>{r(t)&&(e.map?.removeControl(r(t)),X(t,void 0))}),Ze(()=>{e.map&&e.loaded&&!r(t)&&(X(t,new Rv({apiKey:Zn,maplibregl:$r,proximity:[{type:"map-center"}],types:o,country:e.country,marker:!0,showResultMarkers:!0,flyToOptions:{duration:1e3},fitBoundsOptions:{duration:1e3}}),!0),e.map.addControl(r(t),"top-left"))}),Be()}tr(["click"]);function yn(n,e,t){let o=["match",n];for(let[a,s]of Object.entries(e))o.push(a),o.push(s);return o.push(t),o}function dr(n,e,t){let o=["step",n];for(let a=1;a<e.length;a++)o.push(t[a-1]),o.push(e[a]);return o.push(t[t.length-1]),o}function nr(){return{type:"FeatureCollection",features:[]}}let Zn="MZEJTanw3WpxRvt7qDfo",nl=`https://api.maptiler.com/fonts/{fontstack}/{range}.pbf?key=${Zn}`;new Vc([["Blank",{version:8,sources:{},layers:[],glyphs:nl}],["Maptiler Streets",`https://api.maptiler.com/maps/streets-v2/style.json?key=${Zn}`],["Maptiler Dataviz",`https://api.maptiler.com/maps/dataviz/style.json?key=${Zn}`],["Maptiler Hybrid",`https://api.maptiler.com/maps/hybrid/style.json?key=${Zn}`],["Maptiler OpenStreetMap",`https://api.maptiler.com/maps/openstreetmap/style.json?key=${Zn}`],["Maptiler OS Open Zoomstack",`https://api.maptiler.com/maps/uk-openzoomstack-light/style.json?key=${Zn}`],["ESRI World Imagery",{version:8,sources:{"raster-tiles":{type:"raster",tiles:["https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:256,attribution:"ESRI &copy; <a href='http://www.esri.com' target='_blank'>ESRI</a>",minzoom:0,maxzoom:18}},layers:[{id:"raster-basemap",type:"raster",source:"raster-tiles"}],glyphs:nl}]]);var Bv=P('<p><a href="https://nptscot.github.io/manual/#routenetwork" target="_blank"> </a></p>'),Fv=P("<option> </option>"),Ov=P("<select></select>"),jv=P("<option> </option>"),zv=P("<select></select>"),Dv=P("<option> </option>"),Uv=P("<select></select>"),Gv=P("<option> </option>"),Wv=P("<select></select>"),Hv=P("<label><!></label> <label><!></label> <label><!></label> <label><!></label>",1),qv=P("<tr><th> </th><td> </td><td> </td><td> </td></tr>"),Jv=P("<tr><th> </th><td> </td><td> </td><td> </td></tr>"),Qv=P('<div style="max-width: 30vw; max-height: 60vh; overflow: auto;"><p><!></p> <p><!></p> <p><!></p> <details><summary> </summary> <p> </p> <table><tbody><tr><td></td><th> </th><th> </th><th> </th></tr><!></tbody></table> <p> </p> <table><tbody><tr><td></td><th> </th><th> </th><th> </th></tr><!></tbody></table></details></div>'),Zv=P("<!> <!>",1);function Vv(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=we(!1),a=we("all"),s=we("bicycle_go_dutch"),l=we("fastest"),i=we("flow"),f=[["all","All"],["commute","Commute"],["primary","Primary School"],["secondary","Secondary"],["utility","Other everyday"]],v=[["bicycle","Baseline"],["bicycle_go_dutch","Go Dutch"],["bicycle_ebike","E-bike"]],y=[["fastest","Fast/Direct"],["quietest","Quiet/Indirect"]],b=[["none","None"],["flow","People cycling per day"],["quietness","Cycle friendliness"],["gradient","Gradient"]],L={colorScale:["#59ee19","#37a009","#FFC300","#C70039","#581845","#000000"],limits:[3,5,7,10,100]};function O(z){return["let","base",["+",.3,["/",3,["+",1,["^",2.718,["-",2.94,["*",z,.0021]]]]]],["interpolate",["linear"],["zoom"],12,["*",2.1,["var","base"]],14,["*",5.25,["var","base"]],15,["*",7.5,["var","base"]],16,["*",18,["var","base"]],18,["*",52.5,["var","base"]]]]}function M(z){return["step",z,"rgba(0,0,0,0)",1,"#9C9C9C",50,"#FFFF73",100,"#AFFF00",250,"#00FFFF",500,"#30B0FF",1e3,"#2E5FFF",2e3,"#0000FF",3e3,"#FF00C5"]}let T=u(()=>`${r(a)}_${r(l)}_${r(s)}`),x=u(()=>({none:"#304ce7",flow:M(["get",r(T)]),quietness:["step",["get","quietness"],"#882255",25,"#CC6677",50,"#44AA99",75,"#117733",101,"#000000"],gradient:dr(["abs",["get","gradient"]],L.limits,L.colorScale)})[r(i)]);var C=Zv(),_=Q(C);{const z=j=>{var d=Bv(),g=c(d),h=c(g);J($=>U(h,$),[()=>r(t).t(188)]),p(j,d)},I=j=>{var d=Hv(),g=Q(d);{const S=E=>{var N=Ov();Jt(N,21,()=>f,Qt,(G,q)=>{var H=u(()=>Dr(r(q),2));let Y=()=>r(H)[0],ue=()=>r(H)[1];var oe=Fv(),Z=c(oe),te={};J(()=>{U(Z,ue()),te!==(te=Y())&&(oe.value=(oe.__value=Y())??"")}),p(G,oe)}),hn(N,()=>r(a),G=>X(a,G)),p(E,N)};var h=c(g);{let E=u(()=>[S]),N=u(()=>r(t).cx(230));me(h,{get t(){return r(E)},get x(){return r(N)}})}}var $=m(g,2);{const S=E=>{var N=zv();Jt(N,21,()=>v,Qt,(G,q)=>{var H=u(()=>Dr(r(q),2));let Y=()=>r(H)[0],ue=()=>r(H)[1];var oe=jv(),Z=c(oe),te={};J(()=>{U(Z,ue()),te!==(te=Y())&&(oe.value=(oe.__value=Y())??"")}),p(G,oe)}),hn(N,()=>r(s),G=>X(s,G)),p(E,N)};var w=c($);{let E=u(()=>[S]),N=u(()=>r(t).cx(231));me(w,{get t(){return r(E)},get x(){return r(N)}})}}var A=m($,2);{const S=E=>{var N=Uv();Jt(N,21,()=>y,Qt,(G,q)=>{var H=u(()=>Dr(r(q),2));let Y=()=>r(H)[0],ue=()=>r(H)[1];var oe=Dv(),Z=c(oe),te={};J(()=>{U(Z,ue()),te!==(te=Y())&&(oe.value=(oe.__value=Y())??"")}),p(G,oe)}),hn(N,()=>r(l),G=>X(l,G)),p(E,N)};var B=c(A);{let E=u(()=>[S]),N=u(()=>r(t).cx(232));me(B,{get t(){return r(E)},get x(){return r(N)}})}}var k=m(A,2);{const S=E=>{var N=Wv();Jt(N,21,()=>b,Qt,(G,q)=>{var H=u(()=>Dr(r(q),2));let Y=()=>r(H)[0],ue=()=>r(H)[1];var oe=Gv(),Z=c(oe),te={};J(()=>{U(Z,ue()),te!==(te=Y())&&(oe.value=(oe.__value=Y())??"")}),p(G,oe)}),hn(N,()=>r(i),G=>X(i,G)),p(E,N)};var R=c(k);{let E=u(()=>[S]),N=u(()=>r(t).cx(233));me(R,{get t(){return r(E)},get x(){return r(N)}})}}p(j,d)};let F=u(()=>r(t).t(229));Pr(_,{get label(){return r(F)},get show(){return r(o)},set show(j){X(o,j,!0)},help:z,legend:I,$$slots:{help:!0,legend:!0}})}var D=m(_,2);{let z=u(()=>`pmtiles://${Qr("cnt/layers/route_network.pmtiles")}`);ga(D,{get url(){return r(z)},children:(I,F)=>{{let j=u(()=>We("context-route-network")),d=u(()=>({"line-color":r(x),"line-width":O(["get",r(T)])})),g=u(()=>({visibility:r(o)?"visible":"none"}));gt(I,Le(()=>r(j),{sourceLayer:"rnet",get paint(){return r(d)},get layout(){return r(g)},hoverCursor:"pointer",children:(h,$)=>{Bt(h,{openOn:"click",children:(A,B)=>{let k=()=>B?.().data;const R=u(()=>k().properties);var S=Qv(),E=c(S),N=c(E);{let Ie=u(()=>r(t).cx(234)),Re=u(()=>[r(R)[r(T)].toLocaleString()]);me(N,{get x(){return r(Ie)},get a(){return r(Re)}})}var G=m(E,2),q=c(G);{let Ie=u(()=>r(t).cx(235)),Re=u(()=>[r(R).gradient]);me(q,{get x(){return r(Ie)},get a(){return r(Re)}})}var H=m(G,2),Y=c(H);{let Ie=u(()=>r(t).cx(236)),Re=u(()=>[r(R).quietness]);me(Y,{get x(){return r(Ie)},get a(){return r(Re)}})}var ue=m(H,2),oe=c(ue),Z=c(oe),te=m(oe,2),K=c(te),V=m(te,2),ee=c(V),re=c(ee),ae=m(c(re)),ne=c(ae),ie=m(ae),_e=c(ie),le=m(ie),fe=c(le),se=m(re);Jt(se,17,()=>f,Qt,(Ie,Re)=>{var Ue=u(()=>Dr(r(Re),2));let Ge=()=>r(Ue)[0],Je=()=>r(Ue)[1];var Oe=qv(),Qe=c(Oe),qe=c(Qe),Xe=m(Qe),st=c(Xe),ft=m(Xe),wt=c(ft),At=m(ft),mt=c(At);J((Mt,tt,it)=>{U(qe,Je()),U(st,Mt),U(wt,tt),U(mt,it)},[()=>r(R)[`${Ge()}_fastest_bicycle`].toLocaleString(),()=>r(R)[`${Ge()}_fastest_bicycle_go_dutch`].toLocaleString(),()=>r(R)[`${Ge()}_fastest_bicycle_ebike`].toLocaleString()]),p(Ie,Oe)});var ye=m(V,2),he=c(ye),Se=m(ye,2),xe=c(Se),Fe=c(xe),ke=m(c(Fe)),Ce=c(ke),pe=m(ke),Me=c(pe),Te=m(pe),Ae=c(Te),Ee=m(Fe);Jt(Ee,17,()=>f,Qt,(Ie,Re)=>{var Ue=u(()=>Dr(r(Re),2));let Ge=()=>r(Ue)[0],Je=()=>r(Ue)[1];var Oe=Jv(),Qe=c(Oe),qe=c(Qe),Xe=m(Qe),st=c(Xe),ft=m(Xe),wt=c(ft),At=m(ft),mt=c(At);J((Mt,tt,it)=>{U(qe,Je()),U(st,Mt),U(wt,tt),U(mt,it)},[()=>r(R)[`${Ge()}_quietest_bicycle`].toLocaleString(),()=>r(R)[`${Ge()}_quietest_bicycle_go_dutch`].toLocaleString(),()=>r(R)[`${Ge()}_quietest_bicycle_ebike`].toLocaleString()]),p(Ie,Oe)}),J((Ie,Re,Ue,Ge,Je,Oe,Qe,qe,Xe)=>{U(Z,Ie),U(K,Re),U(ne,Ue),U(_e,Ge),U(fe,Je),U(he,Oe),U(Ce,Qe),U(Me,qe),U(Ae,Xe)},[()=>r(t).t(237),()=>r(t).t(238),()=>r(t).t(239),()=>r(t).t(240),()=>r(t).t(241),()=>r(t).t(242),()=>r(t).t(239),()=>r(t).t(240),()=>r(t).t(241)]),p(A,S)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}p(n,C),Be()}var Kv=P('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),Xv=P('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),Yv=P('<p><a href="https://nptscot.github.io/manual/#infrastructureandtraffic" target="_blank"> </a></p>'),eg=P("<!> <!> <!>",1),tg=P('<!> <!> <!> <div class="layer-group"> </div> <!> <!>',1);function rg(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=we(!1),a=we(!1),s=we(!1),l={colorScale:["#27918d","#ffaa33","#440154"],limits:[0,2e3,4e3,1e4]},i={High:"mediumseagreen",Medium:"orange",Low:"red","Should not be used":"brown"},f={"Segregated Track (wide)":"#054d05","Off Road Cycleway":"#3a9120","Segregated Track (narrow)":"#87d668","Shared Footway":"#ffbf00","Painted Cycle Lane":"#7faedd"};var v=tg(),y=Q(v);{const C=z=>{rs(z,{get labelColors(){return f}})},_=z=>{var I=Kv(),F=c(I),j=c(F);J(d=>U(j,d),[()=>r(t).t(188)]),p(z,I)};let D=u(()=>r(t).t(187));Pr(y,{get label(){return r(D)},get show(){return r(s)},set show(z){X(s,z,!0)},legend:C,help:_,$$slots:{legend:!0,help:!0}})}var b=m(y,2);{const C=z=>{{let I=u(()=>Object.values(i)),F=u(()=>({buckets:Object.keys(i)}));hr(z,{get colorScale(){return r(I)},get labels(){return r(F)},fullWidthBucketLegend:!0})}},_=z=>{var I=Xv(),F=c(I),j=c(F);J(d=>U(j,d),[()=>r(t).t(188)]),p(z,I)};let D=u(()=>r(t).t(189));Pr(b,{get label(){return r(D)},get show(){return r(a)},set show(z){X(a,z,!0)},legend:C,help:_,$$slots:{legend:!0,help:!0}})}var L=m(b,2);Vv(L,{});var O=m(L,2),M=c(O),T=m(O,2);{const C=z=>{{let I=u(()=>({limits:l.limits}));hr(z,{get colorScale(){return l.colorScale},get labels(){return r(I)}})}},_=z=>{var I=Yv(),F=c(I),j=c(F);J(d=>U(j,d),[()=>r(t).t(188)]),p(z,I)};let D=u(()=>r(t).t(191));Pr(T,{get label(){return r(D)},get show(){return r(o)},set show(z){X(o,z,!0)},legend:C,help:_,$$slots:{legend:!0,help:!0}})}var x=m(T,2);{let C=u(()=>`pmtiles://${Qr("cnt/layers/cbd.pmtiles")}`);ga(x,{get url(){return r(C)},children:(_,D)=>{var z=eg(),I=Q(z);{let d=u(()=>We("context-traffic")),g=u(()=>["has",r(t).t(192)]),h=u(()=>({"line-color":yn(["get",r(t).t(192)],{"0 to 1999":l.colorScale[0],"2000 to 3999":l.colorScale[1],"4000+":l.colorScale[2]},"cyan"),"line-width":lo(0)})),$=u(()=>({visibility:r(o)?"visible":"none"}));gt(I,Le(()=>r(d),{sourceLayer:"cbd_layer",get filter(){return r(g)},get paint(){return r(h)},get layout(){return r($)}}))}var F=m(I,2);{let d=u(()=>We("context-los")),g=u(()=>({"line-color":yn(["get",r(t).t(193)],i,"cyan"),"line-width":lo(1)})),h=u(()=>({visibility:r(a)?"visible":"none"}));gt(F,Le(()=>r(d),{sourceLayer:"cbd_layer",get paint(){return r(g)},get layout(){return r(h)}}))}var j=m(F,2);{let d=u(()=>We("context-existing-infra")),g=u(()=>["!=",["get",r(t).t(194)],r(t).t(195)]),h=u(()=>({"line-color":yn(["get",r(t).t(194)],f,"cyan"),"line-width":lo(1)})),$=u(()=>({visibility:r(s)?"visible":"none"}));gt(j,Le(()=>r(d),{sourceLayer:"cbd_layer",get filter(){return r(g)},get paint(){return r(h)},get layout(){return r($)}}))}p(_,z)},$$slots:{default:!0}})}J(C=>U(M,C),[()=>r(t).t(190)]),p(n,v),Be()}var ng=P('<a href="https://www.data.gov.uk/dataset/9a6f9d86-9698-4a5d-a2c8-89f3b212c52c/scottish-school-roll-and-locations" target="_blank"> </a>'),og=P('<a href="https://data.spatialhub.scot/dataset/gp_practices-is" target="_blank"> </a>'),ag=P('<a href="https://data.spatialhub.scot/dataset/nhs_hospitals-is" target="_blank"> </a>'),ig=P('<a href="https://www.openstreetmap.org/about" target="_blank"> </a>'),sg=P("<p><!></p>"),lg=P("<!> <!>",1);function ug(n,e){Ne(e,!0);const t=()=>be(It,"$backend",o),[o,a]=ut(),s=u(()=>ct(dt("main")));let l=we(!1),i={School:"#7fc97f",GP:"#beaed4",Hospital:"#fdc086",Grocery:"#386cb0",CommunityCenter:"#ffff99",Recreation:"#f0027f"};var f=lg(),v=Q(f);{const L=T=>{rs(T,{get labelColors(){return i},swatchClass:"circle"})},O=T=>{var x=sg();{const _=(F,j=Pe)=>{var d=ng(),g=c(d);J(h=>U(g,h),[()=>r(s).tx(j())]),p(F,d)},D=(F,j=Pe)=>{var d=og(),g=c(d);J(h=>U(g,h),[()=>r(s).tx(j())]),p(F,d)},z=(F,j=Pe)=>{var d=ag(),g=c(d);J(h=>U(g,h),[()=>r(s).tx(j())]),p(F,d)},I=(F,j=Pe)=>{var d=ig(),g=c(d);J(h=>U(g,h),[()=>r(s).tx(j())]),p(F,d)};var C=c(x);{let F=u(()=>[_,D,z,I]),j=u(()=>r(s).cx(208));me(C,{get t(){return r(F)},get x(){return r(j)}})}}p(T,x)};let M=u(()=>r(s).t(207));Pr(v,{get label(){return r(M)},get show(){return r(l)},set show(T){X(l,T,!0)},legend:L,help:O,$$slots:{legend:!0,help:!0}})}var y=m(v,2);{var b=L=>{{let O=u(()=>t().getPOIs());lt(L,{get data(){return r(O)},generateId:!0,children:(M,T)=>{{let x=u(()=>We("context-pois")),C=u(()=>({"circle-color":yn(["get","kind"],i,"black"),"circle-radius":10,"circle-stroke-color":"black","circle-stroke-width":1,"circle-opacity":.8})),_=u(()=>({visibility:r(l)?"visible":"none"}));Pn(M,Le(()=>r(x),{get paint(){return r(C)},get layout(){return r(_)},children:(D,z)=>{Bt(D,{openOn:"hover",children:(F,j)=>{let d=()=>j?.().data;const g=u(()=>d().properties);var h=Dt();J(()=>U(h,r(g).name||`unnamed ${r(g).kind}`)),p(F,h)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}};ve(y,L=>{t()&&L(b)})}p(n,f),Be(),a()}var cg=P('<!> <div style="display: flex; justify-content: space-between;"><span> </span> <span> </span></div>',1),dg=P('<a href="https://www.data.gov.uk/dataset/1102bf85-ed49-440a-b211-da87e8d752eb/scottish-index-of-multiple-deprivation-simd-2020" target="_blank"> </a>'),fg=P("<p><!></p>"),vg=P('<!> <div style="display: flex; justify-content: space-between;"><span> </span> <span> </span> <span> </span></div>',1),gg=P('<a href="https://www.data.gov.uk/dataset/1102bf85-ed49-440a-b211-da87e8d752eb/scottish-index-of-multiple-deprivation-simd-2020" target="_blank"> </a>'),_g=P("<p><!></p>"),pg=P('<!> <div style="display: flex; justify-content: space-between;"><span style="text-align: center; width: 100%"> </span></div>',1),hg=P("<p> </p>"),mg=P("<p><!></p>"),bg=P("<p><!></p>"),yg=P("<p><!></p>"),Ag=P("<!> <!> <!> <!>",1),wg=P("<!> <!> <!> <!>",1);function xg(n,e){Ne(e,!0);const t=()=>be(ho,"$metricBuckets",o),[o,a]=ut(),s=u(()=>ct(dt("main")));let l=we(!1),i=we(!1),f=we(!1);var v=wg(),y=Q(v);{const M=C=>{var _=cg(),D=Q(_);{let g=u(()=>Vo.toReversed()),h=u(()=>({buckets:wl(Yo).toReversed()}));hr(D,{get colorScale(){return r(g)},get labels(){return r(h)}})}var z=m(D,2),I=c(z),F=c(I),j=m(I,2),d=c(j);J((g,h)=>{U(F,g),U(d,h)},[()=>r(s).t(210),()=>r(s).t(211)]),p(C,_)},T=C=>{var _=fg();{const z=(I,F=Pe)=>{var j=dg(),d=c(j);J(g=>U(d,g),[()=>r(s).tx(F())]),p(I,j)};var D=c(_);{let I=u(()=>[z]),F=u(()=>r(s).cx(212));me(D,{get t(){return r(I)},get x(){return r(F)}})}}p(C,_)};let x=u(()=>r(s).t(209));Pr(y,{get label(){return r(x)},onChange:()=>{r(l)&&(X(i,!1),X(f,!1))},get show(){return r(l)},set show(C){X(l,C,!0)},legend:M,help:T,$$slots:{legend:!0,help:!0}})}var b=m(y,2);{const M=C=>{var _=vg(),D=Q(_);{let $=u(()=>({limits:t().population_density}));hr(D,{get colorScale(){return Zo},get labels(){return r($)}})}var z=m(D,2),I=c(z),F=c(I),j=m(I,2),d=c(j),g=m(j,2),h=c(g);J(($,w,A)=>{U(F,$),U(d,w),U(h,A)},[()=>r(s).t(214),()=>r(s).t(215),()=>r(s).t(216)]),p(C,_)},T=C=>{var _=_g();{const z=(I,F=Pe)=>{var j=gg(),d=c(j);J(g=>U(d,g),[()=>r(s).tx(F())]),p(I,j)};var D=c(_);{let I=u(()=>[z]),F=u(()=>r(s).cx(217));me(D,{get t(){return r(I)},get x(){return r(F)}})}}p(C,_)};let x=u(()=>r(s).t(213));Pr(b,{get label(){return r(x)},onChange:()=>{r(i)&&(X(l,!1),X(f,!1))},get show(){return r(i)},set show(C){X(i,C,!0)},legend:M,help:T,$$slots:{legend:!0,help:!0}})}var L=m(b,2);{const M=C=>{var _=pg(),D=Q(_);{let j=u(()=>Ko.toReversed()),d=u(()=>({limits:Xo.toReversed().map(g=>`${g}%`)}));hr(D,{get colorScale(){return r(j)},get labels(){return r(d)}})}var z=m(D,2),I=c(z),F=c(I);J(j=>U(F,j),[()=>r(s).t(219)]),p(C,_)},T=C=>{var _=hg(),D=c(_);J(z=>U(D,z),[()=>r(s).t(220)]),p(C,_)};let x=u(()=>r(s).t(218));Pr(L,{get label(){return r(x)},onChange:()=>{r(f)&&(X(l,!1),X(i,!1))},get show(){return r(f)},set show(C){X(f,C,!0)},legend:M,help:T,$$slots:{legend:!0,help:!0}})}var O=m(L,2);{let M=u(()=>`pmtiles://${Qr("cnt/layers/population.pmtiles")}`);ga(O,{get url(){return r(M)},children:(T,x)=>{var C=Ag(),_=Q(C);{let F=u(()=>We("context-simd")),j=u(()=>({"fill-color":dr(["get","imd_percentile"],Yo,Vo),"fill-opacity":bt(.7,.9)})),d=u(()=>({visibility:r(l)?"visible":"none"}));ur(_,Le(()=>r(F),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(j)},get layout(){return r(d)},children:(g,h)=>{Bt(g,{openOn:"hover",children:(w,A)=>{let B=()=>A?.().data;const k=u(()=>B().properties);var R=mg(),S=c(R);{let E=u(()=>r(s).cx(221)),N=u(()=>[r(k).id,r(k).population.toLocaleString(),r(k).imd_rank,r(k).imd_percentile]);me(S,{get x(){return r(E)},get a(){return r(N)}})}p(w,R)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var D=m(_,2);{let F=u(()=>We("context-population-car-ownership")),j=u(()=>({"fill-color":dr(["*",100,["/",["get","households_with_cars_or_vans"],["get","total_households"]]],Xo,Ko),"fill-opacity":bt(.7,.9)})),d=u(()=>({visibility:r(f)?"visible":"none"}));ur(D,Le(()=>r(F),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(j)},get layout(){return r(d)},children:(g,h)=>{Bt(g,{openOn:"hover",children:(w,A)=>{let B=()=>A?.().data;const k=u(()=>B().properties);var R=bg(),S=c(R);{let E=u(()=>r(s).cx(222)),N=u(()=>[r(k).id,Wi(r(k).households_with_cars_or_vans,r(k).total_households),r(k).total_households.toLocaleString()]);me(S,{get x(){return r(E)},get a(){return r(N)}})}p(w,R)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var z=m(D,2);{let F=u(()=>We("context-population-density")),j=u(()=>({"fill-color":dr(["/",["get","population"],["/",["get","area"],1e6]],t().population_density,Zo),"fill-opacity":bt(.7,.9)})),d=u(()=>({visibility:r(i)?"visible":"none"}));ur(z,Le(()=>r(F),{sourceLayer:"population",manageHoverState:!0,get paint(){return r(j)},get layout(){return r(d)},children:(g,h)=>{Bt(g,{openOn:"hover",children:(w,A)=>{let B=()=>A?.().data;const k=u(()=>B().properties);var R=yg(),S=c(R);{let E=u(()=>r(s).cx(223)),N=u(()=>[r(k).id,r(k).population.toLocaleString(),Math.round(r(k).population/(r(k).area/1e6)).toLocaleString()]);me(S,{get x(){return r(E)},get a(){return r(N)}})}p(w,R)},$$slots:{default:!0}})},$$slots:{default:!0}}))}var I=m(z,2);{let F=u(()=>We("context-population-outline")),j=u(()=>({visibility:r(l)||r(i)||r(f)?"visible":"none"}));gt(I,Le(()=>r(F),{sourceLayer:"population",paint:{"line-color":"black","line-width":1},get layout(){return r(j)}}))}p(T,C)},$$slots:{default:!0}})}p(n,v),Be(),a()}var $g=P("<img/>"),kg=P('<div style="display: flex; gap: 8px; align-items: center;"><!></div>'),Sg=P('<a href="https://wiki.openstreetmap.org/wiki/Tag:railway%3Dstation" target="_blank"> </a>'),Eg=P("<p><!></p>"),Lg=P("<p> </p>"),Cg=P("<!> <!>",1);function Mg(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=we(!1);var a=Cg(),s=Q(a);{const i=y=>{var b=kg();{const O=M=>{var T=$g();J(x=>{De(T,"src",Nl),De(T,"alt",x)},[()=>r(t).t(225)]),p(M,T)};var L=c(b);{let M=u(()=>[O]),T=u(()=>r(t).cx(226));me(L,{get t(){return r(M)},get x(){return r(T)}})}}p(y,b)},f=y=>{var b=Eg();{const O=(M,T=Pe)=>{var x=Sg(),C=c(x);J(_=>U(C,_),[()=>r(t).tx(T())]),p(M,x)};var L=c(b);{let M=u(()=>[O]),T=u(()=>r(t).cx(227));me(L,{get t(){return r(M)},get x(){return r(T)}})}}p(y,b)};let v=u(()=>r(t).t(224));Pr(s,{get label(){return r(v)},get show(){return r(o)},set show(y){X(o,y,!0)},legend:i,help:f,$$slots:{legend:!0,help:!0}})}var l=m(s,2);{let i=u(()=>Qr("cnt/layers/railways.geojson"));lt(l,{get data(){return r(i)},generateId:!0,children:(f,v)=>{{let y=u(()=>We("context-railway-stations")),b=u(()=>({"icon-image":"national_rail","icon-size":1,"icon-allow-overlap":!0,visibility:r(o)?"visible":"none"}));vo(f,Le(()=>r(y),{get layout(){return r(b)},children:(L,O)=>{Bt(L,{openOn:"hover",children:(T,x)=>{let C=()=>x?.().data;var _=Lg(),D=c(_);J(z=>U(D,z),[()=>C().properties.name??r(t).t(228)]),p(T,_)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}p(n,a),Be()}var Pg=P('<a href="https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-safety-data" target="_blank"> </a>'),Tg=P('<a href="https://www.gov.uk/guidance/road-accident-and-safety-statistics-guidance" target="_blank"> </a>'),Ig=P('<a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" target="_blank"> </a>'),Rg=P("<p><!></p> <ul><li> </li> <li> </li> <li> </li> <li> </li> <li><!></li></ul> <p> </p> <p><!></p>",1),Ng=P('<input type="checkbox" class="svelte-1pznq80"/>'),Bg=P('<input type="checkbox" class="svelte-1pznq80"/>'),Fg=P('<input type="number" class="svelte-1pznq80"/>'),Og=P('<input type="number" class="svelte-1pznq80"/>'),jg=P('<fieldset style="display: flex; gap: 3em;" class="svelte-1pznq80"><label><!></label> <label><!></label></fieldset> <fieldset class="year-filter svelte-1pznq80"><label><!></label> <label><!></label></fieldset> <!>',1),zg=P("<b> </b>"),Dg=P("<b> </b>"),Ug=P("<b> </b>"),Gg=P("<b> </b>"),Wg=P("<p><!></p>"),Hg=P("<b> </b>"),qg=P("<p><!></p>"),Jg=P("<p><!></p> <p><!></p> <p><!></p> <!> <!> <p> </p>",1),Qg=P("<!> <!>",1),Zg=P("<!> <!>",1);function Vg(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=we(!1),a=ht({pedestrians:!0,cyclists:!0,minYear:2017,maxYear:2023});function s(_){let D=["any"];return a.pedestrians&&D.push(["get","pedestrian"]),a.cyclists&&D.push(["get","cyclist"]),["all",[">=",["get","year"],a.minYear],["<=",["get","year"],a.maxYear],D]}function l(_){let D=[];return _.pedestrian&&D.push("pedestrian"),_.cyclist&&D.push("cyclist"),D.join(", ")}function i(_){window.open(`https://www.cyclestreets.net/collisions/reports/${_.features[0].properties.accident_index}`,"_blank")}let f={1:"Crossing on pedestrian crossing facility",2:"Crossing in zig-zag approach lines",3:"Crossing in zig-zag exit lines",4:"Crossing elsewhere within 50m. of pedestrian crossing",5:"In carriageway, crossing elsewhere",6:"On footway or verge",7:"On refuge, central island or central reservation",8:"In centre of carriageway - not on refuge, island or central reservation",9:"In carriageway, not crossing"},v={1:"Crossing from driver's nearside",2:"Crossing from nearside - masked by parked or stationary vehicle",3:"Crossing from driver's offside",4:"Crossing from offside - masked by parked or stationary vehicle",5:"In carriageway, stationary - not crossing (standing or playing)",6:"In carriageway, stationary - not crossing (standing or playing - masked by parked or stationary vehicle)",7:"Walking along in carriageway, facing traffic",8:"Walking along in carriageway, back to traffic"},y={1:"Fatal",2:"Serious",3:"Slight"},b="#080C54",L="#1F9EB7",O="#CDE594",M={Slight:O,Serious:L,Fatal:b};var T=Zg(),x=Q(T);{const _=I=>{var F=Rg(),j=Q(F);{const ue=(oe,Z=Pe)=>{var te=Pg(),K=c(te);J(V=>U(K,V),[()=>r(t).tx(Z())]),p(oe,te)};var d=c(j);{let oe=u(()=>[ue]),Z=u(()=>r(t).cx(244));me(d,{get t(){return r(oe)},get x(){return r(Z)}})}}var g=m(j,2),h=c(g),$=c(h),w=m(h,2),A=c(w),B=m(w,2),k=c(B),R=m(B,2),S=c(R),E=m(R,2);{const ue=(oe,Z=Pe)=>{var te=Tg(),K=c(te);J(V=>U(K,V),[()=>r(t).tx(Z())]),p(oe,te)};var N=c(E);{let oe=u(()=>[ue]),Z=u(()=>r(t).cx(249));me(N,{get t(){return r(oe)},get x(){return r(Z)}})}}var G=m(g,2),q=c(G),H=m(G,2);{const ue=(oe,Z=Pe)=>{var te=Ig(),K=c(te);J(V=>U(K,V),[()=>r(t).tx(Z())]),p(oe,te)};var Y=c(H);{let oe=u(()=>[ue]),Z=u(()=>r(t).cx(251));me(Y,{get t(){return r(oe)},get x(){return r(Z)}})}}J((ue,oe,Z,te,K)=>{U($,ue),U(A,oe),U(k,Z),U(S,te),U(q,K)},[()=>r(t).t(245),()=>r(t).t(246),()=>r(t).t(247),()=>r(t).t(248),()=>r(t).t(250)]),p(I,F)},D=I=>{var F=jg(),j=Q(F),d=c(j);{const E=N=>{var G=Ng();pn(G,()=>a.pedestrians,q=>a.pedestrians=q),p(N,G)};var g=c(d);{let N=u(()=>[E]),G=u(()=>r(t).cx(252));me(g,{get t(){return r(N)},get x(){return r(G)}})}}var h=m(d,2);{const E=N=>{var G=Bg();pn(G,()=>a.cyclists,q=>a.cyclists=q),p(N,G)};var $=c(h);{let N=u(()=>[E]),G=u(()=>r(t).cx(253));me($,{get t(){return r(N)},get x(){return r(G)}})}}var w=m(j,2),A=c(w);{const E=N=>{var G=Fg();De(G,"min",2017),De(G,"max",2023),ea(G,()=>a.minYear,q=>a.minYear=q),p(N,G)};var B=c(A);{let N=u(()=>[E]),G=u(()=>r(t).cx(254));me(B,{get t(){return r(N)},get x(){return r(G)}})}}var k=m(A,2);{const E=N=>{var G=Og();De(G,"min",2017),De(G,"max",2023),ea(G,()=>a.maxYear,q=>a.maxYear=q),p(N,G)};var R=c(k);{let N=u(()=>[E]),G=u(()=>r(t).cx(255));me(R,{get t(){return r(N)},get x(){return r(G)}})}}var S=m(w,2);rs(S,{get labelColors(){return M},swatchClass:"circle",itemsPerRow:3}),p(I,F)};let z=u(()=>r(t).t(243));Pr(x,{get label(){return r(z)},get show(){return r(o)},set show(I){X(o,I,!0)},help:_,legend:D,$$slots:{help:!0,legend:!0}})}var C=m(x,2);{let _=u(()=>`pmtiles://${Qr("cnt/layers/stats19.pmtiles")}`);ga(C,{get url(){return r(_)},children:(D,z)=>{var I=Qg(),F=Q(I);{let d=u(()=>We("context-stats19-heatmap")),g=u(()=>s()),h=u(()=>({visibility:r(o)?"visible":"none"}));nd(F,Le(()=>r(d),{sourceLayer:"stats19",maxzoom:13,get filter(){return r(g)},get layout(){return r(h)},paint:{"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,9,15]}}))}var j=m(F,2);{let d=u(()=>We("context-stats19-points")),g=u(()=>({"circle-color":dr(["get","severity"],[1,2,3],[b,L,O]),"circle-opacity":.9,"circle-radius":13,"circle-stroke-color":"black","circle-stroke-width":.1})),h=u(()=>s()),$=u(()=>({visibility:r(o)?"visible":"none"}));Pn(j,Le(()=>r(d),{sourceLayer:"stats19",minzoom:13,get paint(){return r(g)},get filter(){return r(h)},get layout(){return r($)},hoverCursor:"pointer",onclick:i,children:(w,A)=>{Bt(w,{openOn:"click",children:(k,R)=>{let S=()=>R?.().data;const E=u(()=>S().properties);var N=Jg(),G=Q(N);{const ae=ne=>{var ie=zg(),_e=c(ie);J(()=>U(_e,r(E).year)),p(ne,ie)};var q=c(G);{let ne=u(()=>[ae]),ie=u(()=>r(t).cx(256));me(q,{get t(){return r(ne)},get x(){return r(ie)}})}}var H=m(G,2);{const ae=ne=>{var ie=Dg(),_e=c(ie);J(()=>U(_e,y[r(E).severity])),p(ne,ie)};var Y=c(H);{let ne=u(()=>[ae]),ie=u(()=>r(t).cx(257));me(Y,{get t(){return r(ne)},get x(){return r(ie)}})}}var ue=m(H,2);{const ae=ne=>{var ie=Ug(),_e=c(ie);J(le=>U(_e,le),[()=>l(r(E))]),p(ne,ie)};var oe=c(ue);{let ne=u(()=>[ae]),ie=u(()=>r(t).cx(258));me(oe,{get t(){return r(ne)},get x(){return r(ie)}})}}var Z=m(ue,2);{var te=ae=>{var ne=Wg();{const _e=le=>{var fe=Gg(),se=c(fe);J(()=>U(se,f[r(E).pedestrian_location])),p(le,fe)};var ie=c(ne);{let le=u(()=>[_e]),fe=u(()=>r(t).cx(259));me(ie,{get t(){return r(le)},get x(){return r(fe)}})}}p(ae,ne)};ve(Z,ae=>{r(E).pedestrian_location&&ae(te)})}var K=m(Z,2);{var V=ae=>{var ne=qg();{const _e=le=>{var fe=Hg(),se=c(fe);J(()=>U(se,v[r(E).pedestrian_movement])),p(le,fe)};var ie=c(ne);{let le=u(()=>[_e]),fe=u(()=>r(t).cx(260));me(ie,{get t(){return r(le)},get x(){return r(fe)}})}}p(ae,ne)};ve(K,ae=>{r(E).pedestrian_movement&&ae(V)})}var ee=m(K,2),re=c(ee);J(ae=>U(re,ae),[()=>r(t).t(261)]),p(k,N)},$$slots:{default:!0}})},$$slots:{default:!0}}))}p(D,I)},$$slots:{default:!0}})}p(n,T),Be()}var Kg=(n,e)=>X(e,!r(e)),Xg=P('<div class="layer-group"> </div> <!> <!> <!> <div class="layer-group"> </div> <!> <!> <div class="layer-group"> </div> <!>',1),Yg=P("<!> <!>",1),e_=P('<input type="checkbox" role="switch"/>'),t_=P('<div class="pico contextual-layers svelte-6ypeli"><button><div style="display: flex; gap: 12px; color: #333; align-items: center; justify-content: center;"><!> <!></div></button> <div class="contextual-layer-controls svelte-6ypeli"><!> <div class="context-control"><span style="font-size: 20px; margin-left: 8px; margin-top: 4px;"> </span> <select style="width: auto; font-size: 20px; margin: 8px; padding: 8px; text-overflow: ellipsis;"><option> </option><option> </option><option> </option><option> </option></select> <!> <span style="font-size: 20px; margin-left: 8px; margin-top: 4px;"> </span> <label><!></label> <!></div></div></div>');function r_(n,e){Ne(e,!0);const t=()=>be(It,"$backend",f),o=()=>be(Ra,"$showExistingFiltersAndTRs",f),a=()=>be(Kr,"$appFocus",f),s=()=>be(wi,"$maptilerBasemap",f),l=()=>be(Na,"$useMetricUnits",f),i=()=>be(ta,"$devMode",f),[f,v]=ut(),y=u(()=>ct(dt("main")));let b=we(!1);Ti(n,{defaultStyling:!0,children:(L,O)=>{var M=t_();let T;var x=c(M);x.__click=[Kg,b];var C=c(x),_=c(C);Hc(_,{color:"#333"});var D=m(_,2);{var z=te=>{var K=Dt();J(V=>U(K,V),[()=>r(y).t(196)]),p(te,K)};ve(D,te=>{r(b)&&te(z)})}var I=m(x,2);let F;var j=c(I);{var d=te=>{var K=Yg(),V=Q(K);{let ae=u(()=>r(y).t(197));Pr(V,{get label(){return r(ae)},get show(){return ra(),o()},set show(ne){Ve(Ra,ne)}})}var ee=m(V,2);{var re=ae=>{var ne=Xg(),ie=Q(ne),_e=c(ie),le=m(ie,2);xg(le,{});var fe=m(le,2);ug(fe,{});var se=m(fe,2);Vg(se,{});var ye=m(se,2),he=c(ye),Se=m(ye,2);Mg(Se,{});var xe=m(Se,2);Wd(xe,{});var Fe=m(xe,2),ke=c(Fe),Ce=m(Fe,2);rg(Ce,{}),J((pe,Me,Te)=>{U(_e,pe),U(he,Me),U(ke,Te)},[()=>r(y).t(198),()=>r(y).t(199),()=>r(y).t(200)]),p(ae,ne)};ve(ee,ae=>{a()=="cnt"&&ae(re)})}p(te,K)};ve(j,te=>{t()&&te(d)})}var g=m(j,2),h=c(g),$=c(h),w=m(h,2),A=c(w),B=c(A);A.value=A.__value="dataviz";var k=m(A),R=c(k);k.value=k.__value="streets-v2";var S=m(k),E=c(S);S.value=S.__value="hybrid";var N=m(S),G=c(N);N.value=N.__value="uk-openzoomstack-light";var q=m(w,2);xl(q,{});var H=m(q,2),Y=c(H),ue=m(H,2);{const te=K=>{var V=e_();pn(V,l,ee=>Ve(Na,ee)),p(K,V)};var oe=c(ue);{let K=u(()=>[te]),V=u(()=>r(y).cx(467));me(oe,{get t(){return r(K)},get x(){return r(V)}})}}var Z=m(ue,2);{let te=u(()=>r(y).t(206));Pr(Z,{get label(){return r(te)},get show(){return ra(),i()},set show(K){Ve(ta,K)}})}J((te,K,V,ee,re,ae,ne,ie,_e)=>{T=fr(M,"display: flex; flex-direction: column; border-radius: 5px;",T,te),St(x,1,`show-layers-button icon-btn ${r(b)?"expanded":""}`,"svelte-6ypeli"),De(x,"aria-label",K),F=fr(I,"flex-direction: column;",F,V),U($,ee),U(B,re),U(R,ae),U(E,ne),U(G,ie),U(Y,_e)},[()=>({width:r(b)?"300px":"auto"}),()=>r(y).t(196),()=>({display:r(b)?"flex":"none"}),()=>r(y).t(201),()=>r(y).t(202),()=>r(y).t(203),()=>r(y).t(204),()=>r(y).t(205),()=>r(y).t(475)]),hn(w,s,te=>Ve(wi,te)),p(L,M)},$$slots:{default:!0}}),Be(),v()}tr(["click"]);var n_=P('<div class="flex-container svelte-eqsjzd"><div class="top svelte-eqsjzd"><!></div> <div class="content svelte-eqsjzd"><div class="left svelte-eqsjzd"><!></div> <div class="main svelte-eqsjzd"><!></div></div></div>');function o_(n,e){Ne(e,!0),Ze(()=>{qo.value&&Qa.value&&(qo.value.innerHTML="",qo.value.appendChild(Qa.value))}),Ze(()=>{Jo.value&&Za.value&&(Jo.value.innerHTML="",Jo.value.appendChild(Za.value))}),Ze(()=>{Qo.value&&Va.value&&(Qo.value.innerHTML="",Qo.value.appendChild(Va.value))});var t=n_(),o=c(t),a=c(o);Tt(a,()=>e.top??Pe);var s=m(o,2),l=c(s),i=c(l);Tt(i,()=>e.left??Pe);var f=m(l,2),v=c(f);Tt(v,()=>e.main??Pe),p(n,t),Be()}var a_=P("<div><!></div> <div><!></div> <div><!></div>",1);function kr(n,e){Ne(e,!0);var t=a_(),o=Q(t),a=c(o);Tt(a,()=>e.top??Pe),sn(o,v=>Qa.value=v,()=>Qa?.value);var s=m(o,2),l=c(s);Tt(l,()=>e.left??Pe),sn(s,v=>Za.value=v,()=>Za?.value);var i=m(s,2),f=c(i);Tt(f,()=>e.main??Pe),sn(i,v=>Va.value=v,()=>Va?.value),p(n,t),Be()}let Qa=ht({value:void 0}),Za=ht({value:void 0}),Va=ht({value:void 0}),qo=ht({value:void 0}),Jo=ht({value:void 0}),Qo=ht({value:void 0}),ge;function i_(n){const e=ge.__externref_table_alloc();return ge.__wbindgen_export_2.set(e,n),e}function Wn(n,e){try{return n.apply(this,e)}catch(t){const o=i_(t);ge.__wbindgen_exn_store(o)}}const fu=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&fu.decode();let Oo=null;function co(){return(Oo===null||Oo.byteLength===0)&&(Oo=new Uint8Array(ge.memory.buffer)),Oo}function kt(n,e){return n=n>>>0,fu.decode(co().subarray(n,n+e))}let er=0;const Ia=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},s_=typeof Ia.encodeInto=="function"?function(n,e){return Ia.encodeInto(n,e)}:function(n,e){const t=Ia.encode(n);return e.set(t),{read:n.length,written:t.length}};function xr(n,e,t){if(t===void 0){const i=Ia.encode(n),f=e(i.length,1)>>>0;return co().subarray(f,f+i.length).set(i),er=i.length,f}let o=n.length,a=e(o,1)>>>0;const s=co();let l=0;for(;l<o;l++){const i=n.charCodeAt(l);if(i>127)break;s[a+l]=i}if(l!==o){l!==0&&(n=n.slice(l)),a=t(a,o,o=l+n.length*3,1)>>>0;const i=co().subarray(a+l,a+o),f=s_(n,i);l+=f.written,a=t(a,o,l,1)>>>0}return er=l,a}let Qn=null;function tn(){return(Qn===null||Qn.buffer.detached===!0||Qn.buffer.detached===void 0&&Qn.buffer!==ge.memory.buffer)&&(Qn=new DataView(ge.memory.buffer)),Qn}function io(n){return n==null}function Gi(n){const e=typeof n;if(e=="number"||e=="boolean"||n==null)return`${n}`;if(e=="string")return`"${n}"`;if(e=="symbol"){const a=n.description;return a==null?"Symbol":`Symbol(${a})`}if(e=="function"){const a=n.name;return typeof a=="string"&&a.length>0?`Function(${a})`:"Function"}if(Array.isArray(n)){const a=n.length;let s="[";a>0&&(s+=Gi(n[0]));for(let l=1;l<a;l++)s+=", "+Gi(n[l]);return s+="]",s}const t=/\[object ([^\]]+)\]/.exec(toString.call(n));let o;if(t&&t.length>1)o=t[1];else return toString.call(n);if(o=="Object")try{return"Object("+JSON.stringify(n)+")"}catch{return"Object"}return n instanceof Error?`${n.name}: ${n.message}
${n.stack}`:o}function ol(n,e){const t=e(n.length*1,1)>>>0;return co().set(n,t/1),er=n.length,t}function ot(n){const e=ge.__wbindgen_export_2.get(n);return ge.__externref_table_dealloc(n),e}let jo=null;function l_(){return(jo===null||jo.byteLength===0)&&(jo=new Float64Array(ge.memory.buffer)),jo}function u_(n,e){return n=n>>>0,l_().subarray(n/8,n/8+e)}function c_(n,e){return n=n>>>0,co().subarray(n/1,n/1+e)}let zo=null;function d_(){return(zo===null||zo.byteLength===0)&&(zo=new Uint32Array(ge.memory.buffer)),zo}function f_(n,e){const t=e(n.length*4,4)>>>0;return d_().set(n,t/4),er=n.length,t}const al=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(n=>ge.__wbg_ltn_free(n>>>0,1));class v_{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,al.unregister(this),e}free(){const e=this.__destroy_into_raw();ge.__wbg_ltn_free(e,0)}constructor(e,t,o,a,s,l,i){const f=ol(e,ge.__wbindgen_malloc),v=er,y=ol(t,ge.__wbindgen_malloc),b=er,L=xr(a,ge.__wbindgen_malloc,ge.__wbindgen_realloc),O=er;var M=io(s)?0:xr(s,ge.__wbindgen_malloc,ge.__wbindgen_realloc),T=er;const x=xr(l,ge.__wbindgen_malloc,ge.__wbindgen_realloc),C=er,_=ge.ltn_new(f,v,y,b,o,L,O,M,T,x,C,i);if(_[2])throw ot(_[1]);return this.__wbg_ptr=_[0]>>>0,al.register(this,this.__wbg_ptr,this),this}getInvertedBoundary(){let e,t;try{const s=ge.ltn_getInvertedBoundary(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getBounds(){const e=ge.ltn_getBounds(this.__wbg_ptr);var t=u_(e[0],e[1]).slice();return ge.__wbindgen_free(e[0],e[1]*8,8),t}toRouteSnapper(){const e=ge.ltn_toRouteSnapper(this.__wbg_ptr);var t=c_(e[0],e[1]).slice();return ge.__wbindgen_free(e[0],e[1]*1,1),t}toRouteSnapperGj(){let e,t;try{const s=ge.ltn_toRouteSnapperGj(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderModalFilters(){let e,t;try{const s=ge.ltn_renderModalFilters(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderModalFiltersBeforeEdits(){let e,t;try{const s=ge.ltn_renderModalFiltersBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderTurnRestrictions(){let e,t;try{const s=ge.ltn_renderTurnRestrictions(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderTurnRestrictionsBeforeEdits(){let e,t;try{const s=ge.ltn_renderTurnRestrictionsBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderNeighbourhood(){let e,t;try{const s=ge.ltn_renderNeighbourhood(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}renderNeighbourhoodBeforeEdits(){let e,t;try{const s=ge.ltn_renderNeighbourhoodBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}generatedBoundaries(){let e,t;try{const s=ge.ltn_generatedBoundaries(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}generateMergedBoundary(e){let t,o;try{const l=ge.ltn_generateMergedBoundary(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,ot(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}extractWaypointsFromRing(e){let t,o;try{const l=ge.ltn_extractWaypointsFromRing(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,ot(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}setCurrentNeighbourhoodBoundary(e,t){const o=xr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=er,s=ge.ltn_setCurrentNeighbourhoodBoundary(this.__wbg_ptr,o,a,t);if(s[1])throw ot(s[0])}deleteNeighbourhoodBoundary(e){const t=xr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=er;ge.ltn_deleteNeighbourhoodBoundary(this.__wbg_ptr,t,o)}renameNeighbourhoodBoundary(e,t){const o=xr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=er,s=xr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),l=er;ge.ltn_renameNeighbourhoodBoundary(this.__wbg_ptr,o,a,s,l)}setCurrentNeighbourhood(e){const t=xr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=er,a=ge.ltn_setCurrentNeighbourhood(this.__wbg_ptr,t,o);if(a[1])throw ot(a[0])}addModalFilter(e,t){const o=xr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=er,s=ge.ltn_addModalFilter(this.__wbg_ptr,e,o,a);if(s[1])throw ot(s[0])}addManyModalFilters(e,t){const o=xr(t,ge.__wbindgen_malloc,ge.__wbindgen_realloc),a=er,s=ge.ltn_addManyModalFilters(this.__wbg_ptr,e,o,a);if(s[1])throw ot(s[0])}deleteModalFilter(e){ge.ltn_deleteModalFilter(this.__wbg_ptr,e)}addDiagonalFilter(e){const t=ge.ltn_addDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw ot(t[0])}rotateDiagonalFilter(e){const t=ge.ltn_rotateDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw ot(t[0])}deleteDiagonalFilter(e){const t=ge.ltn_deleteDiagonalFilter(this.__wbg_ptr,e);if(t[1])throw ot(t[0])}addTurnRestriction(e,t){const o=ge.ltn_addTurnRestriction(this.__wbg_ptr,e,t);if(o[1])throw ot(o[0])}deleteTurnRestriction(e,t,o){const a=ge.ltn_deleteTurnRestriction(this.__wbg_ptr,e,t,o);if(a[1])throw ot(a[0])}getTurnRestrictionTargets(e){let t,o;try{const l=ge.ltn_getTurnRestrictionTargets(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,ot(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}toggleTravelFlow(e){ge.ltn_toggleTravelFlow(this.__wbg_ptr,e)}toggleMainRoad(e){const t=ge.ltn_toggleMainRoad(this.__wbg_ptr,e);if(t[1])throw ot(t[0])}setMainRoads(e,t){const o=f_(e,ge.__wbindgen_malloc),a=er,s=ge.ltn_setMainRoads(this.__wbg_ptr,o,a,t);if(s[1])throw ot(s[0])}eraseAllMainRoads(){const e=ge.ltn_eraseAllMainRoads(this.__wbg_ptr);if(e[1])throw ot(e[0])}undo(){const e=ge.ltn_undo(this.__wbg_ptr);if(e[1])throw ot(e[0])}redo(){const e=ge.ltn_redo(this.__wbg_ptr);if(e[1])throw ot(e[0])}getShortcutsCrossingRoad(e){let t,o;try{const l=ge.ltn_getShortcutsCrossingRoad(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,ot(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getAllShortcuts(){let e,t;try{const s=ge.ltn_getAllShortcuts(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getAllShortcutsBeforeEdits(){let e,t;try{const s=ge.ltn_getAllShortcutsBeforeEdits(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}toSavefile(){let e,t;try{const s=ge.ltn_toSavefile(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}loadSavefile(e){const t=ge.ltn_loadSavefile(this.__wbg_ptr,e);if(t[1])throw ot(t[0])}changeProjectName(e){const t=xr(e,ge.__wbindgen_malloc,ge.__wbindgen_realloc),o=er;ge.ltn_changeProjectName(this.__wbg_ptr,t,o)}compareRoute(e,t,o,a,s){let l,i;try{const y=ge.ltn_compareRoute(this.__wbg_ptr,e,t,o,a,s);var f=y[0],v=y[1];if(y[3])throw f=0,v=0,ot(y[2]);return l=f,i=v,kt(f,v)}finally{ge.__wbindgen_free(l,i,1)}}impactToOneDestination(e,t){let o,a;try{const i=ge.ltn_impactToOneDestination(this.__wbg_ptr,e,t);var s=i[0],l=i[1];if(i[3])throw s=0,l=0,ot(i[2]);return o=s,a=l,kt(s,l)}finally{ge.__wbindgen_free(o,a,1)}}predictImpact(e){let t,o;try{const l=ge.ltn_predictImpact(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,ot(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getImpactsOnRoad(e,t){let o,a;try{const i=ge.ltn_getImpactsOnRoad(this.__wbg_ptr,e,t);var s=i[0],l=i[1];if(i[3])throw s=0,l=0,ot(i[2]);return o=s,a=l,kt(s,l)}finally{ge.__wbindgen_free(o,a,1)}}getAllIntersections(){let e,t;try{const s=ge.ltn_getAllIntersections(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getMovements(e){let t,o;try{const l=ge.ltn_getMovements(this.__wbg_ptr,e);var a=l[0],s=l[1];if(l[3])throw a=0,s=0,ot(l[2]);return t=a,o=s,kt(a,s)}finally{ge.__wbindgen_free(t,o,1)}}getDemandModel(){let e,t;try{const s=ge.ltn_getDemandModel(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getPOIs(){let e,t;try{const s=ge.ltn_getPOIs(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getMetricBuckets(){let e,t;try{const s=ge.ltn_getMetricBuckets(this.__wbg_ptr);var o=s[0],a=s[1];if(s[3])throw o=0,a=0,ot(s[2]);return e=o,t=a,kt(o,a)}finally{ge.__wbindgen_free(e,t,1)}}getOsmTimestamp(){const e=ge.ltn_getOsmTimestamp(this.__wbg_ptr);return e[0]===0?void 0:e[1]}}async function g_(n,e){if(typeof Response=="function"&&n instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(n,e)}catch(o){if(n.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const t=await n.arrayBuffer();return await WebAssembly.instantiate(t,e)}else{const t=await WebAssembly.instantiate(n,e);return t instanceof WebAssembly.Instance?{instance:t,module:n}:t}}function __(){const n={};return n.wbg={},n.wbg.__wbg_buffer_0e2c274546535a84=function(e){return e.buffer},n.wbg.__wbg_call_3a8ceff4c9f12325=function(){return Wn(function(e,t){return e.call(t)},arguments)},n.wbg.__wbg_debug_809501eb69aeeef4=function(e){console.debug(e)},n.wbg.__wbg_done_60e5165eca70220e=function(e){return e.done},n.wbg.__wbg_entries_85a648a6a5215287=function(e){return Object.entries(e)},n.wbg.__wbg_error_1c3d6d32fc1361cc=function(e){console.error(e)},n.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let o,a;try{o=e,a=t,console.error(kt(e,t))}finally{ge.__wbindgen_free(o,a,1)}},n.wbg.__wbg_get_9c5338635800e15f=function(){return Wn(function(e,t){return Reflect.get(e,t)},arguments)},n.wbg.__wbg_get_d749e505e6746136=function(e,t){return e[t>>>0]},n.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,t){return e[t]},n.wbg.__wbg_globalThis_d0fa1c7e1465604c=function(){return Wn(function(){return globalThis.globalThis},arguments)},n.wbg.__wbg_global_23a7926f0ad701bc=function(){return Wn(function(){return global.global},arguments)},n.wbg.__wbg_info_26a1a6efb20c9f43=function(e){console.info(e)},n.wbg.__wbg_instanceof_ArrayBuffer_c632aa9cfefb45b9=function(e){let t;try{t=e instanceof ArrayBuffer}catch{t=!1}return t},n.wbg.__wbg_instanceof_Map_212855790ec94f3b=function(e){let t;try{t=e instanceof Map}catch{t=!1}return t},n.wbg.__wbg_instanceof_Uint8Array_aa04d9da2a05b974=function(e){let t;try{t=e instanceof Uint8Array}catch{t=!1}return t},n.wbg.__wbg_isArray_b7133b5e9a258525=function(e){return Array.isArray(e)},n.wbg.__wbg_isSafeInteger_f6d409cd7a7eb81d=function(e){return Number.isSafeInteger(e)},n.wbg.__wbg_iterator_0210e004ec06fb30=function(){return Symbol.iterator},n.wbg.__wbg_length_bc129fab12fd2a9c=function(e){return e.length},n.wbg.__wbg_length_ee1bca74ed444cce=function(e){return e.length},n.wbg.__wbg_log_91785a95194156ea=function(e){console.log(e)},n.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},n.wbg.__wbg_new_cf66b35fe5443282=function(e){return new Uint8Array(e)},n.wbg.__wbg_newnoargs_1143e0b74be16ea9=function(e,t){return new Function(kt(e,t))},n.wbg.__wbg_next_4d092fa9da3ba108=function(e){return e.next},n.wbg.__wbg_next_7b79803d4b7a1b68=function(){return Wn(function(e){return e.next()},arguments)},n.wbg.__wbg_now_882dd9fbc163f00d=function(e){return e.now()},n.wbg.__wbg_performance_686bdd9b0415bed6=function(e){return e.performance},n.wbg.__wbg_self_3a2c444cba620c12=function(){return Wn(function(){return self.self},arguments)},n.wbg.__wbg_set_2611eb16b9ac5ca9=function(e,t,o){e.set(t,o>>>0)},n.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const o=t.stack,a=xr(o,ge.__wbindgen_malloc,ge.__wbindgen_realloc),s=er;tn().setInt32(e+4,s,!0),tn().setInt32(e+0,a,!0)},n.wbg.__wbg_value_fdfbba27b1fcaf65=function(e){return e.value},n.wbg.__wbg_warn_8fc67512df65ef55=function(e){console.warn(e)},n.wbg.__wbg_window_a27f90073150a6bf=function(){return Wn(function(){return window.window},arguments)},n.wbg.__wbindgen_bigint_from_i64=function(e){return e},n.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},n.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const o=t,a=typeof o=="bigint"?o:void 0;tn().setBigInt64(e+8,io(a)?BigInt(0):a,!0),tn().setInt32(e+0,!io(a),!0)},n.wbg.__wbindgen_boolean_get=function(e){const t=e;return typeof t=="boolean"?t?1:0:2},n.wbg.__wbindgen_debug_string=function(e,t){const o=Gi(t),a=xr(o,ge.__wbindgen_malloc,ge.__wbindgen_realloc),s=er;tn().setInt32(e+4,s,!0),tn().setInt32(e+0,a,!0)},n.wbg.__wbindgen_error_new=function(e,t){return new Error(kt(e,t))},n.wbg.__wbindgen_in=function(e,t){return e in t},n.wbg.__wbindgen_init_externref_table=function(){const e=ge.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},n.wbg.__wbindgen_is_bigint=function(e){return typeof e=="bigint"},n.wbg.__wbindgen_is_function=function(e){return typeof e=="function"},n.wbg.__wbindgen_is_object=function(e){const t=e;return typeof t=="object"&&t!==null},n.wbg.__wbindgen_is_undefined=function(e){return e===void 0},n.wbg.__wbindgen_jsval_eq=function(e,t){return e===t},n.wbg.__wbindgen_jsval_loose_eq=function(e,t){return e==t},n.wbg.__wbindgen_memory=function(){return ge.memory},n.wbg.__wbindgen_number_get=function(e,t){const o=t,a=typeof o=="number"?o:void 0;tn().setFloat64(e+8,io(a)?0:a,!0),tn().setInt32(e+0,!io(a),!0)},n.wbg.__wbindgen_string_get=function(e,t){const o=t,a=typeof o=="string"?o:void 0;var s=io(a)?0:xr(a,ge.__wbindgen_malloc,ge.__wbindgen_realloc),l=er;tn().setInt32(e+4,l,!0),tn().setInt32(e+0,s,!0)},n.wbg.__wbindgen_string_new=function(e,t){return kt(e,t)},n.wbg.__wbindgen_throw=function(e,t){throw new Error(kt(e,t))},n}function p_(n,e){return ge=n.exports,vu.__wbindgen_wasm_module=e,Qn=null,jo=null,zo=null,Oo=null,ge.__wbindgen_start(),ge}async function vu(n){if(ge!==void 0)return ge;typeof n<"u"&&(Object.getPrototypeOf(n)===Object.prototype?{module_or_path:n}=n:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof n>"u"&&(n=new URL("/ltn/assets/backend_bg-CRR_2CCs.wasm",import.meta.url));const e=__();(typeof n=="string"||typeof Request=="function"&&n instanceof Request||typeof URL=="function"&&n instanceof URL)&&(n=fetch(n));const{instance:t,module:o}=await g_(await n,e);return p_(t,o)}const h_="/ltn/assets/streets-v2-style-CzuG29E5.json";function un(n,e){Ne(e,!0);const[t,o]=ut(),a=u(()=>ct(dt("main")));function s(l){l.key==r(a).t(49)&&(l.stopPropagation(),Ve(yt,e.mode))}Xn("keydown",ca,s),da(n,{onclick:()=>Ve(yt,e.mode),children:(l,i)=>{var f=Dt();J(v=>U(f,v),[()=>r(a).t(50)]),p(l,f)}}),Be(),o()}let ri=Mn(null);function m_(n,e,t){let o=r(e).pop();X(e,r(e),!0),o&&t(o)}var b_=P('<input type="checkbox"/>'),y_=P("<span></span>"),A_=P("<b> </b>"),w_=P("<b> </b>"),x_=P("<b> </b>"),$_=P('<ul style="padding-right: 0; padding-left: 20px; margin: 0;"><li><!></li> <li><!></li> <li><!></li></ul>'),k_=P("<span></span> <!>",1),S_=P("<!> <!>",1),E_=P('<p> </p> <div style="display: flex; gap: 16px;"><label><!></label> <button class="secondary"><!></button></div> <!> <!> <!> <!> <!>',1);function gu(n,e){Ne(e,!0);const t=()=>be(ri,"$routeTool",o),[o,a]=ut(),s=[],l=u(()=>ct(dt("main")));let i=W(e,"waypoints",15),f=W(e,"drawnShapeOut",15,void 0);function v(K,V){if(V.length<3)return JSON.parse(K.inner.calculateRoute(V));let ee=JSON.parse(JSON.stringify(V));ee.push(ee[0]);let re=JSON.parse(K.inner.calculateRoute(ee));return re.properties.waypoints.pop(),re.geometry.type=r(l).t(368),re.geometry.coordinates=[re.geometry.coordinates],re}cr(()=>{t()?.stop(),e.map.getCanvas().style.cursor="inherit"});let y=we("snap"),b=we(ht([])),L=we(ht([]));Ze(()=>{X(L,j(t(),i(),r(x)),!0)});let O=we(null),M=we(!1),T=we(!1),x=we(!1);function C(){r(b).length==100&&r(b).shift(),X(b,[...r(b),JSON.parse(JSON.stringify(i()))],!0)}function _(K){i().length>=3||(C(),i().push({point:K.lngLat.toArray(),snapped:r(y)=="snap"}),i(i()))}function D(K){X(O,{point:K.lngLat.toArray(),snapped:r(y)=="snap"},!0)}function z(K){C(),i(i()[K].snapped=!i()[K].snapped,!0),i(i())}function I(K){C(),i().splice(K,1),i(i()),X(M,!1)}function F(K,V,ee,re){if(re||V.length>=3)return nr();try{if(K&&V.length>0&&ee)return JSON.parse(K.inner.calculateRoute([V[V.length-1],ee]))}catch{}return nr()}function j(K,V,ee){if(ee)return r(L);if(!K||V.length<3)return[];let re=[],ae=1,ne=JSON.parse(JSON.stringify(V));ne.push(ne[0]);for(let ie=0;ie<ne.length-1;ie++){let _e=JSON.parse(K.inner.getExtraNodes(ne[ie],ne[ie+1]));for(let[le,fe,se]of _e)re.push({point:[le,fe],snapped:se,insertIdx:ae});ae++}return re}function d(K){C(),i().splice(K.insertIdx,0,{point:K.point,snapped:K.snapped}),i(i()),X(x,!0)}function g(K){i(i()[K.insertIdx].point=K.point,!0),i(i())}function h(){X(x,!1)}function $(){C(),X(T,!0)}Ze(()=>{try{t()&&f(v(t(),i()))}catch(K){console.log("error drawing shape",K),f(void 0)}});let w=u(()=>F(t(),i(),r(O),r(M)||r(T)));Ze(()=>{let K=i().length==0?"crosshair":"inherit";e.map.getCanvas().style.cursor=K});var A=E_(),B=Q(A),k=c(B),R=m(B,2),S=c(R);{const K=V=>{var ee=b_();ee.value=ee.__value="snap",J(()=>ee.disabled=i().length>=3),xi(s,[],ee,()=>r(y),re=>X(y,re)),p(V,ee)};var E=c(S);{let V=u(()=>[K]),ee=u(()=>r(l).cx(370));me(E,{get t(){return r(V)},get x(){return r(ee)}})}}var N=m(S,2);N.__click=[m_,b,i];var G=c(N);{var q=K=>{var V=Dt();J(ee=>U(V,ee),[()=>r(l).t(371)]),p(K,V)},H=K=>{{let V=u(()=>r(l).cx(372)),ee=u(()=>[r(b).length]);me(K,{get x(){return r(V)},get a(){return r(ee)}})}};ve(G,K=>{r(b).length==0?K(q):K(H,!1)})}var Y=m(R,2);va(Y,{onclick:_,onmousemove:D});var ue=m(Y,2);Jt(ue,17,()=>r(L),Qt,(K,V,ee)=>{fo(K,{draggable:!0,ondragstart:()=>d(r(V)),ondrag:()=>g(r(V)),ondragend:h,onclick:()=>{d(r(V)),X(x,!1)},zIndex:0,get lngLat(){return r(V).point},set lngLat(re){r(V).point=re},children:(re,ae)=>{var ne=y_();let ie;J(_e=>ie=St(ne,1,"dot svelte-29me5d",null,ie,_e),[()=>({"snapped-node":r(V).snapped,"free-node":!r(V).snapped,hide:r(x)})]),p(re,ne)},$$slots:{default:!0}})});var oe=m(ue,2);Jt(oe,17,i,Qt,(K,V,ee)=>{fo(K,{draggable:!0,onclick:()=>z(ee),oncontextmenu:()=>I(ee),onmouseenter:()=>X(M,!0),onmouseleave:()=>X(M,!1),ondragstart:$,ondragend:()=>X(T,!1),zIndex:1,get lngLat(){return r(V).point},set lngLat(re){r(V).point=re},children:(re,ae)=>{var ne=k_(),ie=Q(ne);let _e;ie.textContent=ee+1;var le=m(ie,2);Bt(le,{openOn:"hover",popupClass:"edit-waypoint-popup",children:(se,ye)=>{var he=$_(),Se=c(he);{const Me=(Te,Ae=Pe)=>{var Ee=A_(),Ie=c(Ee);J(Re=>U(Ie,Re),[()=>r(l).tx(Ae())]),p(Te,Ee)};var xe=c(Se);{let Te=u(()=>[Me]),Ae=u(()=>r(l).cx(182));me(xe,{get t(){return r(Te)},get x(){return r(Ae)}})}}var Fe=m(Se,2);{const Me=(Te,Ae=Pe)=>{var Ee=w_(),Ie=c(Ee);J(Re=>U(Ie,Re),[()=>r(l).tx(Ae())]),p(Te,Ee)};var ke=c(Fe);{let Te=u(()=>[Me]),Ae=u(()=>r(l).cx(373));me(ke,{get t(){return r(Te)},get x(){return r(Ae)}})}}var Ce=m(Fe,2);{const Me=(Te,Ae=Pe)=>{var Ee=x_(),Ie=c(Ee);J(Re=>U(Ie,Re),[()=>r(l).tx(Ae())]),p(Te,Ee)};var pe=c(Ce);{let Te=u(()=>[Me]),Ae=u(()=>r(l).cx(183));me(pe,{get t(){return r(Te)},get x(){return r(Ae)}})}}p(se,he)},$$slots:{default:!0}}),J(fe=>_e=St(ie,1,"dot svelte-29me5d",null,_e,fe),[()=>({snapped:r(V).snapped})]),p(re,ne)},$$slots:{default:!0}})});var Z=m(oe,2);{let K=u(()=>f()||nr());lt(Z,{get data(){return r(K)},generateId:!0,children:(V,ee)=>{var re=S_(),ae=Q(re);{let ie=u(()=>We("draw-area-lines"));gt(ae,Le(()=>r(ie),{paint:{"line-color":"black","line-width":10}}))}var ne=m(ae,2);{let ie=u(()=>We("draw-area-area"));ur(ne,Le(()=>r(ie),{paint:{"fill-color":"grey","fill-opacity":.5}}))}p(V,re)},$$slots:{default:!0}})}var te=m(Z,2);lt(te,{get data(){return r(w)},children:(K,V)=>{{let ee=u(()=>We("draw-area-lines-preview"));gt(K,Le(()=>r(ee),{paint:{"line-color":"black","line-width":3}}))}},$$slots:{default:!0}}),J(K=>{U(k,K),N.disabled=r(b).length==0},[()=>r(l).t(369)]),p(n,A),Be(),a()}tr(["click"]);var L_=P('<div><div class="bucket-color svelte-4l5cu8"></div> <div class="bucket-indicator svelte-4l5cu8"><!></div></div>'),C_=P('<div class="colors svelte-4l5cu8"></div>');function Hn(n,e){function t(s,l){let i=0;for(let f of s.slice(1,-1)){if(l<f)break;i++}return i}let o=u(()=>t(e.limits,e.value));var a=C_();Jt(a,21,()=>e.colorScale,Qt,(s,l,i)=>{var f=L_();let v;var y=c(f);let b;var L=m(y,2),O=c(L);jc(O,{strokeWidth:"4px",size:"14px"}),J((M,T)=>{v=St(f,1,"bucket svelte-4l5cu8",null,v,M),b=fr(y,"",b,T)},[()=>({selected:i==r(o)}),()=>({background:r(l)})]),p(s,f)}),p(n,a)}var M_=P("<tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td><!></td></tr> <tr><th><!></th><td> </td></tr>",1),P_=P('<table class="svelte-j2xl4e"><tbody><tr><th><!></th><td><!></td></tr><!></tbody></table>');function _u(n,e){Ne(e,!0);const t=()=>be(Kr,"$appFocus",a),o=()=>be(ho,"$metricBuckets",a),[a,s]=ut(),l=u(()=>ct(dt("main")));var i=P_(),f=c(i),v=c(f),y=c(v);{const x=C=>{Hn(C,{get colorScale(){return Hi},get limits(){return Vi},get value(){return e.neighbourhoodBoundary.properties.area_km2}})};var b=c(y);{let C=u(()=>[x]),_=u(()=>r(l).cx(107));me(b,{get t(){return r(C)},get x(){return r(_)}})}}var L=m(y),O=c(L);{let x=u(()=>r(l).cx(108)),C=u(()=>[e.neighbourhoodBoundary.properties.area_km2.toFixed(1)]);me(O,{get x(){return r(x)},get a(){return r(C)}})}var M=m(v);{var T=x=>{var C=M_(),_=Q(C),D=c(_);{const ae=ne=>{{let ie=u(()=>Vo.toReversed()),_e=u(()=>100-e.neighbourhoodBoundary.properties.simd);Hn(ne,{get colorScale(){return r(ie)},get limits(){return Yo},get value(){return r(_e)}})}};var z=c(D);{let ne=u(()=>[ae]),ie=u(()=>r(l).cx(109));me(z,{get t(){return r(ne)},get x(){return r(ie)}})}}var I=m(D),F=c(I);{let ae=u(()=>r(l).cx(110)),ne=u(()=>[1+Math.floor(e.neighbourhoodBoundary.properties.simd/20)]);me(F,{get x(){return r(ae)},get a(){return r(ne)}})}var j=m(_,2),d=c(j);{const ae=ne=>{{let ie=u(()=>e.neighbourhoodBoundary.properties.population/e.neighbourhoodBoundary.properties.area_km2);Hn(ne,{get colorScale(){return Zo},get limits(){return o().population_density},get value(){return r(ie)}})}};var g=c(d);{let ne=u(()=>[ae]),ie=u(()=>r(l).cx(111));me(g,{get t(){return r(ne)},get x(){return r(ie)}})}}var h=m(d),$=c(h);{let ae=u(()=>r(l).cx(112)),ne=u(()=>[Math.round(e.neighbourhoodBoundary.properties.population/e.neighbourhoodBoundary.properties.area_km2).toLocaleString()]);me($,{get x(){return r(ae)},get a(){return r(ne)}})}var w=m(j,2),A=c(w);{const ae=ne=>{{let ie=u(()=>Ko.toReversed()),_e=u(()=>100*(1-e.neighbourhoodBoundary.properties.households_with_cars_or_vans/e.neighbourhoodBoundary.properties.total_households));Hn(ne,{get colorScale(){return r(ie)},get limits(){return Xo},get value(){return r(_e)}})}};var B=c(A);{let ne=u(()=>[ae]),ie=u(()=>r(l).cx(113));me(B,{get t(){return r(ne)},get x(){return r(ie)}})}}var k=m(A),R=c(k);{let ae=u(()=>r(l).cx(114)),ne=u(()=>[Wi(e.neighbourhoodBoundary.properties.households_with_cars_or_vans,e.neighbourhoodBoundary.properties.total_households)]);me(R,{get x(){return r(ae)},get a(){return r(ne)}})}var S=m(w,2),E=c(S);{const ae=ne=>{{let ie=u(()=>e.neighbourhoodBoundary.properties.number_pois/e.neighbourhoodBoundary.properties.area_km2);Hn(ne,{get colorScale(){return qi},get limits(){return o().poi_density},get value(){return r(ie)}})}};var N=c(E);{let ne=u(()=>[ae]),ie=u(()=>r(l).cx(115));me(N,{get t(){return r(ne)},get x(){return r(ie)}})}}var G=m(E),q=c(G);{let ae=u(()=>r(l).cx(116)),ne=u(()=>[(e.neighbourhoodBoundary.properties.number_pois/e.neighbourhoodBoundary.properties.area_km2).toFixed(1)]);me(q,{get x(){return r(ae)},get a(){return r(ne)}})}var H=m(S,2),Y=c(H);{const ae=ne=>{{let ie=u(()=>e.neighbourhoodBoundary.properties.number_stats19_collisions/e.neighbourhoodBoundary.properties.area_km2);Hn(ne,{get colorScale(){return Ji},get limits(){return o().collision_density},get value(){return r(ie)}})}};var ue=c(Y);{let ne=u(()=>[ae]),ie=u(()=>r(l).cx(117));me(ue,{get t(){return r(ne)},get x(){return r(ie)}})}}var oe=m(Y),Z=c(oe);{let ae=u(()=>r(l).cx(116)),ne=u(()=>[(e.neighbourhoodBoundary.properties.number_stats19_collisions/e.neighbourhoodBoundary.properties.area_km2).toFixed(1)]);me(Z,{get x(){return r(ae)},get a(){return r(ne)}})}var te=m(H,2),K=c(te);{const ae=ne=>{Hn(ne,{get colorScale(){return Zi},get limits(){return Qi},get value(){return e.neighbourhoodBoundary.properties.combined_score}})};var V=c(K);{let ne=u(()=>[ae]),ie=u(()=>r(l).cx(118));me(V,{get t(){return r(ne)},get x(){return r(ie)}})}}var ee=m(K),re=c(ee);J(()=>U(re,`${e.neighbourhoodBoundary.properties.combined_score??""} / 5`)),p(x,C)};ve(M,x=>{t()=="cnt"&&x(T)})}p(n,i),Be(),s()}function pu(n,e,t){let o=new Set(n.toSavefile().features.filter(a=>a.properties.kind=="boundary").map(a=>a.properties.name));for(;;){let a=window.prompt(e,t);if(a===null)return null;if(a=a.trim(),a==="")window.alert("Neighbourhood cannot be blank; please pick a name or cancel");else if(o.has(a))window.alert(`There is already a neighbourhood called ${a}; please pick another name`);else return a}}var T_=P('<!> <div class="sub-labels svelte-173u12u"><span></span> <span> </span> <span></span></div>',1),I_=P('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span> <span> </span></div>',1),R_=P('<!> <div style="display: flex; justify-content: space-between;"><span style="text-align: center; width: 100%"> </span></div>',1),N_=P('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span></div>',1),B_=P('<!> <div style="text-align: center;"> </div>',1),F_=P('<!> <div style="text-align: center;"> </div>',1),O_=P('<!> <div class="sub-labels svelte-173u12u"><span> </span> <span> </span></div> <br/> <p> </p>',1),j_=P('<div style="display: flex; gap: 16px; align-items: center; width: fit-content;"><label style="margin: 0; padding: 0;" for="prioritization-selection"> </label> <select id="prioritization-selection"><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option><option> </option></select></div> <!>',1);function hu(n,e){Ne(e,!0);const t=()=>be(Kr,"$appFocus",a),o=()=>be(ho,"$metricBuckets",a),[a,s]=ut(),l=u(()=>ct(dt("main")));let i=W(e,"selectedPrioritization",15);function f(){let S=new URL(window.location.href).searchParams.get("prioritisationMetric");S=="area"?i("area"):S=="population_density"?i("population_density"):S=="simd"?i("simd"):S=="stats19"?i("stats19"):S=="pois"?i("pois"):S=="car_ownership"?i("car_ownership"):S=="combined"&&i("combined")}t()=="cnt"?f():i("none"),Ze(()=>{const S=new URL(window.location.href);i()=="none"?S.searchParams.delete("prioritisationMetric"):S.searchParams.set("prioritisationMetric",i()),history.replaceState({},"",S)});var v=j_(),y=Q(v),b=c(y),L=c(b),O=m(b,2),M=c(O),T=c(M);M.value=M.__value="none";var x=m(M),C=c(x);x.value=x.__value="area";var _=m(x),D=c(_);_.value=_.__value="simd";var z=m(_),I=c(z);z.value=z.__value="population_density";var F=m(z),j=c(F);F.value=F.__value="car_ownership";var d=m(F),g=c(d);d.value=d.__value="pois";var h=m(d),$=c(h);h.value=h.__value="stats19";var w=m(h),A=c(w);w.value=w.__value="combined";var B=m(y,2);{var k=S=>{var E=T_(),N=Q(E);{let Y=u(()=>({limits:Vi}));hr(N,{get colorScale(){return Hi},get labels(){return r(Y)}})}var G=m(N,2),q=m(c(G),2),H=c(q);J(Y=>U(H,Y),[()=>r(l).t(267)]),p(S,E)},R=S=>{var E=$e(),N=Q(E);{var G=H=>{var Y=I_(),ue=Q(Y);{let ae=u(()=>({limits:o().population_density}));hr(ue,{get colorScale(){return Zo},get labels(){return r(ae)}})}var oe=m(ue,2),Z=c(oe),te=c(Z),K=m(Z,2),V=c(K),ee=m(K,2),re=c(ee);J((ae,ne,ie)=>{U(te,ae),U(V,ne),U(re,ie)},[()=>r(l).t(214),()=>r(l).t(215),()=>r(l).t(216)]),p(H,Y)},q=H=>{var Y=$e(),ue=Q(Y);{var oe=te=>{var K=R_(),V=Q(K);{let ne=u(()=>Ko.toReversed()),ie=u(()=>({limits:Xo.toReversed().map(_e=>`${_e}%`)}));hr(V,{get colorScale(){return r(ne)},get labels(){return r(ie)}})}var ee=m(V,2),re=c(ee),ae=c(re);J(ne=>U(ae,ne),[()=>r(l).t(219)]),p(te,K)},Z=te=>{var K=$e(),V=Q(K);{var ee=ae=>{var ne=N_(),ie=Q(ne);{let he=u(()=>Vo.toReversed()),Se=u(()=>({buckets:wl(Yo).toReversed()}));hr(ie,{get colorScale(){return r(he)},get labels(){return r(Se)}})}var _e=m(ie,2),le=c(_e),fe=c(le),se=m(le,2),ye=c(se);J((he,Se)=>{U(fe,he),U(ye,Se)},[()=>r(l).t(210),()=>r(l).t(211)]),p(ae,ne)},re=ae=>{var ne=$e(),ie=Q(ne);{var _e=fe=>{var se=B_(),ye=Q(se);{let xe=u(()=>({limits:o().collision_density}));hr(ye,{get colorScale(){return Ji},get labels(){return r(xe)}})}var he=m(ye,2),Se=c(he);J(xe=>U(Se,xe),[()=>r(l).t(268)]),p(fe,se)},le=fe=>{var se=$e(),ye=Q(se);{var he=xe=>{var Fe=F_(),ke=Q(Fe);{let Me=u(()=>({limits:o().poi_density}));hr(ke,{get colorScale(){return qi},get labels(){return r(Me)}})}var Ce=m(ke,2),pe=c(Ce);J(Me=>U(pe,Me),[()=>r(l).t(269)]),p(xe,Fe)},Se=xe=>{var Fe=$e(),ke=Q(Fe);{var Ce=pe=>{var Me=O_(),Te=Q(Me);{let Oe=u(()=>({buckets:Qi}));hr(Te,{get colorScale(){return Zi},get labels(){return r(Oe)}})}var Ae=m(Te,2),Ee=c(Ae),Ie=c(Ee),Re=m(Ee,2),Ue=c(Re),Ge=m(Ae,4),Je=c(Ge);J((Oe,Qe,qe)=>{U(Ie,Oe),U(Ue,Qe),U(Je,qe)},[()=>r(l).t(270),()=>r(l).t(271),()=>r(l).t(272)]),p(pe,Me)};ve(ke,pe=>{i()=="combined"&&pe(Ce)},!0)}p(xe,Fe)};ve(ye,xe=>{i()=="pois"?xe(he):xe(Se,!1)},!0)}p(fe,se)};ve(ie,fe=>{i()=="stats19"?fe(_e):fe(le,!1)},!0)}p(ae,ne)};ve(V,ae=>{i()=="simd"?ae(ee):ae(re,!1)},!0)}p(te,K)};ve(ue,te=>{i()=="car_ownership"?te(oe):te(Z,!1)},!0)}p(H,Y)};ve(N,H=>{i()=="population_density"?H(G):H(q,!1)},!0)}p(S,E)};ve(B,S=>{i()=="area"?S(k):S(R,!1)})}J((S,E,N,G,q,H,Y,ue,oe)=>{U(L,S),U(T,E),U(C,N),U(D,G),U(I,q),U(j,H),U(g,Y),U($,ue),U(A,oe)},[()=>r(l).t(262),()=>r(l).t(263),()=>r(l).t(264),()=>r(l).t(209),()=>r(l).t(213),()=>r(l).t(218),()=>r(l).t(265),()=>r(l).t(243),()=>r(l).t(266)]),hn(O,i),p(n,v),Be(),s()}function mu(n,e,t){return{none:n.none,area:dr(["get","area_km2"],Vi,Hi),car_ownership:dr(["*",100,["/",["get","households_with_cars_or_vans"],["get","total_households"]]],Xo,Ko),population_density:dr(["/",["get","population"],["get","area_km2"]],t.population_density,Zo),pois:dr(["/",["get","number_pois"],["get","area_km2"]],t.poi_density,qi),simd:dr(["get","simd"],Yo,Vo),stats19:dr(["/",["get","number_stats19_collisions"],["get","area_km2"]],t.collision_density,Ji),combined:dr(["get","combined_score"],Qi,Zi)}[e]}function z_(n,e){Ki("auto_boundaries.geojson",JSON.stringify(r(e),null,"  "))}function D_(n,e,t,o){X(e,null),r(t).clear(),X(t,r(t),!0),X(o,[],!0)}var U_=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav>'),G_=P("<h3> </h3> <p> </p> <!>",1),W_=P("<p> </p>"),H_=(n,e)=>X(e,"choose-area"),q_=P("<button><!></button>"),J_=(n,e)=>X(e,"draw-area"),Q_=P("<button><!></button>"),Z_=P('<div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div> <div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div>',1),V_=P('<div><h3 class="svelte-1ly46ps"> </h3></div> <!> <div style="margin-top: 16px;"><h3 class="svelte-1ly46ps"> </h3> <p> </p></div>',1),K_=(n,e,t)=>e(r(t)),X_=P('<span style="text-align:center;"><!></span>'),Y_=P('<!> <!> <!> <hr/> <div><div class="tool-palette svelte-1ly46ps" style="display: flex; align-items: center; gap: 16px;"><!></div> <!> <div><h3 class="svelte-1ly46ps"> </h3> <p> </p></div> <div style="display: flex; gap: 16px; justify-content: space-between; margin-bottom: 16px;"><button> </button> <button class="destructive" style="display: flex; gap: 8px; align-items: center;"><!></button></div> <h3> </h3> <div class="neighbourhood-boundary-summary svelte-1ly46ps"><!></div></div> <hr/> <button class="secondary"> </button>',1),ep=P("<!> <!>",1),tp=P("<b> </b>"),rp=P("<b> </b>"),np=P("<br/>"),op=P("<b> </b>"),ap=P("<br/>"),ip=P("<b> </b>"),sp=P("<br/>"),lp=P("<b> </b>"),up=P("<br/>"),cp=P("<b> </b> <br/> ",1),dp=P("<!> <!>",1),fp=P("<!> <!>",1),vp=P("<!> <!>",1);function gp(n,e){Ne(e,!0);const t=()=>be(Kr,"$appFocus",v),o=()=>be(It,"$backend",v),a=()=>be(mo,"$projectStorage",v),s=()=>be(bn,"$currentProjectID",v),l=()=>be(yt,"$mode",v),i=()=>be(ho,"$metricBuckets",v),f=()=>be(Vr,"$map",v),[v,y]=ut(),b=u(()=>ct(dt("main")));let L=we("Generating severance boundaries..."),O=we(ht(nr())),M=we("choose-area"),T=we(ht(t()=="cnt"?"combined":"none")),x=we(null),C=we(ht(new Map)),_=we(ht([])),D=we(void 0),z=u(()=>{if(r(D)&&r(D).geometry.coordinates[0].length>3){let B={type:"FeatureCollection",features:[r(D)]};try{return o().generateMergedBoundary(B)}catch(k){console.log(`error merging boundaries: ${k}`)}}return null}),I=u(()=>r(M)=="draw-area"?r(z):r(x));ln(async()=>{await Xa(),X(O,o().generatedBoundaries(),!0),X(L,"")});function F(B){let k=B.features[0].id,R=r(O).features[k],S=new Map(r(C));if(S.has(k)?S.delete(k):S.set(k,R),S.size===0)X(x,null),X(C,S,!0);else if(S.size===1)X(x,S.values().next().value,!0),X(C,S,!0);else{let E={type:"FeatureCollection",features:Array.from(S.values())};try{X(x,o().generateMergedBoundary(E),!0),X(C,S,!0)}catch(N){console.log(`error merging boundaries: ${N}`),window.alert(`Sorry, the boundaries you selected cannot be merged.
Error: ${N}`)}}}function j(B){let k=a().nextAvailableNeighbourhoodName(s()),R=pu(o(),r(b).t(15),k);if(R)try{const S={};r(M)=="draw-area"&&r(D)?.properties?.waypoints&&(S.waypoints=r(D).properties.waypoints);let E={type:"Feature",properties:S,geometry:B.geometry};o().setCurrentNeighbourhoodBoundary(R,E),Ve(so,R),na(),Ve(yt,{mode:"neighbourhood"})}catch(S){window.alert(`Sorry, this boundary is invalid: ${S}`)}}function d(B){return mu({none:["match",["%",["id"],5],0,"blue",1,"yellow",2,"green",3,"purple",4,"orange","black"]},B,i())}function g(B){return{none:bt(.3,.5),area:bt(.7,.9),car_ownership:bt(.7,.9),population_density:bt(.7,.9),pois:bt(.7,.9),simd:bt(.7,.9),stats19:bt(.7,.9),combined:bt(.7,.9)}[B]}function h(B){B.key==r(b).t(16)&&r(I)&&j(r(I))}var $=vp();Xn("keydown",ca,h);var w=Q($);go(w,{get loading(){return r(L)}});var A=m(w,2);kr(A,{top:S=>{var E=U_(),N=c(E),G=c(N),q=c(G);et(q,{mode:{mode:"title"}});var H=m(G,2),Y=c(H);et(Y,{mode:{mode:"pick-neighbourhood"}});var ue=m(H,2),oe=c(ue);J(Z=>U(oe,Z),[()=>mr(l().mode)]),p(S,E)},left:S=>{var E=Y_(),N=Q(E);un(N,{mode:{mode:"pick-neighbourhood"}});var G=m(N,2);{var q=Ae=>{var Ee=G_(),Ie=Q(Ee),Re=c(Ie),Ue=m(Ie,2),Ge=c(Ue),Je=m(Ue,2);hu(Je,{get selectedPrioritization(){return r(T)},set selectedPrioritization(Oe){X(T,Oe,!0)}}),J((Oe,Qe)=>{U(Re,Oe),U(Ge,Qe)},[()=>r(b).t(17),()=>r(b).t(18)]),p(Ae,Ee)};ve(G,Ae=>{t()=="cnt"&&Ae(q)})}var H=m(G,2);{var Y=Ae=>{var Ee=W_(),Ie=c(Ee);J(Re=>U(Ie,Re),[()=>r(b).t(19)]),p(Ae,Ee)};ve(H,Ae=>{r(T)=="none"&&Ae(Y)})}var ue=m(H,4),oe=c(ue);{const Ae=(Ie,Re=Pe)=>{var Ue=q_();Ue.__click=[H_,M];let Ge;{const Oe=Qe=>{Ol(Qe,{})};var Je=c(Ue);{let Qe=u(()=>[Oe]);me(Je,{get t(){return r(Qe)},get x(){return Re()},n:!0})}}J(Oe=>Ge=St(Ue,1,"",null,Ge,Oe),[()=>({active:r(M)=="choose-area"})]),p(Ie,Ue)},Ee=(Ie,Re=Pe)=>{var Ue=Q_();Ue.__click=[J_,M];let Ge;{const Oe=Qe=>{es(Qe,{})};var Je=c(Ue);{let Qe=u(()=>[Oe]);me(Je,{get t(){return r(Qe)},get x(){return Re()},n:!0})}}J(Oe=>Ge=St(Ue,1,"",null,Ge,Oe),[()=>({active:r(M)=="draw-area"})]),p(Ie,Ue)};var Z=c(oe);{let Ie=u(()=>[Ae,Ee]),Re=u(()=>r(b).cx(20));me(Z,{get t(){return r(Ie)},get x(){return r(Re)}})}}var te=m(oe,2);{var K=Ae=>{var Ee=Z_(),Ie=Q(Ee);let Re;var Ue=c(Ie),Ge=c(Ue),Je=m(Ue,2),Oe=c(Je),Qe=m(Ie,2);let qe;var Xe=c(Qe),st=c(Xe),ft=m(Xe,2),wt=c(ft);J((At,mt,Mt,tt,it,Nt)=>{Re=St(Ie,1,"step svelte-1ly46ps",null,Re,At),U(Ge,mt),U(Oe,Mt),qe=St(Qe,1,"step svelte-1ly46ps",null,qe,tt),U(st,it),U(wt,Nt)},[()=>({active:!r(I),complete:r(I)}),()=>r(b).t(21),()=>r(b).t(22),()=>({active:r(I),complete:r(C).size>1}),()=>r(b).t(23),()=>r(b).t(24)]),p(Ae,Ee)},V=Ae=>{var Ee=$e(),Ie=Q(Ee);{var Re=Ue=>{var Ge=V_(),Je=Q(Ge);let Oe;var Qe=c(Je),qe=c(Qe),Xe=m(Je,2);gu(Xe,{get map(){return f()},get waypoints(){return r(_)},set waypoints(tt){X(_,tt,!0)},get drawnShapeOut(){return r(D)},set drawnShapeOut(tt){X(D,tt,!0)}});var st=m(Xe,2);let ft;var wt=c(st),At=c(wt),mt=m(wt,2),Mt=c(mt);J((tt,it,Nt,Ot,Et)=>{Oe=St(Je,1,"step svelte-1ly46ps",null,Oe,tt),U(qe,it),ft=St(st,1,"step svelte-1ly46ps",null,ft,Nt),U(At,Ot),U(Mt,Et)},[()=>({active:!r(I),complete:r(I)}),()=>r(b).t(25),()=>({active:r(I),complete:r(C).size>1}),()=>r(b).t(26),()=>r(b).t(27)]),p(Ue,Ge)};ve(Ie,Ue=>{r(M)=="draw-area"&&Ue(Re)},!0)}p(Ae,Ee)};ve(te,Ae=>{r(M)=="choose-area"?Ae(K):Ae(V,!1)})}var ee=m(te,2);let re;var ae=c(ee),ne=c(ae),ie=m(ae,2),_e=c(ie),le=m(ee,2),fe=c(le);fe.__click=[K_,j,I];var se=c(fe),ye=m(fe,2);ye.__click=[D_,x,C,_];{const Ae=Ee=>{ti(Ee,{})};var he=c(ye);{let Ee=u(()=>[Ae]),Ie=u(()=>r(b).cx(31));me(he,{get t(){return r(Ee)},get x(){return r(Ie)}})}}var Se=m(le,2),xe=c(Se),Fe=m(Se,2),ke=c(Fe);{var Ce=Ae=>{_u(Ae,{get neighbourhoodBoundary(){return r(I)}})},pe=Ae=>{var Ee=X_(),Ie=c(Ee);{var Re=Ge=>{var Je=Dt();J(Oe=>U(Je,Oe),[()=>r(b).t(33)]),p(Ge,Je)},Ue=Ge=>{var Je=$e(),Oe=Q(Je);{var Qe=qe=>{var Xe=$e(),st=Q(Xe);{var ft=At=>{var mt=Dt();J(Mt=>U(mt,Mt),[()=>r(b).t(34)]),p(At,mt)},wt=At=>{var mt=Dt();J(Mt=>U(mt,Mt),[()=>r(b).t(35)]),p(At,mt)};ve(st,At=>{r(_).length<3?At(ft):At(wt,!1)})}p(qe,Xe)};ve(Oe,qe=>{r(M)=="draw-area"&&qe(Qe)},!0)}p(Ge,Je)};ve(Ie,Ge=>{r(M)=="choose-area"?Ge(Re):Ge(Ue,!1)})}p(Ae,Ee)};ve(ke,Ae=>{r(I)?Ae(Ce):Ae(pe,!1)})}var Me=m(ue,4);Me.__click=[z_,O];var Te=c(Me);J((Ae,Ee,Ie,Re,Ue,Ge)=>{re=St(ee,1,"step svelte-1ly46ps",null,re,Ae),U(ne,Ee),U(_e,Ie),fe.disabled=!r(I),U(se,Re),ye.disabled=!(r(I)||r(M)=="draw-area"&&r(_).length>0),U(xe,Ue),U(Te,Ge)},[()=>({active:r(I)}),()=>r(b).t(28),()=>r(b).t(29),()=>r(b).t(30),()=>r(b).t(32),()=>r(b).t(36)]),p(S,E)},main:S=>{var E=fp(),N=Q(E);{var G=Y=>{{let ue=u(()=>({type:r(b).t(37),features:[r(I)]}));lt(Y,{get data(){return r(ue)},children:(oe,Z)=>{var te=ep(),K=Q(te);{let ee=u(()=>We("neighbourhood-boundaries-selected-outline",!1));gt(K,Le(()=>r(ee),{paint:{"line-color":"black","line-width":4,"line-dasharray":[2,2]}}))}var V=m(K,2);{let ee=u(()=>We("neighbourhood-boundaries-selected-outline-base",!1));gt(V,Le(()=>r(ee),{paint:{"line-color":"white","line-width":8}}))}p(oe,te)},$$slots:{default:!0}})}};ve(N,Y=>{r(I)&&Y(G)})}var q=m(N,2);{var H=Y=>{lt(Y,{get data(){return r(O)},generateId:!0,children:(ue,oe)=>{var Z=dp(),te=Q(Z);{let V=u(()=>We("neighbourhood-boundaries",!1)),ee=u(()=>({"fill-color":d(r(T)),"fill-opacity":g(r(T))}));ur(te,Le(()=>r(V),{get paint(){return r(ee)},manageHoverState:!0,hoverCursor:"pointer",onclick:F,children:(re,ae)=>{var ne=$e(),ie=Q(ne);{var _e=le=>{Bt(le,{openOn:"hover",children:(se,ye)=>{let he=()=>ye?.().data;const Se=u(()=>he().properties);var xe=$e(),Fe=Q(xe);{var ke=pe=>{const Me=(Te,Ae=Pe)=>{var Ee=tp(),Ie=c(Ee);J(Re=>U(Ie,Re),[()=>r(b).tx(Ae())]),p(Te,Ee)};{let Te=u(()=>[Me]),Ae=u(()=>r(b).cx(38)),Ee=u(()=>[r(Se).area_km2.toFixed(1)]);me(pe,{get t(){return r(Te)},get x(){return r(Ae)},get a(){return r(Ee)}})}},Ce=pe=>{var Me=$e(),Te=Q(Me);{var Ae=Ie=>{const Re=(Ge,Je=Pe)=>{var Oe=rp(),Qe=c(Oe);J(qe=>U(Qe,qe),[()=>r(b).tx(Je())]),p(Ge,Oe)},Ue=Ge=>{var Je=np();p(Ge,Je)};{let Ge=u(()=>[Re,Ue]),Je=u(()=>r(b).cx(39)),Oe=u(()=>[Wi(r(Se).households_with_cars_or_vans,r(Se).total_households),r(Se).total_households.toLocaleString()]);me(Ie,{get t(){return r(Ge)},get x(){return r(Je)},get a(){return r(Oe)}})}},Ee=Ie=>{var Re=$e(),Ue=Q(Re);{var Ge=Oe=>{const Qe=(Xe,st=Pe)=>{var ft=op(),wt=c(ft);J(At=>U(wt,At),[()=>r(b).tx(st())]),p(Xe,ft)},qe=Xe=>{var st=ap();p(Xe,st)};{let Xe=u(()=>[Qe,qe]),st=u(()=>r(b).cx(40)),ft=u(()=>[Math.round(r(Se).population/r(Se).area_km2).toLocaleString()]);me(Oe,{get t(){return r(Xe)},get x(){return r(st)},get a(){return r(ft)}})}},Je=Oe=>{var Qe=$e(),qe=Q(Qe);{var Xe=ft=>{const wt=(mt,Mt=Pe)=>{var tt=ip(),it=c(tt);J(Nt=>U(it,Nt),[()=>r(b).tx(Mt())]),p(mt,tt)},At=mt=>{var Mt=sp();p(mt,Mt)};{let mt=u(()=>[wt,At]),Mt=u(()=>r(b).cx(41)),tt=u(()=>[(r(Se).number_stats19_collisions/r(Se).area_km2).toFixed(1)]);me(ft,{get t(){return r(mt)},get x(){return r(Mt)},get a(){return r(tt)}})}},st=ft=>{var wt=$e(),At=Q(wt);{var mt=tt=>{const it=(Ot,Et=Pe)=>{var xt=lp(),jt=c(xt);J(or=>U(jt,or),[()=>r(b).tx(Et())]),p(Ot,xt)},Nt=Ot=>{var Et=up();p(Ot,Et)};{let Ot=u(()=>[it,Nt]),Et=u(()=>r(b).cx(42)),xt=u(()=>[(r(Se).number_pois/r(Se).area_km2).toFixed(1)]);me(tt,{get t(){return r(Ot)},get x(){return r(Et)},get a(){return r(xt)}})}},Mt=tt=>{var it=$e(),Nt=Q(it);{var Ot=Et=>{var xt=cp(),jt=Q(xt),or=c(jt),br=m(jt,3);J(cn=>{U(or,cn),U(br,` ${r(Se).combined_score??""}`)},[()=>r(b).t(43)]),p(Et,xt)};ve(Nt,Et=>{r(T)=="combined"&&Et(Ot)},!0)}p(tt,it)};ve(At,tt=>{r(T)=="pois"?tt(mt):tt(Mt,!1)},!0)}p(ft,wt)};ve(qe,ft=>{r(T)=="stats19"?ft(Xe):ft(st,!1)},!0)}p(Oe,Qe)};ve(Ue,Oe=>{r(T)=="population_density"?Oe(Ge):Oe(Je,!1)},!0)}p(Ie,Re)};ve(Te,Ie=>{r(T)=="car_ownership"?Ie(Ae):Ie(Ee,!1)},!0)}p(pe,Me)};ve(Fe,pe=>{r(T)=="none"||r(T)=="area"?pe(ke):pe(Ce,!1)})}p(se,xe)},$$slots:{default:!0}})};ve(ie,le=>{r(T)!="simd"&&le(_e)})}p(re,ne)},$$slots:{default:!0}}))}var K=m(te,2);{let V=u(()=>We("neighbourhood-boundaries-outline",!1));gt(K,Le(()=>r(V),{paint:{"line-color":"black","line-width":1}}))}p(ue,Z)},$$slots:{default:!0}})};ve(q,Y=>{r(M)=="choose-area"&&Y(H)})}p(S,E)},$$slots:{top:!0,left:!0,main:!0}}),p(n,$),Be(),y()}tr(["click"]);const _p="/ltn/assets/bus_gate_icon-uqLuLB7T.gif",pp="/ltn/assets/bus_gate-Dqp8PR-8.gif",hp="/ltn/assets/no_entry_icon-C0369Zpr.gif",mp="/ltn/assets/no_entry-t5FpsRr-.gif",bp="/ltn/assets/school_street_icon-Dc8MrJ0F.gif",yp="/ltn/assets/school_street-C6xhQwM-.gif",Ap="/ltn/assets/walk_cycle_only_icon-Cx19XghM.gif",wp="/ltn/assets/walk_cycle_only-4uLhWa-f.gif";class zt{filterType;label;description;imageUrl;iconUrl;constructor(e,t,o,a,s){this.filterType=e,this.label=t,this.description=o,this.imageUrl=a,this.iconUrl=s}get iconURL(){return this.iconUrl}get largeImageURL(){return this.imageUrl}static getFilter(e){switch(e){case"walk_cycle_only":return zt.walkCycleOnly;case"no_entry":return zt.noEntry;case"bus_gate":return zt.busGate;case"school_street":return zt.schoolStreet;default:console.assert(`unknown filter type: "${e}"`);return}}static walkCycleOnly=new zt("walk_cycle_only","Walking/cycling only","A physical barrier that only allows people walking, cycling, and rolling to pass. Often planters or bollards. Larger vehicles cannot enter.",wp,Ap);static noEntry=new zt("no_entry","No entry","An alternative sign to indicate vehicles are not allowed to enter the street. Only people walking, cycling, and rolling may pass through.",mp,hp);static busGate=new zt("bus_gate","Bus gate","A bus gate sign and traffic cameras are installed to allow buses, pedestrians, and cyclists to pass. There is no physical barrier.",pp,_p);static schoolStreet=new zt("school_street","School street","A closure during school hours only. The barrier usually allows teachers and staff to access the school.",yp,bp);static allTypes=[zt.walkCycleOnly,zt.noEntry,zt.busGate,zt.schoolStreet]}var xp=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),$p=P('<input type="checkbox" role="switch"/>'),kp=P("<u> </u> <p><!></p> <p><!></p> <p><!></p>",1),Sp=P("<p> </p>"),Ep=P("<!> <p><!></p> <label><!></label> <p><!></p> <!> <hr/> <!>",1),Lp=P("<!> <!>",1);function Cp(n,e){Ne(e,!0);const t=()=>be(It,"$backend",a),o=()=>be(yt,"$mode",a),[a,s]=ut(),l=u(()=>ct(dt("main")));let i=we(ht(nr()));try{X(i,t().getDemandModel(),!0)}catch{window.alert("No demand model for this area"),Ve(yt,{mode:"pick-neighbourhood"})}let f=we(!1),v=we(void 0);function y(_,D){if(_==null){let z=D?"sum_to":"sum_from",I=Math.max(...r(i).features.map(j=>j.properties[z])),F=b(I);return[F,dr(["get",z],F,ma)]}else{let z=D?"counts_to":"counts_from",I=[...r(i).features.map(d=>d.properties[z][_])],F=Math.max(...I),j=b(F);return[j,dr(["at",["id"],["literal",I]],j,ma)]}}function b(_){let D=ma.length+1;return Array.from(Array(D).keys()).map(z=>Math.round(_/(D-1)*z))}let L=u(()=>r(v)?r(v).id:null),O=u(()=>r(L)!=null?r(i).features[r(L)]:null),M=u(()=>y(r(L),r(f))),T=u(()=>Dr(r(M),2)),x=u(()=>r(T)[0]),C=u(()=>r(T)[1]);kr(n,{top:I=>{var F=xp(),j=c(F),d=c(j),g=c(d);et(g,{mode:{mode:"title"}});var h=m(d,2),$=c(h);et($,{mode:{mode:"pick-neighbourhood"}});var w=m(h,2),A=c(w);et(A,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var B=m(w,2),k=c(B);J(R=>U(k,R),[()=>mr(o().mode)]),p(I,F)},left:I=>{var F=Ep(),j=Q(F);un(j,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var d=m(j,2),g=c(d);{let E=u(()=>r(l).cx(51)),N=u(()=>[r(i).features.length.toLocaleString()]);me(g,{get x(){return r(E)},get a(){return r(N)}})}var h=m(d,2);{const E=N=>{var G=$p();pn(G,()=>r(f),q=>X(f,q)),p(N,G)};var $=c(h);{let N=u(()=>[E]),G=u(()=>r(l).cx(52));me($,{get t(){return r(N)},get x(){return r(G)}})}}var w=m(h,2),A=c(w);{let E=u(()=>r(l).cx(53)),N=u(()=>[r(f)?"from":"to",r(L)==null?"each zone":"this zone"]);me(A,{get x(){return r(E)},get a(){return r(N)}})}var B=m(w,2);{let E=u(()=>({limits:r(x)}));hr(B,{get colorScale(){return ma},get labels(){return r(E)}})}var k=m(B,4);{var R=E=>{var N=kp(),G=Q(N),q=c(G),H=m(G,2),Y=c(H);{let K=u(()=>r(l).cx(54)),V=u(()=>[r(O).properties.sum_from.toLocaleString()]);me(Y,{get x(){return r(K)},get a(){return r(V)}})}var ue=m(H,2),oe=c(ue);{let K=u(()=>r(l).cx(55)),V=u(()=>[r(O).properties.sum_to.toLocaleString()]);me(oe,{get x(){return r(K)},get a(){return r(V)}})}var Z=m(ue,2),te=c(Z);{let K=u(()=>r(l).cx(56)),V=u(()=>[r(O).properties.counts_from[r(L)]]);me(te,{get x(){return r(K)},get a(){return r(V)}})}J(()=>U(q,r(O).properties.name)),p(E,N)},S=E=>{var N=Sp(),G=c(N);J(q=>U(G,q),[()=>r(l).t(57)]),p(E,N)};ve(k,E=>{r(O)&&r(L)!=null?E(R):E(S,!1)})}p(I,F)},main:I=>{lt(I,{get data(){return r(i)},generateId:!0,children:(F,j)=>{var d=Lp(),g=Q(d);{let $=u(()=>We("debug-demand-fill")),w=u(()=>({"fill-color":r(C),"fill-opacity":bt(.5,.1)}));ur(g,Le(()=>r($),{get paint(){return r(w)},manageHoverState:!0,get hovered(){return r(v)},set hovered(A){X(v,A,!0)}}))}var h=m(g,2);{let $=u(()=>We("debug-demand-outline"));gt(h,Le(()=>r($),{paint:{"line-width":2,"line-color":"black"}}))}p(F,d)},$$slots:{default:!0}})},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}var Mp=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav>'),Pp=(n,e)=>X(e,nr(),!0),Tp=P('<button class="secondary"> </button> <!>',1),Ip=P('<a target="_blank"> </a>'),Rp=P("<!> <p> </p> <!> <!>",1),Np=P("<!> <!>",1),Bp=P("<!> <!>",1);function Fp(n,e){Ne(e,!0);const t=()=>be(It,"$backend",a),o=()=>be(yt,"$mode",a),[a,s]=ut(),l=u(()=>ct(dt("main")));let i=we(null),f=we(ht(nr())),v=we(0);function y(b){X(i,b.features[0].properties.osm,!0),X(f,t().getMovements(b.features[0].id),!0),X(v,0)}kr(n,{top:M=>{var T=Mp(),x=c(T),C=c(x),_=c(C);et(_,{mode:{mode:"title"}});var D=m(C,2),z=c(D);et(z,{mode:{mode:"pick-neighbourhood"}});var I=m(D,2),F=c(I);J(j=>U(F,j),[()=>mr(o().mode)]),p(M,T)},left:M=>{var T=Rp(),x=Q(T);un(x,{mode:{mode:"pick-neighbourhood"}});var C=m(x,2),_=c(C),D=m(C,2);{var z=j=>{var d=Tp(),g=Q(d);g.__click=[Pp,f];var h=c(g),$=m(g,2);Ya($,{get list(){return r(f).features},get idx(){return r(v)},set idx(w){X(v,w,!0)}}),J(w=>U(h,w),[()=>r(l).t(59)]),p(j,d)};ve(D,j=>{r(f).features.length>0&&j(z)})}var I=m(D,2);{var F=j=>{var d=Ip(),g=c(d);J(h=>{De(d,"href",r(i)),U(g,h)},[()=>r(l).t(60)]),p(j,d)};ve(I,j=>{r(i)&&j(F)})}J(j=>U(_,j),[()=>r(l).t(58)]),p(M,T)},main:M=>{var T=Bp(),x=Q(T);{let _=u(()=>t().getAllIntersections());lt(x,{get data(){return r(_)},generateId:!0,children:(D,z)=>{{let I=u(()=>We("debug-intersections"));Pn(D,Le(()=>r(I),{paint:{"circle-radius":15,"circle-color":["case",["get","has_turn_restrictions"],"purple","black"]},manageHoverState:!0,hoverCursor:"pointer",onclick:y}))}},$$slots:{default:!0}})}var C=m(x,2);lt(C,{get data(){return r(f)},generateId:!0,children:(_,D)=>{var z=Np(),I=Q(z);{let j=u(()=>We("debug-movements-outline"));gt(I,Le(()=>r(j),{paint:{"line-width":2,"line-color":"red"}}))}var F=m(I,2);{let j=u(()=>We("debug-movements-fill")),d=u(()=>["==",["id"],r(v)]);ur(F,Le(()=>r(j),{get filter(){return r(d)},paint:{"fill-color":"cyan"}}))}p(_,z)},$$slots:{default:!0}}),p(M,T)},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}tr(["click"]);var Op=P("<!> <!>",1);function _a(n,e){Ne(e,!0);const t=()=>be(Ba,"$roadStyle",a),o=()=>be($i,"$drawBorderEntries",a),[a,s]=ut();let l=W(e,"show",3,!0),i=W(e,"prefix",3,"");function f(M){return["interpolate",["linear"],["zoom"],14,.08*M,22,.7*M]}function v(M){return[0,-50*M]}function y(){return["interpolate",["linear"],["zoom"],14,1,22,.7]}var b=Op(),L=Q(b);{let M=u(()=>We(i()+"cells")),T=u(()=>({visibility:!l()||t()=="cells"?"none":"visible"})),x=u(()=>({"fill-color":Ka(),"fill-opacity":.5,"fill-outline-color":"hsla(0, 0%, 0%, 0.3)"}));ur(L,Le(()=>r(M),{filter:["==",["get","kind"],"cell"],get layout(){return r(T)},get paint(){return r(x)}}))}var O=m(L,2);{let M=u(()=>We(i()+"border-entries")),T=u(()=>({"icon-image":"border_entry_arrow","icon-rotate":["get","bearing_upon_entry"],"icon-allow-overlap":!0,"icon-size":f(1),"icon-offset":v(1),"symbol-sort-key":["get","bearing_upon_entry"],visibility:l()&&o()?"visible":"none"})),x=u(()=>({"icon-color":Ka(),"icon-halo-color":"black","icon-opacity":y(),"icon-halo-width":f(1.5),"icon-halo-blur":0}));vo(O,Le(()=>r(M),{filter:["==",["get","kind"],"border_entry"],get layout(){return r(T)},get paint(){return r(x)},minzoom:13,interactive:!1}))}p(n,b),Be(),s()}function ni(n,e){Ne(e,!1),yc();{let t=yl(()=>We("neighbourhood-boundary"));ur(n,Le(()=>r(t),{filter:["==",["get","kind"],"boundary"],paint:{"fill-color":"black","fill-opacity":.3}}))}Be()}var jp=P("<!> <!> <!> <!>",1);function pa(n,e){Ne(e,!0);const t=()=>be(Na,"$useMetricUnits",s),o=()=>be(ki,"$thickRoadsForShortcuts",s),a=()=>be(Ba,"$roadStyle",s),[s,l]=ut();let i=W(e,"interactive",3,!0),f=W(e,"linePopup",3,void 0),v=W(e,"onClickLine",3,(z,I)=>{}),y=W(e,"show",3,!0),b=W(e,"prefix",3,"");function L(z,I){return z=="cells"?Ka():z=="edits"?bt(["case",["get","edited"],gs,"white"],Ur.mapFeature.hover.backgroundColor):z=="speeds"?t()?dr(["round",["*",1.60934,["get","speed_mph"]]],$l,Si):dr(["round",["get","speed_mph"]],kl,Si):I<=2?bt("white","blue"):(console.assert(z=="shortcuts"),bt(["interpolate-hcl",["linear"],["get","shortcuts"],0,"white",1,"#F19A93",I,"#A32015"],Ur.mapFeature.hover.backgroundColor))}function O(z){return z=="edits"?bt(["case",["get","edited"],gs,"gray"],Ur.mapFeature.hover.backgroundColor):bt("gray",Ur.mapFeature.hover.backgroundColor)}function M(z,I,F){return!z||I<=2?lo(F):["interpolate",["linear"],["get","shortcuts"],0,5+F,I,25+F]}var T=jp(),x=Q(T);{let z=u(()=>We(b()+"interior-roads-outlines")),I=u(()=>({"line-width":M(o(),e.maxShortcuts,1),"line-color":"black"})),F=u(()=>({visibility:y()?"visible":"none"}));gt(x,Le(()=>r(z),{filter:["==",["get","kind"],"interior_road"],get paint(){return r(I)},get layout(){return r(F)},minzoom:13}))}var C=m(x,2);{let z=u(()=>We(b()+"interior-roads")),I=u(()=>({"line-width":M(o(),e.maxShortcuts,0),"line-color":L(a(),e.maxShortcuts),"line-opacity":bt(1,.5)})),F=u(()=>({"line-sort-key":["get","shortcuts"],visibility:y()?"visible":"none"})),j=u(()=>i()?"pointer":void 0);gt(C,Le(()=>r(z),{filter:["==",["get","kind"],"interior_road"],get paint(){return r(I)},get layout(){return r(F)},minzoom:13,onclick:d=>i()&&v()(d.features[0],d.event.lngLat),get manageHoverState(){return i()},get hoverCursor(){return r(j)},children:(d,g)=>{var h=$e(),$=Q(h);{var w=A=>{var B=$e(),k=Q(B);Tt(k,()=>f()??Pe),p(A,B)};ve($,A=>{i()&&A(w)})}p(d,h)},$$slots:{default:!0}}))}var _=m(C,2);{let z=u(()=>We(b()+"main-roads-outlines")),I=u(()=>({"line-width":M(o(),e.maxShortcuts,6),"line-color":"black"})),F=u(()=>({visibility:y()?"visible":"none"}));gt(_,Le(()=>r(z),{filter:["==",["get","kind"],"main_road"],get paint(){return r(I)},get layout(){return r(F)},minzoom:13}))}var D=m(_,2);{let z=u(()=>We(b()+"main-roads")),I=u(()=>({"line-width":M(o(),e.maxShortcuts,4),"line-color":O(a()),"line-opacity":bt(1,.5)})),F=u(()=>({"line-sort-key":["get","shortcuts"],visibility:y()?"visible":"none"})),j=u(()=>i()?"pointer":void 0);gt(D,Le(()=>r(z),{filter:["==",["get","kind"],"main_road"],get paint(){return r(I)},get layout(){return r(F)},minzoom:13,onclick:d=>i()&&v()(d.features[0],d.event.lngLat),get manageHoverState(){return i()},get hoverCursor(){return r(j)},children:(d,g)=>{var h=$e(),$=Q(h);{var w=A=>{var B=$e(),k=Q(B);Tt(k,()=>f()??Pe),p(A,B)};ve($,A=>{i()&&A(w)})}p(d,h)},$$slots:{default:!0}}))}p(n,T),Be(),l()}var zp=P("<!> <!>",1);function Dp(n,e){Ne(e,!0);const t=()=>be(Vt,"$mutationCounter",s),o=()=>be(It,"$backend",s),a=()=>be(Ra,"$showExistingFiltersAndTRs",s),[s,l]=ut();let i=W(e,"children",3,void 0),f=W(e,"turnRestrictionGj",3,null),v=W(e,"show",3,!0),y=W(e,"prefix",3,""),b=W(e,"onClickTurnRestriction",3,()=>{}),L=we(void 0),O=u(()=>r(L)==null?nr():{type:"FeatureCollection",features:[{type:"Feature",geometry:JSON.parse(r(L).properties.from_geometry),properties:{}},{type:"Feature",geometry:JSON.parse(r(L).properties.to_geometry),properties:{}}]}),M=u(()=>t()>0&&f()==null?o().renderTurnRestrictions():nr());var T=zp(),x=Q(T);{let _=u(()=>f()||r(M));lt(x,{get data(){return r(_)},generateId:!0,children:(D,z)=>{{let I=u(()=>We(y()+"turn-restrictions")),F=u(()=>a()?void 0:["get","edited"]),j=u(()=>({"icon-image":["concat","no_",["get","kind"],"_turn"],"icon-rotate":["get","icon_angle"],"icon-allow-overlap":!0,"icon-size":.05,visibility:v()?"visible":"none"}));vo(D,Le(()=>r(I),{minzoom:13,get filter(){return r(F)},get layout(){return r(j)},paint:{"icon-opacity":["case",["get","edited"],1,.5]},get onclick(){return b()},get hovered(){return r(L)},set hovered(d){X(L,d,!0)},children:(d,g)=>{var h=$e(),$=Q(h);Tt($,()=>i()??Pe),p(d,h)},$$slots:{default:!0}}))}},$$slots:{default:!0}})}var C=m(x,2);lt(C,{get data(){return r(O)},children:(_,D)=>{{let z=u(()=>We(y()+"turn-restrictions-debug-arrows")),I=u(()=>({visibility:v()?"visible":"none"}));gt(_,Le(()=>r(z),{interactive:!1,paint:{"line-width":4,"line-color":"red"},get layout(){return r(I)}}))}},$$slots:{default:!0}}),p(n,T),Be(),l()}var Up=P("<!> <!>",1),Gp=P("<!> <!>",1);function kn(n,e){Ne(e,!0);const t=()=>be(Vt,"$mutationCounter",s),o=()=>be(It,"$backend",s),a=()=>be(Ra,"$showExistingFiltersAndTRs",s),[s,l]=ut();let i=W(e,"modalFilterGj",3,null),f=W(e,"turnRestrictionGj",3,null),v=W(e,"onClickModalFilter",3,()=>{}),y=W(e,"onClickTurnRestriction",3,()=>{}),b=W(e,"modalFilterPopup",3,void 0),L=W(e,"turnRestrictionPopup",3,void 0),O=W(e,"show",3,!0),M=W(e,"prefix",3,""),T=13,x=u(()=>t()>0&&i()==null?o().renderModalFilters():nr());var C=Gp(),_=Q(C);{let z=u(()=>i()||r(x));lt(_,{get data(){return r(z)},generateId:!0,children:(I,F)=>{var j=Up(),d=Q(j);{let h=u(()=>We(M()+"modal-filters")),$=u(()=>["all",["!=",["get","filter_kind"],"diagonal_filter"],a()?["literal",!0]:["get","edited"]]),w=u(()=>({"icon-image":["get","filter_kind"],"icon-rotate":["get","angle"],"icon-allow-overlap":!0,"icon-size":.1,visibility:O()?"visible":"none"}));vo(d,Le(()=>r(h),{get interactive(){return e.interactive},get filter(){return r($)},minzoom:T,get layout(){return r(w)},paint:{"icon-opacity":["case",["get","edited"],1,.5]},get onclick(){return v()},children:(A,B)=>{var k=$e(),R=Q(k);Tt(R,()=>b()??Pe),p(A,k)},$$slots:{default:!0}}))}var g=m(d,2);{let h=u(()=>We(M()+"intersection-filters")),$=u(()=>({"icon-image":"diagonal_filter","icon-rotate":["get","angle",["get","filter"]],"icon-allow-overlap":!0,"icon-size":.07,visibility:O()?"visible":"none"}));vo(g,Le(()=>r(h),{filter:["==",["get","filter_kind"],"diagonal_filter"],minzoom:T,get layout(){return r($)},interactive:!1}))}p(I,j)},$$slots:{default:!0}})}var D=m(_,2);Dp(D,{get show(){return O()},get prefix(){return M()},get turnRestrictionGj(){return f()},get onClickTurnRestriction(){return y()},children:(z,I)=>{var F=$e(),j=Q(F);Tt(j,()=>L()??Pe),p(z,F)},$$slots:{default:!0}}),p(n,C),Be(),l()}function ha(n,e){Ne(e,!0);let t=W(e,"show",3,!0),o=W(e,"prefix",3,"");{let a=u(()=>We(o()+"one-ways")),s=u(()=>({"icon-image":"oneway_arrow","icon-size":1,"symbol-placement":"line","symbol-spacing":50,"icon-allow-overlap":!0,"icon-rotate":["case",["==",["get","travel_flow"],"forwards"],0,180],visibility:t()?"visible":"none"}));vo(n,Le(()=>r(a),{filter:["all",["in",["get","kind"],["literal",["interior_road","main_road"]]],["!=",["get","travel_flow"],"both"]],get layout(){return r(s)},paint:{"icon-opacity":["case",["get","travel_flow_edited"],1,.5]},minzoom:13,interactive:!1}))}Be()}function Ka(){return["match",["get","cell_color"],"disconnected","red","pedestrianized","#dddde8",["let","index",["%",["to-number",["get","cell_color"]],10],["match",["var","index"],0,"#8dd3c7",1,"#ffffb3",2,"#bebada",3,"#80b1d3",4,"#fdb462",5,"#b3de69",6,"#fccde5",7,"#bc80bd",8,"#ccebc5",9,"#ffed6f","blue"]]]}var Wp=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),Hp=(n,e)=>X(e,null),qp=P('<button class="close-btn svelte-ouxims"></button>'),Jp=P("<!> <h5> </h5> <!>",1),Qp=P("<p> </p>"),Zp=P('<!> <h4> </h4> <p> </p> <div style="display: flex; align-items: start; justify-content: space-between;"><h4> </h4> <!></div> <!>',1),Vp=P("<!> <!> <!> <!> <!>",1),Kp=P("<!> <!>",1),Xp=P("<!> <!> <!> <!>",1);function Yp(n,e){Ne(e,!0);const t=()=>be(It,"$backend",a),o=()=>be(yt,"$mode",a),[a,s]=ut(),l=u(()=>ct(dt("main")));let i=t().renderNeighbourhood(),f=we(null);function v(y){let b=y.features[0],L=t().getMovements(b.properties.intersection_id);X(f,{feature:b,movements:L,movementIdx:0},!0)}kr(n,{top:O=>{var M=Wp(),T=c(M),x=c(T),C=c(x);et(C,{mode:{mode:"title"}});var _=m(x,2),D=c(_);et(D,{mode:{mode:"pick-neighbourhood"}});var z=m(_,2),I=c(z);et(I,{mode:{mode:"neighbourhood"}});var F=m(z,2),j=c(F);J(d=>U(j,d),[()=>mr(o().mode)]),p(O,M)},left:O=>{var M=Zp(),T=Q(M);un(T,{mode:{mode:"neighbourhood"}});var x=m(T,2),C=c(x),_=m(x,2),D=c(_),z=m(_,2),I=c(z),F=c(I),j=m(I,2);{var d=w=>{var A=qp();A.__click=[Hp,f],p(w,A)};ve(j,w=>{r(f)&&w(d)})}var g=m(z,2);{var h=w=>{var A=Jp(),B=Q(A);ro(B,{get properties(){return r(f).feature.properties}});var k=m(B,2),R=c(k),S=m(k,2);Ya(S,{get list(){return r(f).movements.features},get idx(){return r(f).movementIdx},set idx(E){r(f).movementIdx=E}}),J(E=>U(R,E),[()=>r(l).t(64)]),p(w,A)},$=w=>{var A=Qp(),B=c(A);J(k=>U(B,k),[()=>r(l).t(65)]),p(w,A)};ve(g,w=>{r(f)?w(h):w($,!1)})}J((w,A,B)=>{U(C,w),U(D,A),U(F,B)},[()=>r(l).t(61),()=>r(l).t(62),()=>r(l).t(63)]),p(O,M)},main:O=>{var M=Xp(),T=Q(M);lt(T,{get data(){return i},generateId:!0,children:(z,I)=>{var F=Vp(),j=Q(F);ni(j,{});var d=m(j,2);_a(d,{});var g=m(d,2);ha(g,{});var h=m(g,2);{let w=u(()=>We("debug-borders"));Pn(h,Le(()=>r(w),{filter:["==",["get","kind"],"border_intersection"],paint:{"circle-radius":15,"circle-color":"green"},children:(A,B)=>{Bt(A,{openOn:"hover",children:(R,S)=>{let E=()=>S?.().data;ro(R,{get properties(){return E().properties}})},$$slots:{default:!0}})},$$slots:{default:!0}}))}var $=m(h,2);pa($,{interactive:!0,onClickLine:(A,B)=>window.open(A.properties.way,"_blank"),get maxShortcuts(){return i.maxShortcuts},linePopup:A=>{Bt(A,{openOn:"hover",children:(k,R)=>{let S=()=>R?.().data;ro(k,{get properties(){return S().properties}})},$$slots:{default:!0}})},$$slots:{linePopup:!0}}),p(z,F)},$$slots:{default:!0}});var x=m(T,2);kn(x,{interactive:!0,modalFilterPopup:F=>{Bt(F,{openOn:"hover",children:(d,g)=>{let h=()=>g?.().data;ro(d,{get properties(){return h().properties}})},$$slots:{default:!0}})},turnRestrictionPopup:F=>{Bt(F,{openOn:"hover",children:(d,g)=>{let h=()=>g?.().data;ro(d,{get properties(){return h().properties}})},$$slots:{default:!0}})},$$slots:{modalFilterPopup:!0,turnRestrictionPopup:!0}});var C=m(x,2);{let z=u(()=>t().getAllIntersections());lt(C,{get data(){return r(z)},generateId:!0,children:(I,F)=>{{let j=u(()=>We("debug-intersections")),d=u(()=>({"circle-radius":Sl(30),"circle-color":Ur.mapFeature.hover.backgroundColor,"circle-stroke-color":Ur.mapFeature.hover.backgroundColor,"circle-stroke-opacity":.8,"circle-stroke-width":bt(0,3),"circle-opacity":["case",["==",["get","intersection_id"],r(f)?.feature?.properties?.intersection_id??-1],.3,bt(0,.5)]}));Pn(I,Le(()=>r(j),{get paint(){return r(d)},manageHoverState:!0,hoverCursor:"pointer",onclick:v,children:(g,h)=>{Bt(g,{openOn:"hover",children:(w,A)=>{let B=()=>A?.().data;ro(w,{get properties(){return B().properties}})},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}var _=m(C,2);{var D=z=>{lt(z,{get data(){return r(f).movements},generateId:!0,children:(I,F)=>{var j=Kp(),d=Q(j);{let h=u(()=>We("debug-movements-outline"));gt(d,Le(()=>r(h),{paint:{"line-width":2,"line-color":"red"}}))}var g=m(d,2);{let h=u(()=>We("debug-movements-fill")),$=u(()=>["==",["id"],r(f).movementIdx]);ur(g,Le(()=>r(h),{get filter(){return r($)},paint:{"fill-color":"cyan"}}))}p(I,j)},$$slots:{default:!0}})};ve(_,z=>{r(f)&&z(D)})}p(O,M)},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}tr(["click"]);const eh="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='lucide%20lucide-eraser-icon%20lucide-eraser'%20version='1.1'%20id='svg3'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs3'%20/%3e%3cpath%20d='m7%2021-4.3-4.3c-1-1-1-2.5%200-3.4l9.6-9.6c1-1%202.5-1%203.4%200l5.6%205.6c1%201%201%202.5%200%203.4L13%2021'%20id='path1'%20/%3e%3cpath%20d='M22%2021H7'%20id='path2'%20/%3e%3cpath%20d='m5%2011%209%209'%20id='path3'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.0194348;fill-opacity:1'%20d='M%2010.210757,14.752002%206.459622,11.000548%209.8160254,7.6426783%20C%2012.367029,5.0905596%2013.239386,4.2512757%2013.451467,4.1450647%20c%200.349597,-0.1750803%200.789698,-0.1876196%201.091224,-0.031091%200.115256,0.059832%201.582424,1.4856537%203.265247,3.1732297%203.019567,3.0280936%203.057066,3.0684746%203.149916,3.3920116%200.07937,0.276581%200.08343,0.372957%200.02609,0.620542%20-0.06661,0.287624%20-0.13239,0.357763%20-3.515539,3.748403%20-1.896214,1.900412%20-3.460904,3.455295%20-3.477088,3.455295%20-0.01619,0%20-1.717438,-1.688155%20-3.780562,-3.751453%20z'%20id='path4'%20/%3e%3cpath%20style='fill:%23ffffff;fill-opacity:1;stroke:%23ff533e;stroke-width:0.0194348'%20d='M%205.321794,17.868809%20C%204.1705931,16.713048%203.1848808,15.680805%203.131322,15.574936%203.077763,15.469067%203.0207033,15.236442%203.004522,15.057992%202.959692,14.563595%203.080751,14.37604%204.1030807,13.356012%20l%200.8902675,-0.888263%203.7509032,3.751221%203.7509036,3.751222%20H%209.9550205%207.4148864%20Z'%20id='path5'%20/%3e%3c/svg%3e",th="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20class='lucide%20lucide-paintbrush-icon%20lucide-paintbrush'%20version='1.1'%20id='svg3'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs3'%20/%3e%3cpath%20d='m14.622%2017.897-10.68-2.913'%20id='path1'%20/%3e%3cpath%20d='M18.376%202.622a1%201%200%201%201%203.002%203.002L17.36%209.643a.5.5%200%200%200%200%20.707l.944.944a2.41%202.41%200%200%201%200%203.408l-.944.944a.5.5%200%200%201-.707%200L8.354%207.348a.5.5%200%200%201%200-.707l.944-.944a2.41%202.41%200%200%201%203.408%200l.944.944a.5.5%200%200%200%20.707%200z'%20id='path2'%20/%3e%3cpath%20d='M9%208c-1.804%202.71-3.97%203.46-6.583%203.948a.507.507%200%200%200-.302.819l7.32%208.883a1%201%200%200%200%201.185.204C12.735%2020.405%2016%2016.792%2016%2015'%20id='path3'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.00941713'%20d='M%2013.216364,10.769138%209.4441913,6.9961356%209.8268793,6.6205315%20C%2010.053748,6.3978626%2010.26605,6.2149074%2010.348288,6.1711993%20c%200.393818,-0.2093087%200.914655,-0.2092623%201.30798,1.172e-4%200.09062,0.048241%200.356713,0.2875083%200.767422,0.6900596%200.345786,0.338918%200.691198,0.6557984%200.767583,0.7041789%200.216015,0.1368197%200.430512,0.2013581%200.722288,0.2173241%200.316089,0.017296%200.499892,-0.017578%200.768527,-0.1458202%200.194182,-0.092699%200.283143,-0.1774989%202.37486,-2.2637553%202.357603,-2.3514493%202.273297,-2.2768061%202.645598,-2.3423855%200.33614,-0.05921%200.694848,0.059949%200.950717,0.3158186%200.253238,0.2532377%200.374946,0.6150471%200.31719,0.9429318%20-0.0673,0.3820937%200.01738,0.2862242%20-2.343684,2.6533839%20-2.086365,2.0917555%20-2.171127,2.1806742%20-2.263828,2.3748599%20-0.127718,0.2675385%20-0.162966,0.4524174%20-0.14652,0.7685267%200.01524,0.292912%200.09451,0.540519%200.242982,0.758947%200.04844,0.07126%200.360914,0.406322%200.694399,0.744591%200.41818,0.424179%200.627762,0.657447%200.675382,0.751709%200.212723,0.421072%200.212671,0.891705%20-1.46e-4,1.312073%20-0.04338,0.08569%20-0.207187,0.276887%20-0.439097,0.512528%20-0.203448,0.20672%20-0.376992,0.375854%20-0.385655,0.375854%20-0.0087,0%20-1.713228,-1.697851%20-3.787922,-3.773003%20z'%20id='path4'%20/%3e%3cpath%20style='fill:%23ffffff;stroke:%23ff533e;stroke-width:0.00941713;fill-opacity:1'%20d='M%209.349188,15.407794%204.525255,14.090285%203.9850003,13.435502%203.4447455,12.780718%203.9569969,12.649282%20C%206.0202821,12.119873%207.4294884,11.334333%208.7020764,10.004212%208.8652116,9.8337017%209.0246733,9.6590433%209.0564355,9.6160824%20l%200.05775,-0.078111%202.9032955,2.9031996%202.903295,2.9032%20-0.06256,0.166083%20c%20-0.122687,0.325724%20-0.617409,1.223308%20-0.670589,1.216662%20-0.008,-9.97e-4%20-2.18528,-0.594692%20-4.8384428,-1.319322%20z'%20id='path5'%20/%3e%3cpath%20style='fill:%23000000;fill-opacity:1;stroke:%23000000;stroke-width:0.00941713;stroke-opacity:1'%20d='M%208.4622824,18.869673%20C%207.5370363,17.746854%206.7832695,16.824931%206.7872451,16.820955%20c%200.00525,-0.0052%205.8629439,1.583356%206.0455299,1.639545%200.04062,0.0125%20-1.405633,1.450684%20-1.775827,1.765924%20-0.389041,0.331289%20-0.845683,0.684738%20-0.884654,0.684738%20-0.01526,0%20-0.7847654,-0.91867%20-1.7100116,-2.041489%20z'%20id='path6'%20/%3e%3c/svg%3e",il="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3csvg%20width='200'%20height='200'%20viewBox='0%200%20208%20208'%20version='1.1'%20id='svg4'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:svg='http://www.w3.org/2000/svg'%3e%3cdefs%20id='defs4'%20/%3e%3cg%20id='g2'%20transform='translate(-0.5,-587.21484)'%20style='display:inline'%3e%3cpath%20fill='none'%20stroke-width='10'%20stroke-linecap='butt'%20stroke-linejoin='miter'%20stroke='%231476c6'%20stroke-opacity='1'%20stroke-miterlimit='4'%20d='m%201026.4453,2047.8516%20c%20564.1016,0%201021.4063,-457.3047%201021.4063,-1021.4063%20C%202047.8516,462.34375%201590.5469,5%201026.4453,5%20462.30469,5%205,462.34375%205,1026.4453%205,1590.5469%20462.30469,2047.8516%201026.4453,2047.8516%20Z%20m%200,0'%20transform='matrix(0.1,0,0,-0.1,0,792)'%20id='path2'%20/%3e%3c/g%3e%3cpath%20fill-rule='nonzero'%20fill='%231476c6'%20fill-opacity='1'%20d='m%20102.14453,4.207026%20c%2054.08594,0%2097.93359,43.84766%2097.93359,97.933604%200,54.08984%20-43.84765,97.9375%20-97.93359,97.9375%20-54.089842,0%20-97.937499,-43.84766%20-97.937499,-97.9375%200,-54.085944%2043.847657,-97.933604%2097.937499,-97.933604'%20id='path3'%20style='display:inline'%20/%3e%3cpath%20fill-rule='nonzero'%20fill='%23ffffff'%20fill-opacity='1'%20d='M%20185.51172,115.58985%20H%2069.265625%20l%2027.648437,27.65234%20H%2056.015625%20L%2014.816406,102.04297%2056.015625,60.843746%20H%2096.914062%20L%2069.265625,88.492186%20H%20185.51172%20v%2027.097664'%20id='path4'%20style='display:inline'%20/%3e%3c/svg%3e",rh="/ltn/assets/traffic_1-MHHbc4qO.svg";function mn(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function nh(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function oh(n){return n.type==="Feature"?n.geometry:n}function bu(n,e,t={}){if(t.final===!0)return ah(n,e);const o=mn(n),a=mn(e),s=Mr(o[0]),l=Mr(a[0]),i=Mr(o[1]),f=Mr(a[1]),v=Math.sin(l-s)*Math.cos(f),y=Math.cos(i)*Math.sin(f)-Math.sin(i)*Math.cos(f)*Math.cos(l-s);return aa(Math.atan2(v,y))}function ah(n,e){let t=bu(e,n);return t=(t+180)%360,t}function ih(n,e,t,o={}){const a=mn(n),s=Mr(a[0]),l=Mr(a[1]),i=Mr(t),f=qd(e,o.units),v=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(i)),y=s+Math.atan2(Math.sin(i)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(v)),b=aa(y),L=aa(v);return Vn([b,L],o.properties)}function _n(n,e,t={}){var o=mn(n),a=mn(e),s=Mr(a[1]-o[1]),l=Mr(a[0]-o[0]),i=Mr(o[1]),f=Mr(a[1]),v=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(l/2),2)*Math.cos(i)*Math.cos(f);return Hd(2*Math.atan2(Math.sqrt(v),Math.sqrt(1-v)),t.units)}var sh=_n;function lh(n,e,t={}){const a=oh(n).coordinates;let s=0;for(let l=0;l<a.length&&!(e>=s&&l===a.length-1);l++)if(s>=e){const i=e-s;if(i){const f=bu(a[l],a[l-1])-180;return ih(a[l],i,f,t)}else return Vn(a[l])}else s+=_n(a[l],a[l+1],t);return Vn(a[a.length-1])}var uh=lh;function ch(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=u(y),a=50,s=100,l=.01,i=ht(b()),f=u(O),v=setInterval(M,s);cr(()=>clearInterval(v));function y(){return e.paths.features.map(T=>1/T.properties.directness).reduce((T,x)=>T+x,0)}function b(){return e.paths.features.length==0?[]:Array.from({length:a},L)}function L(){let T=Math.random()*r(o),x=0;for(let[C,_]of e.paths.features.entries())if(x+=1/_.properties.directness,T<x)return{idx:C,distance:0};throw new Error(`didnt pick dot, totalDirectness is ${r(o)}`)}function O(){return{type:r(t).t(37),features:i.map(({idx:T,distance:x})=>uh(e.paths.features[T],x,{units:"kilometers"}))}}function M(){for(let[T,x]of i.entries())x.distance+=l,x.distance>=e.paths.features[x.idx].properties.length_meters/1e3&&(i[T]=L())}lt(n,{get data(){return r(f)},children:(T,x)=>{{let C=u(()=>We("animate-shortcuts"));Pn(T,Le(()=>r(C),{paint:{"circle-radius":10,"circle-color":"purple","circle-stroke-color":"black","circle-stroke-width":1}}))}},$$slots:{default:!0}}),Be()}class dh{feature;constructor(e){this.feature=e}get intersectionId(){return this.feature.properties.intersection_id}get filter(){return this.feature.properties.filter}get filterAngle(){return this.feature.properties.filter?.angle}get hasRotatedFilter(){return this.feature.properties.filter?.is_rotated??!1}}const hi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAAlwSFlzAAAOwwAADsMBx2+oZAAAALRQTFRFR3BMemc7uV08rWA9gmc9wlw9+1M8/1c6XGw7rWA8yFs9Tm47d2g8RXA7lmM8N3I6bGo7g2Y8u108wl097lY9vV08pmE9pGE8IHY7/3YajWU8hWc811o+nmI87VU7L3M73Fo+K3Q62Fs+s189kWQ8gGc7iGU8e2g7x1pAC3k6////X6d+H4RKTJ1vjcCjEHg6F3c6HnY6+Pv6NJBbWaR5FX5C4vDoHINIQZZlfbiWmMaszuTYcGgFiwAAACl0Uk5TAMN7grBaDAXjiU7r0O+f9dvJdmUgbZSi/AKouC+zGPg3+yV8wbuzwESr5F6DAAAFwklEQVR42u3ax1rbQACF0STGvRsXMJieMqTICqS//3tlkS8LgpNgSZsZnf8R7hysgp49kyRJkiRJkqQ0mzdn141HvVhctGyTese95clkmIddZZedwXp2ZqR0u1oOLsO/y/qvFm1LJdnpqh+e0nZwjUB6tZZPO/5fBJoGS6zeIAt7NF65IUyq7jDsVza9sFoytVdHYe86PcOlcv6bbShQ341AIq0KnX8IQ78BSbTMQ8E6p9aLv+Y4FG7qWSD6rjrFzz9kKwPG3iaUaew2IPYLwHkpAGHqrXDcTcudf8gXNoz6B+CyJIAwPbZixJ2UPf9w5HVQxM37pQGEtRnjrVv+/EPHu4B4e1kBgO2hHWOt1akAQBgZMtZ6eRUAnhsy1hpVnH+YeBCMtVElAMZzS0baQRXnn+X+H1Df10AeA6LudSUAwsySkfa8GgAvLAmAABAAAkAACADFDuDL+4d9/QRAnQC8/Xj7R5/vAKgPgHePzv/29gcA9QFwf7ujTwDUBsDbXQDeAQAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAABAAAkAACAABIAAEgAAQAAJAAAgAASAABIAAEAACQAAIAAEgAASAAAAAAAAAAAAAAAAAAAAAfne/C8AXAGoD4G7H+X8OANQGQPj+6Pw/3gNQIwDh/YeHfbsLANQJwD4BAICi7HU1AGaWjLSXlZx/dmjJSDuoBEDes2SkjSoBMD61ZKR1KwHQaVsy0g63VQAYGDLWzvpVAFgbstYvAjJPgfG2rABAf27HaLsYlwdwYsZ4Oy5/Ddi6AsTcrPRzwKRlxYhrD8reAnaNGHXXuR8AdwHFO1qYMPLeDMsAuDFg9HWPSlwAruwX/0VgkxU9/2HTfAnUuil4/ufXxkuis2mx8/cEmIyAmwJXgXHDcOlcBTZ73wl2fAmYVI39Pg3YTn0Hllinm8s9/vy7PgNLr8X0ideB/trjf5pvBA5P/n8hyCcjx59u8+6ryflfHwny4WDU9OOfeO2LRXe0Xh/80Xq0bDTPzCNJkiRJkqQk+wnTOFu90krtLAAAAABJRU5ErkJggg==";var fh=P('<div class="icon"> </div>'),vh=P('<img style="transform: rotate(45deg);" class="svelte-1geomdd"/>'),gh=P('<div style="font-size: 200%; padding-bottom: 4px;" class="icon"> </div>'),_h=P('<img style="transform: rotate(45deg);" class="svelte-1geomdd"/>'),ph=P('<div style="font-size: 200%; margin-top: -12px;" class="icon"> </div>'),hh=P('<img style="transform: rotate(135deg);" class="svelte-1geomdd"/>'),mh=P('<div style="display: flex; align-items: center;"><!></div>');function bh(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));var o=mh(),a=c(o);{var s=i=>{var f=$e(),v=Q(f);{var y=L=>{const O=(T,x=Pe)=>{var C=fh(),_=c(C);J(D=>U(_,D),[()=>r(t).tx(x())]),p(T,C)},M=T=>{var x=vh();J(C=>{De(x,"src",hi),De(x,"alt",C)},[()=>r(t).t(176)]),p(T,x)};{let T=u(()=>[O,M]),x=u(()=>r(t).cx(177));me(L,{get t(){return r(T)},get x(){return r(x)}})}},b=L=>{const O=(T,x=Pe)=>{var C=gh(),_=c(C);J(D=>U(_,D),[()=>r(t).tx(x())]),p(T,C)},M=T=>{var x=_h();J(C=>{De(x,"src",hi),De(x,"alt",C)},[()=>r(t).t(178)]),p(T,x)};{let T=u(()=>[O,M]),x=u(()=>r(t).cx(179));me(L,{get t(){return r(T)},get x(){return r(x)}})}};ve(v,L=>{e.intersection.hasRotatedFilter?L(y):L(b,!1)})}p(i,f)},l=i=>{const f=(y,b=Pe)=>{var L=ph(),O=c(L);J(M=>U(O,M),[()=>r(t).tx(b())]),p(y,L)},v=y=>{var b=hh();J(L=>{De(b,"src",hi),De(b,"alt",L)},[()=>r(t).t(180)]),p(y,b)};{let y=u(()=>[f,v]),b=u(()=>r(t).cx(181));me(i,{get t(){return r(y)},get x(){return r(b)}})}};ve(a,i=>{e.intersection.filter?i(s):i(l,!1)})}p(n,o),Be()}function yh(n,e){Ne(e,!0);let t=W(e,"onClickIntersection",3,i=>{}),o=W(e,"interactive",3,!1),a=W(e,"show",3,!0);function s(i){let f=e.neighbourhood.features[i];return new dh(f)}function l(i){return s(i[0].id)}{let i=u(()=>We("editable-intersections")),f=u(()=>({"circle-radius":Sl(30),"circle-color":Ur.mapFeature.hover.backgroundColor,"circle-opacity":bt(0,.5),"circle-stroke-color":Ur.mapFeature.hover.backgroundColor,"circle-stroke-opacity":.8,"circle-stroke-width":bt(0,3)})),v=u(()=>({visibility:a()?"visible":"none"}));Pn(n,Le(()=>r(i),{filter:["==",["get","kind"],"editable_intersection"],get paint(){return r(f)},get layout(){return r(v)},minzoom:13,get interactive(){return o()},manageHoverState:!0,hoverCursor:"pointer",onclick:y=>t()(l(y.features)),children:(y,b)=>{Bt(y,{openOn:"hover",children:(O,M)=>{let T=()=>M?.().features;{let x=u(()=>l(T()));bh(O,{get intersection(){return r(x)}})}},$$slots:{default:!0}})},$$slots:{default:!0}}))}Be()}var Ah=(n,e,t)=>Ve(Xi,r(t).filterType),wh=P('<button class="outline" style="width: 100%"><img width="80"/> <br/> </button>'),xh=(n,e)=>e(!1),$h=P('<article style="max-height: 80vh; max-width: 80vw; overflow: auto"><h3> </h3> <table><tbody><tr><td></td><td><img height="300"/> <p> </p></td></tr></tbody></table> <center><button> </button></center></article>');function kh(n,e){Ne(e,!0);const t=()=>be(Xi,"$currentFilterType",o),[o,a]=ut(),s=u(()=>ct(dt("main")));let l=W(e,"show",15),i=u(()=>zt.allTypes.find(f=>f.filterType==t()));El(n,{get show(){return l()},set show(f){l(f)},children:(f,v)=>{var y=$h(),b=c(y),L=c(b),O=m(b,2),M=c(O),T=c(M),x=c(T);Jt(x,21,()=>zt.allTypes,Qt,(d,g)=>{var h=wh();h.__click=[Ah,t,g];var $=c(h),w=m($,3);J(()=>{h.disabled=t()==r(g).filterType,De($,"src",r(g).iconURL),De($,"alt",r(g).label),U(w,` ${r(g).label??""}`)}),p(d,h)});var C=m(x),_=c(C),D=m(_,2),z=c(D),I=m(O,2),F=c(I);F.__click=[xh,l];var j=c(F);J((d,g)=>{U(L,d),De(_,"src",r(i).largeImageURL),De(_,"alt",r(i).label),U(z,r(i).description),U(j,g)},[()=>r(s).t(174),()=>r(s).t(175)]),p(f,y)},$$slots:{default:!0}}),Be(),a()}tr(["click"]);function Sh(n,e){Ne(e,!0);const t=u(()=>ct(dt("main")));let o=we(null);e.map.on("dragstart",a),e.map.on("mousemove",s),e.map.on("mouseup",l),cr(()=>{e.map.dragPan.enable(),e.map.off("dragstart",a),e.map.off("mousemove",s),e.map.off("mouseup",l)});function a(){e.map.dragPan.disable(),X(o,{type:r(t).t(376),properties:{},geometry:{type:r(t).t(377),coordinates:[]}},!0)}function s(i){if(r(o)){let f=i.lngLat.toArray(),v=r(o).geometry.coordinates.at(-1);if(v&&sh(v,f)*1e3<.5)return;r(o).geometry.coordinates.push(f)}}function l(){!r(o)||r(o).geometry.coordinates.length==0?e.onDone(null):e.onDone(r(o)),X(o,null),e.map.dragPan.enable()}{let i=u(()=>r(o)||nr());lt(n,{get data(){return r(i)},children:(f,v)=>{{let y=u(()=>We("freehand-line"));gt(f,Le(()=>r(y),{paint:{"line-width":5,"line-color":"red"}}))}},$$slots:{default:!0}})}Be()}var Eh=P("<p><!></p>"),Lh=P("<p><!></p>"),Ch=P("<!> <!> <!>",1),Mh=P("<!> <!>",1);function Ph(n,e){Ne(e,!0);const t=()=>be(Ei,"$showBeforeEdits",a),o=()=>be(It,"$backend",a),[a,s]=ut(),l=u(()=>ct(dt("main")));let i="before-edits-",f=we(null),v=we(null),y=we(null);Ze(()=>{t()&&r(f)==null&&(X(f,o().renderNeighbourhoodBeforeEdits(),!0),X(v,o().renderModalFiltersBeforeEdits(),!0),X(y,o().renderTurnRestrictionsBeforeEdits(),!0))});var b=Mh(),L=Q(b);{var O=x=>{lt(x,{get data(){return r(f)},generateId:!0,children:(C,_)=>{var D=Ch(),z=Q(D);_a(z,{get show(){return t()},prefix:i});var I=m(z,2);ha(I,{get show(){return t()},prefix:i});var F=m(I,2);pa(F,{get show(){return t()},prefix:i,interactive:!0,get maxShortcuts(){return r(f).maxShortcuts},linePopup:d=>{Bt(d,{openOn:"hover",children:(h,$)=>{let w=()=>$?.().data;const A=u(()=>w().properties);var B=$e(),k=Q(B);{var R=E=>{var N=Eh(),G=c(N);{let q=u(()=>r(l).cx(469)),H=u(()=>[r(A).shortcuts,r(A).name??"unnamed road",Fa(r(A).speed_mph)]);me(G,{get x(){return r(q)},get a(){return r(H)}})}p(E,N)},S=E=>{var N=$e(),G=Q(N);{var q=H=>{var Y=Lh(),ue=c(Y);{let oe=u(()=>r(l).cx(470)),Z=u(()=>[r(A).name??"unnamed road",Fa(r(A).speed_mph)]);me(ue,{get x(){return r(oe)},get a(){return r(Z)}})}p(H,Y)};ve(G,H=>{r(A).kind=="main_road"&&H(q)},!0)}p(E,N)};ve(k,E=>{r(A).kind=="interior_road"?E(R):E(S,!1)})}p(h,B)},$$slots:{default:!0}})},$$slots:{linePopup:!0}}),p(C,D)},$$slots:{default:!0}})};ve(L,x=>{r(f)&&x(O)})}var M=m(L,2);{var T=x=>{kn(x,{prefix:i,get show(){return t()},interactive:!1,get modalFilterGj(){return r(v)},get turnRestrictionGj(){return r(y)}})};ve(M,x=>{r(v)&&r(y)&&x(T)})}p(n,b),Be(),s()}var Th=P("<span></span>"),Ih=P("<b> </b>"),Rh=P("<b> </b>"),Nh=P("<b> </b>"),Bh=P("<li><!></li>"),Fh=P('<ul style="padding-right: 0; padding-left: 20px; margin: 0;"><li><!></li> <li><!></li> <!></ul>'),Oh=P("<span></span> <!>",1),jh=P("<!> <!> <!> <!> <!>",1);function zh(n,e){Ne(e,!0);const t=()=>be(ri,"$routeTool",o),[o,a]=ut(),s=u(()=>ct(dt("main")));let l=W(e,"waypoints",15);cr(()=>{l([]),t()?.stop(),e.map.getCanvas().style.cursor="inherit"});let i=!0,f=we(ht([]));Ze(()=>{X(f,_(t(),l(),r(L)),!0)});let v=we(null),y=we(!1),b=we(!1),L=we(!1);function O(S){l().push({point:S.lngLat.toArray(),snapped:i}),l(l())}function M(S){X(v,{point:S.lngLat.toArray(),snapped:i},!0)}function T(S){l().splice(S,1),l(l()),X(y,!1)}function x(S,E){try{if(S)return JSON.parse(S.inner.calculateRoute(E))}catch{}return null}function C(S,E,N,G){if(G)return nr();try{if(S&&E.length>0&&N)return JSON.parse(S.inner.calculateRoute([E[E.length-1],N]))}catch{}return nr()}function _(S,E,N){if(N)return r(f);if(!S)return[];let G=[],q=1;for(let H=0;H<E.length-1;H++){let Y=JSON.parse(S.inner.getExtraNodes(E[H],E[H+1]));for(let[ue,oe,Z]of Y)G.push({point:[ue,oe],snapped:Z,insertIdx:q});q++}return G}function D(S){l().splice(S.insertIdx,0,{point:S.point,snapped:S.snapped}),l(l()),X(L,!0)}function z(S){l(l()[S.insertIdx].point=S.point,!0),l(l())}function I(){X(L,!1)}function F(){X(b,!0)}function j(S){S.key==r(s).t(49)&&e.cancel(),S.key==r(s).t(16)&&l().length>1&&g()}function d(S){l().length>1&&S==l().length-1&&g()}function g(){let S=x(t(),l());S?(e.finish(S.properties.full_path.map(E=>E.snapped)),l([])):e.cancel()}let h=u(()=>C(t(),l(),r(v),r(y)||r(b)));Ze(()=>{let S=l().length==0?"crosshair":"inherit";e.map.getCanvas().style.cursor=S});var $=jh();Xn("keydown",ca,j);var w=Q($);va(w,{onclick:O,onmousemove:M});var A=m(w,2);Jt(A,17,()=>r(f),Qt,(S,E,N)=>{fo(S,{draggable:!0,ondragstart:()=>D(r(E)),ondrag:()=>z(r(E)),ondragend:I,zIndex:0,get lngLat(){return r(E).point},set lngLat(G){r(E).point=G},children:(G,q)=>{var H=Th();let Y;J(ue=>Y=St(H,1,"dot svelte-1i3xsfo",null,Y,ue),[()=>({"snapped-node":r(E).snapped,"free-node":!r(E).snapped,hide:r(L)})]),p(G,H)},$$slots:{default:!0}})});var B=m(A,2);Jt(B,17,l,Qt,(S,E,N)=>{fo(S,{draggable:!0,onclick:()=>d(N),oncontextmenu:()=>T(N),onmouseenter:()=>X(y,!0),onmouseleave:()=>X(y,!1),ondragstart:F,ondragend:()=>X(b,!1),zIndex:1,get lngLat(){return r(E).point},set lngLat(G){r(E).point=G},children:(G,q)=>{var H=Oh(),Y=Q(H);let ue;Y.textContent=N+1;var oe=m(Y,2);Bt(oe,{openOn:"hover",popupClass:"waypoint-popup",children:(Z,te)=>{var K=Fh(),V=c(K);{const _e=(le,fe=Pe)=>{var se=Ih(),ye=c(se);J(he=>U(ye,he),[()=>r(s).tx(fe())]),p(le,se)};var ee=c(V);{let le=u(()=>[_e]),fe=u(()=>r(s).cx(182));me(ee,{get t(){return r(le)},get x(){return r(fe)}})}}var re=m(V,2);{const _e=(le,fe=Pe)=>{var se=Rh(),ye=c(se);J(he=>U(ye,he),[()=>r(s).tx(fe())]),p(le,se)};var ae=c(re);{let le=u(()=>[_e]),fe=u(()=>r(s).cx(183));me(ae,{get t(){return r(le)},get x(){return r(fe)}})}}var ne=m(re,2);{var ie=_e=>{var le=Bh();{const se=(ye,he=Pe)=>{var Se=Nh(),xe=c(Se);J(Fe=>U(xe,Fe),[()=>r(s).tx(he())]),p(ye,Se)};var fe=c(le);{let ye=u(()=>[se]),he=u(()=>r(s).cx(184));me(fe,{get t(){return r(ye)},get x(){return r(he)}})}}p(_e,le)};ve(ne,_e=>{l().length>1&&N==l().length-1&&_e(ie)})}p(Z,K)},$$slots:{default:!0}}),J(Z=>ue=St(Y,1,"dot svelte-1i3xsfo",null,ue,Z),[()=>({snapped:r(E).snapped})]),p(G,H)},$$slots:{default:!0}})});var k=m(B,2);{let S=u(()=>x(t(),l())||nr());lt(k,{get data(){return r(S)},generateId:!0,children:(E,N)=>{{let G=u(()=>We("draw-route-lines"));gt(E,Le(()=>r(G),{paint:{"line-color":"purple","line-width":10}}))}},$$slots:{default:!0}})}var R=m(k,2);lt(R,{get data(){return r(h)},children:(S,E)=>{{let N=u(()=>We("draw-route-preview"));gt(S,Le(()=>r(N),{paint:{"line-color":"black","line-width":3}}))}},$$slots:{default:!0}}),p(n,$),Be(),a()}function Dh(n,e,t){e().eraseAllMainRoads(),lr(Vt,t())}var Uh=P("<li><!></li>"),Gh=P('<div style="display: flex; justify-content: space-between;"><nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li> </li></ul></nav> <nav><ul><li><!></li> <li><!></li> <li><!></li> <li><!></li> <li><!></li> <!></ul></nav></div>'),Wh=P('<input type="checkbox" role="switch"/>'),Hh=(n,e)=>X(e,{kind:"filter",freehand:!1},!0),qh=(n,e)=>X(e,{kind:"oneway"},!0),Jh=(n,e,t)=>X(e,t(),!0),Qh=(n,e)=>X(e,{kind:"main-roads",tool:"toggle",waypoints:[]},!0),Zh=(n,e)=>X(e,!0),Vh=P('<h3> </h3> <p> </p> <!> <div style="display: flex; gap: 8px; align-items: leading; flex-direction: column; width: fit-content;"><button class="outline"> </button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button></div>',1),Kh=P("<h3> </h3> <p> </p>",1),Xh=P("<h3> </h3> <p> </p>",1),Yh=P("<i> </i>"),e0=P('<a href="https://openstreetmap.org/about" target="_blank"> </a>'),t0=(n,e)=>{X(e,{kind:"main-roads",tool:"toggle",waypoints:[]},!0)},r0=(n,e)=>{X(e,{kind:"main-roads",tool:"snap-route-main",waypoints:[]},!0)},n0=(n,e)=>{X(e,{kind:"main-roads",tool:"snap-route-erase",waypoints:[]},!0)},o0=P('<h3> </h3> <p><!></p> <p> </p> <div class="classification-buttons svelte-1i6ad5a" style="display: flex; flex-direction: column; gap: 8px; justify-content: left;"><button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button> <button><div style="display: flex; align-items: center; gap: 8px;"><!> <span> </span></div></button></div>',1),a0=P("<mark> </mark>"),i0=P('<input type="checkbox"/>'),s0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),l0=P('<input type="checkbox"/>'),u0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),c0=P('<input type="checkbox"/>'),d0=P('<span class="footnote-ref svelte-1i6ad5a"> </span>'),f0=P('<div style="display: flex; justify-content: space-between; align-items: center"><h2> </h2> <label><!></label></div> <div><div class="tool-palette" style="display: flex; justify-content: space-between; flex-wrap: wrap; gap: 6px;"><div style="height: 50px; display: flex; justify-content: left; gap: 6px;"><button><img/></button> <button><div style="height: 100%; width: 100%; position: relative;"><img style="position: absolute; width: 60%; height: 60%; top: -1px; left: -1px;"/> <img style="position: absolute; width: 60%; height: 60%; bottom: -1px; right: -1px; transform: rotate(180deg);"/></div></button> <button><img/></button> <button><img/></button></div> <div style="height: 50px; display: flex; justify-content: right; gap: 6px;"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button></div></div> <div style="min-height: 200px; padding-bottom: 16px; border-bottom: solid var(--pico-muted-border-color) 1px;"><!></div> <!></div> <h2> </h2> <label><!></label> <label><!></label> <label><!></label> <label style="display: flex; align-items: center; gap: 8px; flex-wrap: wrap;"><span style="text-wrap: nowrap;"> </span> <select style="margin: 0; padding: 8px; width: auto;"><option> </option><option> </option><option> </option><option><!></option></select></label> <!> <h2> </h2> <!>',1),v0=P("<p><!></p>"),g0=P("<p><!></p>"),_0=P('<img width="20"/>'),p0=P("<div><!></div>"),h0=P("<p> </p>"),m0=P("<p> </p>"),b0=P("<p> </p>"),y0=P("<!> <!>",1),A0=P("<!> <!> <!> <!> <!>",1),w0=P('<img width="20"/>'),x0=P("<div><!></div>"),$0=P("<!> <!> <!> <!> <!> <!> <!>",1);function k0(n,e){Ne(e,!0);const t=()=>be(It,"$backend",M),o=()=>be(Vr,"$map",M),a=()=>be(Vt,"$mutationCounter",M),s=()=>be(Xi,"$currentFilterType",M),l=()=>be(Ei,"$showBeforeEdits",M),i=()=>be(_s,"$animateShortcuts",M),f=()=>be(yt,"$mode",M),v=()=>be(ta,"$devMode",M),y=()=>be($i,"$drawBorderEntries",M),b=()=>be(ki,"$thickRoadsForShortcuts",M),L=()=>be(Ba,"$roadStyle",M),O=()=>be(Na,"$useMetricUnits",M),[M,T]=ut(),x=u(()=>ct(dt("main")));function C(){return{kind:"turn_restriction",from_road_id:null,from_road_name:"",possible_targets:nr()}}let _=we(ht({kind:"filter",freehand:!1})),D=we(!1),z=we(ht(t().renderNeighbourhood())),I=u(()=>r(z).features.find(Z=>Z.properties.kind=="boundary")),F=we(ht(nr())),j=we(0);ln(()=>{Ll()}),cr(()=>{o().doubleClickZoom.enable()});function d(Z){X(z,t().renderNeighbourhood(),!0),na()}function g(Z,te){a()==r(j)||!te||(X(F,t().getAllShortcuts(),!0),X(j,a(),!0))}function h(Z,te){r(_).kind=="filter"?(t().addModalFilter(te,s()),lr(Vt,a())):r(_).kind=="oneway"?(t().toggleTravelFlow(Z.properties.road),lr(Vt,a())):r(_).kind=="main-roads"&&r(_).tool=="toggle"?(t().toggleMainRoad(Z.properties.road),lr(Vt,a())):r(_).kind=="turn_restriction"&&(r(_).from_road_id=Z.properties.road,r(_).from_road_name=Z.properties.name||"unnamed road",r(_).possible_targets=t().getTurnRestrictionTargets(Z.properties.road))}function $(Z){r(_).kind=="turn_restriction"&&(o().queryRenderedFeatures(Z.point,{layers:["interior-roads","turn-restriction-targets"]}).length>0||X(_,C(),!0))}function w(Z){if(r(_).kind=="turn_restriction"&&r(_).from_road_id!=null){let te=Z.features[0].properties.road;t().addTurnRestriction(r(_).from_road_id,te),lr(Vt,a())}X(_,C(),!0)}function A(Z){let te=Z.features[0];t().deleteModalFilter(te.properties.road),lr(Vt,a())}function B(Z){let te=Z.features[0];t().deleteTurnRestriction(te.properties.intersection,te.properties.from_road,te.properties.to_road),lr(Vt,a())}function k(Z){if(r(_).kind!="filter"){console.assert(!1,`this shouldn't happen - intersections should only be clickable when in 'filter' mode, not ${r(_).kind}`);return}Z.hasRotatedFilter?(t().deleteDiagonalFilter(Z),lr(Vt,a())):Z.filter?(t().rotateDiagonalFilter(Z),lr(Vt,a())):(t().addDiagonalFilter(Z),lr(Vt,a()))}function R(Z){return!!(Z.kind=="filter"&&Z.freehand||Z.kind=="main-roads"&&Z.tool!="toggle"&&Z.waypoints.length>0||Z.kind=="turn_restriction"&&Z.from_road_id!=null)}function S(Z){l()||Z.target.tagName!=r(x).t(378)&&(R(r(_))||(Z.ctrlKey&&Z.key=="z"&&E(),Z.ctrlKey&&Z.key=="y"&&N(),Z.key=="1"&&X(_,{kind:"filter",freehand:!1},!0),Z.key=="2"&&X(_,{kind:"oneway"},!0),Z.key=="3"&&X(_,C(),!0),Z.key=="4"&&X(_,{kind:"main-roads",tool:"toggle",waypoints:[]},!0)))}function E(){t().undo(),lr(Vt,a())}function N(){t().redo(),lr(Vt,a())}function G(Z){Z&&(t().addManyModalFilters(Z,s()),lr(Vt,a())),X(_,{kind:"filter",freehand:!1},!0)}function q(Z){let te=r(_).kind=="main-roads"&&r(_).tool=="snap-route-main";t().setMainRoads(Z,te),lr(Vt,a())}let H="Shortcuts are routes from one main road to another, which cut through the neighborhood's interior.",Y="Cells are the colored area reachable without travelling along a main road.",ue={left:Pl,right:Pi,straight:Tl,u_left_to_right:Rl,u_right_to_left:Il};Ze(()=>{r(_).kind=="oneway"||r(_).kind=="main-roads"?o().doubleClickZoom.disable():o().doubleClickZoom.enable()}),Ze(()=>{r(_).kind=="filter"&&r(_).freehand?o().getCanvas().style.cursor=`url(${th}) 8 22, cell`:r(_).kind=="main-roads"&&r(_).tool=="snap-route-erase"?o().getCanvas().style.cursor=`url(${eh}) 8 22, cell`:o().getCanvas().style.cursor=""}),Ze(()=>{d(a())}),Ze(()=>{g(a(),i())});let oe=u(()=>r(z).features.filter(Z=>Z.properties.kind=="cell"&&Z.properties.cell_color=="disconnected").length);Xn("keydown",ca,S),kr(n,{top:V=>{var ee=Gh(),re=c(ee),ae=c(re),ne=c(ae),ie=c(ne);et(ie,{mode:{mode:"title"}});var _e=m(ne,2),le=c(_e);et(le,{mode:{mode:"pick-neighbourhood"}});var fe=m(_e,2),se=c(fe),ye=m(re,2),he=c(ye),Se=c(he),xe=c(Se);et(xe,{mode:{mode:"view-shortcuts"}});var Fe=m(Se,2),ke=c(Fe);et(ke,{mode:{mode:"route",prevMode:"neighbourhood"}});var Ce=m(Fe,2),pe=c(Ce);et(pe,{mode:{mode:"predict-impact",prevMode:"neighbourhood"}});var Me=m(Ce,2),Te=c(Me);et(Te,{mode:{mode:"impact-one-destination"}});var Ae=m(Me,2),Ee=c(Ae);{let Ue=u(()=>({mode:"set-boundary",name:r(I).properties.name,existing:r(I)}));et(Ee,{get mode(){return r(Ue)}})}var Ie=m(Ae,2);{var Re=Ue=>{var Ge=Uh(),Je=c(Ge);et(Je,{mode:{mode:"debug-neighbourhood"},children:(Oe,Qe)=>{var qe=Dt();J(Xe=>U(qe,Xe),[()=>r(x).t(379)]),p(Oe,qe)},$$slots:{default:!0}}),p(Ue,Ge)};ve(Ie,Ue=>{v()&&Ue(Re)})}J(Ue=>U(se,Ue),[()=>mr(f().mode)]),p(V,ee)},left:V=>{var ee=f0(),re=Q(ee),ae=c(re),ne=c(ae),ie=m(ae,2);{const nt=He=>{var Ye=Wh();J(Ke=>Ye.disabled=Ke,[()=>R(r(_))]),pn(Ye,l,Ke=>Ve(Ei,Ke)),p(He,Ye)};var _e=c(ie);{let He=u(()=>[nt]),Ye=u(()=>r(x).cx(381));me(_e,{get t(){return r(He)},get x(){return r(Ye)}})}}var le=m(re,2);let fe;var se=c(le),ye=c(se),he=c(ye);he.__click=[Hh,_];let Se;var xe=c(he),Fe=m(he,2);Fe.__click=[qh,_];let ke;var Ce=c(Fe),pe=c(Ce),Me=m(pe,2),Te=m(Fe,2);Te.__click=[Jh,_,C];let Ae;var Ee=c(Te),Ie=m(Te,2);Ie.__click=[Qh,_];let Re;var Ue=c(Ie),Ge=m(ye,2),Je=c(Ge);Je.__click=E;var Oe=c(Je);Zc(Oe,{});var Qe=m(Je,2);Qe.__click=N;var qe=c(Qe);Jc(qe,{});var Xe=m(se,2),st=c(Xe);{var ft=nt=>{var He=Vh(),Ye=Q(He),Ke=c(Ye),$t=m(Ye,2),Pt=c($t),Ht=m($t,2);kh(Ht,{get show(){return r(D)},set show(Nr){X(D,Nr,!0)}});var Ar=m(Ht,2),Hr=c(Ar);Hr.__click=[Zh,D];var Rr=c(Hr),Xt=m(Hr,2);Xt.__click=function(...Nr){(r(_).freehand?()=>X(_,{kind:"filter",freehand:!1},!0):()=>X(_,{kind:"filter",freehand:!0},!0))?.apply(this,Nr)};let Lt;var en=c(Xt),Sn=c(en);qc(Sn,{});var fn=m(Sn,2),En=c(fn);J((Nr,On,eo,bo,to,yo)=>{U(Ke,Nr),U(Pt,On),U(Rr,eo),De(Xt,"data-tippy-content",bo),Lt=St(Xt,1,"",null,Lt,to),U(En,yo)},[()=>r(x).t(394),()=>r(x).t(395),()=>r(x).t(396),()=>r(x).t(397),()=>({active:r(_).freehand,outline:!r(_).freehand}),()=>r(x).t(398)]),p(nt,He)},wt=nt=>{var He=$e(),Ye=Q(He);{var Ke=Pt=>{var Ht=Kh(),Ar=Q(Ht),Hr=c(Ar),Rr=m(Ar,2),Xt=c(Rr);J((Lt,en)=>{U(Hr,Lt),U(Xt,en)},[()=>r(x).t(399),()=>r(x).t(400)]),p(Pt,Ht)},$t=Pt=>{var Ht=$e(),Ar=Q(Ht);{var Hr=Xt=>{var Lt=Xh(),en=Q(Lt),Sn=c(en),fn=m(en,2),En=c(fn);J((Nr,On)=>{U(Sn,Nr),U(En,On)},[()=>r(x).t(387),()=>r(x).t(401)]),p(Xt,Lt)},Rr=Xt=>{var Lt=$e(),en=Q(Lt);{var Sn=fn=>{var En=o0(),Nr=Q(En),On=c(Nr),eo=m(Nr,2);{const si=(zn,Dn=Pe)=>{var Un=Yh(),xo=c(Un);J($o=>U(xo,$o),[()=>r(x).tx(Dn())]),p(zn,Un)},li=(zn,Dn=Pe)=>{var Un=e0(),xo=c(Un);J($o=>U(xo,$o),[()=>r(x).tx(Dn())]),p(zn,Un)};var bo=c(eo);{let zn=u(()=>[si,li]),Dn=u(()=>r(x).cx(403));me(bo,{get t(){return r(zn)},get x(){return r(Dn)}})}}var to=m(eo,2),yo=c(to),ai=m(to,2),jn=c(ai);jn.__click=[t0,_];let is;var Eu=c(jn),ss=c(Eu);Ol(ss,{});var Lu=m(ss,2),Cu=c(Lu),Ao=m(jn,2);Ao.__click=[r0,_];let ls;var Mu=c(Ao),us=c(Mu);Qc(us,{});var Pu=m(us,2),Tu=c(Pu),wo=m(Ao,2);wo.__click=[n0,_];let cs;var Iu=c(wo),ds=c(Iu);Dc(ds,{});var Ru=m(ds,2),Nu=c(Ru),ii=m(wo,2);ii.__click=[Dh,t,a],St(ii,1,"",null,{},{outline:!0});var Bu=c(ii),fs=c(Bu);ti(fs,{});var Fu=m(fs,2),Ou=c(Fu);J((si,li,zn,Dn,Un,xo,$o,ju,zu,Du,Uu,Gu)=>{U(On,si),U(yo,li),De(jn,"data-tippy-content",zn),is=St(jn,1,"",null,is,Dn),U(Cu,Un),De(Ao,"data-tippy-content",xo),ls=St(Ao,1,"",null,ls,$o),U(Tu,ju),De(wo,"data-tippy-content",zu),cs=St(wo,1,"",null,cs,Du),U(Nu,Uu),U(Ou,Gu)},[()=>r(x).t(402),()=>r(x).t(404),()=>r(x).t(405),()=>({active:r(_).tool=="toggle",outline:r(_).tool!="toggle"}),()=>r(x).t(406),()=>r(x).t(407),()=>({active:r(_).tool=="snap-route-main",outline:r(_).tool!="snap-route-main"}),()=>r(x).t(408),()=>r(x).t(407),()=>({active:r(_).tool=="snap-route-erase",outline:r(_).tool!="snap-route-erase"}),()=>r(x).t(409),()=>r(x).t(410)]),p(fn,En)};ve(en,fn=>{r(_).kind=="main-roads"&&fn(Sn)},!0)}p(Xt,Lt)};ve(Ar,Xt=>{r(_).kind=="turn_restriction"?Xt(Hr):Xt(Rr,!1)},!0)}p(Pt,Ht)};ve(Ye,Pt=>{r(_).kind=="oneway"?Pt(Ke):Pt($t,!1)},!0)}p(nt,He)};ve(st,nt=>{r(_).kind=="filter"?nt(ft):nt(wt,!1)})}var At=m(Xe,2);{var mt=nt=>{var He=a0(),Ye=c(He);J(Ke=>U(Ye,Ke),[()=>r(x).t(411)]),p(nt,He)};ve(At,nt=>{r(oe)>0&&nt(mt)})}var Mt=m(le,2),tt=c(Mt),it=m(Mt,2);{const nt=Ye=>{var Ke=i0();pn(Ke,i,$t=>Ve(_s,$t)),p(Ye,Ke)},He=(Ye,Ke=Pe)=>{var $t=s0();De($t,"data-tippy-content",H);var Pt=c($t);J(Ht=>U(Pt,Ht),[()=>r(x).tx(Ke())]),p(Ye,$t)};var Nt=c(it);{let Ye=u(()=>[nt,He]),Ke=u(()=>r(x).cx(413));me(Nt,{get t(){return r(Ye)},get x(){return r(Ke)}})}}var Ot=m(it,2);{const nt=Ye=>{var Ke=l0();pn(Ke,y,$t=>Ve($i,$t)),p(Ye,Ke)},He=(Ye,Ke=Pe)=>{var $t=u0();De($t,"data-tippy-content",Y);var Pt=c($t);J(Ht=>U(Pt,Ht),[()=>r(x).tx(Ke())]),p(Ye,$t)};var Et=c(Ot);{let Ye=u(()=>[nt,He]),Ke=u(()=>r(x).cx(414));me(Et,{get t(){return r(Ye)},get x(){return r(Ke)}})}}var xt=m(Ot,2);{const nt=Ye=>{var Ke=c0();pn(Ke,b,$t=>Ve(ki,$t)),p(Ye,Ke)},He=(Ye,Ke=Pe)=>{var $t=d0();De($t,"data-tippy-content",H);var Pt=c($t);J(Ht=>U(Pt,Ht),[()=>r(x).tx(Ke())]),p(Ye,$t)};var jt=c(xt);{let Ye=u(()=>[nt,He]),Ke=u(()=>r(x).cx(415));me(jt,{get t(){return r(Ye)},get x(){return r(Ke)}})}}var or=m(xt,2),br=c(or),cn=c(br),Sr=m(br,2),ar=c(Sr),Xr=c(ar);ar.value=ar.__value="shortcuts";var Tr=m(ar),dn=c(Tr);Tr.value=Tr.__value="cells";var Wr=m(Tr),Ir=c(Wr);Wr.value=Wr.__value="edits";var Yr=m(Wr),ce=c(Yr);{let nt=u(()=>r(x).cx(468)),He=u(()=>[O()?"km/h":"mph"]);me(ce,{get x(){return r(nt)},get a(){return r(He)}})}Yr.value=Yr.__value="speeds";var _t=m(or,2);{var Kt=nt=>{{let He=u(()=>({buckets:O()?$l:kl}));hr(nt,{get colorScale(){return Si},get labels(){return r(He)}})}};ve(_t,nt=>{L()=="speeds"&&nt(Kt)})}var Gt=m(_t,2),sr=c(Gt),yr=m(Gt,2);_u(yr,{get neighbourhoodBoundary(){return r(I)}}),J((nt,He,Ye,Ke,$t,Pt,Ht,Ar,Hr,Rr,Xt,Lt,en,Sn,fn,En,Nr,On,eo,bo,to,yo,ai,jn)=>{U(ne,nt),fe=St(le,1,"svelte-1i6ad5a",null,fe,He),Se=St(he,1,"icon-btn",null,Se,Ye),De(he,"data-tippy-content",Ke),De(xe,"src",$t),De(xe,"alt",Pt),ke=St(Fe,1,"icon-btn",null,ke,Ht),De(Fe,"data-tippy-content",Ar),De(pe,"src",il),De(pe,"alt",Hr),De(Me,"src",il),De(Me,"alt",Rr),Ae=St(Te,1,"icon-btn",null,Ae,Xt),De(Te,"data-tippy-content",Lt),De(Ee,"src",Pi),De(Ee,"alt",en),Re=St(Ie,1,"icon-btn",null,Re,Sn),De(Ie,"data-tippy-content",fn),De(Ue,"src",rh),De(Ue,"alt",En),Je.disabled=r(z).undo_length==0,De(Je,"data-tippy-content",Nr),Qe.disabled=r(z).redo_length==0,De(Qe,"data-tippy-content",On),U(tt,eo),U(cn,bo),U(Xr,to),U(dn,yo),U(Ir,ai),U(sr,jn)},[()=>r(x).t(380),()=>({"edits-disabled":l()}),()=>({active:r(_).kind=="filter"}),()=>r(x).t(382),()=>zt.getFilter(s()).iconURL,()=>r(x).t(383),()=>({active:r(_).kind=="oneway"}),()=>r(x).t(384),()=>r(x).t(385),()=>r(x).t(385),()=>({active:r(_).kind=="turn_restriction"}),()=>r(x).t(386),()=>r(x).t(387),()=>({active:r(_).kind=="main-roads"}),()=>r(x).t(388),()=>r(x).t(389),()=>r(z).undo_length==0?r(x).t(390):r(x).t(391,[r(z).undo_length]),()=>r(z).redo_length==0?r(x).t(392):r(x).t(393,[r(z).redo_length]),()=>r(x).t(412),()=>r(x).t(416),()=>r(x).t(417),()=>r(x).t(418),()=>r(x).t(419),()=>r(x).t(421)]),hn(Sr,L,nt=>Ve(Ba,nt)),p(V,ee)},main:V=>{var ee=$0(),re=Q(ee);va(re,{onclick:$});var ae=m(re,2);Ph(ae,{});var ne=m(ae,2);lt(ne,{get data(){return r(z)},generateId:!0,children:(xe,Fe)=>{var ke=A0(),Ce=Q(ke);ni(Ce,{});var pe=m(Ce,2);{let Ee=u(()=>!l());_a(pe,{get show(){return r(Ee)}})}var Me=m(pe,2);{let Ee=u(()=>!l());ha(Me,{get show(){return r(Ee)}})}var Te=m(Me,2);{const Ee=Ue=>{Bt(Ue,{openOn:"hover",children:(Je,Oe)=>{let Qe=()=>Oe?.().data;const qe=u(()=>Qe().properties);var Xe=y0(),st=Q(Xe);{var ft=tt=>{var it=v0(),Nt=c(it);{let Ot=u(()=>r(x).cx(469)),Et=u(()=>[r(qe).shortcuts,r(qe).name??"unnamed road",Fa(r(qe).speed_mph)]);me(Nt,{get x(){return r(Ot)},get a(){return r(Et)}})}p(tt,it)},wt=tt=>{var it=$e(),Nt=Q(it);{var Ot=Et=>{var xt=g0(),jt=c(xt);{let or=u(()=>r(x).cx(470)),br=u(()=>[r(qe).name??"unnamed road",Fa(r(qe).speed_mph)]);me(jt,{get x(){return r(or)},get a(){return r(br)}})}p(Et,xt)};ve(Nt,Et=>{r(qe).kind=="main_road"&&Et(Ot)},!0)}p(tt,it)};ve(st,tt=>{r(qe).kind=="interior_road"?tt(ft):tt(wt,!1)})}var At=m(st,2);{var mt=tt=>{var it=p0();{const Ot=Et=>{var xt=_0();J((jt,or)=>{De(xt,"src",jt),De(xt,"alt",or)},[()=>zt.getFilter(s()).iconURL,()=>r(x).t(394)]),p(Et,xt)};var Nt=c(it);{let Et=u(()=>[Ot]),xt=u(()=>r(x).cx(422));me(Nt,{get t(){return r(Et)},get x(){return r(xt)}})}}p(tt,it)},Mt=tt=>{var it=$e(),Nt=Q(it);{var Ot=xt=>{var jt=h0(),or=c(jt);J(br=>U(or,br),[()=>r(x).t(423)]),p(xt,jt)},Et=xt=>{var jt=$e(),or=Q(jt);{var br=Sr=>{var ar=m0(),Xr=c(ar);J(Tr=>U(Xr,Tr),[()=>r(x).t(424)]),p(Sr,ar)},cn=Sr=>{var ar=$e(),Xr=Q(ar);{var Tr=dn=>{var Wr=b0(),Ir=c(Wr);J(Yr=>U(Ir,Yr),[()=>r(x).t(425)]),p(dn,Wr)};ve(Xr,dn=>{r(_).kind=="turn_restriction"&&dn(Tr)},!0)}p(Sr,ar)};ve(or,Sr=>{r(_).kind=="main-roads"&&r(_).tool=="toggle"?Sr(br):Sr(cn,!1)},!0)}p(xt,jt)};ve(Nt,xt=>{r(_).kind=="oneway"?xt(Ot):xt(Et,!1)},!0)}p(tt,it)};ve(At,tt=>{r(_).kind=="filter"?tt(mt):tt(Mt,!1)})}p(Je,Xe)},$$slots:{default:!0}})};let Ie=u(()=>!l()),Re=u(()=>r(_).kind=="filter"&&!r(_).freehand||r(_).kind=="oneway"||r(_).kind=="main-roads"&&r(_).tool=="toggle"||r(_).kind=="turn_restriction"&&r(_).from_road_id==null);pa(Te,{get show(){return r(Ie)},get interactive(){return r(Re)},onClickLine:h,get maxShortcuts(){return r(z).maxShortcuts},linePopup:Ee,$$slots:{linePopup:!0}})}var Ae=m(Te,2);{let Ee=u(()=>!l()),Ie=u(()=>r(_).kind=="filter");yh(Ae,{get show(){return r(Ee)},get interactive(){return r(Ie)},get neighbourhood(){return r(z)},onClickIntersection:k})}p(xe,ke)},$$slots:{default:!0}});var ie=m(ne,2);{var _e=xe=>{ch(xe,{get paths(){return r(F)}})};ve(ie,xe=>{i()&&a()==r(j)&&xe(_e)})}var le=m(ie,2);{const xe=pe=>{Bt(pe,{openOn:"hover",children:(Me,Te)=>{var Ae=Dt();J(Ee=>U(Ae,Ee),[()=>r(x).t(426)]),p(Me,Ae)},$$slots:{default:!0}})},Fe=pe=>{Bt(pe,{openOn:"hover",children:(Me,Te)=>{var Ae=Dt();J(Ee=>U(Ae,Ee),[()=>r(x).t(427)]),p(Me,Ae)},$$slots:{default:!0}})};let ke=u(()=>!l()),Ce=u(()=>r(_).kind=="filter");kn(le,{get show(){return r(ke)},onClickModalFilter:A,onClickTurnRestriction:B,get interactive(){return r(Ce)},modalFilterPopup:xe,turnRestrictionPopup:Fe,$$slots:{modalFilterPopup:!0,turnRestrictionPopup:!0}})}var fe=m(le,2);{var se=xe=>{Sh(xe,{get map(){return o()},onDone:G})},ye=xe=>{var Fe=$e(),ke=Q(Fe);{var Ce=pe=>{zh(pe,{get map(){return o()},finish:q,cancel:()=>X(_,{kind:"main-roads",tool:"toggle",waypoints:[]},!0),get waypoints(){return r(_).waypoints},set waypoints(Me){r(_).waypoints=Me}})};ve(ke,pe=>{r(_).kind=="main-roads"&&r(_).tool!="toggle"&&pe(Ce)},!0)}p(xe,Fe)};ve(fe,xe=>{r(_).kind=="filter"&&r(_).freehand?xe(se):xe(ye,!1)})}var he=m(fe,2);{var Se=xe=>{{let Fe=u(()=>r(_).possible_targets||nr());lt(xe,{get data(){return r(Fe)},generateId:!0,children:(ke,Ce)=>{{let pe=u(()=>We("turn-restriction-targets")),Me=u(()=>({"line-color":"yellow","line-opacity":bt(.5,1),"line-width":lo(1)}));gt(ke,Le(()=>r(pe),{manageHoverState:!0,get paint(){return r(Me)},onclick:w,children:(Te,Ae)=>{Bt(Te,{openOn:"hover",children:(Ie,Re)=>{let Ue=()=>Re?.().data;const Ge=u(()=>Ue().properties);var Je=x0();{const Qe=qe=>{var Xe=w0();J(st=>{De(Xe,"src",ue[r(Ge).kind]),De(Xe,"alt",st)},[()=>r(x).t(428)]),p(qe,Xe)};var Oe=c(Je);{let qe=u(()=>[Qe]),Xe=u(()=>r(x).cx(429)),st=u(()=>[r(_).kind=="turn_restriction"?r(_).from_road_name:"???",r(Ge).name||"unnamed road"]);me(Oe,{get t(){return r(qe)},get x(){return r(Xe)},get a(){return r(st)}})}}p(Ie,Je)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}})}};ve(he,xe=>{r(_).kind=="turn_restriction"&&xe(Se)})}p(V,ee)},$$slots:{top:!0,left:!0,main:!0}}),Be(),T()}tr(["click"]);var S0=P("<li><!></li>"),E0=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li><!></li> <li> </li></ul></nav>'),L0=P("<span> </span>"),C0=P("<span> </span>"),M0=P("<p><!></p> <i> </i>",1),P0=P("<i> </i>"),T0=P("<p><!></p>"),I0=P("<i> </i>"),R0=P("<p><!></p>"),N0=P("<!> <!> <!> <!>",1),B0=P("<!> <p><!></p> <!>",1),F0=P("<!> <!> <!>",1),O0=P("<!> <!>",1),j0=P("<!> <!>",1);function z0(n,e){Ne(e,!0);const t=()=>be(It,"$backend",s),o=()=>be(Yi,"$fastSample",s),a=()=>be(yt,"$mode",s),[s,l]=ut(),i=u(()=>ct(dt("main")));let f=ht(e.road.properties);f.kind="focus";let v=we(ht([])),y=we(0),b=we("Finding changes to this road");ln(async()=>{await Xa(),X(v,t().getImpactsOnRoad(f.id,o()),!0),X(b,""),r(v).length==0&&(window.alert("No routes over this road change. (This is a bug in progress of being fixed.)"),Ve(yt,{mode:"predict-impact",prevMode:e.prevPrevMode}))});function L(_){return{type:"FeatureCollection",features:[r(v)[_].before,r(v)[_].after,e.road].filter(D=>D!=null)}}function O(_){return r(v)[_].before!=null?Do(r(v)[_].before.geometry.coordinates[0]):Do(r(v)[_].after.geometry.coordinates[0])}function M(_){let D=r(v)[_].before!=null?r(v)[_].before.geometry.coordinates:r(v)[_].after.geometry.coordinates;return Do(D[D.length-1])}var T=j0(),x=Q(T);go(x,{get loading(){return r(b)}});var C=m(x,2);kr(C,{top:I=>{var F=E0(),j=c(F),d=c(j),g=c(d);et(g,{mode:{mode:"title"}});var h=m(d,2),$=c(h);et($,{mode:{mode:"pick-neighbourhood"}});var w=m(h,2);{var A=E=>{var N=S0(),G=c(N);et(G,{mode:{mode:"neighbourhood"}}),p(E,N)};ve(w,E=>{e.prevPrevMode=="neighbourhood"&&E(A)})}var B=m(w,2),k=c(B);{let E=u(()=>({mode:"predict-impact",prevMode:e.prevPrevMode}));et(k,{get mode(){return r(E)}})}var R=m(B,2),S=c(R);J(E=>U(S,E),[()=>mr(a().mode)]),p(I,F)},left:I=>{var F=B0(),j=Q(F);{let w=u(()=>({mode:"predict-impact",prevMode:e.prevPrevMode}));un(j,{get mode(){return r(w)}})}var d=m(j,2);{const w=(B,k=Pe)=>{var R=L0();fr(R,"",{},{color:"red"});var S=c(R);J(E=>U(S,E),[()=>r(i).tx(k())]),p(B,R)},A=(B,k=Pe)=>{var R=C0();fr(R,"",{},{color:"blue"});var S=c(R);J(E=>U(S,E),[()=>r(i).tx(k())]),p(B,R)};var g=c(d);{let B=u(()=>[w,A]),k=u(()=>r(i).cx(66)),R=u(()=>[f.before.toLocaleString(),f.after.toLocaleString(),Math.round(100*f.after/f.before)]);me(g,{get t(){return r(B)},get x(){return r(k)},get a(){return r(R)}})}}var h=m(d,2);{var $=w=>{var A=N0(),B=Q(A);Ya(B,{get list(){return r(v)},get idx(){return r(y)},set idx(q){X(y,q,!0)}});var k=m(B,2);{var R=q=>{var H=M0(),Y=Q(H),ue=c(Y);{let te=u(()=>r(i).cx(67)),K=u(()=>[r(v)[r(y)].count.toLocaleString()]);me(ue,{get x(){return r(te)},get a(){return r(K)}})}var oe=m(Y,2),Z=c(oe);J(te=>U(Z,te),[()=>r(i).t(68)]),p(q,H)};ve(k,q=>{r(v)[r(y)].count>1&&q(R)})}var S=m(k,2);{var E=q=>{var H=T0();fr(H,"",{},{color:"red"});{const ue=(oe,Z=Pe)=>{var te=P0(),K=c(te);J(V=>U(K,V),[()=>r(i).tx(Z())]),p(oe,te)};var Y=c(H);{let oe=u(()=>[ue]),Z=u(()=>r(i).cx(69));me(Y,{get t(){return r(oe)},get x(){return r(Z)}})}}p(q,H)};ve(S,q=>{r(v)[r(y)].before==null&&q(E)})}var N=m(S,2);{var G=q=>{var H=R0();fr(H,"",{},{color:"blue"});{const ue=(oe,Z=Pe)=>{var te=I0(),K=c(te);J(V=>U(K,V),[()=>r(i).tx(Z())]),p(oe,te)};var Y=c(H);{let oe=u(()=>[ue]),Z=u(()=>r(i).cx(70));me(Y,{get t(){return r(oe)},get x(){return r(Z)}})}}p(q,H)};ve(N,q=>{r(v)[r(y)].after==null&&q(G)})}p(w,A)};ve(h,w=>{r(v).length>0&&w($)})}p(I,F)},main:I=>{var F=O0(),j=Q(F);{var d=h=>{var $=F0(),w=Q($);{let k=u(()=>L(r(y)));lt(w,{get data(){return r(k)},children:(R,S)=>{{let E=u(()=>We("predict-impact")),N=u(()=>({"line-width":yn(["get","kind"],{focus:8},5),"line-color":yn(["get","kind"],{focus:"black",before:"red",after:"blue"},"cyan"),"line-opacity":yn(["get","kind"],{focus:1},.5)}));gt(R,Le(()=>r(E),{get paint(){return r(N)}}))}},$$slots:{default:!0}})}var A=m(w,2);{let k=u(()=>O(r(y)));Yn(A,{get lngLat(){return r(k)},children:(R,S)=>{var E=Dt();J(N=>U(E,N),[()=>r(i).t(71)]),p(R,E)},$$slots:{default:!0}})}var B=m(A,2);{let k=u(()=>M(r(y)));Yn(B,{get lngLat(){return r(k)},children:(R,S)=>{var E=Dt();J(N=>U(E,N),[()=>r(i).t(72)]),p(R,E)},$$slots:{default:!0}})}p(h,$)};ve(j,h=>{r(v).length>0&&h(d)})}var g=m(j,2);kn(g,{interactive:!1}),p(I,F)},$$slots:{top:!0,left:!0,main:!0}}),p(n,T),Be(),l()}var D0=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),U0=P("<p> </p>"),G0=P("<i> </i>"),W0=P("<p><!></p>"),H0=P("<p> </p>"),q0=P("<p> </p>"),J0=P("<i> </i>"),Q0=P("<p><!></p>"),Z0=P("<p> </p>"),V0=P("<!> <p> </p> <u> </u> <!> <u> </u> <!>",1),K0=P("<p><!></p>"),X0=P("<!> <!> <!> <!> <!>",1),Y0=P("<!> <!>",1);function e1(n,e){Ne(e,!0);const t=()=>be(It,"$backend",s),o=()=>be(ba,"$oneDestination",s),a=()=>be(yt,"$mode",s),[s,l]=ut(),i=u(()=>ct(dt("main")));let f=t().renderNeighbourhood(),v=we(void 0);ln(()=>{setTimeout(()=>{o()&&Li(ba)},10)});function y(z){return z?t().compareRoute(new Ai.LngLat(z.properties.pt1_x,z.properties.pt1_y),o(),1):nr()}function b(z){Ve(Ea,new Ai.LngLat(z.properties.pt1_x,z.properties.pt1_y)),Ve(La,o()),Ve(yt,{mode:"route",prevMode:"impact-one-destination"})}function L(z){Ve(ba,z.lngLat)}let O=u(()=>t().impactToOneDestination(o())),M=u(()=>y(r(v))),T=u(()=>r(M).features.find(z=>z.properties.kind=="before")),x=u(()=>r(M).features.find(z=>z.properties.kind=="after"));var C=Y0(),_=Q(C);va(_,{oncontextmenu:L});var D=m(_,2);kr(D,{top:j=>{var d=D0(),g=c(d),h=c(g),$=c(h);et($,{mode:{mode:"title"}});var w=m(h,2),A=c(w);et(A,{mode:{mode:"pick-neighbourhood"}});var B=m(w,2),k=c(B);et(k,{mode:{mode:"neighbourhood"}});var R=m(B,2),S=c(R);J(E=>U(S,E),[()=>mr(a().mode)]),p(j,d)},left:j=>{var d=V0(),g=Q(d);un(g,{mode:{mode:"neighbourhood"}});var h=m(g,2),$=c(h),w=m(h,2);fr(w,"",{},{color:"red"});var A=c(w),B=m(w,2);{var k=H=>{var Y=U0(),ue=c(Y);J((oe,Z)=>U(ue,`${oe??""}, ${Z??""}`),[()=>Oa(r(T).properties.distance),()=>ja(r(T).properties.time)]),p(H,Y)},R=H=>{var Y=$e(),ue=Q(Y);{var oe=te=>{var K=W0();{const ee=(re,ae=Pe)=>{var ne=G0(),ie=c(ne);J(_e=>U(ie,_e),[()=>r(i).tx(ae())]),p(re,ne)};var V=c(K);{let re=u(()=>[ee]),ae=u(()=>r(i).cx(75));me(V,{get t(){return r(re)},get x(){return r(ae)}})}}p(te,K)},Z=te=>{var K=H0(),V=c(K);J(ee=>U(V,ee),[()=>r(i).t(76)]),p(te,K)};ve(ue,te=>{r(x)?te(oe):te(Z,!1)},!0)}p(H,Y)};ve(B,H=>{r(T)?H(k):H(R,!1)})}var S=m(B,2);fr(S,"",{},{color:"blue"});var E=c(S),N=m(S,2);{var G=H=>{var Y=q0(),ue=c(Y);J((oe,Z)=>U(ue,`${oe??""}, ${Z??""}`),[()=>Oa(r(x).properties.distance),()=>ja(r(x).properties.time)]),p(H,Y)},q=H=>{var Y=$e(),ue=Q(Y);{var oe=te=>{var K=Q0();{const ee=(re,ae=Pe)=>{var ne=J0(),ie=c(ne);J(_e=>U(ie,_e),[()=>r(i).tx(ae())]),p(re,ne)};var V=c(K);{let re=u(()=>[ee]),ae=u(()=>r(i).cx(75));me(V,{get t(){return r(re)},get x(){return r(ae)}})}}p(te,K)},Z=te=>{var K=Z0(),V=c(K);J(ee=>U(V,ee),[()=>r(i).t(76)]),p(te,K)};ve(ue,te=>{r(T)?te(oe):te(Z,!1)},!0)}p(H,Y)};ve(N,H=>{r(x)?H(G):H(q,!1)})}J((H,Y,ue)=>{U($,H),U(A,Y),U(E,ue)},[()=>r(i).t(73),()=>r(i).t(74),()=>r(i).t(77)]),p(j,d)},main:j=>{var d=X0(),g=Q(d);lt(g,{get data(){return f},generateId:!0,children:(B,k)=>{{let R=u(()=>We("cells")),S=u(()=>({"fill-color":Ka(),"fill-opacity":.6}));ur(B,Le(()=>r(R),{filter:["==",["get","kind"],"cell"],get paint(){return r(S)}}))}},$$slots:{default:!0}});var h=m(g,2);lt(h,{get data(){return r(O)},generateId:!0,children:(B,k)=>{{let R=u(()=>We("interior-roads")),S=u(()=>({"line-color":["interpolate-hcl",["linear"],["/",["get","time_after"],["get","time_before"]],1,"white",Math.max(r(O).highest_time_ratio,1.1),"red"],"line-width":5}));gt(B,Le(()=>r(R),{get paint(){return r(S)},manageHoverState:!0,onclick:E=>b(E.features[0]),get hovered(){return r(v)},set hovered(E){X(v,E,!0)},children:(E,N)=>{Bt(E,{openOn:"hover",children:(q,H)=>{let Y=()=>H?.().data;const ue=u(()=>Y().properties);var oe=K0(),Z=c(oe);{let te=u(()=>r(i).cx(78)),K=u(()=>[(r(ue).time_after/r(ue).time_before).toFixed(1)]);me(Z,{get x(){return r(te)},get a(){return r(K)}})}p(q,oe)},$$slots:{default:!0}})},$$slots:{default:!0}}))}},$$slots:{default:!0}});var $=m(h,2);lt($,{get data(){return r(M)},children:(B,k)=>{{let R=u(()=>We("compare-route")),S=u(()=>({"line-width":10,"line-color":yn(["get","kind"],{before:"red",after:"blue"},"red")}));gt(B,Le(()=>r(R),{interactive:!1,get paint(){return r(S)}}))}},$$slots:{default:!0}});var w=m($,2);kn(w,{interactive:!1});var A=m(w,2);Yn(A,{draggable:!0,get lngLat(){return ra(),o()},set lngLat(B){Ve(ba,B)},children:(B,k)=>{var R=Dt();J(S=>U(R,S),[()=>r(i).t(79)]),p(B,R)},$$slots:{default:!0}}),p(j,d)},$$slots:{top:!0,left:!0,main:!0}}),p(n,C),Be(),l()}function t1(n,e){Ki("debug_route_snapper.geojson",e().toRouteSnapperGj())}var r1=(n,e)=>Cl(e()),n1=(n,e)=>e(),o1=P("<li><!></li>"),a1=P('<details class="dropdown" style="display: inline-block; margin-top: 8px"><summary role="button" class="contrast outline"><!> <span style="margin-left: 2px;"> </span></summary> <ul></ul></details>'),i1=P('<a href="mailto:dabreegster@gmail.com"> </a>'),s1=P("<p><!></p>"),l1=P('<div style="display: flex"><i><!></i> <!></div>'),u1=P('<button class="secondary"> </button>'),c1=P('<h2><!></h2> <div style="display: flex; gap: 8px"><button class="outline" style="margin-right: 8px;"><div style="display: flex; align-items: center; gap: 8px; color: black;"><!> <span style="margin-right: 2px;"> </span></div></button> <button class="outline" style="margin-right: 8px;"><div style="display: flex; align-items: center; gap: 8px; color: black;"><!> <span style="margin-right: 2px;"> </span></div></button></div> <!> <p><!></p> <p><!></p> <p><!></p> <!> <!>',1);function d1(n,e){Ne(e,!0);const t=()=>be(It,"$backend",f),o=()=>be(mo,"$projectStorage",f),a=()=>be(Al,"$currentProject",f),s=()=>be(bn,"$currentProjectID",f),l=()=>be(Vt,"$mutationCounter",f),i=()=>be(ta,"$devMode",f),[f,v]=ut(),y=u(()=>ct(dt("main")));let b=we(!1),L=t().getOsmTimestamp();function O(V){for(let[ee,re]of o().studyAreaProjects())if(ee==a().study_area_name)return re.filter(ae=>ae.projectID!=V);return[]}function M(){let V=a().project_name,ee=window.prompt(r(y).t(127,[V]),o().nextAvailableProjectName(V));if(ee)try{let re=o().copyProject(s(),ee);Ve(bn,re),t().changeProjectName(ee);let ae=new URL(window.location.href);ae.searchParams.set("project",re),window.history.replaceState(null,"",ae.toString()),window.alert(`Done, you are now working on project ${ee}`)}catch(re){window.alert(`Couldn't copy project: ${re}`)}}function T(V){X(b,!1);let ee=o().project(V);t().loadSavefile(ee),Ve(bn,V),lr(Vt,l());let re=new URL(window.location.href);re.searchParams.set("project",V),window.history.replaceState(null,"",re.toString())}function x(V){let ee=0,re=0,ae=0;for(let ne of V.features)ne.properties.kind=="modal_filter"?ee++:ne.properties.kind=="deleted_existing_modal_filter"?re++:ne.properties.kind=="travel_flow"&&ae++;return{modalFilters:ee,deletedModalFilters:re,travelFlows:ae}}let C=u(()=>x(e.projectGj)),_=u(()=>O(s()));var D=c1(),z=Q(D),I=c(z);{let V=u(()=>r(y).cx(128)),ee=u(()=>[a().project_name]);me(I,{get x(){return r(V)},get a(){return r(ee)}})}var F=m(z,2),j=c(F);j.__click=[r1,s];var d=c(j),g=c(d);Fl(g,{});var h=m(g,2),$=c(h),w=m(j,2);w.__click=[n1,M];var A=c(w),B=c(A);Bl(B,{});var k=m(B,2),R=c(k),S=m(F,2);{var E=V=>{var ee=a1(),re=c(ee),ae=c(re);Uc(ae,{});var ne=m(ae,2),ie=c(ne),_e=m(re,2);Jt(_e,21,()=>r(_),Qt,(le,fe)=>{var se=o1(),ye=c(se);da(ye,{onclick:()=>T(r(fe).projectID),children:(he,Se)=>{var xe=Dt();J(()=>U(xe,r(fe).projectName)),p(he,xe)}}),p(le,se)}),J(le=>U(ie,le),[()=>r(y).t(133)]),Ic("open","toggle",ee,le=>X(b,le),()=>r(b)),p(V,ee)};ve(S,V=>{a().study_area_name&&r(_).length>0&&V(E)})}var N=m(S,2),G=c(N);{let V=u(()=>r(y).cx(134)),ee=u(()=>[r(C).modalFilters]);me(G,{get x(){return r(V)},get a(){return r(ee)}})}var q=m(N,2),H=c(q);{let V=u(()=>r(y).cx(135)),ee=u(()=>[r(C).deletedModalFilters]);me(H,{get x(){return r(V)},get a(){return r(ee)}})}var Y=m(q,2),ue=c(Y);{let V=u(()=>r(y).cx(136)),ee=u(()=>[r(C).travelFlows]);me(ue,{get x(){return r(V)},get a(){return r(ee)}})}var oe=m(Y,2);{var Z=V=>{var ee=l1(),re=c(ee),ae=c(re);{let ie=u(()=>r(y).cx(137)),_e=u(()=>[L.toDateString()]);me(ae,{get x(){return r(ie)},get a(){return r(_e)}})}var ne=m(re,2);Uo(ne,{children:(ie,_e)=>{var le=s1();{const se=(ye,he=Pe)=>{var Se=i1(),xe=c(Se);J(Fe=>U(xe,Fe),[()=>r(y).tx(he())]),p(ye,Se)};var fe=c(le);{let ye=u(()=>[se]),he=u(()=>r(y).cx(138));me(fe,{get t(){return r(ye)},get x(){return r(he)}})}}p(ie,le)},$$slots:{default:!0}}),p(V,ee)};ve(oe,V=>{L&&V(Z)})}var te=m(oe,2);{var K=V=>{var ee=u1();ee.__click=[t1,t];var re=c(ee);J(ae=>U(re,ae),[()=>r(y).t(139)]),p(V,ee)};ve(te,V=>{i()&&V(K)})}J((V,ee,re,ae)=>{De(j,"title",V),U($,ee),De(w,"title",re),U(R,ae)},[()=>r(y).t(129),()=>r(y).t(130),()=>r(y).t(131),()=>r(y).t(132)]),p(n,D),Be(),v()}tr(["click"]);var f1=P("<li><!></li>"),v1=P('<div style="display: flex; justify-content: space-between;"><nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li></ul></nav> <nav><ul><li><!></li> <li><!></li> <!></ul></nav></div>'),g1=(n,e,t)=>e(t()),_1=(n,e,t)=>e(t()),p1=P('<li><h3><!></h3> <span class="actions"><button class="outline icon-btn"><!></button> <button class="icon-btn destructive"><!></button></span></li>'),h1=P("<h3> </h3> <p> </p> <!> <hr/>",1),m1=P('<h2> </h2> <ul class="navigable-list"><!> <li><!></li></ul> <!> <!>',1),b1=P("<b> </b>"),y1=P("<b> </b>"),A1=P("<b> </b>"),w1=P("<h2> </h2> <!>",1),x1=P("<!> <!> <!> <!>",1),$1=P("<!> <!>",1);function k1(n,e){Ne(e,!0);const t=()=>be(Vt,"$mutationCounter",v),o=()=>be(It,"$backend",v),a=()=>be(yt,"$mode",v),s=()=>be(Kr,"$appFocus",v),l=()=>be(ho,"$metricBuckets",v),i=()=>be(bn,"$currentProjectID",v),f=()=>be(ta,"$devMode",v),[v,y]=ut(),b=u(()=>ct(dt("main")));let L=u(()=>t()>0?o().toSavefile():nr()),O=u(()=>({type:"FeatureCollection",features:r(L).features.filter(F=>F.properties.kind=="boundary")}));Ze(()=>{r(O).features.length==0&&Ve(yt,{mode:"add-neighbourhood"})});let M=we(ht(s()=="cnt"?"combined":"none")),T=we(null),x=we(void 0);Ve(so,void 0);function C(F){o().setCurrentNeighbourhood(F),Ve(so,F),Ve(yt,{mode:"neighbourhood"})}function _(F){window.confirm(r(b).t(140,[F]))&&(o().deleteNeighbourhoodBoundary(F),console.assert(!so),na(),lr(Vt,t()))}function D(F){let j=pu(o(),r(b).t(141,[F]),F);j&&(o().renameNeighbourhoodBoundary(F,j),Ve(so,j),na(),lr(Vt,t()))}function z(F){let j=Ur.mapFeature.hover.backgroundColor,d=mu({none:j},F,l());return["case",["==",["feature-state","highlight"],"yes"],j,d]}function I(F){let j=.7;return{none:["case",["==",["feature-state","highlight"],"yes"],j,bt(.3,j)],area:bt(.7,.9),population_density:bt(.7,.9),simd:bt(.7,.9),stats19:bt(.7,.9),pois:bt(.7,.9),car_ownership:bt(.7,.9),combined:bt(.7,.9)}[F]}kr(n,{top:g=>{var h=v1(),$=c(h),w=c($),A=c(w),B=c(A);et(B,{mode:{mode:"title"}});var k=m(A,2),R=c(k);ei(R,i,oe=>{var Z=Dt();J(te=>U(Z,te),[()=>mr(a().mode)]),p(oe,Z)});var S=m($,2),E=c(S),N=c(E),G=c(N);et(G,{mode:{mode:"route",prevMode:"pick-neighbourhood"}});var q=m(N,2),H=c(q);et(H,{mode:{mode:"predict-impact",prevMode:"pick-neighbourhood"}});var Y=m(q,2);{var ue=oe=>{var Z=f1(),te=c(Z);et(te,{mode:{mode:"debug-intersections"}}),p(oe,Z)};ve(Y,oe=>{f()&&oe(ue)})}p(g,h)},left:g=>{var h=m1(),$=Q(h),w=c($),A=m($,2),B=c(A);Jt(B,17,()=>r(O).features,Qt,(G,q)=>{let H=()=>r(q).properties.name;var Y=p1();let ue;var oe=c(Y),Z=c(oe);da(Z,{onclick:()=>C(H()),children:(ae,ne)=>{var ie=Dt();J(()=>U(ie,H())),p(ae,ie)}});var te=m(oe,2),K=c(te);K.__click=[g1,D,H];var V=c(K);es(V,{color:"black"});var ee=m(K,2);ee.__click=[_1,_,H];var re=c(ee);ti(re,{color:"white"}),J((ae,ne,ie)=>{ue=St(Y,1,"actionable-cell svelte-j2ux5u",null,ue,ae),De(K,"title",ne),De(ee,"title",ie)},[()=>({highlighted:r(x)?.properties.name==H()||r(T)==H()}),()=>r(b).t(143),()=>r(b).t(144)]),Xn("mouseenter",Y,()=>X(T,H(),!0)),Xn("mouseleave",Y,()=>X(T,null)),p(G,Y)});var k=m(B,2),R=c(k);{const G=q=>{zc(q,{})};et(R,{mode:{mode:"add-neighbourhood"},_w_snippet_0:G,children:(q,H)=>{{let Y=u(()=>[G]),ue=u(()=>r(b).cx(145));me(q,{get t(){return r(Y)},get x(){return r(ue)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}var S=m(A,2);{var E=G=>{var q=h1(),H=Q(q),Y=c(H),ue=m(H,2),oe=c(ue),Z=m(ue,2);hu(Z,{get selectedPrioritization(){return r(M)},set selectedPrioritization(te){X(M,te,!0)}}),J((te,K)=>{U(Y,te),U(oe,K)},[()=>r(b).t(17),()=>r(b).t(146)]),p(G,q)};ve(S,G=>{s()=="cnt"&&G(E)})}var N=m(S,2);d1(N,{get projectGj(){return r(L)}}),J(G=>U(w,G),[()=>r(b).t(142)]),p(g,h)},main:g=>{var h=$1(),$=Q(h);lt($,{get data(){return r(O)},promoteId:"name",children:(A,B)=>{var k=x1(),R=Q(k);{let G=u(()=>r(T)?[{name:r(T),highlight:"yes"}]:[]);od(R,{get data(){return r(G)},idCol:"name"})}var S=m(R,2);{let G=u(()=>We("neighbourhood-boundaries-selected-outline",!1));gt(S,Le({filter:["==",["get","kind"],"boundary"]},()=>r(G),{manageHoverState:!1,paint:{"line-color":"black","line-width":4,"line-dasharray":[2,2]}}))}var E=m(S,2);{let G=u(()=>We("neighbourhood-boundaries-selected-outline-base",!1));gt(E,Le({filter:["==",["get","kind"],"boundary"]},()=>r(G),{manageHoverState:!1,paint:{"line-color":"white","line-width":8,"line-opacity":.7}}))}var N=m(E,2);{let G=u(()=>We("neighbourhood-boundaries",!1)),q=u(()=>({"fill-color":z(r(M)),"fill-opacity":I(r(M))}));ur(N,Le(()=>r(G),{filter:["==",["get","kind"],"boundary"],get paint(){return r(q)},manageHoverState:!0,hoverCursor:"pointer",onclick:H=>C(H.features[0].properties.name),get hovered(){return r(x)},set hovered(H){X(x,H,!0)},children:(H,Y)=>{Bt(H,{openOn:"hover",children:(oe,Z)=>{let te=()=>Z?.().data;const K=u(()=>te().properties);var V=w1(),ee=Q(V),re=c(ee),ae=m(ee,2);{var ne=_e=>{const le=(fe,se=Pe)=>{var ye=b1(),he=c(ye);J(Se=>U(he,Se),[()=>r(b).tx(se())]),p(fe,ye)};{let fe=u(()=>[le]),se=u(()=>r(b).cx(147)),ye=u(()=>[Math.round(r(K).population/r(K).area_km2).toLocaleString()]);me(_e,{get t(){return r(fe)},get x(){return r(se)},get a(){return r(ye)}})}},ie=_e=>{var le=$e(),fe=Q(le);{var se=he=>{const Se=(xe,Fe=Pe)=>{var ke=y1(),Ce=c(ke);J(pe=>U(Ce,pe),[()=>r(b).tx(Fe())]),p(xe,ke)};{let xe=u(()=>[Se]),Fe=u(()=>r(b).cx(148)),ke=u(()=>[(r(K).number_stats19_collisions/r(K).area_km2).toFixed(1)]);me(he,{get t(){return r(xe)},get x(){return r(Fe)},get a(){return r(ke)}})}},ye=he=>{var Se=$e(),xe=Q(Se);{var Fe=ke=>{const Ce=(pe,Me=Pe)=>{var Te=A1(),Ae=c(Te);J(Ee=>U(Ae,Ee),[()=>r(b).tx(Me())]),p(pe,Te)};{let pe=u(()=>[Ce]),Me=u(()=>r(b).cx(149)),Te=u(()=>[(r(K).number_pois/r(K).area_km2).toFixed(1)]);me(ke,{get t(){return r(pe)},get x(){return r(Me)},get a(){return r(Te)}})}};ve(xe,ke=>{r(M)=="pois"&&ke(Fe)},!0)}p(he,Se)};ve(fe,he=>{r(M)=="stats19"?he(se):he(ye,!1)},!0)}p(_e,le)};ve(ae,_e=>{r(M)=="population_density"?_e(ne):_e(ie,!1)})}J(()=>U(re,r(K).name)),p(oe,V)},$$slots:{default:!0}})},$$slots:{default:!0}}))}p(A,k)},$$slots:{default:!0}});var w=m($,2);kn(w,{interactive:!1}),p(g,h)},$$slots:{top:!0,left:!0,main:!0}}),Be(),y()}tr(["click"]);function sl(n,e,t){Ve(Yi,r(t)=="fast")}var S1=P("<li><!></li>"),E1=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li> </li></ul></nav>'),L1=P('<a href="https://nptscot.github.io/data/" target="_blank"> </a>'),C1=P("<p><!></p>"),M1=P("<span> </span> <!>",1),P1=P('<a href="https://www.nomisweb.co.uk/sources/census_2021_od" target="_blank"> </a>'),T1=P('<a href="https://www.ons.gov.uk/peoplepopulationandcommunity/populationandmigration/populationestimates/methodologies/userguidetocensus2021origindestinationdataenglandandwales" target="_blank"> </a>'),I1=P("<p><!></p>"),R1=P("<span> </span> <!>",1),N1=P("<b> </b>"),B1=P('<a href="mailto:dabreegster@gmail.com"> </a>'),F1=P("<p><!></p>"),O1=P("<b> </b> <!>",1),j1=P('<input type="radio"/>'),z1=P('<input type="radio"/>'),D1=P('<input type="number"/>'),U1=P('<!> <p><!></p> <div style="display: flex"><!></div> <hr/> <fieldset><label><!></label> <label><!></label></fieldset> <p> </p> <label><!></label> <!>',1),G1=P("<p><!></p> <p> </p>",1),W1=P("<!> <!>",1),H1=P("<!> <!> <!>",1),q1=P("<!> <!>",1);function J1(n,e){Ne(e,!0);const t=()=>be(It,"$backend",i),o=()=>be(yt,"$mode",i),a=()=>be(Yi,"$fastSample",i),s=()=>be(Kr,"$appFocus",i),l=()=>be(ps,"$minImpactCount",i),[i,f]=ut(),v=[],y=u(()=>ct(dt("main")));let b=["#1a9641","#a6d96a","white","#fdae61","#d7191c"],L=we(""),O=we(ht({type:"FeatureCollection",features:[],max_count:1})),M=t().toSavefile(),T=3,x=10;function C(j){Ve(yt,{mode:"impact-detail",road:j,prevPrevMode:e.prevMode})}async function _(j){X(L,r(y).t(80),!0),await Xa(),X(O,t().predictImpact(j),!0),X(L,"")}Ze(()=>{_(a())});let D=we(ht(a()?"fast":"accurate"));var z=q1(),I=Q(z);go(I,{get loading(){return r(L)}});var F=m(I,2);kr(F,{top:h=>{var $=E1(),w=c($),A=c(w),B=c(A);et(B,{mode:{mode:"title"}});var k=m(A,2),R=c(k);et(R,{mode:{mode:"pick-neighbourhood"}});var S=m(k,2);{var E=q=>{var H=S1(),Y=c(H);et(Y,{mode:{mode:"neighbourhood"}}),p(q,H)};ve(S,q=>{e.prevMode=="neighbourhood"&&q(E)})}var N=m(S,2),G=c(N);J(q=>U(G,q),[()=>mr(o().mode)]),p(h,$)},left:h=>{var $=U1(),w=Q($);{let V=u(()=>({mode:e.prevMode}));un(w,{get mode(){return r(V)}})}var A=m(w,2);{const V=(ee,re=Pe)=>{et(ee,{mode:{mode:"debug-demand"},children:(ae,ne)=>{var ie=Dt();J(_e=>U(ie,_e),[()=>r(y).tx(re())]),p(ae,ie)},$$slots:{default:!0}})};var B=c(A);{let ee=u(()=>[V]),re=u(()=>r(y).cx(81));me(B,{get t(){return r(ee)},get x(){return r(re)}})}}var k=m(A,2),R=c(k);{var S=V=>{var ee=M1(),re=Q(ee),ae=c(re),ne=m(re,2);Uo(ne,{children:(ie,_e)=>{var le=C1();{const se=(ye,he=Pe)=>{var Se=L1(),xe=c(Se);J(Fe=>U(xe,Fe),[()=>r(y).tx(he())]),p(ye,Se)};var fe=c(le);{let ye=u(()=>[se]),he=u(()=>r(y).cx(83));me(fe,{get t(){return r(ye)},get x(){return r(he)}})}}p(ie,le)},$$slots:{default:!0}}),J(ie=>U(ae,ie),[()=>r(y).t(82)]),p(V,ee)},E=V=>{var ee=$e(),re=Q(ee);{var ae=ie=>{var _e=R1(),le=Q(_e),fe=c(le),se=m(le,2);Uo(se,{children:(ye,he)=>{var Se=I1();{const Fe=(Ce,pe=Pe)=>{var Me=P1(),Te=c(Me);J(Ae=>U(Te,Ae),[()=>r(y).tx(pe())]),p(Ce,Me)},ke=(Ce,pe=Pe)=>{var Me=T1(),Te=c(Me);J(Ae=>U(Te,Ae),[()=>r(y).tx(pe())]),p(Ce,Me)};var xe=c(Se);{let Ce=u(()=>[Fe,ke]),pe=u(()=>r(y).cx(85));me(xe,{get t(){return r(Ce)},get x(){return r(pe)}})}}p(ye,Se)},$$slots:{default:!0}}),J(ye=>U(fe,ye),[()=>r(y).t(84)]),p(ie,_e)},ne=ie=>{var _e=O1(),le=Q(_e),fe=c(le),se=m(le,2);Uo(se,{children:(ye,he)=>{var Se=F1();{const Fe=(Ce,pe=Pe)=>{var Me=N1(),Te=c(Me);J(Ae=>U(Te,Ae),[()=>r(y).tx(pe())]),p(Ce,Me)},ke=(Ce,pe=Pe)=>{var Me=B1(),Te=c(Me);J(Ae=>U(Te,Ae),[()=>r(y).tx(pe())]),p(Ce,Me)};var xe=c(Se);{let Ce=u(()=>[Fe,ke]),pe=u(()=>r(y).cx(87));me(xe,{get t(){return r(Ce)},get x(){return r(pe)}})}}p(ye,Se)},$$slots:{default:!0}}),J(ye=>U(fe,ye),[()=>r(y).t(86)]),p(ie,_e)};ve(re,ie=>{s()=="england"?ie(ae):ie(ne,!1)},!0)}p(V,ee)};ve(R,V=>{s()=="cnt"?V(S):V(E,!1)})}var N=m(k,4),G=c(N);{const V=ee=>{var re=j1();re.__change=[sl,a,D],re.value=re.__value="fast",xi(v,[],re,()=>r(D),ae=>X(D,ae)),p(ee,re)};var q=c(G);{let ee=u(()=>[V]),re=u(()=>r(y).cx(88));me(q,{get t(){return r(ee)},get x(){return r(re)}})}}var H=m(G,2);{const V=ee=>{var re=z1();re.__change=[sl,a,D],re.value=re.__value="accurate",xi(v,[],re,()=>r(D),ae=>X(D,ae)),p(ee,re)};var Y=c(H);{let ee=u(()=>[V]),re=u(()=>r(y).cx(89));me(Y,{get t(){return r(ee)},get x(){return r(re)}})}}var ue=m(N,2),oe=c(ue),Z=m(ue,2);{const V=ee=>{var re=D1();De(re,"min",0),ea(re,l,ae=>Ve(ps,ae)),p(ee,re)};var te=c(Z);{let ee=u(()=>[V]),re=u(()=>r(y).cx(91));me(te,{get t(){return r(ee)},get x(){return r(re)}})}}var K=m(Z,2);hr(K,{get colorScale(){return b},labels:{limits:["0%","50%","same","150%","200%"]}}),J(V=>U(oe,V),[()=>r(y).t(90)]),p(h,$)},main:h=>{var $=H1(),w=Q($);lt(w,{get data(){return M},children:(k,R)=>{{let S=u(()=>We("neighbourhood-boundaries",!1));ur(k,Le(()=>r(S),{filter:["==",["get","kind"],"boundary"],paint:{"fill-color":"grey","fill-opacity":.5}}))}},$$slots:{default:!0}});var A=m(w,2);lt(A,{get data(){return r(O)},generateId:!0,children:(k,R)=>{var S=W1(),E=Q(S);{let G=u(()=>We("predict-impact-outline")),q=u(()=>[">=",["max",["get","before"],["get","after"]],l()]),H=u(()=>({"line-width":["interpolate",["linear"],["get","after"],0,1.5*T,r(O).max_count,1.5*x],"line-color":"black"}));gt(E,Le(()=>r(G),{get filter(){return r(q)},get paint(){return r(H)}}))}var N=m(E,2);{let G=u(()=>We("predict-impact")),q=u(()=>[">=",["max",["get","before"],["get","after"]],l()]),H=u(()=>({"line-width":["interpolate",["linear"],["get","after"],0,T,r(O).max_count,x],"line-color":["let","ratio",["*",100,["/",["get","after"],["get","before"]]],["interpolate-hcl",["linear"],["var","ratio"],0,b[0],50,b[1],100,b[2],150,b[3],200,b[4]]]}));gt(N,Le(()=>r(G),{get filter(){return r(q)},get paint(){return r(H)},manageHoverState:!0,hoverCursor:"pointer",onclick:Y=>C(Y.features[0]),children:(Y,ue)=>{Bt(Y,{openOn:"hover",children:(Z,te)=>{let K=()=>te?.().data;const V=u(()=>K().properties);var ee=G1(),re=Q(ee),ae=c(re);{let _e=u(()=>r(y).cx(92)),le=u(()=>[r(V).before.toLocaleString(),r(V).after.toLocaleString()]);me(ae,{get x(){return r(_e)},get a(){return r(le)}})}var ne=m(re,2),ie=c(ne);J(_e=>U(ie,`${_e??""}%`),[()=>Math.round(100*r(V).after/r(V).before)]),p(Z,ee)},$$slots:{default:!0}})},$$slots:{default:!0}}))}p(k,S)},$$slots:{default:!0}});var B=m(A,2);kn(B,{interactive:!1}),p(h,$)},$$slots:{top:!0,left:!0,main:!0}}),p(n,z),Be(),f()}tr(["change"]);var Q1=P("<li><!></li>"),Z1=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <!> <li> </li></ul></nav>'),V1=P("<p> </p>"),K1=P("<i> </i>"),X1=P("<p><!></p>"),Y1=P("<p> </p>"),em=P("<i> </i>"),tm=P("<p><!></p>"),rm=P('<input type="range" min="1.0" max="5.0" step="0.1"/>'),nm=P("<!> <p> </p> <u> </u> <!> <u> </u> <!> <label><!></label> <i> </i>",1),om=P("<!> <!> <!> <!>",1),am=P("<!> <!> <!> <!> <!>",1);function im(n,e){Ne(e,!0);const t=()=>be(It,"$backend",i),o=()=>be(Ea,"$routePtA",i),a=()=>be(La,"$routePtB",i),s=()=>be(hs,"$mainRoadPenalty",i),l=()=>be(yt,"$mode",i),[i,f]=ut(),v=u(()=>ct(dt("main")));let y=e.prevMode=="neighbourhood"?t().renderNeighbourhood():null,b=u(()=>t().compareRoute(o(),a(),s())),L=u(()=>r(b).features.find(M=>M.properties.kind=="before")),O=u(()=>r(b).features.find(M=>M.properties.kind=="after"));ln(()=>{setTimeout(()=>{Li(Ea),Li(La)},10)}),kr(n,{top:C=>{var _=Z1(),D=c(_),z=c(D),I=c(z);et(I,{mode:{mode:"title"}});var F=m(z,2),j=c(F);et(j,{mode:{mode:"pick-neighbourhood"}});var d=m(F,2);{var g=w=>{var A=Q1(),B=c(A);et(B,{mode:{mode:"neighbourhood"}}),p(w,A)};ve(d,w=>{e.prevMode=="neighbourhood"&&w(g)})}var h=m(d,2),$=c(h);J(w=>U($,w),[()=>mr(l().mode)]),p(C,_)},left:C=>{var _=nm(),D=Q(_);{let G=u(()=>({mode:e.prevMode}));un(D,{get mode(){return r(G)}})}var z=m(D,2),I=c(z),F=m(z,2);fr(F,"",{},{color:"red"});var j=c(F),d=m(F,2);{var g=G=>{var q=V1(),H=c(q);J((Y,ue)=>U(H,`${Y??""}, ${ue??""}`),[()=>Oa(r(L).properties.distance),()=>ja(r(L).properties.time)]),p(G,q)},h=G=>{var q=X1();{const Y=(ue,oe=Pe)=>{var Z=K1(),te=c(Z);J(K=>U(te,K),[()=>r(v).tx(oe())]),p(ue,Z)};var H=c(q);{let ue=u(()=>[Y]),oe=u(()=>r(v).cx(75));me(H,{get t(){return r(ue)},get x(){return r(oe)}})}}p(G,q)};ve(d,G=>{r(L)?G(g):G(h,!1)})}var $=m(d,2);fr($,"",{},{color:"blue"});var w=c($),A=m($,2);{var B=G=>{var q=Y1(),H=c(q);J((Y,ue)=>U(H,`${Y??""}, ${ue??""}`),[()=>Oa(r(O).properties.distance),()=>ja(r(O).properties.time)]),p(G,q)},k=G=>{var q=tm();{const Y=(ue,oe=Pe)=>{var Z=em(),te=c(Z);J(K=>U(te,K),[()=>r(v).tx(oe())]),p(ue,Z)};var H=c(q);{let ue=u(()=>[Y]),oe=u(()=>r(v).cx(75));me(H,{get t(){return r(ue)},get x(){return r(oe)}})}}p(G,q)};ve(A,G=>{r(O)?G(B):G(k,!1)})}var R=m(A,2);{const G=q=>{var H=rm();ea(H,s,Y=>Ve(hs,Y)),p(q,H)};var S=c(R);{let q=u(()=>[G]),H=u(()=>r(v).cx(94)),Y=u(()=>[s()]);me(S,{get t(){return r(q)},get x(){return r(H)},get a(){return r(Y)}})}}var E=m(R,2),N=c(E);J((G,q,H,Y)=>{U(I,G),U(j,q),U(w,H),U(N,Y)},[()=>r(v).t(93),()=>r(v).t(74),()=>r(v).t(77),()=>r(v).t(95)]),p(C,_)},main:C=>{var _=am(),D=Q(_);{var z=g=>{lt(g,{get data(){return y},generateId:!0,children:(h,$)=>{var w=om(),A=Q(w);ni(A,{});var B=m(A,2);_a(B,{});var k=m(B,2);ha(k,{});var R=m(k,2);pa(R,{interactive:!1,get maxShortcuts(){return y.maxShortcuts}}),p(h,w)},$$slots:{default:!0}})};ve(D,g=>{e.prevMode=="neighbourhood"&&g(z)})}var I=m(D,2);kn(I,{interactive:!1});var F=m(I,2);lt(F,{get data(){return r(b)},children:(g,h)=>{{let $=u(()=>We("compare-route")),w=u(()=>({"line-width":10,"line-color":yn(["get","kind"],{before:"red",after:"blue"},"red")}));gt(g,Le(()=>r($),{get paint(){return r(w)}}))}},$$slots:{default:!0}});var j=m(F,2);Yn(j,{draggable:!0,get lngLat(){return ra(),o()},set lngLat(g){Ve(Ea,g)},children:(g,h)=>{var $=Dt();J(w=>U($,w),[()=>r(v).t(71)]),p(g,$)},$$slots:{default:!0}});var d=m(j,2);Yn(d,{draggable:!0,get lngLat(){return ra(),a()},set lngLat(g){Ve(La,g)},children:(g,h)=>{var $=Dt();J(w=>U($,w),[()=>r(v).t(72)]),p(g,$)},$$slots:{default:!0}}),p(C,_)},$$slots:{top:!0,left:!0,main:!0}}),Be(),f()}function sm(n,e,t,o,a,s){if(r(e))try{t().setCurrentNeighbourhoodBoundary(o.name,r(e)),na(),Ve(yt,{mode:"neighbourhood"})}catch(l){window.alert(`Sorry, this boundary is invalid: ${l}`),s()}}var lm=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),um=P('<!> <h1> </h1> <!> <div style="display: flex; gap: 16px;"><button> </button> <button class="secondary"> </button></div>',1);function cm(n,e){Ne(e,!0);const t=()=>be(It,"$backend",s),o=()=>be(yt,"$mode",s),a=()=>be(Vr,"$map",s),[s,l]=ut(),i=u(()=>ct(dt("main")));let f=we(ht([])),v=we(void 0),y=e.existing.properties.waypoints;if(!y){let L={type:"LineString",coordinates:e.existing.geometry.coordinates[1]};y=t().extractWaypointsFromRing(L)}X(f,y.map(L=>({point:[L.lon,L.lat],snapped:L.snapped})),!0);function b(){Ve(yt,{mode:"neighbourhood"})}kr(n,{top:M=>{var T=lm(),x=c(T),C=c(x),_=c(C);et(_,{mode:{mode:"title"}});var D=m(C,2),z=c(D);et(z,{mode:{mode:"pick-neighbourhood"}});var I=m(D,2),F=c(I);et(F,{mode:{mode:"neighbourhood"}});var j=m(I,2),d=c(j);J(g=>U(d,g),[()=>mr(o().mode)]),p(M,T)},left:M=>{var T=um(),x=Q(T);un(x,{mode:{mode:"neighbourhood"}});var C=m(x,2),_=c(C),D=m(C,2);gu(D,{get map(){return a()},get waypoints(){return r(f)},set waypoints(g){X(f,g,!0)},get drawnShapeOut(){return r(v)},set drawnShapeOut(g){X(v,g,!0)}});var z=m(D,2),I=c(z);I.__click=[sm,v,t,e,o,b];var F=c(I),j=m(I,2);j.__click=b;var d=c(j);J((g,h,$)=>{U(_,g),I.disabled=r(f).length<3,U(F,h),U(d,$)},[()=>r(i).t(96),()=>r(i).t(97),()=>r(i).t(98)]),p(M,T)},$$slots:{top:!0,left:!0}}),Be(),l()}tr(["click"]);function dm(n,e){var t,o,a,s,l,i,f,v,y,b,L=0,O=n.type==="FeatureCollection",M=n.type==="Feature",T=O?n.features.length:1;for(t=0;t<T;t++){for(i=O?n.features[t].geometry:M?n.geometry:n,v=O?n.features[t].properties:M?n.properties:{},y=O?n.features[t].bbox:M?n.bbox:void 0,b=O?n.features[t].id:M?n.id:void 0,f=i?i.type==="GeometryCollection":!1,l=f?i.geometries.length:1,a=0;a<l;a++){if(s=f?i.geometries[a]:i,s===null){if(e(null,L,v,y,b)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,L,v,y,b)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<s.geometries.length;o++)if(e(s.geometries[o],L,v,y,b)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}L++}}function fm(n,e){dm(n,function(t,o,a,s,l){var i=t===null?null:t.type;switch(i){case null:case"Point":case"LineString":case"Polygon":return e(Ri(t,a,{bbox:s,id:l}),o,0)===!1?!1:void 0}var f;switch(i){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var v=0;v<t.coordinates.length;v++){var y=t.coordinates[v],b={type:f,coordinates:y};if(e(Ri(b,a),o,v)===!1)return!1}})}var vm=Object.defineProperty,gm=Object.defineProperties,_m=Object.getOwnPropertyDescriptors,ll=Object.getOwnPropertySymbols,pm=Object.prototype.hasOwnProperty,hm=Object.prototype.propertyIsEnumerable,ul=(n,e,t)=>e in n?vm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,cl=(n,e)=>{for(var t in e||(e={}))pm.call(e,t)&&ul(n,t,e[t]);if(ll)for(var t of ll(e))hm.call(e,t)&&ul(n,t,e[t]);return n},dl=(n,e)=>gm(n,_m(e));function mm(n,e,t={}){if(!n||!e)throw new Error("lines and pt are required arguments");const o=mn(e);let a=Vn([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),s=0;return fm(n,function(l,i,f){const v=nh(l);for(let y=0;y<v.length-1;y++){const b=Vn(v[y]);b.properties.dist=_n(e,b,t);const L=mn(b),O=Vn(v[y+1]);O.properties.dist=_n(e,O,t);const M=mn(O),T=_n(b,O,t);let x,C;L[0]===o[0]&&L[1]===o[1]?[x,,C]=[L,void 0,!1]:M[0]===o[0]&&M[1]===o[1]?[x,,C]=[M,void 0,!0]:[x,,C]=Am(b.geometry.coordinates,O.geometry.coordinates,mn(e));let _;x&&(_=Vn(x,{dist:_n(e,x,t),multiFeatureIndex:f,location:s+_n(b,x,t)})),_&&_.properties.dist<a.properties.dist&&(a=dl(cl({},_),{properties:dl(cl({},_.properties),{index:C?y+1:y})})),s+=T}}),a}function bm(n,e){const[t,o,a]=n,[s,l,i]=e;return t*s+o*l+a*i}function ym(n,e){const[t,o,a]=n,[s,l,i]=e;return[o*i-a*l,a*s-t*i,t*l-o*s]}function fl(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2))}function qn(n,e){const t=bm(n,e)/(fl(n)*fl(e));return Math.acos(Math.min(Math.max(t,-1),1))}function mi(n){const e=Mr(n[1]),t=Mr(n[0]);return[Math.cos(e)*Math.cos(t),Math.cos(e)*Math.sin(t),Math.sin(e)]}function Jn(n){const[e,t,o]=n,a=aa(Math.asin(o));return[aa(Math.atan2(t,e)),a]}function Am(n,e,t){const o=mi(n),a=mi(e),s=mi(t),[l,i,f]=s,[v,y,b]=ym(o,a),L=y*f-b*i,O=b*l-v*f,M=v*i-y*l,T=M*y-O*b,x=L*b-M*v,C=O*v-L*y,_=1/Math.sqrt(Math.pow(T,2)+Math.pow(x,2)+Math.pow(C,2)),D=[T*_,x*_,C*_],z=[-1*T*_,-1*x*_,-1*C*_],I=qn(o,a),F=qn(o,D),j=qn(a,D),d=qn(o,z),g=qn(a,z);let h;return F<d&&F<g||j<d&&j<g?h=D:h=z,qn(o,h)>I||qn(a,h)>I?_n(Jn(h),Jn(o))<=_n(Jn(h),Jn(a))?[Jn(o),!0,!1]:[Jn(a),!1,!0]:[Jn(h),!1,!1]}var wm=mm;const xm=["==",["geometry-type"],"Polygon"],$m=["==",["geometry-type"],"LineString"],km=["==",["geometry-type"],"Point"];function yu(){return{type:"FeatureCollection",features:[]}}function bi(n){return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:Au(n)}}}function Au(n){return[Math.round(n[0]*1e7)/1e7,Math.round(n[1]*1e7)/1e7]}const wu=Mn(yu()),xu=Mn(0),Sm=100;class Em{map;active;eventListenersSuccess;eventListenersUpdated;eventListenersFailure;points;cursor;hover;dragFrom;previousStates;constructor(e){this.map=e,this.active=!1,this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[],this.points=[],this.cursor=null,this.hover=null,this.dragFrom=null,this.previousStates=[],this.map.on("mousemove",this.onMouseMove),this.map.on("click",this.onClick),this.map.on("dblclick",this.onDoubleClick),this.map.on("mousedown",this.onMouseDown),this.map.on("mouseup",this.onMouseUp),document.addEventListener("keypress",this.onKeypress),document.addEventListener("keydown",this.onKeyDown)}tearDown(){this.map.off("mousemove",this.onMouseMove),this.map.off("click",this.onClick),this.map.off("dblclick",this.onDoubleClick),this.map.off("mousedown",this.onMouseDown),this.map.off("mouseup",this.onMouseUp),document.removeEventListener("keypress",this.onKeypress),document.removeEventListener("keydown",this.onKeyDown)}finish(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersSuccess)t(e);else for(let t of this.eventListenersFailure)t();this.stop()}cancel(){for(let e of this.eventListenersFailure)e();this.stop()}onMouseMove=e=>{if(this.active&&!this.dragFrom)this.recalculateHovering(e);else if(this.active&&this.dragFrom){if(this.hover=="polygon"){let t=this.dragFrom[0]-e.lngLat.lng,o=this.dragFrom[1]-e.lngLat.lat;for(let a of this.points)a[0]-=t,a[1]-=o}else this.points[this.hover]=e.lngLat.toArray();this.dragFrom=e.lngLat.toArray(),this.redraw()}};onClick=e=>{if(this.beforeUpdate(),this.active&&this.cursor){let t=[];if(vl(this.points).forEach((o,a)=>{t.push([a+1,wm(o,this.cursor).properties.dist])}),t.sort((o,a)=>o[1]-a[1]),t.length>0){let o=t[0][0];this.points.splice(o,0,this.cursor.geometry.coordinates),this.hover=o}else this.points.push(this.cursor.geometry.coordinates),this.hover=this.points.length-1;this.redraw(),this.pointsUpdated()}else this.active&&typeof this.hover=="number"&&(this.points.splice(this.hover,1),this.hover=null,this.redraw(),this.pointsUpdated(),this.recalculateHovering(e))};onDoubleClick=e=>{this.active&&(e.preventDefault(),this.cursor=bi(e.lngLat.toArray()),this.onClick(e),this.finish())};onMouseDown=e=>{this.active&&!this.dragFrom&&this.hover!=null&&(e.preventDefault(),this.cursor=null,this.dragFrom=e.lngLat.toArray(),this.beforeUpdate(),this.redraw())};onMouseUp=()=>{this.active&&this.dragFrom&&(this.dragFrom=null,this.redraw(),this.pointsUpdated())};onKeypress=e=>{if(!this.active)return;let t=e.target.tagName;t=="INPUT"||t=="TEXTAREA"||(e.key=="Enter"?(e.stopPropagation(),this.finish()):e.key=="z"&&e.ctrlKey&&this.undo())};onKeyDown=e=>{if(!this.active)return;let t=e.target.tagName;t=="INPUT"||t=="TEXTAREA"||e.key=="Escape"&&(e.stopPropagation(),this.cancel())};addEventListenerSuccess(e){this.eventListenersSuccess.push(e)}addEventListenerUpdated(e){this.eventListenersUpdated.push(e)}addEventListenerFailure(e){this.eventListenersFailure.push(e)}clearEventListeners(){this.eventListenersSuccess=[],this.eventListenersUpdated=[],this.eventListenersFailure=[]}startNew(){this.active=!0,this.map.doubleClickZoom.disable()}editExisting(e){this.active=!0,this.map.doubleClickZoom.disable(),this.points=JSON.parse(JSON.stringify(e.geometry.coordinates[0])),this.points.pop(),this.redraw()}stop(){this.map.doubleClickZoom.enable(),this.points=[],this.cursor=null,this.active=!1,this.hover=null,this.dragFrom=null,this.previousStates=[],this.redraw(),this.map.getCanvas().style.cursor="inherit"}undo(){this.dragFrom!=null||this.previousStates.length==0||(this.points=this.previousStates.pop(),this.hover=null,this.redraw())}redraw(){let e=yu();this.points.forEach((a,s)=>{let l=bi(a);l.properties.hover=this.hover==s,l.properties.idx=s,e.features.push(l)}),e.features=e.features.concat(vl(this.points));let t=this.polygonFeature();t&&(t.properties.hover=this.hover=="polygon",e.features.push(t)),wu.set(e);let o="crosshair";this.hover!=null&&(o=this.dragFrom?"grabbing":"pointer"),this.map.getCanvas().style.cursor=o,xu.set(this.previousStates.length)}pointsUpdated(){let e=this.polygonFeature();if(e)for(let t of this.eventListenersUpdated)t(e)}recalculateHovering(e){this.cursor=null,this.hover=null;for(let t of this.map.queryRenderedFeatures(e.point,{layers:["edit-polygon-fill","edit-polygon-vertices"]}))if(t.geometry.type=="Polygon"){this.hover="polygon";break}else if(t.geometry.type=="Point"&&Object.hasOwn(t.properties,"idx")){this.hover=t.properties.idx;break}this.hover==null&&(this.cursor=bi(e.lngLat.toArray())),this.redraw()}polygonFeature(){if(this.points.length<3)return null;let e=this.points.map(Au),t=[JSON.parse(JSON.stringify(e))];return t[0].push(JSON.parse(JSON.stringify(t[0][0]))),{type:"Feature",geometry:{type:"Polygon",coordinates:t},properties:{}}}beforeUpdate(){this.previousStates.push(JSON.parse(JSON.stringify(this.points))),this.previousStates.length>Sm&&this.previousStates.shift()}}function vl(n){let e=[];for(let t=0;t<n.length-1;t++)e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[t],n[t+1]]},properties:{}});return n.length>=3&&e.push({type:"Feature",geometry:{type:"LineString",coordinates:[n[n.length-1],n[0]]},properties:{}}),e}var Lm=(n,e)=>e.polygonTool.finish(),Cm=(n,e)=>e.polygonTool.cancel(),Mm=(n,e)=>e.polygonTool.undo(),Pm=P('<div style="display: flex; justify-content: space-between;"><button>Finish</button> <button>Cancel</button> <button><!></button></div> <ul><li><b>Click</b> the map to add a vertex</li> <li><b>Click</b> a vertex to delete it</li> <li><b>Drag</b> a vertex or the polygon to move it</li> <li>Press <b>Control+Z</b> to undo your last change</li> <li>Press <b>Enter</b> or <b>double click</b> to finish</li> <li>Press <b>Escape</b> to cancel</li></ul>',1);function Tm(n,e){Ne(e,!0);const t=()=>be(xu,"$undoLength",o),[o,a]=ut();var s=Pm(),l=Q(s),i=c(l);i.__click=[Lm,e];var f=m(i,2);f.__click=[Cm,e];var v=m(f,2);v.__click=[Mm,e];var y=c(v);{var b=O=>{var M=Dt("Undo");p(O,M)},L=O=>{var M=Dt();J(()=>U(M,`Undo (${t()??""})`)),p(O,M)};ve(y,O=>{t()==0?O(b):O(L,!1)})}J(()=>v.disabled=t()==0),p(n,s),Be(),a()}tr(["click"]);var Im=P("<!> <!> <!>",1);function Rm(n){const e=()=>be(wu,"$polygonToolGj",t),[t,o]=ut();lt(n,{get data(){return e()},children:(a,s)=>{var l=Im(),i=Q(l);ur(i,{id:"edit-polygon-fill",get filter(){return xm},paint:{"fill-color":"red","fill-opacity":["case",["boolean",["get","hover"],"false"],1,.5]}});var f=m(i,2);gt(f,{id:"edit-polygon-lines",get filter(){return $m},paint:{"line-color":"black","line-width":8,"line-opacity":.5}});var v=m(f,2);Pn(v,{id:"edit-polygon-vertices",get filter(){return km},paint:{"circle-color":"black","circle-opacity":["case",["has","hovered"],1,.5],"circle-radius":10}}),p(a,l)},$$slots:{default:!0}}),o()}async function Nm(n,e,t,o){if(e.map){if(e.map.getZoom()<13){e.onerror?.("Zoom in more to import");return}await t(o())}}function Bm(n,e,t,o){e.map&&(X(t,new Em(e.map),!0),r(t).startNew(),r(t).addEventListenerSuccess(async a=>{X(t,null),await o(a)}),r(t).addEventListenerFailure(()=>{X(t,null)}))}var Fm=P('<button class="btn btn-primary" type="button">Import current view</button> <p class="fst-italic my-3">or...</p> <button class="btn btn-primary" type="button">Draw an area to import on the map</button>',1),Om=P("<!> <!>",1);function jm(n,e){Ne(e,!0);let t=we(null),o=we(!1);async function a(L){try{e.onloading?.("Loading from Overpass");let M=await(await fetch($u(L))).text();r(o)&&Ki("osm.xml",M),e.gotXml?.(M,L)}catch(O){e.onerror?.(O.toString())}}function s(L){return[L.lng,L.lat]}function l(){let L=e.map.getBounds();return{type:"Feature",properties:{},geometry:{coordinates:[[s(L.getSouthWest()),s(L.getNorthWest()),s(L.getNorthEast()),s(L.getSouthEast()),s(L.getSouthWest())]],type:"Polygon"}}}var i=Om(),f=Q(i);{var v=L=>{Tm(L,{get polygonTool(){return r(t)}})},y=L=>{var O=Fm(),M=Q(O);M.__click=[Nm,e,a,l];var T=m(M,4);T.__click=[Bm,e,t,a],p(L,O)};ve(f,L=>{r(t)?L(v):L(y,!1)})}var b=m(f,2);_d(b,{get checked(){return r(o)},set checked(L){X(o,L,!0)},children:(L,O)=>{var M=Dt("Save a copy of the osm.xml after importing");p(L,M)},$$slots:{default:!0}}),p(n,i),Be()}tr(["click"]);function $u(n){let e='poly:"';if(n.geometry.type=="Polygon")for(let[o,a]of n.geometry.coordinates[0])e+=`${a} ${o} `;else if(n.geometry.type=="MultiPolygon")for(let[o,a]of n.geometry.coordinates[0][0])e+=`${a} ${o} `;else throw new Error("overpassQueryForPolygon needs a Polygon or MultiPolygon");return e=e.slice(0,-1)+'"',`https://overpass-api.de/api/interpreter?data=${`(nwr(${e}); node(w)->.x; <;); out meta;`}`}class ku{inner;constructor(e,t,o,a,s,l,i){this.inner=new v_(e||new Uint8Array,t||new Uint8Array,o,a,s,l,i)}getInvertedBoundary(){return JSON.parse(this.inner.getInvertedBoundary())}getBounds(){return Array.from(this.inner.getBounds())}toRouteSnapper(){return this.inner.toRouteSnapper()}toRouteSnapperGj(){return this.inner.toRouteSnapperGj()}renderModalFilters(){return JSON.parse(this.inner.renderModalFilters())}renderModalFiltersBeforeEdits(){return JSON.parse(this.inner.renderModalFiltersBeforeEdits())}renderTurnRestrictions(){return JSON.parse(this.inner.renderTurnRestrictions())}renderTurnRestrictionsBeforeEdits(){return JSON.parse(this.inner.renderTurnRestrictionsBeforeEdits())}renderNeighbourhood(){let e=JSON.parse(this.inner.renderNeighbourhood());return e.maxShortcuts=Math.max(...e.features.map(t=>t.properties.kind=="interior_road"?t.properties.shortcuts:0))??0,e}renderNeighbourhoodBeforeEdits(){let e=JSON.parse(this.inner.renderNeighbourhoodBeforeEdits());return e.maxShortcuts=Math.max(...e.features.map(t=>t.properties.kind=="interior_road"?t.properties.shortcuts:0))??0,e}generatedBoundaries(){return JSON.parse(this.inner.generatedBoundaries())}generateMergedBoundary(e){let t=this.inner.generateMergedBoundary(e);return JSON.parse(t)}setCurrentNeighbourhoodBoundary(e,t){this.inner.setCurrentNeighbourhoodBoundary(e,t)}extractWaypointsFromRing(e){let t=this.inner.extractWaypointsFromRing(e);return JSON.parse(t)}deleteNeighbourhoodBoundary(e){this.inner.deleteNeighbourhoodBoundary(e)}renameNeighbourhoodBoundary(e,t){this.inner.renameNeighbourhoodBoundary(e,t)}setCurrentNeighbourhood(e){this.inner.setCurrentNeighbourhood(e)}addModalFilter(e,t){this.inner.addModalFilter(e,t)}addManyModalFilters(e,t){this.inner.addManyModalFilters(e,t)}deleteModalFilter(e){this.inner.deleteModalFilter(e)}addDiagonalFilter(e){this.inner.addDiagonalFilter(e.intersectionId)}rotateDiagonalFilter(e){this.inner.rotateDiagonalFilter(e.intersectionId)}deleteDiagonalFilter(e){this.inner.deleteDiagonalFilter(e.intersectionId)}toggleTravelFlow(e){this.inner.toggleTravelFlow(e)}toggleMainRoad(e){this.inner.toggleMainRoad(e)}setMainRoads(e,t){this.inner.setMainRoads(new Uint32Array(e),t)}addTurnRestriction(e,t){this.inner.addTurnRestriction(e,t)}deleteTurnRestriction(e,t,o){this.inner.deleteTurnRestriction(e,t,o)}getTurnRestrictionTargets(e){return JSON.parse(this.inner.getTurnRestrictionTargets(e))}undo(){this.inner.undo()}redo(){this.inner.redo()}getShortcutsCrossingRoad(e){return JSON.parse(this.inner.getShortcutsCrossingRoad(e))}getAllShortcuts(){return JSON.parse(this.inner.getAllShortcuts())}getAllShortcutsBeforeEdits(){return JSON.parse(this.inner.getAllShortcutsBeforeEdits())}toSavefile(){return JSON.parse(this.inner.toSavefile())}loadSavefile(e){this.inner.loadSavefile(e)}changeProjectName(e){this.inner.changeProjectName(e)}compareRoute(e,t,o){return JSON.parse(this.inner.compareRoute(e.lng,e.lat,t.lng,t.lat,o))}impactToOneDestination(e){return JSON.parse(this.inner.impactToOneDestination(e.lng,e.lat))}predictImpact(e){return JSON.parse(this.inner.predictImpact(e))}getImpactsOnRoad(e,t){return JSON.parse(this.inner.getImpactsOnRoad(e,t)).map(o=>{let[a,s,l]=o;return{count:a,before:s,after:l}})}getAllIntersections(){return JSON.parse(this.inner.getAllIntersections())}getMovements(e){return JSON.parse(this.inner.getMovements(e))}getDemandModel(){let e=JSON.parse(this.inner.getDemandModel());for(let t of e.features)t.properties.sum_from=ms(t.properties.counts_from),t.properties.sum_to=ms(t.properties.counts_to);return e}getPOIs(){return JSON.parse(this.inner.getPOIs())}getMetricBuckets(){try{return JSON.parse(this.inner.getMetricBuckets())}catch{return null}}eraseAllMainRoads(){this.inner.eraseAllMainRoads()}getOsmTimestamp(){let e=this.inner.getOsmTimestamp();return e?new Date(1e3*Number(e)):null}}let _o=Mn(""),po=Mn(null);async function oi(n){let e=Jr(mo).project(n);try{console.time("get input files");let{osmBuffer:t,boundary:o,mapModelBuffer:a}=await zm(e);console.timeEnd("get input files"),_o.set("Download finished, setting up project"),po.set(100),await Xa(),console.time("load"),It.set(new ku(a?new Uint8Array(a):void 0,t?new Uint8Array(t):void 0,o,e.app_focus,e.study_area_name,e.project_name,e.db_schema_version)),Jr(It).loadSavefile(e),bn.set(n),console.timeEnd("load"),Su(n)}catch(t){window.alert(`Couldn't open project: ${t}`),bn.set(void 0)}_o.set(""),po.set(null)}async function zm(n){if(n.app_focus=="cnt")return{mapModelBuffer:await yi(Qr(`cnt/maps_v4/${n.study_area_name}.bin.gz`))};if(n.app_focus=="england")return{mapModelBuffer:await yi(Qr(`england/maps_v4/${n.study_area_name}.bin.gz`))};if(n.study_area_name){let e=await yi(Qr(`severance_pbfs/v2/${n.study_area_name}.osm.pbf`)),o=await(await Ci(Qr(`boundaries/${n.study_area_name}.geojson`))).json();return{osmBuffer:e,boundary:o}}else{_o.set("Grabbing OSM data from Overpass"),po.set(100);let e=n.features.find(a=>a.properties.kind=="study_area_boundary");return{osmBuffer:await(await Ci($u(e))).arrayBuffer(),boundary:e}}}async function yi(n){return console.log(`Grabbing ${n}`),_o.set(`Downloading ${n}`),await Ac(n,e=>po.set(e))}function Su(n){ri.set(new Pd(Jr(Vr),Jr(It).toRouteSnapper(),Mn(nr()),Mn(!0),Mn(0))),Jr(Vr).fitBounds(Jr(It).getBounds(),{duration:500});let e=Jr(It).getMetricBuckets();e&&ho.set(e);let t=new URL(window.location.href);t.searchParams.set("project",n),window.history.replaceState(null,"",t.toString())}var Dm=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li> </li></ul></nav>'),Um=P('<input type="text"/>'),Gm=(n,e)=>e(),Wm=P("<option> </option>"),Hm=P("<optgroup></optgroup>"),qm=P("<select><option></option><!></select>"),Jm=P("<label><!></label> <i> </i> <div><!></div>",1),Qm=P("<div><label><!></label></div> <!>",1),Zm=P("<!> <!> <!>",1);function Vm(n,e){Ne(e,!0);const t=()=>be(It,"$backend",v),o=()=>be(Kr,"$appFocus",v),a=()=>be(mo,"$projectStorage",v),s=()=>be(yt,"$mode",v),l=()=>be(_o,"$loadingMessage",v),i=()=>be(po,"$loadingProgress",v),f=()=>be(Vr,"$map",v),[v,y]=ut(),b=u(()=>ct(dt("main")));let L=we(""),O=we(null),M=we(ht([])),T=we("");ln(async()=>{let d=await Ci(Qr("severance_pbfs/areas.json"));X(M,await d.json(),!0)});async function x(d,g){X(T,r(b).t(160),!0);try{let h;Ve(It,new ku(void 0,new TextEncoder().encode(d),g,o(),h,r(L),a().dbSchemaVersion));const $=a().createProject(t().toSavefile());Ve(bn,$),Su($),Ve(yt,{mode:"add-neighbourhood"})}catch(h){window.alert(`Couldn't import from Overpass: ${h}`)}X(T,"")}async function C(){if(!r(O))return;let d;try{d=a().createEmptyProject(r(L),r(O))}catch(g){X(O,null),window.alert(`Couldn't create project: ${g}`);return}await oi(d),Ve(yt,{mode:"add-neighbourhood"})}var _={loadExample:C},D=Zm(),z=Q(D);go(z,{get loading(){return r(T)},progress:100});var I=m(z,2);go(I,{get loading(){return l()},get progress(){return i()}});var F=m(I,2);kr(F,{top:$=>{var w=Dm(),A=c(w),B=c(A),k=c(B);et(k,{mode:{mode:"title"}});var R=m(B,2),S=c(R);J(E=>U(S,E),[()=>mr(s().mode)]),p($,w)},left:$=>{var w=Qm(),A=Q(w),B=c(A);{const E=N=>{var G=Um();ea(G,()=>r(L),q=>X(L,q)),p(N,G)};var k=c(B);{let N=u(()=>[E]),G=u(()=>r(b).cx(161));me(k,{get t(){return r(N)},get x(){return r(G)}})}}var R=m(A,2);{var S=E=>{var N=Jm(),G=Q(N);{const Z=te=>{var K=qm();K.__change=[Gm,C];var V=c(K);V.value=V.__value="";var ee=m(V);Jt(ee,17,()=>r(M),Qt,(re,ae)=>{var ne=u(()=>Dr(r(ae),2));let ie=()=>r(ne)[0],_e=()=>r(ne)[1];var le=Hm();Jt(le,21,_e,Qt,(fe,se)=>{var ye=u(()=>Dr(r(se),2));let he=()=>r(ye)[0],Se=()=>r(ye)[1];var xe=Wm(),Fe=c(xe),ke={};J(()=>{U(Fe,Se()),ke!==(ke=he())&&(xe.value=(xe.__value=he())??"")}),p(fe,xe)}),J(()=>De(le,"label",ie())),p(re,le)}),hn(K,()=>r(O),re=>X(O,re)),p(te,K)};var q=c(G);{let te=u(()=>[Z]),K=u(()=>r(b).cx(162));me(q,{get t(){return r(te)},get x(){return r(K)}})}}var H=m(G,2),Y=c(H),ue=m(H,2),oe=c(ue);jm(oe,{get map(){return f()},gotXml:x,onloading:Z=>X(T,Z,!0),onerror:Z=>window.alert(Z)}),J(Z=>U(Y,Z),[()=>r(b).t(163)]),p(E,N)};ve(R,E=>{r(L)&&E(S)})}p($,w)},main:$=>{Rm($)},$$slots:{top:!0,left:!0,main:!0}}),p(n,D);var j=Be(_);return y(),j}tr(["change"]);const Km="/ltn/assets/boundaries-BnmDCWUr.geojson",Xm="/ltn/assets/boundaries-Ddt_iXWy.geojson";var Ym=()=>window.location.href=".",e2=()=>window.location.href="cnt.html",t2=()=>window.location.href="england.html",r2=P('<a href="mailto:dabreegster@gmail.com"> </a>'),n2=P("<p><!></p>"),o2=P('<span style="display: flex; flex-direction: row; height: 80%; gap: 4px"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><span class="fi fi-gb-sct"></span></button> <button class="outline icon-btn"><span class="fi fi-gb-eng"></span></button> <!></span>');function a2(n,e){Ne(e,!0);const t=()=>be(Kr,"$appFocus",o),[o,a]=ut(),s=u(()=>ct(dt("main")));ln(Ll);var l=o2(),i=c(l);i.__click=[Ym];var f=c(i);Gc(f,{color:"black"});var v=m(i,2);v.__click=[e2];var y=m(v,2);y.__click=[t2];var b=m(y,2);Uo(b,{children:(L,O)=>{var M=n2();{const x=(C,_=Pe)=>{var D=r2(),z=c(D);J(I=>U(z,I),[()=>r(s).tx(_())]),p(C,D)};var T=c(M);{let C=u(()=>[x]),_=u(()=>r(s).cx(153));me(T,{get t(){return r(C)},get x(){return r(_)}})}}p(L,M)},$$slots:{default:!0}}),J((L,O,M,T,x)=>{De(i,"data-tippy-content",L),i.disabled=t()=="global",De(v,"data-tippy-content",O),De(v,"aria-label",M),v.disabled=t()=="cnt",De(y,"data-tippy-content",T),De(y,"aria-label",x),y.disabled=t()=="england"},[()=>r(s).t(150),()=>r(s).t(151),()=>r(s).t(151),()=>r(s).t(152),()=>r(s).t(152)]),p(n,l),Be(),a()}tr(["click"]);function i2(n,e,t,o){r(e)&&t(r(o).t(154,[r(e)]))}var s2=P("<option> </option>"),l2=P("<p><!></p>"),u2=P("<!> <!>",1),c2=P('<p> </p> <select style="width: 90%"><option></option><!></select> <!>',1);function gl(n,e){Ne(e,!0);const t=()=>be(mo,"$projectStorage",o),[o,a]=ut(),s=u(()=>ct(dt("main")));let l=we(ht({type:"FeatureCollection",features:[]})),i=we(ht([])),f=we("");ln(async()=>{let _=await fetch(e.boundariesUrl);X(l,await _.json(),!0);for(let D of r(l).features)r(i).push(D.properties.name);r(i).sort(),X(i,r(i),!0)});function v(_){let D=_.features[0].properties;y(`${D.kind}_${D.name}`)}async function y(_){let D,z=!1;for(;!z;){let I=D||t().nextAvailableProjectName(Mi(_));if(D=window.prompt(`Please pick a project name to create in ${Mi(_)}`,I),D===null)return;if(D=D.trim(),D===""){window.alert("Project name cannot be blank; Please pick a name or cancel.");continue}try{let F=t().createEmptyProject(D,_);await oi(F),Ve(yt,{mode:"add-neighbourhood"}),z=!0}catch(F){window.alert(F)}}}var b=c2(),L=Q(b),O=c(L),M=m(L,2);M.__change=[i2,f,y,s];var T=c(M);T.value=T.__value="";var x=m(T);Jt(x,17,()=>r(i),Qt,(_,D)=>{var z=s2(),I=c(z),F={};J(()=>{U(I,r(D)),F!==(F=r(D))&&(z.value=(z.__value=r(D))??"")}),p(_,z)});var C=m(M,2);lt(C,{get data(){return r(l)},generateId:!0,children:(_,D)=>{var z=u2(),I=Q(z);{let j=u(()=>({"fill-color":Ur.mapFeature.hover.backgroundColor,"fill-outline-color":Ur.mapFeature.hover.backgroundColor,"fill-opacity":bt(0,.5)})),d=u(()=>r(s).t(156));ur(I,{get paint(){return r(j)},get beforeId(){return r(d)},manageHoverState:!0,hoverCursor:"pointer",onclick:v,children:(g,h)=>{Bt(g,{openOn:"hover",children:(w,A)=>{let B=()=>A?.().data;var k=l2(),R=c(k);{let S=u(()=>r(s).cx(157)),E=u(()=>[B().properties.name]);me(R,{get x(){return r(S)},get a(){return r(E)}})}p(w,k)},$$slots:{default:!0}})},$$slots:{default:!0}})}var F=m(I,2);{let j=u(()=>({"line-color":Ur.mapFeature.hover.backgroundColor,"line-width":2.5})),d=u(()=>r(s).t(156));gt(F,{get paint(){return r(j)},get beforeId(){return r(d)},manageHoverState:!1})}p(_,z)},$$slots:{default:!0}}),J(_=>U(O,_),[()=>r(s).t(155)]),hn(M,()=>r(f),_=>X(f,_)),p(n,b),Be(),a()}tr(["change"]);var d2=P('<label style="margin-top: 16px;"><strong> </strong> <input type="file"/></label>');function f2(n,e){Ne(e,!0);const[t,o]=ut(),a=u(()=>ct(dt("main")));let s=we(void 0);async function l(b){let L=r(s).files[0].name,O=await r(s).files[0].text(),M=JSON.parse(O),T,x,C;M.app_focus&&(console.assert(M.app_focus=="global"||M.app_focus=="cnt"||M.app_focus=="england"),T=M.app_focus),M.study_area_name&&(x=M.study_area_name),M.project_name&&(C=M.project_name),(!M.app_focus||!M.project_name)&&(M.study_area_name&&M.study_area_name.startsWith(r(a).t(158))?(T="cnt",C=bs(ys(L,`ltn_cnt_${M.study_area_name}_`),".geojson")):(T="global",C=bs(ys(L,"ltn_"),".geojson"))),C=C,T=T;let _=wc.projectStorage(T);C=_.nextAvailableProjectName(C),M.project_name=C,M.app_focus=T,M.study_area_name=x;let D=_.createProject(M);await oi(D),Ve(yt,{mode:"pick-neighbourhood"})}var i=d2(),f=c(i),v=c(f),y=m(f,2);y.__change=l,sn(y,b=>X(s,b),()=>r(s)),J(b=>U(v,b),[()=>r(a).t(159)]),p(n,i),Be(),o()}tr(["change"]);var v2=P('<nav aria-label="breadcrumb"><ul><li class="svelte-eliuer"> </li></ul></nav>'),g2=P("<h1> </h1>"),_2=P('<div style="display: flex; justify-content: space-between; align-items: center"><h1> </h1> <!></div>'),p2=(n,e)=>Cl(e()),h2=(n,e,t,o)=>e(t(),o()),m2=(n,e,t,o)=>e(t(),o()),b2=(n,e,t,o)=>e(t(),o()),y2=P('<li class="actionable-cell svelte-eliuer"><h3 class="project-name svelte-eliuer"><!></h3> <span class="actions"><button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button> <button class="outline icon-btn"><!></button> <button class="icon-btn destructive"><!></button></span></li>'),A2=P('<h3 class="study-area-name svelte-eliuer"> </h3> <ul class="navigable-list"></ul>',1),w2=P('<h2> </h2> <div class="project-list svelte-eliuer"></div>',1),x2=(n,e)=>Ve(yt,{mode:"new-project"}),$2=P("<button> </button>"),k2=P('<!> <a target="_blank"> </a> <!> <!> <h2> </h2> <!> <!>',1),S2=P("<p> </p>"),E2=P("<!> <!>",1);function L2(n,e){Ne(e,!0);const t=()=>be(As,"$firstTimeLoadProjectFromURL",v),o=()=>be(Vr,"$map",v),a=()=>be(Kr,"$appFocus",v),s=()=>be(mo,"$projectStorage",v),l=()=>be(yt,"$mode",v),i=()=>be(_o,"$loadingMessage",v),f=()=>be(po,"$loadingProgress",v),[v,y]=ut(),b=u(()=>ct(dt("main")));if(Ve(It,null),Ve(ri,null),Ve(bn,void 0),t()){let F=new URLSearchParams(window.location.search).get("project");F&&O(F),Ve(As,!1)}else{let I=new URL(window.location.href);I.searchParams.delete("project"),window.history.replaceState(null,"",I.toString())}if(o()&&!t()){let I=[-180,-90,180,90];a()=="cnt"?I=[-8.943,54.631,-.901,59.489]:a()=="england"&&(I=[-5.96,49.89,2.31,55.94]),o().fitBounds(I,{duration:500})}let L=we(ht(s().studyAreaProjects()));function O(I){let F=I;try{C(F)}catch{console.error(`Error trying to fetch project from URL: ${F}`)}}function M(I,F){window.confirm(r(b).t(164,[F]))&&(s().removeProject(I),X(L,s().studyAreaProjects(),!0))}function T(I,F){let j=window.prompt(r(b).t(165,[F]),F);if(j){try{s().renameProject(I,j)}catch(d){window.alert(`Couldn't rename project: ${d}`)}X(L,s().studyAreaProjects(),!0)}}function x(I,F){let j=window.prompt(r(b).t(127,[F]),s().nextAvailableProjectName(F));if(j){try{s().copyProject(I,j)}catch(d){window.alert(`Couldn't copy project: ${d}`)}X(L,s().studyAreaProjects(),!0)}}async function C(I){await oi(I),Ve(yt,{mode:"pick-neighbourhood"})}var _=E2(),D=Q(_);go(D,{get loading(){return i()},get progress(){return f()}});var z=m(D,2);kr(z,{top:j=>{var d=v2(),g=c(d),h=c(g),$=c(h);J(w=>U($,w),[()=>mr(l().mode)]),p(j,d)},left:j=>{var d=$e(),g=Q(d);{var h=w=>{var A=k2(),B=Q(A);{var k=K=>{var V=g2(),ee=c(V);J(re=>U(ee,re),[()=>r(b).t(44)]),p(K,V)},R=K=>{var V=_2(),ee=c(V),re=c(ee),ae=m(ee,2);a2(ae,{}),J(ne=>U(re,ne),[()=>r(b).t(166)]),p(K,V)};ve(B,K=>{a()=="cnt"?K(k):K(R,!1)})}var S=m(B,2),E=c(S),N=m(S,2);xl(N,{});var G=m(N,2);{var q=K=>{var V=w2(),ee=Q(V),re=c(ee),ae=m(ee,2);Jt(ae,21,()=>r(L),Qt,(ne,ie)=>{var _e=u(()=>Dr(r(ie),2));let le=()=>r(_e)[0],fe=()=>r(_e)[1];var se=A2(),ye=Q(se),he=c(ye),Se=m(ye,2);Jt(Se,21,fe,Qt,(xe,Fe)=>{let ke=()=>r(Fe).projectID,Ce=()=>r(Fe).projectName;var pe=y2(),Me=c(pe),Te=c(Me);da(Te,{onclick:()=>C(ke()),children:(qe,Xe)=>{var st=Dt();J(()=>U(st,Ce())),p(qe,st)}});var Ae=m(Me,2),Ee=c(Ae);Ee.__click=[p2,ke];var Ie=c(Ee);Fl(Ie,{color:"black"});var Re=m(Ee,2);Re.__click=[h2,T,ke,Ce];var Ue=c(Re);es(Ue,{color:"black"});var Ge=m(Re,2);Ge.__click=[m2,x,ke,Ce];var Je=c(Ge);Bl(Je,{color:"black"});var Oe=m(Ge,2);Oe.__click=[b2,M,ke,Ce];var Qe=c(Oe);ti(Qe,{color:"white"}),J((qe,Xe,st,ft)=>{De(Ee,"title",qe),De(Re,"title",Xe),De(Ge,"title",st),De(Oe,"title",ft)},[()=>r(b).t(129),()=>r(b).t(169),()=>r(b).t(132),()=>r(b).t(170)]),p(xe,pe)}),J(xe=>U(he,xe),[()=>Mi(le())]),p(ne,se)}),J(ne=>U(re,ne),[()=>r(b).t(168)]),p(K,V)};ve(G,K=>{r(L).length>0&&K(q)})}var H=m(G,2),Y=c(H),ue=m(H,2);{var oe=K=>{var V=$2();V.__click=[x2,l];var ee=c(V);J(re=>U(ee,re),[()=>r(b).t(172)]),p(K,V)},Z=K=>{var V=$e(),ee=Q(V);{var re=ne=>{gl(ne,{get boundariesUrl(){return Km}})},ae=ne=>{var ie=$e(),_e=Q(ie);{var le=fe=>{gl(fe,{get boundariesUrl(){return Xm}})};ve(_e,fe=>{a()=="england"&&fe(le)},!0)}p(ne,ie)};ve(ee,ne=>{a()=="cnt"?ne(re):ne(ae,!1)},!0)}p(K,V)};ve(ue,K=>{a()=="global"?K(oe):K(Z,!1)})}var te=m(ue,2);f2(te,{}),J((K,V,ee)=>{De(S,"href",K),U(E,V),U(Y,ee)},[()=>`user_guide.html?lang=${Ml()}`,()=>r(b).t(167),()=>r(b).t(171)]),p(w,A)},$=w=>{var A=S2(),B=c(A);J(k=>U(B,k),[()=>r(b).t(173)]),p(w,A)};ve(g,w=>{o()&&e.wasmReady?w(h):w($,!1)})}p(j,d)},$$slots:{top:!0,left:!0}}),p(n,_),Be(),y()}tr(["click"]);var C2=P('<nav aria-label="breadcrumb"><ul><li><!></li> <li><!></li> <li><!></li> <li> </li></ul></nav>'),M2=P("<p> </p>"),P2=(n,e)=>X(e,{state:"neutral"},!0),T2=P("<b><!></b>"),I2=P("<p> </p> <button> </button> <!> <p><!></p>",1),R2=P("<!> <!>",1),N2=P("<p><!></p>"),B2=P("<p><!></p>"),F2=P("<!> <!> <!> <!>",1),O2=P("<!> <!> <!> <!>",1),j2=P("<!> <!> <!>",1);function z2(n,e){Ne(e,!0);const t=()=>be(It,"$backend",a),o=()=>be(yt,"$mode",a),[a,s]=ut(),l=u(()=>ct(dt("main")));let i=t().renderNeighbourhood(),f=we(ht({state:"neutral"}));function v(y,b){if(r(f).state!="neutral")return;let L=t().getShortcutsCrossingRoad(y.properties.id);if(L.features.length==0){window.alert(r(l).t(99));return}X(f,{state:"chose-road",roadGj:y,gj:L,shortcutIndex:0},!0)}kr(n,{top:O=>{var M=C2(),T=c(M),x=c(T),C=c(x);et(C,{mode:{mode:"title"}});var _=m(x,2),D=c(_);et(D,{mode:{mode:"pick-neighbourhood"}});var z=m(_,2),I=c(z);et(I,{mode:{mode:"neighbourhood"}});var F=m(z,2),j=c(F);J(d=>U(j,d),[()=>mr(o().mode)]),p(O,M)},left:O=>{var M=R2(),T=Q(M);un(T,{mode:{mode:"neighbourhood"}});var x=m(T,2);{var C=D=>{var z=M2(),I=c(z);J(F=>U(I,F),[()=>r(l).t(100)]),p(D,z)},_=D=>{var z=$e(),I=Q(z);{var F=j=>{var d=I2(),g=Q(d),h=c(g),$=m(g,2);$.__click=[P2,f];var w=c($),A=m($,2);Ya(A,{get list(){return r(f).gj.features},get idx(){return r(f).shortcutIndex},set idx(R){r(f).shortcutIndex=R}});var B=m(A,2);{const R=(S,E=Pe)=>{var N=T2(),G=c(N);{let q=u(()=>[r(f).gj.features[r(f).shortcutIndex].properties.directness.toFixed(1)]);me(G,{get x(){return E()},n:!0,get a(){return r(q)}})}p(S,N)};var k=c(B);{let S=u(()=>[R]),E=u(()=>r(l).cx(103));me(k,{get t(){return r(S)},get x(){return r(E)}})}}J((R,S)=>{U(h,R),U(w,S)},[()=>r(l).t(101),()=>r(l).t(102)]),p(j,d)};ve(I,j=>{r(f).state=="chose-road"&&j(F)},!0)}p(D,z)};ve(x,D=>{r(f).state=="neutral"?D(C):D(_,!1)})}p(O,M)},main:O=>{var M=j2(),T=Q(M);lt(T,{get data(){return i},generateId:!0,children:(D,z)=>{var I=F2(),F=Q(I);ni(F,{});var j=m(F,2);_a(j,{});var d=m(j,2);ha(d,{});var g=m(d,2);{const h=w=>{var A=$e(),B=Q(A);{var k=R=>{Bt(R,{openOn:"hover",children:(E,N)=>{let G=()=>N?.().data;const q=u(()=>G().properties);var H=$e(),Y=Q(H);{var ue=Z=>{var te=N2(),K=c(te);{let V=u(()=>r(l).cx(104)),ee=u(()=>[r(q).shortcuts,r(q).name??"unnamed road"]);me(K,{get x(){return r(V)},get a(){return r(ee)}})}p(Z,te)},oe=Z=>{var te=$e(),K=Q(te);{var V=ee=>{var re=B2(),ae=c(re);{let ne=u(()=>r(l).cx(105)),ie=u(()=>[r(q).name??"unnamed road"]);me(ae,{get x(){return r(ne)},get a(){return r(ie)}})}p(ee,re)};ve(K,ee=>{r(q).kind=="main_road"&&ee(V)},!0)}p(Z,te)};ve(Y,Z=>{r(q).kind=="interior_road"?Z(ue):Z(oe,!1)})}p(E,H)},$$slots:{default:!0}})};ve(B,R=>{r(f).state=="neutral"&&R(k)})}p(w,A)};let $=u(()=>r(f).state=="neutral");pa(g,{onClickLine:v,get interactive(){return r($)},get maxShortcuts(){return i.maxShortcuts},linePopup:h,$$slots:{linePopup:!0}})}p(D,I)},$$slots:{default:!0}});var x=m(T,2);{var C=D=>{var z=O2(),I=Q(z);lt(I,{get data(){return r(f).gj.features[r(f).shortcutIndex]},children:(g,h)=>{{let $=u(()=>We("shortcuts"));gt(g,Le(()=>r($),{paint:{"line-width":10,"line-color":"cyan"}}))}},$$slots:{default:!0}});var F=m(I,2);lt(F,{get data(){return r(f).roadGj},children:(g,h)=>{{let $=u(()=>We("shortcuts-focus"));gt(g,Le(()=>r($),{paint:{"line-width":5,"line-color":"blue"}}))}},$$slots:{default:!0}});var j=m(F,2);{let g=u(()=>Do(r(f).gj.features[r(f).shortcutIndex].geometry.coordinates[0]));Yn(j,{get lngLat(){return r(g)},children:(h,$)=>{var w=Dt();J(A=>U(w,A),[()=>r(l).t(71)]),p(h,w)},$$slots:{default:!0}})}var d=m(j,2);{let g=u(()=>Do(r(f).gj.features[r(f).shortcutIndex].geometry.coordinates[r(f).gj.features[r(f).shortcutIndex].geometry.coordinates.length-1]));Yn(d,{get lngLat(){return r(g)},children:(h,$)=>{var w=Dt();J(A=>U(w,A),[()=>r(l).t(72)]),p(h,w)},$$slots:{default:!0}})}p(D,z)};ve(x,D=>{r(f).state=="chose-road"&&D(C)})}var _=m(x,2);kn(_,{interactive:!1}),p(O,M)},$$slots:{top:!0,left:!0,main:!0}}),Be(),s()}tr(["click"]);var D2=P('<link rel="icon" type="image/x-icon"/>'),U2=P("<h1> </h1>"),G2=P("<h1> </h1>"),W2=P('<article style="max-height: 80vh; max-width: 80vw; overflow: auto"><!> <!></article>'),H2=(n,e)=>X(e,!0),q2=()=>window.open(`user_guide.html?lang=${Ml()}`,"_blank"),J2=P('<div class="pico" style="display: flex; align-items: center; gap: 8px;"><button class="outline"><img style="height: 32px;"/></button> <div style="width: 100%"></div> <button class="icon-btn"><!></button></div>'),Q2=P('<div class="pico"><div></div></div>'),Z2=P('<div class="ltn-map-btn zoom-to-fit-btn"><!></div>'),V2=P("<!> <!>",1),K2=P("<!> <!>",1),X2=P("<!> <!> <!> <!> <!> <div></div> <!> <!> <!> <!>",1),Y2=P('<div style="position: relative; width: 100%; height: 100%;"><!></div>'),eb=P('<div class="pico"><!></div> <div><!></div>',1);function rb(n,e){Ne(e,!0);const t=()=>be(Vr,"$mapStore",f),o=()=>be(It,"$backend",f),a=()=>be(wi,"$maptilerBasemap",f),s=()=>be(Mc,"$locale",f),l=()=>be(Kr,"$appFocusStore",f),i=()=>be(yt,"$mode",f),[f,v]=ut(),y=u(()=>ct(dt("main")));Kr.set(e.appFocus);let b=we(!1);ln(async()=>{await vu(),await Wl(),X(b,!0);try{(await fetch("/severance_pbfs/areas.json")).ok&&(Ve($c,!0),console.log("Using local asset files"))}catch{}});let L=we(void 0),O=we(!1);function M(F){t().fitBounds(o().getBounds(),{animate:F})}let T=we(ht(Date.now()));function x(){r(L)&&Date.now()-r(T)>500&&(zd(),X(T,Date.now(),!0))}let C=we(void 0);e.appFocus=="cnt"&&X(C,[-8.943,54.631,-.901,59.489],!0);let _=u(()=>a()=="streets-v2"?h_:`https://api.maptiler.com/maps/${a()}/style.json?key=${Pc}`),D=we(!1);Ze(()=>{r(L)&&(r(L).keyboard.disableRotation(),r(L).dragRotate.disable(),r(L).touchZoomRotate.disableRotation(),Vr.set(r(L)))});var z=$e();Tc(F=>{var j=D2();J(()=>De(j,"href",Bc)),p(F,j)});var I=Q(z);xc(I,()=>Ec(s()),null,F=>{var j=eb(),d=Q(j),g=c(d);El(g,{get show(){return r(D)},set show(w){X(D,w,!0)},children:(w,A)=>{var B=W2(),k=c(B);{var R=N=>{var G=U2(),q=c(G);J(H=>U(q,H),[()=>r(y).t(44)]),p(N,G)},S=N=>{var G=G2(),q=c(G);J(H=>U(q,H),[()=>r(y).t(45)]),p(N,G)};ve(k,N=>{e.appFocus=="cnt"?N(R):N(S,!1)})}var E=m(k,2);kc(E,{}),p(w,B)},$$slots:{default:!0}});var h=m(d,2),$=c(h);o_($,{top:k=>{var R=J2(),S=c(R);S.__click=[H2,D];var E=c(S),N=m(S,2);sn(N,H=>qo.value=H,()=>qo?.value);var G=m(N,2);G.__click=[q2];var q=c(G);Sc(q,{color:"black"}),J((H,Y)=>{De(E,"src",Oc),De(E,"alt",H),De(G,"title",Y)},[()=>r(y).t(46),()=>r(y).t(47)]),p(k,R)},left:k=>{var R=Q2(),S=c(R);sn(S,E=>Jo.value=E,()=>Jo?.value),p(k,R)},main:k=>{var R=Y2(),S=c(R);{let E=u(()=>[{id:zt.walkCycleOnly.filterType,url:zt.walkCycleOnly.iconURL},{id:zt.noEntry.filterType,url:zt.noEntry.iconURL},{id:zt.busGate.filterType,url:zt.busGate.iconURL},{id:zt.schoolStreet.filterType,url:zt.schoolStreet.iconURL},{id:"diagonal_filter",url:Fc},{id:"no_straight_turn",url:Tl},{id:"no_left_turn",url:Pl},{id:"no_right_turn",url:Pi},{id:"no_u_left_to_right_turn",url:Rl},{id:"no_u_right_to_left_turn",url:Il},{id:"oneway_arrow",url:Nc},{id:"border_entry_arrow",url:Rc,options:{sdf:!0}},{id:"national_rail",url:Nl}]);fd(S,{get style(){return r(_)},hash:!0,get bounds(){return r(C)},maxZoom:19,onerror:N=>{console.log(N.error)},get images(){return r(E)},get map(){return r(L)},set map(N){X(L,N,!0)},get loaded(){return r(O)},set loaded(N){X(O,N,!0)},children:(N,G)=>{var q=X2(),H=Q(q);Dl(H,{showCompass:!1});var Y=m(H,2);va(Y,{onstyledata:x});var ue=m(Y,2);{var oe=le=>{var fe=V2(),se=Q(fe);Ti(se,{position:"top-left",children:(he,Se)=>{xs(he,{children:(xe,Fe)=>{{let ke=u(()=>r(y).t(48));Lc(xe,{get title(){return r(ke)},onclick:()=>M(!0),children:(Ce,pe)=>{var Me=Z2(),Te=c(Me);Wc(Te,{}),p(Ce,Me)},$$slots:{default:!0}})}},$$slots:{default:!0}})},$$slots:{default:!0}});var ye=m(se,2);Ti(ye,{position:"top-left",children:(he,Se)=>{xs(he,{children:(xe,Fe)=>{Cc(xe,{get map(){return t()},get maptilerBasemap(){return a()}})},$$slots:{default:!0}})},$$slots:{default:!0}}),p(le,fe)};ve(ue,le=>{o()&&le(oe)})}var Z=m(ue,2);Nv(Z,{get map(){return r(L)},get loaded(){return r(O)}});var te=m(Z,2);Ul(te,{});var K=m(te,2);sn(K,le=>Qo.value=le,()=>Qo?.value);var V=m(K,2);{var ee=le=>{L2(le,{get wasmReady(){return r(b)}})},re=le=>{var fe=$e(),se=Q(fe);{var ye=he=>{Vm(he,{})};ve(se,he=>{i().mode=="new-project"&&he(ye)},!0)}p(le,fe)};ve(V,le=>{i().mode=="title"?le(ee):le(re,!1)})}var ae=m(V,2);r_(ae,{});var ne=m(ae,2);{var ie=le=>{var fe=K2(),se=Q(fe);{let xe=u(()=>o().getInvertedBoundary());lt(se,{get data(){return r(xe)},children:(Fe,ke)=>{{let Ce=u(()=>We("boundary"));ur(Fe,Le(()=>r(Ce),{paint:{"fill-color":"black","fill-opacity":.3}}))}},$$slots:{default:!0}})}var ye=m(se,2);{var he=xe=>{k1(xe,{})},Se=xe=>{var Fe=$e(),ke=Q(Fe);{var Ce=Me=>{cm(Me,{get name(){return i().name},get existing(){return i().existing}})},pe=Me=>{var Te=$e(),Ae=Q(Te);{var Ee=Re=>{gp(Re,{})},Ie=Re=>{var Ue=$e(),Ge=Q(Ue);{var Je=Qe=>{k0(Qe,{})},Oe=Qe=>{var qe=$e(),Xe=Q(qe);{var st=wt=>{z2(wt,{})},ft=wt=>{var At=$e(),mt=Q(At);{var Mt=it=>{e1(it,{})},tt=it=>{var Nt=$e(),Ot=Q(Nt);{var Et=jt=>{im(jt,{get prevMode(){return i().prevMode}})},xt=jt=>{var or=$e(),br=Q(or);{var cn=ar=>{J1(ar,{get prevMode(){return i().prevMode}})},Sr=ar=>{var Xr=$e(),Tr=Q(Xr);{var dn=Ir=>{z0(Ir,{get road(){return i().road},get prevPrevMode(){return i().prevPrevMode}})},Wr=Ir=>{var Yr=$e(),ce=Q(Yr);{var _t=Gt=>{Yp(Gt,{})},Kt=Gt=>{var sr=$e(),yr=Q(sr);{var nt=Ye=>{Fp(Ye,{})},He=Ye=>{var Ke=$e(),$t=Q(Ke);{var Pt=Ht=>{Cp(Ht,{})};ve($t,Ht=>{i().mode=="debug-demand"&&Ht(Pt)},!0)}p(Ye,Ke)};ve(yr,Ye=>{i().mode=="debug-intersections"?Ye(nt):Ye(He,!1)},!0)}p(Gt,sr)};ve(ce,Gt=>{i().mode=="debug-neighbourhood"?Gt(_t):Gt(Kt,!1)},!0)}p(Ir,Yr)};ve(Tr,Ir=>{i().mode=="impact-detail"?Ir(dn):Ir(Wr,!1)},!0)}p(ar,Xr)};ve(br,ar=>{i().mode=="predict-impact"?ar(cn):ar(Sr,!1)},!0)}p(jt,or)};ve(Ot,jt=>{i().mode=="route"?jt(Et):jt(xt,!1)},!0)}p(it,Nt)};ve(mt,it=>{i().mode=="impact-one-destination"?it(Mt):it(tt,!1)},!0)}p(wt,At)};ve(Xe,wt=>{i().mode=="view-shortcuts"?wt(st):wt(ft,!1)},!0)}p(Qe,qe)};ve(Ge,Qe=>{i().mode=="neighbourhood"?Qe(Je):Qe(Oe,!1)},!0)}p(Re,Ue)};ve(Ae,Re=>{i().mode=="add-neighbourhood"?Re(Ee):Re(Ie,!1)},!0)}p(Me,Te)};ve(ke,Me=>{i().mode=="set-boundary"?Me(Ce):Me(pe,!1)},!0)}p(xe,Fe)};ve(ye,xe=>{i().mode=="pick-neighbourhood"?xe(he):xe(Se,!1)})}p(le,fe)};ve(ne,le=>{o()&&le(ie)})}var _e=m(ne,2);Td(_e),p(N,q)},$$slots:{default:!0}})}p(k,R)},$$slots:{top:!0,left:!0,main:!0}}),J(()=>St(h,1,`app-focus-${l()??""}`)),p(F,j)}),p(n,z),Be(),v()}tr(["click"]);export{rb as A};
